import{u as A,c as Ce,r as a,k as ds,w as ms,W as _s,j as e,x as hs,Q as se,D as fs,C as us,n as xe,L as ue,t as de,S as ae,d as be,e as re,l as fe,a1 as Ie,N as xs,b as js,lv as vs}from"./index-731451a5.js";import{s as te}from"./HostelSiteInfo.module-332fbdef.js";import{J as Ye}from"./JoinFormTextArea-7f6dded0.js";import{B as G}from"./BorderBottom-47800983.js";import{J as ee}from"./JoinFormInput-8e74a0e0.js";import{J as Ns}from"./JoinFormFileEdit-e41481d6.js";import{e as bs,f as gs,g as ps,h as es,i as Ss,c as Cs,j as ys,k as ws,l as ks,m as Ts,n as $s,a as Es,o as Is,b as Fs,p as Ps,q as ss,r as Ds,s as Bs,t as qs,d as As,v as Us,w as ts,x as Os,y as Js,z as Rs,A as Ws}from"./transport-api-9ab21e71.js";import{s as le}from"./Funds.module-7551169c.js";import{F as Gs}from"./FeesCategoryList-8131ad8c.js";import{a as zs,A as Ys}from"./ApplicationPreviewDetail-fd29a331.js";import{s as D}from"./HostelFeeStructure.module-5a40a31e.js";import{s as k}from"./Hostel.module-50da11fe.js";import He from"./AssignStaffModal-61be8e90.js";import{P as oe}from"./PopupWrapper-ffbaef7a.js";import{C as Hs}from"./CustomNormalSelectInput-9ec7329b.js";import{S as Qe}from"./SearchUniversalUser-4ed43b07.js";import{U as as}from"./UniversalTab-d4f2174c.js";import{S as is}from"./StringLength-222a9fd1.js";import{O as ye}from"./Overlay-07ce6f88.js";import{S as we}from"./SearchModalBackdrop-5b309d60.js";import{s as V}from"./EditConfirm.module-344fbdb9.js";import{w as Qs}from"./hostel-api-4d11cb04.js";import{s as pe}from"./AdmissionApplicationRequest.module-43e4e129.js";import{P as Ks}from"./PaymentModeType-cf3d04e2.js";import{J as Xs}from"./JoinFormCalender-5158d888.js";import{k as Zs}from"./finance-api-5c6c5671.js";import{t as Ms}from"./pdf-convertor-function-e794de58.js";import{r as Vs}from"./main.receipt.pdf.worker-5753b302.js";import{s as Ls}from"./institute-staff-student-api-7f4890fe.js";import{s as q}from"./AdmissionScholarship.module-d4281c11.js";import{s as ce}from"./FeesStructure.module-7a88fbbc.js";import{J as ns}from"./JoinFormInputView-879755fe.js";import{s as Te}from"./JoinForm.module-212f9bb3.js";const qa=({tid:s,viewAs:t})=>{var z,Z,K,ie;const{t:i}=A(),m=Ce(),[c,n]=a.useState(!1),[f,_]=a.useState({transport_about:"",transport_process:"",cashier_name:"",cashier_signature:""}),[u,j]=a.useState([{contact_department_name:"",contact_person_name:"",contact_person_mobile:"",contact_person_email:""}]),[p,v]=a.useState(""),[x,N]=a.useState(""),[T,d]=a.useState(!1),[y,b]=a.useState(!1),[g,C]=a.useState(""),S=ds(F=>F.idChange.id),{data:h,refetch:r}=ms(S,{skip:t==="INSTITUTE"?!0:!S});a.useEffect(()=>{S&&r()},[S,r]);const{transportGetSiteInfo:E,transportGetSiteInfoRefetch:w}=bs({tid:s,skip:!s}),[o]=gs(),[l]=_s();a.useEffect(()=>{s&&w()},[s,w]),a.useEffect(()=>{var F,J,R,M,U,X,ne;if(E!=null&&E.trans_site&&(_({transport_about:(F=E==null?void 0:E.trans_site)==null?void 0:F.transport_about,transport_process:(J=E==null?void 0:E.trans_site)==null?void 0:J.transport_process,cashier_name:(R=E==null?void 0:E.trans_site)==null?void 0:R.cashier_name,cashier_signature:(M=E==null?void 0:E.trans_site)==null?void 0:M.cashier_signature}),(X=(U=E==null?void 0:E.trans_site)==null?void 0:U.transport_contact)!=null&&X.length)){let me=[];for(let H of(ne=E==null?void 0:E.trans_site)==null?void 0:ne.transport_contact){let ge={contact_department_name:H==null?void 0:H.contact_department_name,contact_person_name:H==null?void 0:H.contact_person_name,contact_person_mobile:H==null?void 0:H.contact_person_mobile,contact_person_email:H==null?void 0:H.contact_person_email,contactId:H==null?void 0:H._id};me.push(ge)}j(me)}},[E==null?void 0:E.trans_site]);const $=()=>{j(F=>[...F,{contact_department_name:"",contact_person_name:"",contact_person_mobile:"",contact_person_email:""}])},P=(F,J)=>{const R=[...u];for(let M=0;M<(R==null?void 0:R.length);M++)M===J&&(R[M][F.target.name]=F.target.value);j(R)},W=()=>{m(-1)},B=F=>{_(J=>({...J,[F.target.name]:F.target.value}))},I=F=>{if(F.target.files[0]){const J=URL.createObjectURL(F.target.files[0]);N(F.target.files[0]),C(J),v(J),d(!0)}},O=F=>{if(F){n(R=>!R);const J=new FormData;J.append("file",F),l({fileUpload:J}).then(R=>{var M;(M=R.data)!=null&&M.imageKey&&_(U=>{var X;return{...U,cashier_signature:(X=R.data)==null?void 0:X.imageKey}}),n(U=>!U)}).catch({})}};a.useEffect(()=>{y&&O(x)},[y,x]);const Q=()=>{n(F=>!F),o({tid:s,updateSiteInfo:{...f,transport_contact:u==null?void 0:u.filter(F=>F!=null&&F.contactId?"":F),edit_transport_contact:u==null?void 0:u.filter(F=>F!=null&&F.contactId?F:"")}}).then(()=>{n(F=>!F)}).catch({})};return e.jsxs("div",{className:te.bgContainer,children:[t==="INSTITUTE"?null:e.jsx("div",{className:te.navbar,children:e.jsx(hs,{status:"members",profileData:h==null?void 0:h.user,username:(z=h==null?void 0:h.user)==null?void 0:z.username,name:(Z=h==null?void 0:h.user)==null?void 0:Z.userLegalName,photoId:(K=h==null?void 0:h.user)==null?void 0:K.photoId,profilePhoto:(ie=h==null?void 0:h.user)==null?void 0:ie.profilePhoto})}),e.jsxs("div",{className:te.container,children:[e.jsxs("div",{className:te.containerhead,children:[e.jsx("h6",{children:i("update_transport_site_info")}),e.jsx("img",{src:"/images/close-post-icon.svg",alt:"",onClick:W})]}),e.jsx(G,{customStyle:{width:"100%"}}),e.jsx("div",{className:te.containercontent,children:e.jsxs("div",{className:te.container_inner_content,children:[e.jsx(Ye,{labelText:i("about_transport_department"),placeholder:i("about_transport_department_placeholder"),name:"transport_about",value:f.transport_about,type:"text",onChange:B,customStyleContainer:{width:"100%"}}),e.jsx(Ye,{labelText:i("transport_process_site"),placeholder:i("transport_process_site_placeholder"),name:"transport_process",value:f.transport_process,type:"text",onChange:B,customStyleContainer:{width:"100%"}}),e.jsxs("div",{className:te.show_field,style:{alignItems:"flex-start"},children:[e.jsx(ee,{labelText:i("site_cashier_name"),placeholder:i("site_cashier_name_placeholder"),name:"cashier_name",value:f==null?void 0:f.cashier_name,type:"text",onChange:B,customStyleContainer:{width:"69.5%"}}),e.jsx(Ns,{labelText:i("cashier_signature"),name:"cashier_signature",value:f.cashier_signature,onChange:I,customStyleContainer:{width:"29.5%"}})]}),e.jsxs("div",{className:te.add_contact_person,children:[e.jsx("h6",{children:i("add_contact_persons")}),u==null?void 0:u.map((F,J)=>e.jsxs("div",{children:[e.jsxs("div",{className:te.show_field,children:[e.jsx(ee,{labelText:i("site_department_name"),placeholder:i("site_department_name_placeholder"),name:"contact_department_name",value:F==null?void 0:F.contact_department_name,type:"text",onChange:R=>P(R,J),customStyleContainer:{width:"49.5%"}}),e.jsx(ee,{labelText:i("contact_person_name"),placeholder:i("contact_person_name_placeholder"),name:"contact_person_name",value:F==null?void 0:F.contact_person_name,type:"text",onChange:R=>P(R,J),customStyleContainer:{width:"49.5%"}})]}),e.jsxs("div",{className:te.show_field,children:[e.jsx(ee,{labelText:i("contact_person_mobile"),placeholder:i("contact_person_mobile_placeholder"),name:"contact_person_mobile",value:F==null?void 0:F.contact_person_mobile,type:"text",onChange:R=>P(R,J),customStyleContainer:{width:"49.5%"}}),e.jsx(ee,{labelText:i("contact_person_email"),placeholder:i("contact_person_email_placeholder"),name:"contact_person_email",value:F==null?void 0:F.contact_person_email,type:"email",onChange:R=>P(R,J),customStyleContainer:{width:"49.5%"}})]})]},J))]}),e.jsx("button",{className:te.add_contact_person_btn,title:"Add Contact Person",onClick:$,children:i("add_contact_person")}),c&&e.jsx(se,{}),e.jsx("button",{className:te.update_btn,onClick:Q,children:i("update")}),e.jsx(fs,{open:T,children:e.jsx(us,{setPhotoURL:v,photoURL:p,setFile:N,setOpenCrop:d,setUpload:b,setProfilePhoto:C,first:1,second:1})})]})})]})]})},ve=({carryParentState:s,activeTab:t,customStyle:i,children:m})=>{const c=xe();return e.jsx(ue,{to:`/q/${c.username}/transport?a=${t}`,state:{...s},style:i,children:m})};function $e({bal:s,value:t}){return e.jsxs("div",{className:le.balanceItem,children:[e.jsxs("p",{children:[s,":"]}),e.jsxs("p",{children:["Rs. ",t]})]})}const Aa=({tid:s,transport:t,onRefetch:i,pageOpenAs:m})=>{var j,p,v;const{t:c}=A(),[n,f]=a.useState(!1),[_]=ps(),u=()=>{var x;(t==null?void 0:t.collected_fee)>0&&(t==null?void 0:t.requested_status)==="Pending"&&(f(N=>!N),_({tid:s,submitCash:{amount:t==null?void 0:t.collected_fee,id:((x=t==null?void 0:t.institute)==null?void 0:x._id)??""}}).then(()=>{i(),f(N=>!N)}).catch({}))};return e.jsxs("div",{className:le.funds2,children:[e.jsxs("div",{className:le.fundshead,children:[e.jsxs("h6",{children:[" ",c("transport_fees_fund")," "]}),e.jsx("img",{src:"/images/finance/filter-icon.svg",alt:""})]}),e.jsxs("div",{className:le.fundscontent,children:[e.jsxs("div",{className:le.sidebarbottomitem,children:[e.jsx("img",{alt:"not found",src:"/images/hostel/rupee-blue-icon.svg"}),e.jsxs("div",{children:[e.jsxs("p",{className:le.namee,children:["Rs."," ",(t!=null&&t.offline_fee?t==null?void 0:t.offline_fee:0+(t==null?void 0:t.online_fee)?t==null?void 0:t.online_fee:0).toFixed(2)]}),e.jsxs("p",{className:le.desig,children:[" ",c("total_tansport_fees")," "]})]})]}),e.jsx($e,{check:"false",bal:c("online_fees"),value:((j=t==null?void 0:t.online_fee)==null?void 0:j.toFixed(2))??0}),e.jsx($e,{check:"true",bal:c("offline_fees"),value:((p=t==null?void 0:t.offline_fee)==null?void 0:p.toFixed(2))??0}),e.jsx($e,{check:"true",bal:c("cash_with_me"),value:((v=t==null?void 0:t.collected_fee)==null?void 0:v.toFixed(2))??0}),m==="INSTITUTE"?null:e.jsx("div",{className:le.fundbtn,onClick:u,style:{color:"#ffffff",backgroundColor:"#1c023b"},children:(t==null?void 0:t.requested_status)==="Pending"?`${c("submit")} ${c("submit_cash_to_finance_manager")}`:`${c("requested")} ${c("submit_cash_to_finance_manager")}`}),e.jsxs("div",{className:le.fundbtn,children:[c("total_pending_fees")," : Rs. ",t==null?void 0:t.remaining_fee]}),e.jsxs("div",{className:le.fundbtn,children:[c("total_written_of_fees")," : Rs. ",t==null?void 0:t.exempt_fee]})]}),n&&e.jsx(se,{})]})},et=({financeId:s,transportId:t,instituteId:i,viewAs:m,isRootAccess:c})=>{const{t:n}=A(),[f,_]=a.useState(!1),[u,j]=de(),[p,v]=a.useState(1),[x,N]=a.useState(!0),[T,d]=a.useState(!1),[y,b]=a.useState(!0),[g,C]=a.useState([]),[S,h]=a.useState(""),{getTransportFeeStructureList:r,getTransportFeeStructureListRefetch:E}=es({data:{tid:t,page:p,limit:10},skip:!t});a.useEffect(()=>{t&&(b(!0),E())},[t,p,E]),a.useEffect(()=>{j&&x&&v(l=>l+1)},[j,x]),a.useEffect(()=>{var l,$;T?(C(r==null?void 0:r.all_structures),b(!1),d(!1)):r!=null&&r.all_structures?(C(P=>[...new Set([...P,...r==null?void 0:r.all_structures].map(JSON.stringify))].map(JSON.parse)),b(!1)):((l=r==null?void 0:r.all_structures)==null?void 0:l.length)===0&&b(!1),(($=r==null?void 0:r.all_structures)==null?void 0:$.length)===10?N(!0):N(!1)},[r==null?void 0:r.all_structures]);const w=()=>{_(l=>!l)},o=()=>{v(1),d(!0),b(!0),E()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:D.structure_container_title,children:[e.jsx("h6",{children:n("fees_structure")}),c==="VALID"?e.jsx("div",{className:D.upload_excel_container,children:e.jsx("p",{className:D.add_new_category,onClick:w,children:n("add_new_fees_structure")})}):null]}),e.jsx(G,{customStyle:{marginBottom:"1rem",width:"100%"}}),g==null?void 0:g.map((l,$)=>{var P,W,B,I;return(g==null?void 0:g.length)===$+1?e.jsxs("div",{className:D.fees_card,ref:u,onClick:()=>h(l==null?void 0:l._id),style:{cursor:"pointer"},children:[e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),e.jsxs("div",{className:D.fees_card_text,children:[e.jsxs("div",{className:D.fees_card_text_bottom,children:[e.jsx("h6",{children:((P=l==null?void 0:l.category_master)==null?void 0:P.category_name)??""}),e.jsx("h6",{children:((W=l==null?void 0:l.class_master)==null?void 0:W.className)??""})]}),e.jsxs("div",{className:D.fees_card_text_bottom,children:[e.jsx("h6",{children:(l==null?void 0:l.structure_name)??""}),e.jsx("h6",{children:(l==null?void 0:l.total_admission_fees)??0})]})]})]},l==null?void 0:l._id):e.jsxs("div",{className:D.fees_card,onClick:()=>h(l==null?void 0:l._id),style:{cursor:"pointer"},children:[e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),e.jsxs("div",{className:D.fees_card_text,children:[e.jsxs("div",{className:D.fees_card_text_bottom,children:[e.jsx("h6",{children:((B=l==null?void 0:l.category_master)==null?void 0:B.category_name)??""}),e.jsx("h6",{children:((I=l==null?void 0:l.class_master)==null?void 0:I.className)??""})]}),e.jsxs("div",{className:D.fees_card_text_bottom,children:[e.jsx("h6",{children:(l==null?void 0:l.structure_name)??""}),e.jsx("h6",{children:(l==null?void 0:l.total_admission_fees)??0})]})]})]},l==null?void 0:l._id)}),y&&e.jsx(ae,{}),f&&e.jsx(zs,{onClose:w,financeId:s,departmentId:t,onRefetch:o,instituteId:i,flowAs:"Transport_Manager"}),S&&e.jsx(Ys,{structureId:S,setStructureId:h,onRefetch:o,departmentId:t,instituteId:i,financeId:s,flowAs:"Transport_Manager",viewAs:m,isRootAccess:c})]})},Ne=({carryParentState:s,activeTab:t,customStyle:i,children:m})=>{const c=xe();return e.jsx(ue,{to:`/q/${c.username}/member/transport?a=${t}`,state:{...s},style:i,children:m})},st=({fees_category_count:s,fee_master_array_count:t,fee_structure_count:i,carryParentState:m,accessRole:c,callApi:n,pageOpenAs:f})=>{const{t:_}=A();return e.jsx(e.Fragment,{children:f==="INSTITUTE"?e.jsxs(e.Fragment,{children:[e.jsx(ve,{carryParentState:m,activeTab:"fee&n=category",children:e.jsxs("div",{className:D.fees_category,children:[e.jsx("div",{className:D.fees_category_icon,children:e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"})}),e.jsxs("div",{className:D.fees_category_text,children:[e.jsx("h6",{children:_("fees_master")}),e.jsxs("p",{children:[_("fees_total")," ",s+t]})]})]})}),e.jsx(ve,{carryParentState:m,activeTab:"fee&n=structure",children:e.jsxs("div",{className:D.department_card_container,style:{marginTop:"0.8rem"},children:[e.jsx("img",{src:"/images/profileAndCover/department-profile-img.svg",alt:"department avatar",className:D.department_card_image}),e.jsxs("div",{children:[e.jsx("h6",{className:D.department_card_name,children:_("fees_structure")}),e.jsxs("p",{className:D.department_card_head,children:[_("total_fees_structure")," ",i??0]})]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{carryParentState:m,activeTab:"fee&n=category",accessRole:c,callApi:n,children:e.jsxs("div",{className:D.fees_category,children:[e.jsx("div",{className:D.fees_category_icon,children:e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"})}),e.jsxs("div",{className:D.fees_category_text,children:[e.jsx("h6",{children:_("fees_master")}),e.jsxs("p",{children:[_("fees_total")," ",s+t]})]})]})}),e.jsx(Ne,{carryParentState:m,activeTab:"fee&n=structure",accessRole:c,callApi:n,children:e.jsxs("div",{className:D.department_card_container,style:{marginTop:"0.8rem"},children:[e.jsx("img",{src:"/images/profileAndCover/department-profile-img.svg",alt:"department avatar",className:D.department_card_image}),e.jsxs("div",{children:[e.jsx("h6",{className:D.department_card_name,children:_("fees_structure")}),e.jsxs("p",{className:D.department_card_head,children:[_("total_fees_structure")," ",i??0]})]})]})})]})})},Ua=({financeId:s,instituteId:t,fees_category_count:i,fee_master_array_count:m,fee_structure_count:c,carryParentState:n,accessRole:f,transportId:_,callApi:u,pageOpenAs:j,isRootAccess:p})=>{var x,N,T;const v=be();return e.jsxs("div",{className:D.fess_container,children:[((x=v==null?void 0:v.search)==null?void 0:x.substring(3))==="fee"&&e.jsx(st,{instituteId:t,fees_category_count:i??0,carryParentState:n,fee_master_array_count:m??0,fee_structure_count:c,accessRole:f,callApi:u,pageOpenAs:j}),((N=v==null?void 0:v.search)==null?void 0:N.substring(9))==="category"&&e.jsx(Gs,{financeId:s,openAs:"TRANSPORT_MANAGER"}),((T=v==null?void 0:v.search)==null?void 0:T.substring(9))==="structure"&&e.jsx(et,{financeId:s,instituteId:t,transportId:_,isRootAccess:p})]})},Ke=({vehicle:s,customStyle:t,carryParentState:i,pageOpenAs:m})=>{var n,f,_,u,j,p,v,x,N,T,d,y;const{t:c}=A();return e.jsx(e.Fragment,{children:m==="INSTITUTE"?e.jsx(ve,{carryParentState:{...i,vehicleId:s==null?void 0:s._id},activeTab:"vehicle-detail",customStyle:t||{width:"49%"},children:e.jsxs("div",{className:k.vehical_card_container,style:t,children:[e.jsx("img",{src:"/images/transport/bus-icon.svg",alt:"bus"}),e.jsxs("div",{className:k.vehical_card_text,children:[e.jsxs("h6",{children:[c("vehicle_name")," : ",(s==null?void 0:s.vehicle_name)??""]}),e.jsxs("h6",{children:[c("vehicle_no")," ",(s==null?void 0:s.vehicle_number)??""]}),e.jsxs("p",{children:[c("driver"),`${((n=s==null?void 0:s.vehicle_driver)==null?void 0:n.staffFirstName)??""} ${((f=s==null?void 0:s.vehicle_driver)==null?void 0:f.staffMiddleName)??""} ${((_=s==null?void 0:s.vehicle_driver)==null?void 0:_.staffLastName)??""}`]}),e.jsxs("p",{children:[c("conductor"),`${((u=s==null?void 0:s.vehicle_conductor)==null?void 0:u.staffFirstName)??""} ${((j=s==null?void 0:s.vehicle_conductor)==null?void 0:j.staffMiddleName)??""} ${((p=s==null?void 0:s.vehicle_conductor)==null?void 0:p.staffLastName)??""}`]}),e.jsxs("p",{children:[c("total_passenger")," : ",(s==null?void 0:s.passenger_count)??0]})]})]})}):e.jsx(Ne,{carryParentState:{...i,vehicleId:s==null?void 0:s._id},activeTab:"vehicle-detail",customStyle:t||{width:"49%"},children:e.jsxs("div",{className:k.vehical_card_container,style:t,children:[e.jsx("img",{src:"/images/transport/bus-icon.svg",alt:"bus"}),e.jsxs("div",{className:k.vehical_card_text,children:[e.jsxs("h6",{children:[c("vehile_name")," : ",(s==null?void 0:s.vehicle_name)??"","c"]}),e.jsxs("h6",{children:[c("vehicle_no")," ",(s==null?void 0:s.vehicle_number)??""]}),e.jsxs("p",{children:[c("driver"),`${((v=s==null?void 0:s.vehicle_driver)==null?void 0:v.staffFirstName)??""} ${((x=s==null?void 0:s.vehicle_driver)==null?void 0:x.staffMiddleName)??""} ${((N=s==null?void 0:s.vehicle_driver)==null?void 0:N.staffLastName)??""}`]}),e.jsxs("p",{children:[c("conductor"),`${((T=s==null?void 0:s.vehicle_conductor)==null?void 0:T.staffFirstName)??""} ${((d=s==null?void 0:s.vehicle_conductor)==null?void 0:d.staffMiddleName)??""} ${((y=s==null?void 0:s.vehicle_conductor)==null?void 0:y.staffLastName)??""}`]}),e.jsxs("p",{children:[c("total_passenger")," : ",(s==null?void 0:s.passenger_count)??0]})]})]})})})},tt=({onClose:s,tid:t,instituteId:i,onRefetch:m})=>{const{t:c}=A(),[n,f]=a.useState({dsid:"",csid:"",vehicle_number:"",vehicle_type:"",vehicle_tracking_id:"",vehicle_name:""}),[_,u]=a.useState(!1),[j,p]=a.useState(""),[v,x]=a.useState(!1),[N,T]=a.useState(""),[d,y]=a.useState(""),[b,g]=a.useState(!1),[C]=Ss(),S=o=>{p(o),f(l=>({...l,dsid:o==null?void 0:o._id})),u(l=>!l)},h=o=>{T(o),f(l=>({...l,csid:o==null?void 0:o._id})),x(l=>!l)},r=o=>{const l={};for(let $ in o)$==="csid"||$==="vehicle_tracking_id"||o[$]||(l[$]=`${$} is required!`);return l},E=()=>{const o=r(n);let l=!1;for(let $ in o)if($){l=!0;break}l?y(o):(g($=>!$),C({tid:t,createVehicle:{dsid:n.vehicle_type==="Own"?n.dsid:"",csid:n.vehicle_type==="Own"?n.csid:"",duid:n.vehicle_type==="Outsider"?j==null?void 0:j._id:"",cuid:n.vehicle_type==="Outsider"?N==null?void 0:N._id:"",vehicle_number:n.vehicle_number??"",vehicle_type:n.vehicle_type??"",vehicle_tracking_id:n.vehicle_tracking_id??"",vehicle_name:n.vehicle_name??""}}).then(()=>{m(),s(),g($=>!$)}).catch({}))},w=o=>{f(o==="Own"?l=>({...l,vehicle_type:o,dsid:"",csid:""}):l=>({...l,vehicle_type:o,dsid:"",csid:""}))};return e.jsxs(oe,{onClose:s,children:[e.jsxs("div",{className:D.add_category_modal,style:{width:"35rem"},children:[e.jsxs("div",{className:D.add_category_modal_title,children:[e.jsx("h6",{children:c("add_vehicle")}),e.jsx("img",{src:"/images/close-post-icon.svg",onClick:s,alt:""})]}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.5rem",width:"100%"}}),e.jsx(Hs,{selectLabel:c("select_vehicle_type"),selectedValue:c("select_vehicle_type_placeholder"),options:["Own","Outsider"],value:n.vehicle_type,onClick:w}),e.jsx(ee,{labelText:c("vehicle_name"),placeholder:c("vehicle_name_placeholder"),name:"vehicle_name",value:n==null?void 0:n.vehicle_name,type:"text",onChange:o=>f(l=>({...l,vehicle_name:o.target.value})),errorShow:d.vehicle_name}),e.jsx(ee,{labelText:c("vehicle_number"),placeholder:c("vehicle_number_placeholder"),name:"vehicle_number",value:n==null?void 0:n.vehicle_number,type:"text",onChange:o=>f(l=>({...l,vehicle_number:o.target.value})),errorShow:d.vehicle_number}),e.jsx(ee,{labelText:c("tracking_id"),placeholder:c("tracking_id_placeholder"),name:"vehicle_tracking_id",value:n==null?void 0:n.vehicle_tracking_id,type:"text",onChange:o=>f(l=>({...l,vehicle_tracking_id:o.target.value}))}),e.jsxs("div",{className:D.leading_person_container,onClick:()=>u(!0),style:{marginTop:"1.3rem"},children:[e.jsx("img",{src:j!=null&&j.staffProfilePhoto?`${re}/${j.staffProfilePhoto}`:"/images/user-icon.svg",alt:"avatar"}),e.jsxs("div",{className:D.leading_person_text,children:[e.jsx("h6",{children:j?`${(j==null?void 0:j.staffFirstName)??""} 
                  ${(j==null?void 0:j.staffMiddleName)??""}
                  ${(j==null?void 0:j.staffLastName)??""} `:c("select_vehicle_driver")}),e.jsxs("p",{children:[c("search_joined_list")," ",d.dsid&&e.jsxs("span",{style:{color:"red",marginLeft:"15px"},children:["* ",c("form_require_label")]})]})]})]}),e.jsxs("div",{className:D.leading_person_container,onClick:()=>x(!0),style:{marginTop:"1.3rem"},children:[e.jsx("img",{src:N!=null&&N.staffProfilePhoto?`${re}/${N.staffProfilePhoto}`:"/images/user-icon.svg",alt:"avatar"}),e.jsxs("div",{className:D.leading_person_text,children:[e.jsx("h6",{children:N?`${(N==null?void 0:N.staffFirstName)??""} 
                  ${(N==null?void 0:N.staffMiddleName)??""}
                  ${(N==null?void 0:N.staffLastName)??""} `:c("select_vehicle_conductor")}),e.jsxs("p",{children:[c("search_joined_list")," "]})]})]}),e.jsx("button",{className:D.set_fees_structure_btn,title:"Add Vehicle",onClick:E,style:{justifyContent:"center"},children:c("add_vehicle")}),b&&e.jsx(se,{})]}),_&&n.vehicle_type==="Own"&&e.jsx(He,{assignHead:_,headSelect:S,title:c("select_vehicle_driver"),onClose:()=>u(o=>!o),viewAs:"ADMISSION_ADMIN",instituteId:i,disabledId:n.csid??n.dsid??""}),_&&n.vehicle_type==="Outsider"&&e.jsx(Qe,{onClose:u(o=>!o),title:c("select_vehicle_driver"),assignHead:_,disabledId:n.csid??n.dsid??"",headSelect:S}),v&&n.vehicle_type==="Own"&&e.jsx(He,{assignHead:v,headSelect:h,title:c("select_vehicle_conductor"),onClose:()=>x(o=>!o),viewAs:"ADMISSION_ADMIN",instituteId:i,disabledId:n.csid??n.dsid??""}),v&&n.vehicle_type==="Outsider"&&e.jsx(Qe,{onClose:()=>x(o=>!o),title:c("select_vehicle_conductor"),disabledId:n.csid??n.dsid??"",assignHead:v,headSelect:h})]})},Oa=({tid:s,carryParentState:t,pageOpenAs:i,instituteId:m,isRootAccess:c})=>{const{t:n}=A(),[f,_]=a.useState(!1),[u,j]=de(),[p,v]=a.useState(1),[x,N]=a.useState(!0),[T,d]=a.useState(!0),[y,b]=a.useState([]),[g,C]=a.useState(""),[S,h]=a.useState(!1),{getVehicleList:r,getVehicleListRefetch:E}=Cs({data:{tid:s,page:p,limit:10,search:g},skip:!s});a.useEffect(()=>{s&&(d(!0),E())},[s,p,g,E]),a.useEffect(()=>{j&&x&&v(P=>P+1)},[j,x]),a.useEffect(()=>{var P,W;S?(b(r==null?void 0:r.all_vehicles),d(!1),h(!1)):g?(b(r==null?void 0:r.all_vehicles),d(!1)):r!=null&&r.all_vehicles?(b(B=>[...new Set([...B,...r==null?void 0:r.all_vehicles].map(JSON.stringify))].map(JSON.parse)),d(!1)):((P=r==null?void 0:r.all_vehicles)==null?void 0:P.length)===0&&d(!1),((W=r==null?void 0:r.all_vehicles)==null?void 0:W.length)===10?N(!0):N(!1)},[r==null?void 0:r.all_vehicles]);const w=a.useCallback(fe.debounce(P=>C(P),500),[]),o=P=>{w(P.target.value)},l=()=>{_(P=>!P)},$=()=>{v(1),h(!0),d(!0),E()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.with_search,children:[e.jsx("h6",{children:n("vehicles")}),e.jsx("section",{className:k.search_container,children:e.jsxs("div",{className:k.search_container_input,children:[e.jsx("img",{className:k.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search vehicles...",onChange:o})]})})]}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),c==="INVALID"?null:e.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:e.jsx("p",{className:k.add_new_category,onClick:l,children:n("add_new_vehicle")})}),e.jsx("div",{className:k.vehicle_list,children:y==null?void 0:y.map((P,W)=>(y==null?void 0:y.length)===W+1?e.jsx("div",{ref:u,style:{width:"49%"},children:e.jsx(Ke,{vehicle:P,carryParentState:t,pageOpenAs:i,customStyle:{width:"100%"}})},P==null?void 0:P._id):e.jsx(Ke,{vehicle:P,carryParentState:t,pageOpenAs:i},P==null?void 0:P._id))}),T&&e.jsx(ae,{}),f&&e.jsx(tt,{onClose:l,tid:s,instituteId:m,onRefetch:$})]})},Xe=({transpotation:s,border:t})=>{var m,c,n,f,_,u;const{t:i}=A();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.transpotation_card,children:[e.jsx("h6",{style:{width:"15%",paddingLeft:"0.8rem"},children:((c=(m=s==null?void 0:s.vehicle)==null?void 0:m[0])==null?void 0:c.vehicle_type)??""}),e.jsxs("div",{style:{width:"37%"},className:k.transpotation_card_detail,children:[s!=null&&s.staffFirstName?e.jsx("img",{src:s!=null&&s.staffProfilePhoto?`${re}/${s.staffProfilePhoto}`:"/images/user-icon.svg",alt:"avatar"}):e.jsx("img",{src:s!=null&&s.profilePhoto?`${re}/${s.profilePhoto}`:"/images/user-icon.svg",alt:"avatar"}),e.jsxs("div",{className:k.transpotation_card_detail_text,children:[s!=null&&s.staffFirstName?e.jsx("h6",{children:`${(s==null?void 0:s.staffFirstName)??""} 
         ${(s==null?void 0:s.staffMiddleName)??""}
         ${(s==null?void 0:s.staffLastName)??""} `}):e.jsx("h6",{children:(s==null?void 0:s.userLegalName)??""}),e.jsxs("p",{children:[" ",i("vehicle_no")," ",((f=(n=s==null?void 0:s.vehicle)==null?void 0:n[0])==null?void 0:f.vehicle_number)??""]})]})]}),e.jsxs("div",{style:{width:"28%",display:"flex"},className:k.transpotation_card_detail_other,children:[e.jsxs("div",{className:k.transpotation_card_detail_other_inner,children:[e.jsx("img",{src:"/images/email-white.svg",alt:"icon"}),e.jsx("p",{children:((_=s==null?void 0:s.user)==null?void 0:_.userEmail)??""})]}),e.jsxs("div",{className:k.transpotation_card_detail_other_inner,children:[e.jsx("img",{src:"/images/phone-white.svg",alt:"icon"}),e.jsx("p",{children:((u=s==null?void 0:s.user)==null?void 0:u.userPhoneNumber)??""})]})]}),e.jsx("h6",{style:{width:"20%",display:"flex",justifyContent:"center"},className:k.joining_date,children:Ie(s.staffJoinDate).format("DD-MM-yyyy")})]}),t&&e.jsx(G,{customStyle:{width:"100%"}})]})},Ja=({tid:s,carryParentState:t})=>{const{t:i}=A(),[m,c]=de(),[n,f]=a.useState(1),[_,u]=a.useState(!0),[j,p]=a.useState(!0),[v,x]=a.useState([]),[N,T]=a.useState(""),{getDriverConductorList:d,getDriverConductorListRefetch:y}=ys({data:{tid:s,page:n,limit:10,search:N},skip:!s});a.useEffect(()=>{s&&(p(!0),y())},[s,n,N,y]),a.useEffect(()=>{c&&_&&f(C=>C+1)},[c,_]),a.useEffect(()=>{var C,S;N?(x(d==null?void 0:d.all_dcStaff),p(!1)):d!=null&&d.all_dcStaff?(x(h=>[...new Set([...h,...d==null?void 0:d.all_dcStaff].map(JSON.stringify))].map(JSON.parse)),p(!1)):((C=d==null?void 0:d.all_dcStaff)==null?void 0:C.length)===0&&p(!1),((S=d==null?void 0:d.all_dcStaff)==null?void 0:S.length)===10?u(!0):u(!1)},[d==null?void 0:d.all_dcStaff]);const b=a.useCallback(fe.debounce(C=>T(C),500),[]),g=C=>{b(C.target.value)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.with_search,style:{paddingInline:"1rem",paddingBottom:"0.5rem"},children:[e.jsx("h6",{children:i("vehicles")}),e.jsx("section",{className:k.search_container,children:e.jsxs("div",{className:k.search_container_input,children:[e.jsx("img",{className:k.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search",onChange:g})]})})]}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),e.jsxs("div",{className:k.transpotation_container,style:{borderTop:"0"},children:[e.jsxs("div",{className:k.transpotation_head,children:[e.jsx("h6",{style:{width:"15%",paddingLeft:"0.8rem"},children:i("transport_type")}),e.jsx("h6",{style:{width:"37%"},children:i("name")}),e.jsx("h6",{style:{width:"28%"},children:i("contact_number")}),e.jsx("h6",{style:{width:"20%"},children:i("joining_date")})]}),e.jsx(G,{customStyle:{width:"100%"}}),v==null?void 0:v.map((C,S)=>(v==null?void 0:v.length)===S+1?e.jsx("div",{ref:m,children:e.jsx(Xe,{transpotation:C,carryParentState:t})},C==null?void 0:C._id):e.jsx(Xe,{transpotation:C,carryParentState:t,border:!0},C==null?void 0:C._id))]}),j&&e.jsx(ae,{})]})},Ze=({passenger:s,border:t})=>{var f,_,u,j,p,v;const{t:i}=A(),m=xe(),c=Ce(),n=()=>{c(`/q/${m.username}/student/profile`,{state:{sid:s==null?void 0:s._id,viewAs:"ADMISSION_ADMIN"}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.transpotation_card,onClick:n,title:"View Profile",children:[e.jsxs("div",{style:{width:"70%"},className:k.transpotation_card_detail,children:[e.jsx("img",{src:s!=null&&s.studentProfilePhoto?`${re}/${s.studentProfilePhoto}`:"/images/user-icon.svg",alt:"avatar"}),e.jsxs("div",{className:k.transpotation_card_detail_text,children:[e.jsx("h6",{children:`${(s==null?void 0:s.studentFirstName)??""} 
         ${(s==null?void 0:s.studentMiddleName)??""}
         ${(s==null?void 0:s.studentLastName)??""} `}),e.jsxs("p",{children:[i("gr_number")," ",(s==null?void 0:s.studentGRNO)??""]}),e.jsxs("p",{children:[i("class_name")," ",`${((f=s==null?void 0:s.studentClass)==null?void 0:f.className)??""} - ${((_=s==null?void 0:s.studentClass)==null?void 0:_.classTitle)??""}`]}),e.jsxs("h6",{style:{fontSize:"12px"},children:[i("fee_structure")," "," : ",((u=s==null?void 0:s.transport_fee_structure)==null?void 0:u.unique_structure_name)??"",", ",i("rs")," ",((j=s==null?void 0:s.transport_fee_structure)==null?void 0:j.total_admission_fees)??""]})]})]}),e.jsxs("div",{style:{width:"30%",display:"flex"},className:k.transpotation_card_detail_other,children:[e.jsxs("div",{className:k.transpotation_card_detail_other_inner,children:[e.jsx("img",{src:"/images/email-white.svg",alt:"icon"}),e.jsx("p",{children:((p=s==null?void 0:s.user)==null?void 0:p.userEmail)??""})]}),e.jsxs("div",{className:k.transpotation_card_detail_other_inner,children:[e.jsx("img",{src:"/images/phone-white.svg",alt:"icon"}),e.jsx("p",{children:((v=s==null?void 0:s.user)==null?void 0:v.userPhoneNumber)??""})]})]})]}),t&&e.jsx(G,{customStyle:{width:"100%"}})]})},cs=({onChooseBatch:s,onClose:t})=>e.jsxs(e.Fragment,{children:[e.jsx(we,{onClose:t}),e.jsx(ye,{customStyle:{zIndex:"1200"},children:e.jsxs("div",{className:V.edit_modal_container,style:{width:"200px"},children:[e.jsx("h6",{className:V.edit,onClick:()=>s(""),children:"Current Batches"}),e.jsx("h6",{className:V.edit,onClick:()=>s("PAST"),children:"Past Batches"}),e.jsxs("h6",{className:V.remove,onClick:()=>s("ALL"),children:[" ","All Batches"]})]})})]}),Ra=({tid:s,carryParentState:t,instituteId:i})=>{const{t:m}=A(),[c,n]=de(),[f,_]=a.useState(1),[u,j]=a.useState(!0),[p,v]=a.useState(!0),[x,N]=a.useState([]),[T,d]=a.useState(""),[y,b]=a.useState(!1),[g,C]=a.useState(""),[S,h]=a.useState(!0),[r,E]=a.useState(!1),{getPassengerList:w,getPassengerListRefetch:o}=ws({data:{tid:s,page:f,limit:10,search:T,filter_by:S,batch_filter:g,id:i},skip:!s});a.useEffect(()=>{s&&(v(!0),o())},[s,i,f,T,g,S,o]),a.useEffect(()=>{n&&u&&_(I=>I+1)},[n,u]),a.useEffect(()=>{var I,O;y?(N(w==null?void 0:w.all_passengers),v(!1),b(!1)):T?(N(w==null?void 0:w.all_passengers),v(!1)):w!=null&&w.all_passengers?(f===1?(N(w==null?void 0:w.all_passengers),b(!1)):N(Q=>[...new Set([...Q,...w==null?void 0:w.all_passengers].map(JSON.stringify))].map(JSON.parse)),v(!1)):((I=w==null?void 0:w.all_passengers)==null?void 0:I.length)===0&&v(!1),((O=w==null?void 0:w.all_passengers)==null?void 0:O.length)===10?j(!0):j(!1)},[w==null?void 0:w.all_passengers]);const l=a.useCallback(fe.debounce(I=>d(I),500),[]),$=I=>{l(I.target.value)},P=()=>{E(I=>!I)},W=I=>{_(O=>1),C(I),b(!0),P()},B=()=>{_(I=>1),h(I=>!I),b(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.with_search,style:{padding:"0"},children:[e.jsx("h6",{children:m("passengers_and_student")}),e.jsxs("div",{className:k.search_container_filter,children:[e.jsx("section",{className:k.search_container,children:e.jsxs("div",{className:k.search_container_input,children:[e.jsx("img",{className:k.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search",onChange:$})]})}),e.jsx("img",{src:"/images/filter-blue-icon.svg",alt:"filter icon",style:{cursor:"pointer"},title:"See data batch wise"})]})]}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",paddingRight:"1rem"},children:e.jsx("p",{className:k.add_new_category,onClick:B,children:m("filter_by_fees")})}),e.jsx("div",{className:k.transpotation_container,style:{borderRadius:"0",border:"none"},children:x==null?void 0:x.map((I,O)=>(x==null?void 0:x.length)===O+1?e.jsx("div",{ref:c,children:e.jsx(Ze,{passenger:I,carryParentState:t})},O):e.jsx(Ze,{passenger:I,carryParentState:t,border:!0},O))}),p&&e.jsx(ae,{}),r&&e.jsx(cs,{onChooseBatch:W,onClose:P})]})},ls=({onClose:s,onRefetch:t,openAs:i,batchMenu:m,onEdit:c,transportId:n,instituteId:f})=>{const{t:_}=A(),[u,j]=a.useState(""),[p,v]=a.useState(!1),[x,N]=a.useState({batchName:i==="EDIT"?m==null?void 0:m.batchName:""}),[T]=ks();a.useEffect(()=>{i==="EDIT"&&N(y=>({...y,batchName:m==null?void 0:m.batchName}))},[i]);const d=()=>{x.batchName?i==="EDIT"?c(x.batchName):n&&(v(y=>!y),T({tid:n,transportBatch:x,id:f}).then(()=>{t(),s(),v(y=>!y)}).catch({})):j(!0)};return e.jsx(oe,{onClose:s,children:e.jsxs("div",{className:D.add_category_modal,children:[e.jsxs("div",{className:D.add_category_modal_title,children:[e.jsx("h6",{children:_(i==="EDIT"?"edit_batch":"add_new_batch")}),e.jsx("img",{src:"/images/close-post-icon.svg",onClick:s,alt:""})]}),e.jsx(G,{customStyle:{width:"100%",marginTop:"0.6rem",marginBottom:"0.6rem"}}),e.jsx(ee,{labelText:_("batch-name-place"),placeholder:"e.g. 2022-23",name:"batchName",value:x==null?void 0:x.batchName,type:"text",onChange:y=>{var b;((b=y.target.value)==null?void 0:b.length)<=30&&N(g=>({...g,batchName:y.target.value}))},errorShow:u}),e.jsx(is,{maxLength:30,valueLength:x.batchName}),e.jsx("button",{className:D.set_fees_structure_btn,title:"Create Batch",onClick:d,style:{justifyContent:"center"},children:_(i==="EDIT"?"update":"create")}),p&&e.jsx(se,{})]})})},at=({onClose:s,batchMenu:t,onRefetch:i,transportId:m,onMasterApiRefetch:c})=>{const[n,f]=a.useState(!1),[_,u]=a.useState(!1),[j]=Qs(),[p]=Ts(),[v]=$s(),x=()=>{t!=null&&t._id&&(f(d=>!d),p({bid:t==null?void 0:t._id}).then(()=>{i(),s(),f(d=>!d)}).catch({}))},N=d=>{t!=null&&t._id&&(u(!1),f(y=>!y),j({bid:t==null?void 0:t._id,updateBatch:{batchName:d}}).then(()=>{i(),f(y=>!y),s()}).catch({}))},T=()=>{t!=null&&t._id&&m&&(f(d=>!d),v({tid:m,bid:t==null?void 0:t._id}).then(()=>{c(),f(d=>!d),s()}).catch({}))};return e.jsx(e.Fragment,{children:_?e.jsx(ls,{openAs:"EDIT",onEdit:N,batchMenu:t,onClose:()=>u(d=>!d),onRefetch:i,transportId:m}):e.jsxs(e.Fragment,{children:[e.jsx(we,{onClose:s}),e.jsxs(ye,{customStyle:{zIndex:"1200"},children:[e.jsxs("div",{className:V.edit_modal_container,style:{width:"200px"},children:[e.jsx("h6",{className:V.edit,onClick:T,children:"Select Batch"})," ",e.jsx("h6",{className:V.edit,onClick:()=>u(d=>!d),children:"Edit"}),e.jsx("h6",{className:V.remove,onClick:x,children:"Delete"})]}),n&&e.jsx(se,{})]})]})})},Me=({batch:s,selectedId:t,transportId:i,onRefetch:m,onMasterApiRefetch:c})=>{const{t:n}=A(),[f,_]=a.useState("");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.hostel_batch_container,style:{backgroundColor:t===(s==null?void 0:s._id)?"rgb(226, 229, 232)":"inherit"},children:[e.jsx("img",{className:k.hostel_batch_image,src:"/images/master-24-grey-icon.svg",alt:"batch icon",style:{borderRadius:"0"}}),e.jsxs("div",{className:k.hostel_batch_container_text,children:[e.jsx("h6",{children:(s==null?void 0:s.batchName)??""}),e.jsxs("p",{children:[n("created_on_")," ",Ie(s==null?void 0:s.createdAt).format("DD MMM yyyy")]})]}),e.jsx("img",{src:"/images/three-24-dot-icon.svg",alt:"menu icon",onClick:()=>_(s),className:k.hostel_batch_menu,title:"Menu"})]}),f&&e.jsx(at,{onClose:()=>_(""),transportId:i,onRefetch:m,batchMenu:f,onMasterApiRefetch:c})]})},Wa=({transportId:s,selectedBacthId:t,onMasterApiRefetch:i,carryParentState:m,pageOpenAs:c,instituteId:n,isRootAccess:f})=>{var W;const{t:_}=A(),u=be(),[j,p]=a.useState([{name:_("batch"),id:0,url:"member/transport?a=batch"},{name:_("hostel_tab_standard"),id:1,url:"member/transport?a=standard"}]),[v,x]=a.useState(!1),[N,T]=de(),[d,y]=a.useState(1),[b,g]=a.useState(!0),[C,S]=a.useState(!0),[h,r]=a.useState([]),[E,w]=a.useState(!1),{getTransportAllBatch:o,getTransportAllBatchRefetch:l}=Es({data:{tid:s,page:d,limit:10},skip:!s});a.useEffect(()=>{c&&p([{name:_("batch"),id:0,url:"transport?a=batch"},{name:_("hostel_tab_standard"),id:1,url:"transport?a=standard"}])},[c]),a.useEffect(()=>{s&&(S(!0),l())},[s,d,l]),a.useEffect(()=>{T&&b&&y(B=>B+1)},[T,b]),a.useEffect(()=>{var B,I;E?(r(o==null?void 0:o.all_batches),S(!1),w(!1)):o!=null&&o.all_batches?(r(O=>[...new Set([...O,...o==null?void 0:o.all_batches].map(JSON.stringify))].map(JSON.parse)),S(!1)):((B=o==null?void 0:o.all_batches)==null?void 0:B.length)===0&&S(!1),((I=o==null?void 0:o.all_batches)==null?void 0:I.length)===10?g(!0):g(!1)},[o==null?void 0:o.all_batches]);const $=()=>{y(1),w(!0),S(!0),l()},P=()=>{x(B=>!B)};return e.jsxs(e.Fragment,{children:[e.jsx(as,{tabList:j,activeIndexTab:((W=u.search)==null?void 0:W.substring(3))==="batch"?0:1,showAs:!0,customStyleTab:{width:"100%",marginTop:"-1rem"},customStyleLink:{width:"50%"},carryParentState:m}),e.jsx(G,{customStyle:{marginBottom:"0.6rem",width:"100%"}}),e.jsx("div",{className:k.with_search,children:e.jsx("h6",{children:_("transport_batch")})}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),f==="VALID"?e.jsx("div",{className:k.add_container,children:e.jsx("p",{className:k.add_new_category,onClick:P,children:_("create_new_batch")})}):null,h==null?void 0:h.map((B,I)=>(h==null?void 0:h.length)===I+1?e.jsx("div",{ref:N,children:e.jsx(Me,{batch:B,transportId:s,onRefetch:$,selectedId:t,onMasterApiRefetch:i})},B==null?void 0:B._id):e.jsx(Me,{batch:B,transportId:s,onRefetch:$,selectedId:t,onMasterApiRefetch:i},B==null?void 0:B._id)),C&&e.jsx(ae,{status:"white"}),v&&e.jsx(ls,{onClose:P,transportId:s,onRefetch:$,instituteId:n})]})},it=({onClose:s,onRefetch:t,transportId:i})=>{const{t:m}=A(),[c,n]=a.useState(""),[f,_]=a.useState(!1),[u,j]=a.useState({className:""}),[p]=Is(),v=()=>{u.className?i&&(_(x=>!x),p({tid:i,transportStandard:u}).then(()=>{t(),s(),_(x=>!x)}).catch({})):n(!0)};return e.jsx(oe,{onClose:s,children:e.jsxs("div",{className:D.add_category_modal,children:[e.jsxs("div",{className:D.add_category_modal_title,children:[e.jsx("h6",{children:m("create_new_master")}),e.jsx("img",{src:"/images/close-post-icon.svg",onClick:s,alt:""})]}),e.jsx(G,{customStyle:{width:"100%",marginTop:"0.6rem",marginBottom:"0.6rem"}}),e.jsx(ee,{labelText:m("create_master_header_2"),placeholder:m("e.g. 6th Class/ FYJC"),name:"className",value:u==null?void 0:u.className,type:"text",onChange:x=>{var N;((N=x.target.value)==null?void 0:N.length)<=40&&j(T=>({...T,className:x.target.value}))},errorShow:c}),e.jsx(is,{maxLength:40,valueLength:u.className}),e.jsx("button",{className:D.set_fees_structure_btn,title:"Create Standard",onClick:v,style:{justifyContent:"center"},children:m("create")}),f&&e.jsx(se,{})]})})},nt=({standard:s})=>{const{t}=A();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:k.hostel_batch_container,children:[e.jsx("img",{className:k.hostel_batch_image,src:"/images/master-24-grey-icon.svg",alt:"batch icon",style:{borderRadius:"0"}}),e.jsxs("div",{className:k.hostel_batch_container_text,children:[e.jsx("h6",{children:(s==null?void 0:s.className)??""}),e.jsxs("p",{children:[t("created_on_")," ",Ie(s==null?void 0:s.createdAt).format("DD MMM yyyy")]})]})]})})},Ga=({transportId:s,carryParentState:t,pageOpenAs:i,isRootAccess:m})=>{var y,b;const{t:c}=A(),n=be(),[f,_]=a.useState([{name:c("batch"),id:0,url:"member/transport?a=batch"},{name:c("hostel_tab_standard"),id:1,url:"member/transport?a=standard"}]),[u,j]=a.useState(!1),[p,v]=a.useState(!0),{getTransportAllStandard:x,getTransportAllStandardRefetch:N}=Fs({tid:s,skip:!s});a.useEffect(()=>{i&&_([{name:c("batch"),id:0,url:"transport?a=batch"},{name:c("hostel_tab_standard"),id:1,url:"transport?a=standard"}])},[i]),a.useEffect(()=>{s&&(v(!0),N())},[s,N]),a.useEffect(()=>{var g;(x!=null&&x.all_masters||((g=x==null?void 0:x.all_masters)==null?void 0:g.length)===0)&&v(!1)},[x==null?void 0:x.all_masters]);const T=()=>{v(!0),N()},d=()=>{j(g=>!g)};return e.jsxs(e.Fragment,{children:[e.jsx(as,{tabList:f,activeIndexTab:((y=n.search)==null?void 0:y.substring(3))==="batch"?0:1,showAs:!0,customStyleTab:{width:"100%",marginTop:"-1rem"},customStyleLink:{width:"50%"},carryParentState:t}),e.jsx(G,{customStyle:{marginBottom:"0.6rem",width:"100%"}}),e.jsx("div",{className:k.with_search,children:e.jsx("h6",{children:c("transport_standard")})}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),m==="VALID"?e.jsx("div",{className:k.add_container,children:e.jsx("p",{className:k.add_new_category,onClick:d,children:c("create_new_standard")})}):null,(b=x==null?void 0:x.all_masters)==null?void 0:b.map(g=>e.jsx(nt,{standard:g},g==null?void 0:g._id)),p&&e.jsx(ae,{status:"white"}),u&&e.jsx(it,{onClose:d,transportId:s,onRefetch:T})]})},ct="_MiddleContent_h0r3j_1",lt="_MiddleContentLeft_h0r3j_10",rt="_tabs_h0r3j_19",ot={MiddleContent:ct,MiddleContentLeft:lt,tabs:rt};function dt({transportId:s,currentApplicant:t,onRefetch:i,onClose:m,instituteId:c,onParentRefetch:n}){var h,r,E;const[f,_]=a.useState(!1),{t:u}=A(),[j,p]=a.useState({amount:"",mode:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:""}),[v,x]=a.useState({msg:"",run:!1}),[N,T]=a.useState(""),[d]=Ps(),y=w=>{p(o=>({...o,amount:+w.target.value,fee_payment_amount:+w.target.value}))},b=w=>{w.target.name==="fee_payment_mode"?p(o=>({...o,[w.target.name]:w.target.value,mode:w.target.value==="By Cash"?"Offline":"Online",fee_payment_mode:w.target.value})):p(o=>({...o,[w.target.name]:w.target.value}))},g=w=>{const o=w==null?void 0:w.split("/");p(l=>({...l,transaction_date:`${o[2]}-${o[1]}-${o[0]}`}))},C=w=>{var l;const o={};for(let $ in w)$==="fee_bank_name"||$==="fee_bank_holder"||$==="fee_utr_reference"||$==="amount"||$==="mode"||(w[$]?$==="fee_payment_amount"&&(w[$]<=((l=t==null?void 0:t.transport_fee_structure)==null?void 0:l.total_admission_fees)||(x({msg:"You can not enter amount greater than total fees.",run:!0}),o.fee_payment_amount=`${$} is required!`)):o[$]=`${$} is required!`);return o},S=()=>{const w=C(j);let o=!1;for(let l in w){o=!0;break}if(o)T(w);else{_(!0);const l={sid:t==null?void 0:t._id,tid:s,id:c,confirm_data:j,receipt_status:j.fee_payment_mode==="Fee Receipt Not Generated"?"Fee Receipt Not Generated":""};l!=null&&l.sid&&(l!=null&&l.tid)?d(l).then($=>{$.data.confirm_status&&(n(),i(),m(!1),_(!1))}).catch({}):_(!1)}};return e.jsxs(oe,{onClose:m,children:[e.jsxs("div",{className:pe.admission_modal,children:[e.jsx("h6",{className:pe.admission_modal_heading,children:u("collect_fees")}),e.jsx(G,{customStyle:{width:"100%",margin:"0.7rem 0"}}),e.jsxs("div",{className:pe.admission_fees_row,children:[e.jsxs("h6",{children:[u("transport_amount")," :"]}),e.jsxs("h6",{children:[u("rs"),"."," ",(h=t==null?void 0:t.transport_fee_structure)==null?void 0:h.total_admission_fees]})]}),e.jsx(ee,{labelText:`${u("amount_first_installment")} ${(E=(r=t==null?void 0:t.transport_fee_structure)==null?void 0:r.one_installments)==null?void 0:E.fees}`,name:"amount",type:"tel",value:j.amount,onChange:y,placeholder:u("amoute_details_collect"),errorShow:N.fee_payment_amount,customStyleLabel:{marginTop:"15px",marginBottom:"7px"},customStyleContainer:{marginBottom:"15px"}}),e.jsx(Ks,{paymentHeading:u("payment_type_mode"),onInputChange:b,errorShow:N.fee_payment_mode}),e.jsx(Xs,{labelText:u("select_date_of_transaction"),placeholder:u("please_select_date"),name:"transaction_date",value:j.transaction_date,onDateFunction:g,customStyleContainer:{position:"relative",marginTop:"0.5rem"},datePickerPosition:{position:"relative",top:"-20rem"},customStyleLabel:{marginTop:"15px"},errorShow:N.transaction_date}),j.fee_payment_mode==="By Cash"?"":e.jsxs(e.Fragment,{children:[e.jsx(ee,{labelText:u("bank_name_collect"),name:"fee_bank_name",type:"tel",value:j.fee_bank_name,onChange:b,placeholder:u("please_enter_bank_name"),customStyleLabel:{marginTop:"15px",marginBottom:"7px"}}),e.jsx(ee,{labelText:u("banke_holder_name"),name:"fee_bank_holder",type:"tel",value:j.fee_bank_holder,onChange:b,placeholder:u("please_enter_name_of_bank_holder"),customStyleLabel:{marginTop:"15px",marginBottom:"7px"}}),e.jsx(ee,{labelText:u("cheque_dd_neft"),name:"fee_utr_reference",type:"tel",value:j.fee_utr_reference,onChange:b,placeholder:u("please_enter_utr_ref_number"),customStyleLabel:{marginTop:"15px",marginBottom:"7px"}})]}),e.jsx("div",{className:pe.confirm_btn,onClick:S,children:u("collect")}),e.jsx(xs,{msg:v.msg,run:v.run,setRun:()=>x({msg:"",run:!1}),postiton:"bottom",type:"error"})]}),f&&e.jsx(se,{})]})}const Ve=({passenger:s,border:t,setVehicleMenu:i,transportId:m,onRefetch:c,isCollect:n,onParentRefetch:f,isRootAccess:_})=>{var l,$,P,W,B,I,O,Q;const{t:u}=A(),j=xe(),p=Ce(),[v,x]=a.useState(!1),[N,T]=a.useState(""),[d,y]=a.useState(!1),[b,g]=a.useState(""),{financeTransportReceipt:C,financeTransportReceiptRefetch:S}=Zs({rid:N,skip:!N});a.useEffect(()=>{N&&S()},[N,S]),a.useEffect(()=>{C!=null&&C.receipt&&(C!=null&&C.all_remain)&&g(C)},[C]),a.useEffect(()=>{if(b){const{institute:z,studentInfo:Z,paymentReceiptInfo:K}=Ms(b==null?void 0:b.all_remain,b==null?void 0:b.receipt),ie=new Worker(new URL(Vs,import.meta.url),{type:"module"});ie.postMessage({institute:z,studentInfo:Z,paymentReceiptInfo:K,printReceiptType:(K==null?void 0:K.transactonRefund)==="Refunded"?"TRANSPORT_REFUND":"TRANSPORT"}),ie.onmessage=F=>{F&&(window.open(F.data,"_blank"),y(J=>!J),g(""),ie.terminate())}}},[b]);const h=()=>{x(z=>!z)},r=()=>{p(`/q/${j.username}/student/profile`,{state:{sid:s==null?void 0:s._id,viewAs:"ADMISSION_ADMIN"}})},E=z=>{z.stopPropagation(),_==="INVALID"||h()},w=z=>{z.stopPropagation(),_==="INVALID"||i(s)},o=(z,Z)=>{z.stopPropagation(),y(K=>!K),T(Z),N===Z&&g(C)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.transpotation_card,onClick:r,title:"View Profile",children:[e.jsxs("div",{style:{width:"50%"},className:k.transpotation_card_detail,children:[e.jsx("img",{src:s!=null&&s.studentProfilePhoto?`${re}/${s.studentProfilePhoto}`:"/images/user-icon.svg",alt:"avatar"}),e.jsxs("div",{className:k.transpotation_card_detail_text,children:[e.jsx("h6",{children:`${(s==null?void 0:s.studentFirstName)??""} 
         ${(s==null?void 0:s.studentMiddleName)??""}
         ${(s==null?void 0:s.studentLastName)??""} `}),e.jsxs("p",{children:[u("gr_number")," ",(s==null?void 0:s.studentGRNO)??""]}),e.jsxs("p",{children:[u("class_name")," ",`${((l=s==null?void 0:s.studentClass)==null?void 0:l.className)??""} - ${(($=s==null?void 0:s.studentClass)==null?void 0:$.classTitle)??""}`]}),e.jsxs("h6",{style:{fontSize:"12px"},children:[u("fee_structure")," "," : ",((P=s==null?void 0:s.transport_fee_structure)==null?void 0:P.unique_structure_name)??"",", ",u("rs")," ",((W=s==null?void 0:s.transport_fee_structure)==null?void 0:W.total_admission_fees)??""]})]})]}),e.jsxs("div",{style:{marginLeft:"1rem",width:"30%",display:"flex"},className:k.transpotation_card_detail_other,children:[e.jsxs("div",{className:k.transpotation_card_detail_other_inner,children:[e.jsx("img",{src:"/images/email-white.svg",alt:"icon"}),e.jsx("p",{children:((B=s==null?void 0:s.user)==null?void 0:B.userEmail)??""})]}),e.jsxs("div",{className:k.transpotation_card_detail_other_inner,children:[e.jsx("img",{src:"/images/phone-white.svg",alt:"icon"}),e.jsx("p",{children:((I=s==null?void 0:s.user)==null?void 0:I.userPhoneNumber)??""})]})]}),e.jsx("div",{className:k.passenger_fees_button,children:n!=null&&n.includes(s==null?void 0:s._id)?e.jsx("div",{className:k.selectBtn,onClick:E,children:u("collect_fee")}):(O=s==null?void 0:s.fee_receipt)==null?void 0:O.map((z,Z)=>Z>2?"":e.jsx("img",{src:"/images/member_tab/admission/admission-receipt-download.svg",onClick:K=>o(K,z),alt:"receipt icon",title:"Download Fees Receipt",style:{height:"1.4rem"}},z))}),_==="INVALID"?"":e.jsx("img",{src:"/images/three-24-dot-icon.svg",alt:"menu icon",onClick:w,className:k.menu_icon,title:"Menu"})]}),t&&e.jsx(G,{customStyle:{width:"100%"}}),v&&e.jsx(dt,{onRefetch:c,transportId:m,currentApplicant:s,onClose:h,instituteId:(Q=s==null?void 0:s.institute)==null?void 0:Q._id,onParentRefetch:f}),d&&e.jsx(se,{})]})},mt=({modalTitle:s,instituteId:t,onClose:i,onSelectStudent:m})=>{const{t:c}=A(),[n,f]=de(),[_,u]=a.useState(1),[j,p]=a.useState(!0),[v,x]=a.useState(!0),[N,T]=a.useState([]),[d,y]=a.useState(""),{searchStudent:b,searchStudentRefetch:g}=Ls({data:{search:d,page:_,limit:10,id:t},skip:!t});a.useEffect(()=>{t&&(x(!0),g())},[t,_,d,g]),a.useEffect(()=>{f&&j&&u(h=>h+1)},[f,j]),a.useEffect(()=>{var h,r;d?(T(b==null?void 0:b.student),x(!1)):b!=null&&b.student?(T(E=>[...new Set([...E,...b==null?void 0:b.student].map(JSON.stringify))].map(JSON.parse)),x(!1)):((h=b==null?void 0:b.student)==null?void 0:h.length)===0&&x(!1),((r=b==null?void 0:b.student)==null?void 0:r.length)===10?p(!0):p(!1)},[b==null?void 0:b.student]);const C=a.useCallback(fe.debounce(h=>y(h),500),[]),S=h=>{C(h.target.value)};return e.jsx(oe,{onClose:i,children:e.jsxs("div",{className:q.assign_role_container,children:[e.jsxs("section",{className:q.assign_role_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:i,alt:"back icon"}),e.jsx("h6",{children:c(s||"select_passenger_student")})]}),e.jsx(G,{customStyle:{width:"100%"}}),e.jsxs("section",{style:{padding:"0 0.8rem"},children:[e.jsx("div",{className:q.search_container,children:e.jsxs("div",{className:q.search_container_text,children:[e.jsx("img",{className:q.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:c("search-label"),onChange:S,autoFocus:!0,style:{border:"0.029vw solid rgba(0, 0, 0, 0.15)",width:"450px"}})]})}),N==null?void 0:N.map((h,r)=>(N==null?void 0:N.length)===r+1?e.jsxs("section",{className:q.student_container,title:"Select student",ref:n,onClick:()=>m(h),children:[e.jsx("img",{src:h.photoId!=="1"?`${re}/${h==null?void 0:h.studentProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"student avatar"}),e.jsxs("div",{className:q.student_container_name,children:[e.jsx("h6",{children:`${h==null?void 0:h.studentFirstName} ${h!=null&&h.studentMiddleName?h==null?void 0:h.studentMiddleName:""} ${h==null?void 0:h.studentLastName}`}),e.jsxs("p",{className:q.student_container_gr,children:[c("gr_number")," ",h==null?void 0:h.studentGRNO]})]})]},h==null?void 0:h._id):e.jsxs("section",{className:q.student_container,title:"Select student",onClick:()=>m(h),children:[e.jsx("img",{src:h.photoId!=="1"?`${re}/${h==null?void 0:h.studentProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"student avatar"}),e.jsxs("div",{className:q.student_container_name,children:[e.jsx("h6",{children:`${h==null?void 0:h.studentFirstName} ${h!=null&&h.studentMiddleName?h==null?void 0:h.studentMiddleName:""} ${h==null?void 0:h.studentLastName}`}),e.jsxs("p",{className:q.student_container_gr,children:[c("gr_number")," ",h==null?void 0:h.studentGRNO]})]})]},h==null?void 0:h._id)),v&&e.jsx(ae,{})]})]})})},_t=({vehicleId:s,onClose:t,onSelectStop:i})=>{var T;const{t:m}=A(),[c,n]=a.useState(!0),[f,_]=a.useState([]),[u,j]=a.useState(""),{getOneVehicleRouteList:p,getOneVehicleRouteListRefetch:v}=ss({data:{search:u,vid:s},skip:!s});a.useEffect(()=>{s&&(n(!0),v())},[s,v]),a.useEffect(()=>{var d,y,b,g;u?(_((d=p==null?void 0:p.route)==null?void 0:d.boarding_points),n(!1)):(y=p==null?void 0:p.route)!=null&&y.boarding_points?(_(C=>{var S;return[...new Set([...C,...(S=p==null?void 0:p.route)==null?void 0:S.boarding_points].map(JSON.stringify))].map(JSON.parse)}),n(!1)):((g=(b=p==null?void 0:p.route)==null?void 0:b.boarding_points)==null?void 0:g.length)===0&&n(!1)},[(T=p==null?void 0:p.route)==null?void 0:T.boarding_points]);const x=a.useCallback(fe.debounce(d=>j(d),500),[]),N=d=>{x(d.target.value)};return e.jsx(oe,{onClose:t,children:e.jsxs("div",{className:q.assign_role_container,style:{paddingBottom:"1rem"},children:[e.jsxs("section",{className:q.assign_role_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:t,alt:"back icon"}),e.jsx("h6",{children:m("select_stop")})]}),e.jsx(G,{customStyle:{width:"100%"}}),e.jsxs("section",{style:{padding:"0 0.8rem"},children:[e.jsx("div",{className:q.search_container,children:e.jsxs("div",{className:q.search_container_text,children:[e.jsx("img",{className:q.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:m("search-label"),onChange:N,autoFocus:!0,style:{border:"0.029vw solid rgba(0, 0, 0, 0.15)",width:"450px"}})]})}),f==null?void 0:f.map(d=>{var y;return(d==null?void 0:d.route_stop)==="At Institute"?"":e.jsxs("section",{className:q.route_container,onClick:()=>i(d),children:[e.jsx("img",{src:"/images/transport/stop-icon.svg",alt:"stop icon"}),e.jsxs("div",{className:q.student_container_name,children:[e.jsx("h6",{children:`${(d==null?void 0:d.route_stop)??""}`}),e.jsxs("p",{className:q.student_container_gr,children:[m("stop_fees")," ",((y=d==null?void 0:d.route_structure)==null?void 0:y.total_admission_fees)??""]})]})]},d==null?void 0:d._id)}),c&&e.jsx(ae,{})]})]})})},ht=({onClose:s,selectedStudent:t,selectedStop:i,vehicleId:m,onParentClose:c,onRefetch:n})=>{var v;const{t:f}=A(),[_,u]=a.useState(!1),[j]=Ds(),p=()=>{t!=null&&t._id&&(i!=null&&i._id)&&(u(x=>!x),j({vid:m,createPassenger:{sid:t==null?void 0:t._id,rid:i==null?void 0:i._id}}).then(()=>{n(),c(),u(x=>!x)}).catch({}))};return e.jsx(oe,{onClose:s,children:e.jsxs("div",{className:q.assign_role_container,children:[e.jsxs("section",{className:q.assign_role_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:s,alt:"back icon"}),e.jsx("h6",{children:f("add_passenger")})]}),e.jsx(G,{customStyle:{width:"100%"}}),e.jsxs("section",{style:{padding:"0 0.8rem"},children:[e.jsxs("section",{className:q.student_container,children:[e.jsx("img",{src:t.photoId!=="1"?`${re}/${t==null?void 0:t.studentProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"student avatar"}),e.jsxs("div",{className:q.student_container_name,children:[e.jsx("h6",{children:`${t==null?void 0:t.studentFirstName} ${t!=null&&t.studentMiddleName?t==null?void 0:t.studentMiddleName:""} ${t==null?void 0:t.studentLastName}`}),e.jsxs("p",{className:q.student_container_gr,children:[f("gr_number")," ",t==null?void 0:t.studentGRNO]})]})]}),e.jsxs("section",{className:q.route_container,children:[e.jsx("img",{src:"/images/transport/stop-icon.svg",alt:"stop icon"}),e.jsxs("div",{className:q.student_container_name,children:[e.jsx("h6",{children:`${(i==null?void 0:i.route_stop)??""}`}),e.jsxs("p",{className:q.student_container_gr,children:[f("stop_fees")," ",((v=i==null?void 0:i.route_structure)==null?void 0:v.total_admission_fees)??""]})]})]}),e.jsx("button",{className:q.applicable_to_btn,style:{justifyContent:"center",margin:"1rem 0"},onClick:p,children:f("add_passenger")}),_&&e.jsx(se,{})]})]})})},ft=({instituteId:s,onClose:t,vehicleId:i,onRefetch:m})=>{const[c,n]=a.useState("STUDENT_ACTION"),[f,_]=a.useState(""),[u,j]=a.useState(""),p=()=>{n(c==="SELECT_STOP"?"STUDENT_ACTION":c==="PREVIEW_PASSENGER"?"SELECT_STOP":"")},v=N=>{_(N),n("SELECT_STOP")},x=N=>{j(N),n("PREVIEW_PASSENGER")};return e.jsxs(e.Fragment,{children:[c==="STUDENT_ACTION"&&e.jsx(mt,{instituteId:s,onClose:t,onSelectStudent:v}),c==="SELECT_STOP"&&e.jsx(_t,{vehicleId:i,onClose:p,onSelectStop:x}),c==="PREVIEW_PASSENGER"&&e.jsx(ht,{vehicleId:i,onClose:p,selectedStop:u,selectedStudent:f,onParentClose:t,onRefetch:m})]})},ut=({onClose:s,vehicleId:t,vehicleMenu:i,onRefetch:m})=>{const[c,n]=a.useState(!1),[f]=Bs(),_=()=>{n(u=>!u),f({vid:t,sid:i==null?void 0:i._id}).then(()=>{m(),s(),n(u=>!u)}).catch({})};return e.jsxs(e.Fragment,{children:[e.jsx(we,{onClose:s}),e.jsxs(ye,{customStyle:{zIndex:"1200"},children:[e.jsx("div",{className:V.edit_modal_container,style:{width:"200px"},children:e.jsx("h6",{className:V.remove,onClick:_,children:"Delete"})}),c&&e.jsx(se,{})]})]})},xt=({vid:s,carryParentState:t,instituteId:i,tid:m,passengerCount:c,isRootAccess:n})=>{const{t:f}=A(),[_,u]=a.useState(!1),[j,p]=de(),[v,x]=a.useState(1),[N,T]=a.useState(!0),[d,y]=a.useState(!0),[b,g]=a.useState([]),[C,S]=a.useState(""),[h,r]=a.useState(!1),[E,w]=a.useState(""),[o,l]=a.useState(""),[$,P]=a.useState(!0),[W,B]=a.useState(!1),{getOneVehiclePassengerList:I,getOneVehiclePassengerListRefetch:O}=qs({data:{vid:s,page:v,limit:10,search:C,filter_by:$,batch_filter:o,id:i},skip:!s});a.useEffect(()=>{s&&(y(!0),O())},[s,i,v,C,o,$,O]);const{transportDetail:Q,transportDetailRefetch:z}=As({tid:m,skip:!m});a.useEffect(()=>{m&&z()},[m,z]),a.useEffect(()=>{p&&N&&x(U=>U+1)},[p,N]),a.useEffect(()=>{var U,X;h?(g(I==null?void 0:I.all_passengers),y(!1),r(!1)):C?(g(I==null?void 0:I.all_passengers),y(!1)):I!=null&&I.all_passengers?(v===1?(g(I==null?void 0:I.all_passengers),r(!1)):g(ne=>[...new Set([...ne,...I==null?void 0:I.all_passengers].map(JSON.stringify))].map(JSON.parse)),y(!1)):((U=I==null?void 0:I.all_passengers)==null?void 0:U.length)===0&&y(!1),((X=I==null?void 0:I.all_passengers)==null?void 0:X.length)===10?T(!0):T(!1)},[I==null?void 0:I.all_passengers]);const Z=()=>{u(U=>!U)},K=a.useCallback(fe.debounce(U=>S(U),500),[]),ie=U=>{K(U.target.value)},F=()=>{x(U=>1),r(!0),y(!0),O()},J=()=>{B(U=>!U)},R=U=>{x(X=>1),l(U),r(!0),J()},M=()=>{x(U=>1),P(U=>!U),r(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.with_search,style:{paddingTop:"1rem",paddingInline:"1rem"},children:[e.jsxs("h6",{children:[f("passengers_and_student")," "," : "," ",c]}),e.jsxs("div",{className:k.search_container_filter,children:[e.jsx("section",{className:k.search_container,children:e.jsxs("div",{className:k.search_container_input,children:[e.jsx("img",{className:k.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search",onChange:ie})]})}),e.jsx("img",{src:"/images/filter-blue-icon.svg",alt:"filter icon",title:"See data batch wise",style:{cursor:"pointer"}})]})]}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",paddingRight:"1rem",gap:"2rem"},children:[e.jsx("p",{className:k.add_new_category,onClick:M,children:f("filter_by_fees")}),n==="VALID"?e.jsx("p",{className:k.add_new_category,onClick:Z,children:f("add_passenger")}):null]}),e.jsx("div",{className:k.transpotation_container,children:b==null?void 0:b.map((U,X)=>{var ne,me;return(b==null?void 0:b.length)===X+1?e.jsx("div",{ref:j,children:e.jsx(Ve,{passenger:U,carryParentState:t,setVehicleMenu:w,transportId:m,onRefetch:F,isCollect:(ne=Q==null?void 0:Q.trans_panel)==null?void 0:ne.pending_student,onParentRefetch:z,isRootAccess:n})},X):e.jsx(Ve,{passenger:U,carryParentState:t,setVehicleMenu:w,transportId:m,onRefetch:F,isCollect:(me=Q==null?void 0:Q.trans_panel)==null?void 0:me.pending_student,onParentRefetch:z,isRootAccess:n,border:!0},X)})}),d&&e.jsx(ae,{}),_&&e.jsx(ft,{onClose:Z,vehicleId:s,onRefetch:F,instituteId:i}),E&&e.jsx(ut,{vehicleMenu:E,vehicleId:s,onClose:()=>w(""),onRefetch:F}),W&&e.jsx(cs,{onChooseBatch:R,onClose:J})]})},jt="_line_container_i78uy_1",vt="_line_i78uy_1",Nt="_dot_point_container_i78uy_15",bt="_dot_point_i78uy_15",gt="_dot_point_title_i78uy_29",pt="_dot_point_subtitle_i78uy_38",St="_dot_form_container_i78uy_55",Ct="_line_hover_i78uy_59",yt="_save_stop_btn_i78uy_68",wt="_button_group_i78uy_88",kt="_save_stop_btn1_i78uy_97",Tt="_delete_stop_btn_i78uy_109",$t="_select_fees_to_btn_i78uy_122",Y={line_container:jt,line:vt,dot_point_container:Nt,dot_point:bt,dot_point_title:gt,dot_point_subtitle:pt,dot_form_container:St,line_hover:Ct,save_stop_btn:yt,button_group:wt,save_stop_btn1:kt,delete_stop_btn:Tt,select_fees_to_btn:$t},rs=({onClose:s,onSelectFeeStructure:t,transportId:i,batchId:m,classMasterId:c,vehicleId:n})=>{const{t:f}=A(),[_,u]=de(),[j,p]=a.useState(1),[v,x]=a.useState(!0),[N,T]=a.useState(!0),[d,y]=a.useState([]),{getTransportFeeStructureList:b,getTransportFeeStructureListRefetch:g}=es({data:{tid:i,page:j,limit:10,filter_by:m,master_by:c??"",vehicle_by:n??""},skip:!i});a.useEffect(()=>{i&&(T(!0),g())},[i,j,g]),a.useEffect(()=>{u&&v&&p(S=>S+1)},[u,v]),a.useEffect(()=>{var S,h;b!=null&&b.all_structures?(y(r=>[...new Set([...r,...b==null?void 0:b.all_structures].map(JSON.stringify))].map(JSON.parse)),T(!1)):((S=b==null?void 0:b.all_structures)==null?void 0:S.length)===0&&T(!1),((h=b==null?void 0:b.all_structures)==null?void 0:h.length)===10?x(!0):x(!1)},[b==null?void 0:b.all_structures]);const C=S=>{t(S),s()};return e.jsx(e.Fragment,{children:e.jsx(oe,{onClose:s,children:e.jsxs("div",{className:ce.add_category_modal,style:{width:"40rem",minHeight:"35rem",maxHeight:"35rem",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth"},children:[e.jsxs("section",{className:ce.add_category_modal_title_left,style:{marginBottom:"1.2rem"},children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:s,alt:"back arrow"}),e.jsx("h6",{children:f("select_fee_structure_of_vehicle")})]}),d==null?void 0:d.map((S,h)=>(d==null?void 0:d.length)===h+1?e.jsxs("div",{className:`${ce.fees_card} ${ce.fees_card_hover}`,ref:_,onClick:()=>C(S),children:[e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),e.jsxs("div",{className:ce.fees_card_text,children:[e.jsx("h6",{children:(S==null?void 0:S.unique_structure_name)??""}),e.jsx("div",{className:ce.fees_card_text_bottom,style:{marginTop:"0.3rem"},children:e.jsxs("h6",{children:[f("total_admission_fees")," "," : "," ",f("rs"),".",(S==null?void 0:S.total_admission_fees)??0]})})]})]},S==null?void 0:S._id):e.jsxs("div",{className:`${ce.fees_card} ${ce.fees_card_hover}`,onClick:()=>C(S),children:[e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),e.jsxs("div",{className:ce.fees_card_text,children:[e.jsx("h6",{children:(S==null?void 0:S.unique_structure_name)??""}),e.jsx("div",{className:ce.fees_card_text_bottom,style:{marginTop:"0.3rem"},children:e.jsxs("h6",{children:[f("total_admission_fees")," "," : "," ",f("rs"),".",(S==null?void 0:S.total_admission_fees)??0]})})]})]},S==null?void 0:S._id)),N&&e.jsx(ae,{})]})})})},os=({name:s,type:t,value:i,onChange:m,placeholder:c,errorShow:n,customStyleContainer:f,customStyleInput:_,inputLength:u,reAccount:j,disabled:p})=>e.jsx("div",{className:Te.join_form_container,style:{...f},children:t==="tel"?e.jsx("input",{className:Te.join_form_input,type:t,value:i,onChange:m,name:s,placeholder:c,maxLength:u??100,disabled:p,style:{..._,borderColor:n||j?"#ff0000":"inherit"}}):e.jsx("input",{className:Te.join_form_input,type:t,value:i,onChange:m,name:s,placeholder:c,disabled:p,style:{..._,borderColor:n||j?"#ff0000":"inherit"}})}),Et=({onAddRoute:s,openAs:t,onWhereAdd:i,vehicleId:m,transportId:c,batchId:n,classMasterId:f,isEdit:_,addIndex:u})=>{const{t:j}=A(),[p,v]=a.useState(""),[x,N]=a.useState(!1),[T,d]=a.useState({stop:"",structure:"",structureName:""}),y=S=>{const h={};for(let r in S)S[r]||(h[r]=`${r} is required!`);return h},b=()=>{const S=y(T);let h=!1;for(let r in S)if(r){h=!0;break}h?v(S):(s(_?{...T,index:u+1}:T),d({stop:"",structure:"",structureName:""}))},g=()=>{N(S=>!S)},C=S=>{d(h=>({...h,structure:(S==null?void 0:S._id)??"",structureName:(S==null?void 0:S.unique_structure_name)??""}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx(os,{placeholder:j("enter_stop_name_placeholder"),type:"text",name:"stop",value:T.stop,onChange:S=>d(h=>({...h,stop:S.target.value})),customStyleContainer:{marginBottom:"0.7rem"},errorShow:p.stop}),T.structureName?e.jsx("div",{onClick:g,style:{cursor:"pointer"},children:e.jsx(ns,{labelText:j("structure_name"),value:T.structureName})}):e.jsx("div",{className:Y.select_fees_to_btn,style:{borderColor:p.structure?"#ff0000":"#001a72"},onClick:g,children:j("select_fees_structure")}),t==="INJECTABLE"?e.jsxs("div",{className:Y.button_group,children:[e.jsx("button",{className:Y.save_stop_btn1,onClick:b,children:j("save_stop")}),e.jsx("button",{className:Y.delete_stop_btn,onClick:i,children:j("delete_stop")})]}):e.jsx("button",{className:Y.save_stop_btn,onClick:b,children:j("save_stop")})]}),x&&e.jsx(rs,{onClose:g,vehicleId:m,transportId:c,batchId:n,classMasterId:f,onSelectFeeStructure:C})]})},Ee=({customStyle:s,customStyleDot:t,onAddRoute:i,openAs:m,onWhereAdd:c,routeIndex:n,vehicleId:f,transportId:_,batchId:u,classMasterId:j,isEdit:p,addIndex:v})=>e.jsxs("div",{className:Y.dot_point_container,style:{...s},children:[e.jsx("div",{className:Y.dot_point,style:{backgroundColor:"#ffffff",...t},children:e.jsx("img",{src:"/images/transport/route-plus-icon.svg",alt:"plus icon"})}),e.jsx("div",{className:Y.dot_form_container,children:e.jsx(Et,{onAddRoute:i,openAs:m,onWhereAdd:c,routeIndex:n,vehicleId:f,transportId:_,batchId:u,classMasterId:j,addIndex:v,isEdit:p})})]}),Se=({customStyle:s,customContainerStyle:t,title:i,subtitle:m,editRoute:c,routeId:n,onRouteClose:f,routeStructureId:_,routeStructureName:u})=>{const j=()=>{c&&f({_id:n,structureName:u,structure:_,stop:i})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:Y.dot_point_container,style:{...t,cursor:"pointer"},onClick:j,children:[e.jsx("div",{className:Y.dot_point,style:s}),e.jsxs("div",{children:[e.jsx("div",{className:Y.dot_point_title,children:i??""}),m&&e.jsx("div",{className:Y.dot_point_subtitle,children:m??""})]})]})})},It=({onAddRoute:s,addedRouteList:t,vehicleId:i,transportId:m,batchId:c,classMasterId:n})=>{const{t:f}=A();return e.jsxs("div",{className:Y.line_container,children:[e.jsx(Se,{title:"At Institution"}),t==null?void 0:t.map((_,u)=>e.jsx(Se,{customContainerStyle:{position:"absolute",top:`${u*4+4}rem`},title:_.stop,subtitle:`${f("structure_name")}${_.structureName}`},u)),e.jsx("div",{className:Y.line,style:{height:`${(t==null?void 0:t.length)*4+4}rem`}}),e.jsx(Ee,{customStyle:{alignItems:"flex-start"},customStyleDot:{marginTop:"-1px"},onAddRoute:s,vehicleId:i,transportId:m,batchId:c,classMasterId:n})]})},Ft=({onAddRoute:s,addedRouteList:t,onWhereAdd:i,addIndex:m,onAddInjectRoute:c,editRoute:n,onRouteClose:f,vehicleId:_,transportId:u,batchId:j,classMasterId:p,isRootAccess:v})=>{const{t:x}=A(),[N,T]=a.useState({yPos:"",click:!1});function d(g){T(()=>({yPos:g.clientY,click:!1}))}const y=g=>{let C=Math.ceil(g/64);return C>1?C:1};function b(g){T(()=>({yPos:g.clientY,click:!0})),i(y(g.clientY-147))}return a.useEffect(()=>{let g=document.getElementById("mouseHover");g.onmousemove=d},[]),e.jsxs("div",{className:Y.line_container,children:[e.jsx(Se,{title:"At Institution"}),t==null?void 0:t.map((g,C)=>(g==null?void 0:g.stop)===""?e.jsx(Ee,{customStyle:{alignItems:"flex-start",position:"absolute",top:C===1||C===0?"4rem":`${4*C}rem`,zIndex:"1"},customStyleDot:{marginTop:"-1px"},onAddRoute:c,openAs:"INJECTABLE",onWhereAdd:i,routeIndex:g.index,vehicleId:_,transportId:u,batchId:j,classMasterId:p},C):e.jsx(Se,{customContainerStyle:{position:"absolute",top:m?C>=m-1?`${C*4+4+10}rem`:`${C*4+4}rem`:`${C*4+4}rem`},title:g.stop??"",subtitle:`${x("structure_name")}${g.structureName??""}`,routeId:g==null?void 0:g._id,routeStructureId:g==null?void 0:g.structure,routeStructureName:g==null?void 0:g.structureName,editRoute:n,onRouteClose:f},C)),e.jsx("div",{className:Y.line,id:"mouseHover",style:{height:v==="INVALID"||!n?`${(t==null?void 0:t.length)*4}rem`:m?`${(t==null?void 0:t.length)*4+4+10}rem`:`${(t==null?void 0:t.length)*4+4}rem`},onClick:b,children:e.jsx("div",{className:Y.line_hover,style:{top:N.yPos-170,width:"15rem"},id:"mouseClick",children:v==="INVALID"||!n?null:e.jsx("div",{className:Y.dot_point,style:{backgroundColor:"#ffffff"},children:e.jsx("img",{src:"/images/transport/route-plus-icon.svg",alt:"plus icon"})})})}),v==="INVALID"||!n?"":e.jsx(Ee,{customStyle:{alignItems:"flex-start"},customStyleDot:{marginTop:"-1px"},onAddRoute:s,vehicleId:_,transportId:u,batchId:j,classMasterId:p,isEdit:!0,addIndex:t==null?void 0:t.length})]})},Pt=({openRouteMenu:s,onClose:t,vid:i,onRefetch:m,transportId:c,batchId:n,classMasterId:f})=>{const{t:_}=A(),[u,j]=a.useState(!1),[p,v]=a.useState(""),[x,N]=a.useState(!1),[T,d]=a.useState(!1),[y]=Us(),[b]=ts(),[g,C]=a.useState({stop:(s==null?void 0:s.stop)??"",structure:(s==null?void 0:s.structure)??"",structureName:(s==null?void 0:s.structureName)??""});a.useEffect(()=>{C({stop:(s==null?void 0:s.stop)??"",structure:(s==null?void 0:s.structure)??"",structureName:(s==null?void 0:s.structureName)??""})},[s]);const S=()=>{j(o=>!o),y({vid:i,rid:s==null?void 0:s._id}).then(()=>{m(),t(),j(o=>!o)}).catch({})},h=o=>{const l={};for(let $ in o)o[$]||(l[$]=`${$} is required!`);return l},r=()=>{const o=h(g);let l=!1;for(let $ in o)if($){l=!0;break}l?v(o):(j($=>!$),b({vid:i,route_status:"Renaming_Route",modifyRoute:{rid:s==null?void 0:s._id,route_stop:g==null?void 0:g.stop,route_structure:g==null?void 0:g.structure}}).then(()=>{m(),j($=>!$),t()}).catch({}))},E=()=>{N(o=>!o)},w=o=>{C(l=>({...l,structure:(o==null?void 0:o._id)??"",structureName:(o==null?void 0:o.unique_structure_name)??""}))};return e.jsx(e.Fragment,{children:x?e.jsx(rs,{onClose:E,vehicleId:i,transportId:c,batchId:n,classMasterId:f,onSelectFeeStructure:w}):e.jsxs(e.Fragment,{children:[e.jsx(we,{onClose:t}),e.jsxs(ye,{customStyle:{zIndex:"1200"},children:[e.jsx("div",{className:V.edit_modal_container,style:{width:T?"35rem":"200px",height:T?"20rem":"150px"},children:T?e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:V.edit,onClick:()=>d(o=>!o),children:_("edit_routes_name")}),e.jsx(G,{customStyle:{width:"100%"}}),e.jsx(os,{placeholder:_("enter_stop_name_placeholder"),type:"text",name:"stop",value:g.stop,onChange:o=>C(l=>({...l,stop:o.target.value})),customStyleContainer:{marginBottom:"0.7rem"},errorShow:p.stop})," ",g.structureName?e.jsx("div",{onClick:E,style:{cursor:"pointer"},children:e.jsx(ns,{labelText:_("structure_name"),value:g.structureName})}):e.jsx("div",{className:Y.select_fees_to_btn,style:{borderColor:p.structure?"#ff0000":"#001a72"},onClick:E,children:_("select_fees_structure")}),e.jsx("button",{className:V.update_to_btn,onClick:r,children:_("update")})]}):e.jsxs(e.Fragment,{children:[e.jsx("h6",{className:V.edit,onClick:()=>d(o=>!o),children:"Edit"}),e.jsx("h6",{className:V.remove,onClick:S,children:"Delete"})]})}),u&&e.jsx(se,{})]})]})})},Dt=({stopList:s,onClose:t,onRefetch:i,vehicleId:m,transportId:c,batchId:n,classMasterId:f,isRootAccess:_})=>{const{t:u}=A(),[j,p]=a.useState(!1),[v,x]=a.useState([]),[N,T]=a.useState(""),[d,y]=a.useState(!1),[b,g]=a.useState(""),[C]=ts();a.useEffect(()=>{var o,l,$,P,W,B;if(s){let I=[];for(let O=0;O<(s==null?void 0:s.length);++O)O===0||I.push({stop:((o=s[O])==null?void 0:o.route_stop)??"",_id:((l=s[O])==null?void 0:l._id)??"",structure:((P=($=s[O])==null?void 0:$.route_structure)==null?void 0:P._id)??"",structureName:((B=(W=s[O])==null?void 0:W.route_structure)==null?void 0:B.unique_structure_name)??""});x(I)}},[s]);const S=o=>{let l=v,$=!1;for(let P=0;P<(l==null?void 0:l.length);++P)l[P].stop===""&&(l.splice(P,1),$=!0);$?T(""):(l.splice(o-1,0,{stop:"",structure:"",structureName:"",index:o}),T(o),x(l))},h=o=>{x(l=>[...l,o])},r=o=>{let l=v;for(let $=0;$<(l==null?void 0:l.length);++$)l[$].stop===""&&(l[$].stop=o==null?void 0:o.stop,l[$].structure=o==null?void 0:o.structure,l[$].structureName=o==null?void 0:o.structureName);x(l),T("")},E=()=>{if(v!=null&&v.length){p(l=>!l);let o=v==null?void 0:v.filter(l=>l.index?l:"");C({vid:m,route_status:"Add_New_Stop_Point",modifyRoute:{edit_path:o}}).then(()=>{i(),p(l=>!l),t()}).catch({})}},w=o=>{g(o)};return e.jsxs(e.Fragment,{children:[!b&&e.jsx(oe,{onClose:t,children:e.jsxs("div",{className:q.assign_role_container,children:[e.jsxs("section",{className:q.assign_role_title,style:{position:"relative"},children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:t,alt:"back icon"}),e.jsx("h6",{children:u(_==="INVALID"?"vehicle_routes":"add_vehicle_route")}),_==="INVALID"?null:e.jsx("button",{className:q.edit_btn,onClick:()=>y(o=>!o),children:u(d?"cancel":"transport_edit")})]}),e.jsx(G,{customStyle:{width:"100%"}}),e.jsxs("section",{style:{padding:"0 0.8rem"},children:[e.jsx(Ft,{onAddRoute:h,onAddInjectRoute:r,addedRouteList:v,onWhereAdd:S,addIndex:N,isRootAccess:_,editRoute:d,onRouteClose:w,vehicleId:m,transportId:c,batchId:n,classMasterId:f}),_==="INVALID"||!d?null:e.jsx("button",{className:q.applicable_to_btn,style:{justifyContent:"center",marginBottom:"2rem",marginTop:"3rem"},onClick:E,children:u("save_route")}),j&&e.jsx(se,{})]})]})}),b&&e.jsx(Pt,{openRouteMenu:b,onClose:()=>g(""),vid:m,onRefetch:i,transportId:c,batchId:n,classMasterId:f})]})},Bt=({onClose:s,vid:t,transportId:i,batchId:m,classMasterId:c,isRootAccess:n})=>{var S,h,r;const{t:f}=A(),[_,u]=a.useState([]),[j,p]=a.useState(!1),[v]=Os(),[x,N]=a.useState(!0),[T,d]=a.useState([]),{getOneVehicleRouteList:y,getOneVehicleRouteListRefetch:b}=ss({data:{search:"",vid:t},skip:!t});a.useEffect(()=>{t&&(N(!0),b())},[t,b]),a.useEffect(()=>{var E,w,o,l;(E=y==null?void 0:y.route)!=null&&E.boarding_points?(d((w=y==null?void 0:y.route)==null?void 0:w.boarding_points),N(!1)):((l=(o=y==null?void 0:y.route)==null?void 0:o.boarding_points)==null?void 0:l.length)===0&&N(!1)},[(S=y==null?void 0:y.route)==null?void 0:S.boarding_points]);const g=E=>{u(w=>[...w,E])},C=()=>{_!=null&&_.length&&(p(E=>!E),v({vid:t,createRoute:{route_path:_}}).then(()=>{s()}).catch({}))};return e.jsxs(e.Fragment,{children:[(r=(h=y==null?void 0:y.route)==null?void 0:h.boarding_points)!=null&&r.length?e.jsx(Dt,{stopList:T,onClose:s,vid:t,isRootAccess:n,onRefetch:b,vehicleId:t,transportId:i,batchId:m,classMasterId:c}):n==="INVALID"?null:e.jsx(oe,{onClose:s,children:e.jsxs("div",{className:q.assign_role_container,style:{width:"40rem"},children:[e.jsxs("section",{className:q.assign_role_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:s,alt:"back icon"}),e.jsx("h6",{children:f("add_vehicle_route")})]}),e.jsx(G,{customStyle:{width:"100%"}}),e.jsxs("section",{style:{padding:"0 0.8rem"},children:[e.jsx(It,{onAddRoute:g,addedRouteList:_,vehicleId:t,transportId:i,batchId:m,classMasterId:c}),e.jsx("button",{className:q.applicable_to_btn,style:{justifyContent:"center",marginBottom:"2rem",marginTop:"3rem"},onClick:C,children:f("save_route")}),j&&e.jsx(se,{})]})]})}),x&&e.jsx(ae,{})]})},qt="_MiddleContent_1bc13_1",At="_MiddleContentLeft_1bc13_14",Ut="_tabs_1bc13_23",Ot="_item_1bc13_26",Jt="_MiddleContentRight_1bc13_50",Rt="_MiddleContentRightHead_1bc13_57",Wt="_pItem_1bc13_71",Gt="_text_1bc13_90",zt="_addbtn_1bc13_124",Yt="_menu_1bc13_143",Ht="_menuItem_1bc13_148",Qt="_itemIcon_1bc13_163",Kt="_classList_1bc13_185",Xt="_classListItem_1bc13_187",he={MiddleContent:qt,MiddleContentLeft:At,tabs:Ut,item:Ot,MiddleContentRight:Jt,MiddleContentRightHead:Rt,pItem:Wt,text:Gt,addbtn:zt,menu:Yt,menuItem:Ht,itemIcon:Qt,classList:Kt,classListItem:Xt},Zt="_studentMCQ_q25pa_1",Mt="_mcqToptabs_q25pa_4",Vt="_mcqTop_q25pa_4",Lt="_mcqTopItem_q25pa_22",ea="_active_q25pa_38",L={studentMCQ:Zt,mcqToptabs:Mt,mcqTop:Vt,mcqTopItem:Lt,active:ea};function sa({search:s,carryParentState:t,isVehile:i}){const{t:m}=A(),c=xe();return e.jsx("div",{className:L.mcqTop,children:i?e.jsx("div",{className:L.mcqToptabs,children:e.jsx("div",{className:`${L.mcqTopItem} ${L.active}`,children:m("menu")})}):e.jsxs("div",{className:L.mcqToptabs,children:[e.jsx(ue,{to:`/q/${c.username}/member/transport`,state:{...t},style:{width:"33.3%"},children:e.jsx("div",{className:s?L.mcqTopItem:`${L.mcqTopItem} ${L.active}`,children:m("menu")})}),e.jsx(ue,{to:`/q/${c.username}/member/transport?a=fee`,state:{...t},style:{width:"33.3%"},children:e.jsx("div",{className:(s==null?void 0:s.substring(3,6))==="fee"?`${L.mcqTopItem} ${L.active}`:L.mcqTopItem,children:m("fee_structure")})}),e.jsx(ue,{to:`/q/${c.username}/member/transport?a=fund`,state:{...t},style:{width:"33.3%"},children:e.jsx("div",{className:(s==null?void 0:s.substring(3))==="fund"?`${L.mcqTopItem} ${L.active}`:L.mcqTopItem,children:m("funds")})})]})})}function ta({carryParentState:s,accessRole:t,accessTpye:i,callApi:m,pageOpenAs:c}){const{t:n}=A(),f=be();return e.jsx("div",{className:he.MiddleContent,style:{color:"inherit"},children:e.jsxs("div",{className:he.MiddleContentLeft,children:[e.jsx("div",{className:he.tabs,children:e.jsx(sa,{search:f==null?void 0:f.search,carryParentState:s,isVehile:!0})}),e.jsx("div",{className:he.item,children:c==="INSTITUTE"?e.jsxs(e.Fragment,{children:[e.jsx(ve,{carryParentState:s,activeTab:"vehicle-detail&n=passenger",accessRole:t,accessTpye:i,callApi:m,children:e.jsxs("div",{className:he.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/transport/transport-passenger-icon.svg",alt:"moderator icon"}),e.jsx("p",{children:n("vehicle_passenger")})]})}),e.jsx(ve,{carryParentState:s,activeTab:"vehicle-detail&n=route",accessRole:t,accessTpye:i,callApi:m,children:e.jsxs("div",{className:he.itemIcon,children:[e.jsx("img",{src:"/images/transport/add-route-icon.svg",alt:"completed"}),e.jsx("p",{children:n("view_route")})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{carryParentState:s,activeTab:"vehicle-detail&n=passenger",accessRole:t,accessTpye:i,callApi:m,children:e.jsxs("div",{className:he.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/transport/transport-passenger-icon.svg",alt:"moderator icon"}),e.jsx("p",{children:n("vehicle_passenger")})]})}),e.jsx(Ne,{carryParentState:s,activeTab:"vehicle-detail&n=route",accessRole:t,accessTpye:i,callApi:m,children:e.jsxs("div",{className:he.itemIcon,children:[e.jsx("img",{src:"/images/transport/add-route-icon.svg",alt:"completed"}),e.jsx("p",{children:n("view_route")})]})})]})})]})})}const za=({transportId:s,carryParentState:t,pageOpenAs:i,isRootAccess:m,instituteId:c})=>{var l,$,P,W,B,I,O,Q,z,Z,K,ie,F,J,R,M,U,X,ne,me,H,ge,Fe,Pe,De,Be,qe,Ae,Ue,Oe,Je,Re,We,Ge,ze;const{t:n}=A(),f=be(),[_]=js(),u=Ce(),[j,p]=a.useState(""),[v,x]=a.useState(""),[N,T]=a.useState(!1),[d,y]=a.useState(!1),[b,g]=a.useState(""),[C]=Js(),[S,h]=a.useState(!1),{getVehicleDetail:r,getVehicleDetailRefetch:E}=Rs({vid:(l=f.state)==null?void 0:l.vehicleId,skip:!(($=f.state)!=null&&$.vehicleId)});a.useEffect(()=>{var _e;(_e=f.state)!=null&&_e.vehicleId&&E()},[(P=f.state)==null?void 0:P.vehicleId,E]),a.useEffect(()=>{var _e;if(d){h(ke=>!ke);let je=new FormData;je.append("file",v),C({uploadFile:je,vid:(_e=f.state)==null?void 0:_e.vehicleId}).then(()=>{h(ke=>!ke)}).catch({})}},[d,v]);const w=_e=>{const je=URL.createObjectURL(_e.target.files[0]);x(_e.target.files[0]),g(je),p(je),T(!0)},o=()=>{u(-1)};return e.jsx(e.Fragment,{children:_.get("n")?_.get("n")==="passenger"?e.jsx("div",{className:ot.MiddleContentLeft,style:{borderRadius:"6px"},children:e.jsx(xt,{vid:(Je=f.state)==null?void 0:Je.vehicleId,pageOpenAs:i,instituteId:c||((We=(Re=r==null?void 0:r.one_vehicle)==null?void 0:Re.transport)==null?void 0:We.institute),tid:s,passengerCount:((Ge=r==null?void 0:r.one_vehicle)==null?void 0:Ge.passenger_count)??0,isRootAccess:m})}):_.get("n")==="route"?e.jsx(Bt,{onClose:o,vid:(ze=f.state)==null?void 0:ze.vehicleId,transportId:s,batchId:"",classMasterId:"",isRootAccess:m}):null:e.jsxs(e.Fragment,{children:[e.jsx(vs,{coverKey:(W=r==null?void 0:r.one_vehicle)==null?void 0:W.vehicle_photo,coverId:(B=r==null?void 0:r.one_vehicle)!=null&&B.vehicle_photo?"0":"2",defaultCover:"/images/profileAndCover/transport-cover.svg",textLarge:`${n("vehicle_name")} : ${((I=r==null?void 0:r.one_vehicle)==null?void 0:I.vehicle_name)??""} (${((O=r==null?void 0:r.one_vehicle)==null?void 0:O.vehicle_number)??""})`,textSmall:`(${(Q=r==null?void 0:r.one_vehicle)!=null&&Q.vehicle_type?((z=r==null?void 0:r.one_vehicle)==null?void 0:z.vehicle_type)==="Own"?"Own Vehicle":"Outside Vehicle":""})`,driver:`${n("driver")} ${(K=(Z=r==null?void 0:r.one_vehicle)==null?void 0:Z.vehicle_driver)!=null&&K.staffFirstName?`${((F=(ie=r==null?void 0:r.one_vehicle)==null?void 0:ie.vehicle_driver)==null?void 0:F.staffFirstName)??""} ${((R=(J=r==null?void 0:r.one_vehicle)==null?void 0:J.vehicle_driver)==null?void 0:R.staffMiddleName)??""} ${((U=(M=r==null?void 0:r.one_vehicle)==null?void 0:M.vehicle_driver)==null?void 0:U.staffLastName)??""}`:((ne=(X=r==null?void 0:r.one_vehicle)==null?void 0:X.vehicle_driver)==null?void 0:ne.userLegalName)??""}`,conductor:`${n("conductor")} ${(H=(me=r==null?void 0:r.one_vehicle)==null?void 0:me.vehicle_conductor)!=null&&H.staffFirstName?`${((Fe=(ge=r==null?void 0:r.one_vehicle)==null?void 0:ge.vehicle_conductor)==null?void 0:Fe.staffFirstName)??""} ${((De=(Pe=r==null?void 0:r.one_vehicle)==null?void 0:Pe.vehicle_conductor)==null?void 0:De.staffMiddleName)??""} ${((qe=(Be=r==null?void 0:r.one_vehicle)==null?void 0:Be.vehicle_conductor)==null?void 0:qe.staffLastName)??""}`:((Ue=(Ae=r==null?void 0:r.one_vehicle)==null?void 0:Ae.vehicle_conductor)==null?void 0:Ue.userLegalName)??""}`,pendingFees:`${n("pending_fees")} : ${((Oe=r==null?void 0:r.one_vehicle)==null?void 0:Oe.remaining_fee)??0}`,profilePhoto:b,profileChange:w,openCrop:N,setOpenCrop:T,setPhotoURL:p,photoURL:j,setFile:x,setUpload:y,setProfilePhoto:g,viewAs:!1,coverUpdate:m!=="INVALID",openAs:"VEHICLE_DETAIL",coverImageStyle:{height:"auto"}}),e.jsx(ta,{carryParentState:t,pageOpenAs:i}),S&&e.jsx(se,{})]})})},Le=({applicant:s})=>{var m;const{t}=A(),i=xe();return e.jsx(ue,{to:`/q/${i.username}/student/profile/admission`,state:{sid:s==null?void 0:s._id,viewAs:"ADMISSION_ADMIN",openTab:"FEES_DATA"},children:e.jsxs("div",{className:k.hostelite_container,title:"View Profile",children:[e.jsx("img",{alt:"Student Avatar",src:s.photoId!=="1"?`${re}/${s==null?void 0:s.studentProfilePhoto}`:"/images/member_tab/class/default_avatar.svg"}),e.jsxs("div",{className:k.hostelite_container_inner,children:[e.jsxs("div",{className:k.hostelite_container_inner_text,children:[e.jsx("h6",{children:`${s.studentFirstName} ${s.studentMiddleName?s.studentMiddleName:""} ${s.studentLastName}`}),e.jsx("p",{children:((m=s==null?void 0:s.student_unit)==null?void 0:m.hostel_unit_name)??""})]}),e.jsxs("div",{className:k.hostelite_container_inner_text,children:[e.jsxs("h6",{children:[t("rs")," ",". ",(s==null?void 0:s.vehicleRemainFeeCount)??0]}),e.jsx("p",{children:t("pending_fees")})]})]})]})})},Ya=({transportId:s,instituteId:t})=>{const{t:i}=A(),[m,c]=a.useState(""),[n,f]=de({skip:m}),[_,u]=a.useState(1),[j,p]=a.useState(!0),[v,x]=a.useState(!0),[N,T]=a.useState([]),{getPendingFeeByTransport:d,getPendingFeeByTransportRefetch:y}=Ws({data:{tid:s,page:_,limit:10,search:m,id:t??""},skip:!s});a.useEffect(()=>{s&&(x(!0),y())},[s,t,_,m,y]),a.useEffect(()=>{f&&j&&u(C=>C+1)},[f,j]),a.useEffect(()=>{var C,S;m?(T(d==null?void 0:d.remain),x(!1)):d!=null&&d.remain?(T(h=>[...new Set([...h,...d==null?void 0:d.remain].map(JSON.stringify))].map(JSON.parse)),x(!1)):((C=d==null?void 0:d.remain)==null?void 0:C.length)===0&&x(!1),((S=d==null?void 0:d.remain)==null?void 0:S.length)===10?p(!0):p(!1)},[d==null?void 0:d.remain]);const b=a.useCallback(fe.debounce(C=>c(C),500),[]),g=C=>{b(C.target.value)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.with_search,children:[e.jsx("h6",{children:i("remaining_fees")}),e.jsx("section",{className:k.search_container,children:e.jsxs("div",{className:k.search_container_input,children:[e.jsx("img",{className:k.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search...",onChange:g})]})})]}),e.jsx(G,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),N==null?void 0:N.map((C,S)=>(N==null?void 0:N.length)===S+1?e.jsx("div",{ref:n,children:e.jsx(Le,{applicant:C})},C==null?void 0:C._id):e.jsx(Le,{applicant:C},C==null?void 0:C._id)),v&&e.jsx(ae,{})]})};export{ve as I,Ra as P,Aa as T,Oa as V,qa as a,Ja as b,Wa as c,Ga as d,za as e,Ya as f,Ua as g,sa as h,Ne as i,he as s};
