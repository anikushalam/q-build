import{u as R,r as e,H as $,j as a,S as T,$ as q,nn as G,Q as F,t as H,v as V,a1 as E}from"./index-731451a5.js";import{C as J}from"./CustomSelectDepartment-a5dd9a35.js";import{C as Q}from"./index-43f19233.js";import{s as v}from"./PromoteDepartment.module-1bdd3b1d.js";import{B as L}from"./BorderBottom-47800983.js";import{s as A}from"./AdmisisonRefund.module-c6c85188.js";import{p as U,q as z,r as W}from"./admission-api-56b87fde.js";import{O as X}from"./Overlay-07ce6f88.js";import{S as Z}from"./SearchModalBackdrop-5b309d60.js";import{s as O}from"./EditConfirm.module-344fbdb9.js";import{J as K}from"./JoinFormInput-8e74a0e0.js";const Y="_id_container_1xtcr_1",I="_id_container_full_1xtcr_11",tt="_id_container_width_1xtcr_14",st="_selectClass_1xtcr_25",at="_selectClassleft_1xtcr_41",nt="_exportbtn_1xtcr_56",k={id_container:Y,id_container_full:I,id_container_width:tt,selectClass:st,selectClassleft:at,exportbtn:nt},rt=({departmentId:i,selectedClasses:n,setState:u,setStudentData:h,setIsZip:l})=>{var y,P;const{t:f}=R(),[p,N]=e.useState([]),[j,C]=e.useState(!1),[x,_]=e.useState(!0),{oneDepartment:r,oneDepartmentRefetch:g}=$({did:i,skip:!i});e.useEffect(()=>{i&&(N([]),C(!1),_(!0),g())},[i,g]),e.useEffect(()=>{var s,o,c,S;(o=(s=r==null?void 0:r.department)==null?void 0:s.departmentSelectBatch)!=null&&o.classroom&&(N(((S=(c=r==null?void 0:r.department)==null?void 0:c.departmentSelectBatch)==null?void 0:S.classroom)??[]),_(!1))},[(P=(y=r==null?void 0:r.department)==null?void 0:y.departmentSelectBatch)==null?void 0:P.classroom]);const b=s=>{h([]),l(!1),n!=null&&n.includes(s==null?void 0:s._id)?u(o=>{var c,S;return{...o,classes:(c=o.classes)==null?void 0:c.filter(w=>w!==(s==null?void 0:s._id)),studentCount:(o==null?void 0:o.studentCount)-((S=s==null?void 0:s.ApproveStudent)==null?void 0:S.length)}}):u(o=>{var c;return{...o,classes:[...o.classes,s==null?void 0:s._id],studentCount:(o==null?void 0:o.studentCount)+((c=s==null?void 0:s.ApproveStudent)==null?void 0:c.length)}})},d=()=>{var c,S,w;h([]),l(!1);let s=[],o=0;for(let m of(S=(c=r==null?void 0:r.department)==null?void 0:c.departmentSelectBatch)==null?void 0:S.classroom)s.push(m==null?void 0:m._id),o+=(w=m==null?void 0:m.ApproveStudent)==null?void 0:w.length;u(m=>({...m,classes:s,studentCount:o})),C(!0)},D=()=>{u(s=>({...s,classes:[],studentCount:0})),C(!1)};return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:v.with_search,style:{width:"100%",border:"0.4px solid rgba(0, 0, 0, 0.15)",borderRadius:"4px"},children:a.jsxs("div",{className:v.search_container_input,style:{width:"100%"},children:[a.jsx("img",{className:v.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),a.jsx("input",{type:"text",placeholder:"Search classes...",style:{width:"100%"}})]})}),a.jsxs("div",{className:v.counts,children:[a.jsxs("p",{children:[(n==null?void 0:n.length)>0?n.length:""," selected"]}),a.jsx("p",{style:{cursor:"pointer"},onClick:j?D:d,children:f(j?"all_remove":"select_all")})]}),a.jsxs("div",{className:v.items,children:[p==null?void 0:p.map(s=>a.jsxs("div",{onClick:()=>b(s),children:[a.jsxs("div",{className:v.itemm,children:[a.jsx("div",{className:v.subItem,children:s==null?void 0:s.classTitle}),n!=null&&n.includes(s==null?void 0:s._id)?a.jsx("img",{className:v.checkbox,src:"/images/checkbox-icon.svg",alt:"icon"}):a.jsx("img",{className:v.checkbox,src:"/images/box-icon.svg",alt:"icon"})]}),a.jsx(L,{customStyle:{width:"100%"}})]},s==null?void 0:s._id)),x&&a.jsx(T,{status:"white"})]})]})},jt=({instituteId:i})=>{var s,o,c,S,w;const{t:n}=R(),[u,h]=e.useState(!1),[l,f]=e.useState({department:"",classes:[],studentCount:0}),[p,N]=e.useState([]),[j,C]=e.useState(!1),[x,_]=e.useState(!1),{allDepartment:r,allDepartmentRefetch:g}=q({id:i,skip:!i}),[b]=G();e.useEffect(()=>{i&&g()},[i,g]);const d=()=>{C(m=>!m)},D=m=>{f(t=>({...t,department:m,classes:[],studentCount:0})),N([]),_(!1)},y=m=>m.map(function(t){var B,M;return{GRNo:t==null?void 0:t.studentGRNO,Name:(t==null?void 0:t.studentFirstName)+" "+(t==null?void 0:t.studentMiddleName)+" "+(t==null?void 0:t.studentLastName),Gender:t==null?void 0:t.studentGender,MotherName:t!=null&&t.studentMotherName?t==null?void 0:t.studentMotherName:"NA",DOB:t!=null&&t.studentDOB?t==null?void 0:t.studentDOB:"NA","Blood Group":t!=null&&t.student_blood_group?t==null?void 0:t.student_blood_group:"NA","Caste Category":t!=null&&t.studentCastCategory?t==null?void 0:t.studentCastCategory:"NA",Religion:t!=null&&t.studentReligion?t==null?void 0:t.studentReligion:"NA",BirthPlace:t!=null&&t.studentBirthPlace?t==null?void 0:t.studentBirthPlace:"NA",Address:t!=null&&t.studentAddress?t==null?void 0:t.studentAddress:"NA",ParentsName:t!=null&&t.studentParentsName?t==null?void 0:t.studentParentsName:"NA","Parent's Contact":t!=null&&t.studentParentsPhoneNumber?t==null?void 0:t.studentParentsPhoneNumber:"NA",State:t!=null&&t.studentState?t==null?void 0:t.studentState:"NA",District:t!=null&&t.studentDistrict?t==null?void 0:t.studentDistrict:"NA",Nationality:t!=null&&t.studentNationality?t==null?void 0:t.studentNationality:"NA",Class:(B=t==null?void 0:t.studentClass)==null?void 0:B.classTitle,Contact:t==null?void 0:t.studentPhoneNumber,Email:t==null?void 0:t.studentEmail,AdmissionDate:(M=t==null?void 0:t.studentAdmissionDate)==null?void 0:M.split("T")[0],AadharNumber:t!=null&&t.studentAadharNumber?t==null?void 0:t.studentAadharNumber:"NA","Mother Tongue":t!=null&&t.studentMTongue?t==null?void 0:t.studentMTongue:"NA",Caste:t!=null&&t.studentCast?t==null?void 0:t.studentCast:"NA","Current Address":t!=null&&t.studentCurrentAddress?t==null?void 0:t.studentCurrentAddress:"NA","Father Ration Color":t!=null&&t.studentFatherRationCardColor?t==null?void 0:t.studentFatherRationCardColor:"NA","Parent's Occupation":t!=null&&t.studentParentsOccupation?t==null?void 0:t.studentParentsOccupation:"NA","Parent's Annual Income":t!=null&&t.studentParentsAnnualIncom?t==null?void 0:t.studentParentsAnnualIncom:"NA","Previous School":t!=null&&t.studentPreviousSchool?t==null?void 0:t.studentPreviousSchool:"NA","Bank Name":t!=null&&t.studentBankName?t==null?void 0:t.studentBankName:"NA","Bank Account":t!=null&&t.studentBankAccount?t==null?void 0:t.studentBankAccount:"NA","Bank Holder Name":t!=null&&t.studentBankAccountHolderName?t==null?void 0:t.studentBankAccountHolderName:"NA","Bank Ifsc":t!=null&&t.studentBankIfsc?t==null?void 0:t.studentBankIfsc:"NA"}}),P=()=>{var m;((m=l.classes)==null?void 0:m.length)>0&&(h(!0),b({request:l.classes,id:i}).then(t=>{var B,M;_((B=t==null?void 0:t.data)==null?void 0:B.stats),N(y((M=t==null?void 0:t.data)==null?void 0:M.student_card)),h(!1)}).catch({}))};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:k.id_container,children:[a.jsxs("div",{className:j?k.id_container_width:k.id_container_full,children:[a.jsx("h4",{children:n("id_cards")}),a.jsx(J,{selectLabel:n("select_department"),selectedValue:n("plz_select_dept"),options:((s=r==null?void 0:r.institute)==null?void 0:s.depart)??[],onClick:D,openAs:"PROMOTE"}),a.jsxs("div",{className:k.selectClass,onClick:d,children:[a.jsx("div",{className:k.selectClassleft,children:((o=l.classes)==null?void 0:o.length)>0?a.jsxs(a.Fragment,{children:[a.jsxs("h6",{children:[(c=l.classes)==null?void 0:c.length," ",n("classes_selected")]}),a.jsxs("p",{children:[l.studentCount," ",n("student_data_required")]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h6",{children:n("select_classes")}),a.jsx("p",{children:n("student_data")})]})}),a.jsx("img",{src:"/images/forward-right-icon.svg",alt:"icon"})]}),p.length>0?a.jsx(Q,{data:p,filename:`${(S=l.department)==null?void 0:S.dName}-id-card.csv`,children:a.jsx("div",{className:k.exportbtn,children:n("export_data")})}):a.jsx("div",{className:k.exportbtn,onClick:P,children:n("get_info")})]}),j&&a.jsx("div",{className:k.id_container_width,children:a.jsx(rt,{departmentId:(w=l.department)==null?void 0:w._id,selectedClasses:l.classes,setState:f,setStudentData:N,setIsZip:_})})]}),u&&a.jsx(F,{})]})},et=({onEdit:i,xlsxId:n})=>{const{t:u}=R(),[h,l]=e.useState((n==null?void 0:n.excel_file_name)??""),[f,p]=e.useState("");e.useEffect(()=>{l((n==null?void 0:n.excel_file_name)??"")},[n==null?void 0:n.excel_file_name]);const N=()=>{h?i(h):p({excelName:"excelName is required"})};return a.jsxs("div",{style:{width:"20rem",minHeight:"10rem",padding:"1rem"},children:[a.jsx("h6",{children:u("update_excel_name")}),a.jsx(L,{customStyle:{width:"100%"}}),a.jsx(K,{labelText:u("excel_name"),placeholder:u("excel_name_plcaeholder"),value:h,name:"excelName",type:"text",onChange:j=>l(j.target.value),errorShow:f.excelName}),a.jsx("button",{className:O.xlsx_update_btn,title:"Add fees head",onClick:N,style:{justifyContent:"center",marginTop:"1rem"},children:u("update")})]})},ot=({onClose:i,xlsxId:n,onRefetch:u,instituteId:h})=>{const[l,f]=e.useState(!1),[p,N]=e.useState(!1),[j]=U(),[C]=z(),x=()=>{f(r=>!r),j({aid:h,xlsxId:n==null?void 0:n._id}).then(()=>{u(),i(),f(r=>!r)}).catch({})},_=r=>{f(g=>!g),C({aid:h,xlsxId:n==null?void 0:n._id,excelUpdate:{excel_file_name:r}}).then(()=>{u(),f(g=>!g),i()}).catch({})};return a.jsxs(a.Fragment,{children:[a.jsx(Z,{onClose:i}),a.jsxs(X,{customStyle:{zIndex:"1200"},children:[p?a.jsx(et,{xlsxId:n,onEdit:_}):a.jsxs("div",{className:O.edit_modal_container,style:{width:"200px"},children:[a.jsx("h6",{className:O.edit,onClick:()=>N(r=>!r),children:"Edit"}),a.jsx("h6",{className:O.remove,onClick:x,children:"Delete"})]}),l&&a.jsx(F,{})]})]})},gt=({instituteId:i})=>{const[n,u]=H(),[h,l]=e.useState(1),[f,p]=e.useState(!0),[N,j]=e.useState(!1),[C,x]=e.useState(!0),[_,r]=e.useState([]),[g,b]=e.useState(!1),{getAllExcelByAdmissionAdmin:d,getAllExcelByAdmissionAdminRefetch:D}=W({data:{aid:i,page:h,limit:10},skip:!i}),{scrollToTop:y}=V();e.useEffect(()=>{y()},[]),e.useEffect(()=>{i&&(x(!0),D())},[i,h,D]),e.useEffect(()=>{u&&f&&l(s=>s+1)},[u,f]),e.useEffect(()=>{var s,o;N?(r(d==null?void 0:d.all_excel),j(!1),x(!1)):d!=null&&d.all_excel?(r(c=>[...new Set([...c,...d==null?void 0:d.all_excel].map(JSON.stringify))].map(JSON.parse)),x(!1)):((s=d==null?void 0:d.all_excel)==null?void 0:s.length)===0&&x(!1),((o=d==null?void 0:d.all_excel)==null?void 0:o.length)===10?p(!0):p(!1)},[d==null?void 0:d.all_excel]);const P=()=>{l(1),D(),j(!0)};return a.jsxs("div",{className:A.refund_list,children:[_==null?void 0:_.map((s,o)=>(_==null?void 0:_.length)===o+1?a.jsxs("a",{ref:n,className:A.export_card,title:"Download File",href:`https://d3dqpu54js2vfl.cloudfront.net/${s==null?void 0:s.excel_file}`,target:"_blank",rel:"noopener noreferrer",children:[a.jsx("img",{src:"/images/export-xsxl-icon.svg",alt:""}),a.jsxs("section",{className:A.export_card_text,children:[a.jsx("h6",{children:(s==null?void 0:s.excel_file_name)??""}),a.jsxs("div",{className:A.export_card_date,children:[a.jsx("h6",{children:E(s==null?void 0:s.created_at).format("DD MMM yyy")}),a.jsx("h6",{children:E(s==null?void 0:s.created_at).format("LT")})]})]}),a.jsx("img",{src:"/images/three-24-dot-icon.svg",alt:"menu icon",onClick:c=>{c.preventDefault(),b(s)},className:A.menu_icon,title:"Menu"})]},s==null?void 0:s._id):a.jsxs("a",{className:A.export_card,title:"Download File",href:`https://d3dqpu54js2vfl.cloudfront.net/${s==null?void 0:s.excel_file}`,target:"_blank",rel:"noopener noreferrer",children:[a.jsx("img",{src:"/images/export-xsxl-icon.svg",alt:""}),a.jsxs("section",{className:A.export_card_text,children:[a.jsx("h6",{children:(s==null?void 0:s.excel_file_name)??""}),a.jsxs("div",{className:A.export_card_date,children:[a.jsx("h6",{children:E(s==null?void 0:s.created_at).format("DD MMM yyy")}),a.jsx("h6",{children:E(s==null?void 0:s.created_at).format("LT")})]})]}),a.jsx("img",{src:"/images/three-24-dot-icon.svg",alt:"menu icon",onClick:c=>{c.preventDefault(),b(s)},className:A.menu_icon,title:"Menu"})]},s==null?void 0:s._id)),C&&a.jsx(T,{}),g&&a.jsx(ot,{xlsxId:g,onClose:()=>b(""),onRefetch:P,instituteId:i})]})};export{gt as I,jt as S};
