import{u as C,j as a,lH as R,r as b,d as W,c as Q,b as X}from"./index-0ca76035.js";import{a as D,F as g,u as Y,L as Z,b as O,c as M,M as k,U as q,d as B,e as ee,s as E,B as U,f as I,C as ae,Q as _e,g as te,h as ce,i as se,j as ie,H as re,k as le,l as ne}from"./FinanceConfig-24ef7fd2.js";import{F as de}from"./FormFile-128594c4.js";import{C as V}from"./CustomSelectDepartment-c173db4b.js";const oe="_bank_detail_card_16w0o_1",me="_bank_detail_card_heading_16w0o_19",ue="_bank_detail_card_inner_16w0o_31",fe="_bank_detail_applicable_16w0o_39",he="_bank_detail_card_upi_16w0o_53",be="_bank_detail_card_qr_16w0o_59",pe="_bank_detail_list_16w0o_75",xe="_save_button_16w0o_83",je="_applicable_btn_container_16w0o_97",we="_applicable_btn_16w0o_97",ge="_applicable_text_16w0o_127",ve="_applicable_text_error_16w0o_134",Se="_applicable_container_16w0o_140",Ne="_bank_fund_container_16w0o_150",Ce="_bank_fund_16w0o_150",Fe="_bank_details_16w0o_180",Ie="_bank_upi_16w0o_197",ye="_bank_qr_code_16w0o_207",qe="_bank_qr_code_text_16w0o_220",u={bank_detail_card:oe,bank_detail_card_heading:me,bank_detail_card_inner:ue,bank_detail_applicable:fe,bank_detail_card_upi:he,bank_detail_card_qr:be,bank_detail_list:pe,save_button:xe,applicable_btn_container:je,applicable_btn:we,applicable_text:ge,applicable_text_error:ve,applicable_container:Se,bank_fund_container:Ne,bank_fund:Ce,bank_details:Fe,bank_upi:Ie,bank_qr_code:ye,bank_qr_code_text:qe};let y={fontWeight:"400"};const $e=({bank:e})=>{var s,l,p,n,d,i,c,j;const{t:_}=C();return a.jsxs("div",{className:u.bank_detail_card,children:[a.jsxs("div",{className:u.bank_detail_card_heading,children:[a.jsx("img",{src:`${D}/bank-card.svg`,alt:"bank icon"}),a.jsxs("div",{className:u.bank_detail_card_inner,children:[a.jsx("h6",{children:(e==null?void 0:e.finance_bank_name)??""}),a.jsx("p",{children:(s=e==null?void 0:e.department)!=null&&s.dName?(l=e==null?void 0:e.department)==null?void 0:l.dName:e!=null&&e.hostel?"Hostel":e!=null&&e.library?"Library":e!=null&&e.transport?"Transport":((p=e==null?void 0:e.departments)==null?void 0:p.length)>0?(n=e==null?void 0:e.departments)==null?void 0:n.map((m,x)=>{var f;return a.jsxs("span",{children:[(m==null?void 0:m.dName)??"",x+1===((f=e==null?void 0:e.departments)==null?void 0:f.length)?"":", "]},m==null?void 0:m._id)}):""})]})]}),a.jsxs("section",{className:u.bank_detail_applicable,children:[a.jsxs("h6",{children:[_("applicable_for")," "," : "," "]}),a.jsx(g,{label:(d=e==null?void 0:e.department)!=null&&d.dName?(i=e==null?void 0:e.department)==null?void 0:i.dName:e!=null&&e.hostel?"Hostel":e!=null&&e.library?"Library":e!=null&&e.transport?"Transport":((c=e==null?void 0:e.departments)==null?void 0:c.length)>0?(j=e==null?void 0:e.departments)==null?void 0:j.map((m,x)=>{var f;return a.jsxs("span",{children:[(m==null?void 0:m.dName)??"",x+1===((f=e==null?void 0:e.departments)==null?void 0:f.length)?"":", "]},m==null?void 0:m._id)}):"",customFormInputLabel:y})]}),a.jsxs("section",{className:u.bank_detail_applicable,children:[a.jsx("h6",{children:_("bank_details")}),a.jsx(g,{label:`${_("bank_name")} :`,value:e==null?void 0:e.finance_bank_name,customFormInput:y}),a.jsx(g,{label:`${_("account_name")} :`,value:e==null?void 0:e.finance_bank_account_name,customFormInput:y}),a.jsx(g,{label:`${_("account_number")} :`,value:e==null?void 0:e.finance_bank_account_number,customFormInput:y}),a.jsx(g,{label:`${_("ifsc_code")} :`,value:e==null?void 0:e.finance_bank_ifsc_code,customFormInput:y}),a.jsx(g,{label:`${_("address")} :`,value:e==null?void 0:e.finance_bank_branch_address,customFormInput:y})]}),a.jsx(g,{label:`${_("upi_id")} :`,value:e==null?void 0:e.finance_bank_upi_id,customFormInput:y}),a.jsxs("section",{className:u.bank_detail_card_upi,style:{width:"100%",alignItems:"flex-start"},children:[a.jsxs("div",{className:u.bank_detail_card_qr,children:[a.jsxs("h6",{children:[_("qr_code"),":"]}),a.jsx("p",{children:(e==null?void 0:e.finance_bank_upi_id)??""})]}),e!=null&&e.finance_bank_upi_qrcode?a.jsx("img",{src:`${R}/${e==null?void 0:e.finance_bank_upi_qrcode}`,alt:"qr code"}):""]})]})},Le=({fid:e})=>{var p;const _=W(),{financeAllBank:s,financeAllBankLoading:l}=Y({data:{fid:e,page:1,limit:40,search:""},skip:!e});return a.jsxs("div",{className:u.bank_detail_list,children:[l&&a.jsx(Z,{}),(p=s==null?void 0:s.all_accounts)==null?void 0:p.map(n=>a.jsx("div",{style:{width:"49%"},children:a.jsx(O,{parentState:{..._.state,bankId:n==null?void 0:n._id},activeUrl:"type=bank&n=detail",children:a.jsx($e,{bank:n})},n==null?void 0:n._id)}))]})},De=b.memo(Le),Ae=({fid:e,onToggle:_,libraryId:s,transportId:l,hostelId:p,setApplicablFor:n})=>{var h,o;const{t:d}=C(),[i,c]=b.useState({flow:"",flow_id:"",flow_name:"",depart_arr:[]}),{instituteAllDepartment:j}=M({fid:e,skip:!e}),m=r=>{r==="Hostel"?c({flow:"Hostel",flow_id:p,flow_name:"Hostel",depart_arr:[]}):r==="Transport"?c({flow:"Transport",flow_id:l,flow_name:"Transport",depart_arr:[]}):r==="Library"?c({flow:"Library",flow_id:s,flow_name:"Library",depart_arr:[]}):r==="Internal Department"&&c({flow:"Department",flow_id:"",flow_name:"",depart_arr:[]})},x=r=>{c($=>({...$,flow_id:r==null?void 0:r._id,flow_name:r==null?void 0:r.dName,depart_arr:[...new Set([...$.depart_arr,r==null?void 0:r._id])]}))},f=()=>{n(i),_()};return a.jsx(k,{onClose:_,children:a.jsx("div",{className:u.applicable_container,children:a.jsxs(q,{children:[a.jsx(V,{selectLabel:d("applicable_for"),selectedValue:d("applicable_for_placeholder"),options:["Internal Department","Transport","Library","Hostel"],onClick:m,isFull:!0}),i.flow==="Department"&&a.jsx(V,{selectLabel:d("select_internal_department"),selectedValue:d("select_internal_department_placeholder"),options:j??[],onClick:x,isFull:!0,viewAs:"NORMAL_FILTER",defalutValue:((h=i.depart_arr)==null?void 0:h.length)>1?`${(o=i.depart_arr)==null?void 0:o.length} department selected`:i.flow_name}),a.jsx("button",{className:u.applicable_btn,onClick:f,style:{width:"100%",justifyContent:"center"},children:a.jsx("div",{children:d("select")})})]})})})},Te=({errorField:e,applicableFor:_,libraryId:s,transportId:l,hostelId:p,setApplicablFor:n,fid:d})=>{var x,f;const{t:i}=C(),[c,j]=b.useState(!1),m=b.useCallback(()=>{j(h=>!h)},[]);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:u.applicable_btn_container,children:[a.jsxs("button",{className:u.applicable_btn,onClick:m,children:[a.jsx("div",{children:i("account_applicable_for")}),a.jsx("img",{src:`${D}/forward.svg`,alt:"next step"})]}),(_==null?void 0:_.flow_name)&&a.jsx("h6",{className:u.applicable_text,children:((x=_==null?void 0:_.depart_arr)==null?void 0:x.length)>1?`${(f=_==null?void 0:_.depart_arr)==null?void 0:f.length} department selected`:_==null?void 0:_.flow_name})]}),e.flow_id&&a.jsxs("p",{className:u.applicable_text_error,children:["* ",i("form_require_label")]}),c&&a.jsx(Ae,{fid:d,onToggle:m,libraryId:s,transportId:l,hostelId:p,setApplicablFor:n})]})},Ee=b.memo(Te),z=({onClose:e,fid:_,libraryId:s,transportId:l,hostelId:p,openAs:n,onEditAction:d,openBankMenu:i})=>{const{t:c}=C(),[j]=B(),[m]=ee(),[x,f]=b.useState(!1),[h,o]=b.useState(""),[r,$]=b.useState({finance_bank_name:"",finance_bank_account_number:"",finance_bank_account_name:"",finance_bank_ifsc_code:"",finance_bank_branch_address:"",finance_bank_upi_id:"",finance_bank_upi_qrcode:"",finance_bank_re_account_number:"",finance_bank_re_upi_id:""}),[A,P]=b.useState({flow:"",flow_id:"",flow_name:"",depart_arr:[]}),[L,K]=b.useState("");b.useEffect(()=>{n==="EDIT"&&$({finance_bank_name:(i==null?void 0:i.finance_bank_name)??"",finance_bank_account_number:(i==null?void 0:i.finance_bank_account_number)??"",finance_bank_account_name:(i==null?void 0:i.finance_bank_account_name)??"",finance_bank_ifsc_code:(i==null?void 0:i.finance_bank_ifsc_code)??"",finance_bank_branch_address:(i==null?void 0:i.finance_bank_branch_address)??"",finance_bank_upi_id:(i==null?void 0:i.finance_bank_upi_id)??"",finance_bank_upi_qrcode:(i==null?void 0:i.finance_bank_upi_qrcode)??"",finance_bank_re_account_number:(i==null?void 0:i.finance_bank_account_number)??"",finance_bank_re_upi_id:(i==null?void 0:i.finance_bank_upi_id)??""})},[n]);const F=S=>{$(N=>({...N,[S.target.name]:S.target.value}))},G=b.useCallback(S=>{f(v=>!v);const N=new FormData;K(S.target.files[0]),N.append("file",S.target.files[0]),j({fileUpload:N}).then(v=>{f(T=>!T),$(T=>{var H;return{...T,finance_bank_upi_qrcode:(H=v.data)==null?void 0:H.imageKey}})}).catch(()=>{f(v=>!v)})},[]),J=b.useCallback(()=>{if(n==="EDIT"){const S=He(r);let N=!1;for(let v in S){N=!0;break}N?o(S):d(r)}else{const S=Ue(r,A);let N=!1;for(let v in S){N=!0;break}N?o(S):(f(v=>!v),m({fid:_,...A,bankDetails:{...r,depart_arr:A.depart_arr}}).then(()=>{e(),f(v=>!v)}).catch(()=>{f(v=>!v)}))}},[r]);return a.jsxs(a.Fragment,{children:[a.jsx(q,{children:a.jsxs("div",{className:E.fm_header_start_container,children:[a.jsx("img",{src:`${D}/back-arrow.svg`,alt:"back arrow",title:"Add Bank",onClick:e}),a.jsxs("h6",{children:[" ",c(n==="EDIT"?"update_bank_details":"add_bank_details")]})]})}),a.jsx(U,{}),a.jsxs(q,{customStyle:{paddingTop:"0"},children:[n==="EDIT"?null:a.jsx(Ee,{applicableFor:A,errorField:h,fid:_,libraryId:s,transportId:l,hostelId:p,setApplicablFor:P}),a.jsx(I,{label:c("bank_name"),placeholder:c("bank_name_placeholder"),name:"finance_bank_name",value:r.finance_bank_name,type:"text",onChange:F,errorShow:h.finance_bank_name}),a.jsx(I,{label:c("account_name"),placeholder:c("account_name_placeholder"),name:"finance_bank_account_name",value:r.finance_bank_account_name,type:"text",onChange:F,errorShow:h.finance_bank_account_name}),a.jsx(I,{label:c("account_number"),placeholder:c("account_number_placeholder"),name:"finance_bank_account_number",value:r.finance_bank_account_number,type:"tel",onChange:F,errorShow:h.finance_bank_name}),a.jsx(I,{label:c("confirm_account_number"),placeholder:c("confirm_account_number_placeholder"),name:"finance_bank_re_account_number",value:r.finance_bank_re_account_number,type:"tel",onChange:F,errorShow:h.finance_bank_re_account_number,msg:h.finance_bank_re_account_number}),a.jsx(I,{label:c("ifsc_code"),placeholder:c("ifsc_code_placeholder"),name:"finance_bank_ifsc_code",value:r.finance_bank_ifsc_code,type:"text",onChange:F,errorShow:h.finance_bank_ifsc_code}),a.jsx(I,{label:c("address_of_bank"),placeholder:c("address_of_bank_placeholder"),name:"finance_bank_branch_address",value:r.finance_bank_branch_address,type:"text",onChange:F,errorShow:h.finance_bank_branch_address}),a.jsx(I,{label:c("upi_id"),placeholder:c("upi_id_placeholder"),name:"finance_bank_upi_id",value:r.finance_bank_upi_id,type:"text",onChange:F,errorShow:h.finance_bank_upi_id}),a.jsx(I,{label:c("confirm_upi_id"),placeholder:c("finance_bank_re_upi_id"),name:"finance_bank_re_upi_id",value:r.finance_bank_re_upi_id,type:"text",onChange:F,errorShow:h.finance_bank_re_upi_id,msg:h.finance_bank_re_upi_id}),a.jsx(de,{label:c("qr_code_above_upi"),name:"finance_bank_upi_qrcode",value:L!=null&&L.name?{name:L==null?void 0:L.name}:"",onChange:G,errorShow:h.finance_bank_upi_qrcode}),a.jsx(ae,{label:"save",onAction:J})]}),x&&a.jsx(_e,{})]})},Ue=(e,_)=>{const s={};for(let l in e)l==="finance_bank_account_number"&&e.finance_bank_account_number!==e.finance_bank_re_account_number?s.finance_bank_re_account_number=`${t("form_account_dose_not_match_label")}`:l==="finance_bank_upi_id"&&e.finance_bank_upi_id!==e.finance_bank_re_upi_id?s.finance_bank_re_upi_id=`${t("upi_id_dose_not_match_label")}`:e[l]||(s[l]="* required");return _!=null&&_.flow_id||(s.flow_id="flow_id is required"),s},He=e=>{const _={};for(let s in e)s==="finance_bank_account_number"&&e.finance_bank_account_number!==e.finance_bank_re_account_number?_.finance_bank_re_account_number=`${t("form_account_dose_not_match_label")}`:s==="finance_bank_upi_id"&&e.finance_bank_upi_id!==e.finance_bank_re_upi_id?_.finance_bank_re_upi_id=`${t("upi_id_dose_not_match_label")}`:e[s]||(_[s]="* required");return _},Ve=({totalRepay:e,collectOnline:_,dueRepay:s})=>{const{t:l}=C();return a.jsxs("div",{className:u.bank_fund_container,children:[a.jsxs("div",{className:u.bank_fund,children:[a.jsx("h6",{children:l("total_due")}),a.jsxs("h5",{children:[l("rs")," ",e??0]})]}),a.jsxs("div",{className:u.bank_fund,children:[a.jsx("h6",{children:l("online_fees")}),a.jsxs("h5",{children:[l("rs")," ",_??0]})]}),a.jsxs("div",{className:u.bank_fund,children:[a.jsx("h6",{children:l("repayment_due")}),a.jsxs("h5",{children:[l("rs")," ",s??0]})]})]})},w={fontWeight:"400",fontSize:"12px"},Re=({oneBank:e})=>{var s,l,p,n;const{t:_}=C();return a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:u.bank_details,children:[a.jsxs("h6",{children:[_("applicable_for")," "," : "," "]}),a.jsx(g,{label:"",value:(s=e==null?void 0:e.department)!=null&&s.dName?(l=e==null?void 0:e.department)==null?void 0:l.dName:e!=null&&e.hostel?"Hostel":e!=null&&e.library?"Library":e!=null&&e.transport?"Transport":((p=e==null?void 0:e.departments)==null?void 0:p.length)>0?(n=e==null?void 0:e.departments)==null?void 0:n.map((d,i)=>{var c;return a.jsxs("span",{children:[(d==null?void 0:d.dName)??"",i+1===((c=e==null?void 0:e.departments)==null?void 0:c.length)?"":", "]},d==null?void 0:d._id)}):"",customFormInput:w,customFormInputLabel:{...w,marginLeft:"-0.8rem"}})]}),a.jsxs("section",{className:u.bank_details,children:[a.jsx("h6",{children:_("bank_details")}),a.jsx(g,{label:`${_("bank_name")} :`,value:e==null?void 0:e.finance_bank_name,customFormInput:w,customFormInputLabel:w}),a.jsx(g,{label:`${_("account_name")} :`,value:e==null?void 0:e.finance_bank_account_name,customFormInput:w,customFormInputLabel:w}),a.jsx(g,{label:`${_("account_number")} :`,value:e==null?void 0:e.finance_bank_account_number,customFormInput:w,customFormInputLabel:w}),a.jsx(g,{label:`${_("ifsc_code")} :`,value:e==null?void 0:e.finance_bank_ifsc_code,customFormInput:w,customFormInputLabel:w}),a.jsx(g,{label:`${_("address")} :`,value:e==null?void 0:e.finance_bank_branch_address,customFormInput:w,customFormInputLabel:w})]}),a.jsx("section",{className:u.bank_upi,children:a.jsx(g,{label:`${_("upi_id")} :`,value:e==null?void 0:e.finance_bank_upi_id,customFormInput:w,customFormInputLabel:w})}),a.jsxs("section",{className:u.bank_qr_code,children:[a.jsxs("div",{className:u.bank_qr_code_text,children:[a.jsxs("h6",{children:[_("qr_code"),":"]}),a.jsx("p",{children:(e==null?void 0:e.finance_bank_upi_id)??""})]}),e!=null&&e.finance_bank_upi_qrcode?a.jsx("img",{src:`${R}/${e==null?void 0:e.finance_bank_upi_qrcode}`,alt:"qr code"}):""]})]})},We=({onToggle:e,setBankEdit:_,openBankMenu:s})=>{const{t:l}=C(),p=Q(),[n,d]=b.useState(!1),[i,c]=b.useState(!1),[j]=te(),[m]=ce(),x=()=>{_(o=>!o),c(o=>!o)},f=()=>{s!=null&&s._id&&(d(o=>!o),j(s==null?void 0:s._id).then(()=>{e(),d(o=>!o),p(-1)}).catch({}))},h=o=>{s!=null&&s._id&&(d(r=>!r),c(!1),m({bid:s==null?void 0:s._id,bankDetails:o}).then(()=>{d(r=>!r),e(),_(r=>!r)}).catch({}))};return i?a.jsx(z,{onClose:x,openAs:"EDIT",onEditAction:h,openBankMenu:s}):a.jsxs(se,{onClose:e,disabled:n,children:[a.jsx("h6",{onClick:x,children:l("edit")}),a.jsx("h6",{onClick:f,children:l("delete")})]})},ze=[{label:"bank_info",id:0},{label:"fund",id:1}],Pe=()=>{var x,f,h;const{t:e}=C(),_=W(),[s,l]=b.useState(0),[p,n]=b.useState(!1),[d,i]=b.useState(!1),{financeOneBankDetail:c}=ie({bid:_.state.bankId,skip:!_.state.bankId}),j=b.useCallback(()=>{n(o=>!o)},[]),m=o=>{l(o)};return a.jsxs(a.Fragment,{children:[!d&&a.jsxs(a.Fragment,{children:[a.jsxs(q,{children:[a.jsxs("div",{className:E.fm_header_container,children:[a.jsx("h6",{children:e("bank_details")}),a.jsx("img",{src:`${D}/edit.svg`,alt:"back arrow",title:"Edit Bank",onClick:j})]}),a.jsx(re,{children:ze.map(o=>a.jsx(le,{tab:o,isActive:(o==null?void 0:o.id)===s,onAction:m},o==null?void 0:o.id))}),a.jsx(U,{customStyleBorder:{marginTop:"0"}})]}),a.jsx(q,{children:s===0?a.jsx(Re,{oneBank:c==null?void 0:c.one_bank}):a.jsx(Ve,{totalRepay:(x=c==null?void 0:c.one_bank)==null?void 0:x.total_repay,collectOnline:(f=c==null?void 0:c.one_bank)==null?void 0:f.collect_online,dueRepay:(h=c==null?void 0:c.one_bank)==null?void 0:h.due_repay})})]}),p&&a.jsx(We,{onToggle:j,setBankEdit:i,openBankMenu:c==null?void 0:c.one_bank})]})},Ke=({fid:e,libraryId:_,transportId:s,hostelId:l})=>{const{t:p}=C(),[n]=X(),[d,i]=b.useState(!1),c=b.useCallback(()=>{i(j=>!j)},[]);return a.jsx(ne,{children:d?a.jsx(z,{fid:e,libraryId:_,transportId:s,hostelId:l,onClose:c}):n.get("n")?a.jsx(Pe,{fid:e,libraryId:_,transportId:s,hostelId:l}):a.jsxs(a.Fragment,{children:[a.jsx(q,{children:a.jsxs("div",{className:E.fm_header_container,children:[a.jsx("h6",{children:p("bank_account_detail")}),a.jsx("img",{src:`${D}/plus-blue.svg`,alt:"back arrow",title:"Add Bank",onClick:c})]})}),a.jsx(U,{}),a.jsx(q,{children:a.jsx(De,{fid:e})})]})})},Ye=b.memo(Ke);export{Ye as default};
