import{u as z,r as m,k as F,g as D,z as T,bS as y,j as e}from"./index-731451a5.js";import{R as q,S as G,u as J}from"./post-api-f57ebb8f.js";import{k as K,l as M,m as Q,n as V}from"./search-api-15f7f9f9.js";import{s as h}from"./InstituteProfileInfoTop.module-288d442d.js";import{i as W}from"./constant_value-4cd2b3e0.js";const u=({institute:o})=>{var x,g,j,B;const{t:r}=z(),[w,a]=m.useState(!1),c=F(l=>l.idChange),s=F(l=>l.postChange.dashboardPosts),b=D(),[C]=K(),[R]=M(),[U]=q(),[A]=G(),{allDashPost:d,allDashPostRefetch:E}=J({data:{id:c==null?void 0:c.id,viewAs:W},skip:!1}),{oneInstituteProfileRefetch:_}=T({data:{id:o==null?void 0:o._id,type:"ID"},skip:!(o!=null&&o._id)}),{instituteOwnFollowingList:n,instituteOwnFollowingListRefetch:N}=Q({data:{page:1,id:o==null?void 0:o._id,limit:100},skip:!(o!=null&&o._id)}),{instituteFollowList:I,instituteFollowListRefetch:k}=V({list:{page:1,id:o==null?void 0:o._id,limit:100},skip:!(o!=null&&o._id)});m.useEffect(()=>{o!=null&&o._id&&(k(),N())},[o==null?void 0:o._id]),m.useEffect(()=>{d!=null&&d.post&&b(y.followPost({post:d==null?void 0:d.post,profilePost:"dash"}))},[d==null?void 0:d.post]);const S=l=>{const f=[];for(let p=0;p<(s==null?void 0:s.length);p++)s[p].author!==l&&f.push(s[p]);return f},H=()=>{a(!0),C({followId:o==null?void 0:o._id}).then(l=>{l.data.message&&(k(),E(),a(!1))}).catch({})},P=()=>{a(!0);const l=S(o==null?void 0:o._id);b(y.unfollowPost({posts:l})),R({followId:o==null?void 0:o._id}).then(f=>{f.data.message&&(k(),a(!1))}).catch({})},L=()=>{a(!0),U({blockId:o==null?void 0:o._id}).then(()=>{_(),a(!1)}).catch({})},O=()=>{a(!0),A({blockId:o==null?void 0:o._id}).then(()=>{_(),a(!1)}).catch({})};return e.jsx(e.Fragment,{children:(x=o==null?void 0:o.blockedBy)!=null&&x.includes(c==null?void 0:c.id)?e.jsx("div",{className:h.profileedit,title:"Unblock Institute",children:e.jsx("button",{onClick:O,children:r("blocked")})}):(g=n==null?void 0:n.following)!=null&&g.some(l=>(l==null?void 0:l._id)===(c==null?void 0:c.id))?e.jsx("div",{className:h.profileedit,title:"Block Institute",children:e.jsx("button",{onClick:L,children:r("block")})}):(j=o==null?void 0:o.follower)!=null&&j.includes(c==null?void 0:c.id)||(B=I==null?void 0:I.iFollowers)!=null&&B.some(l=>(l==null?void 0:l._id)===(c==null?void 0:c.id))?e.jsx("div",{className:h.profileedit,title:"Unfollow Institute",children:e.jsx("button",{onClick:P,disabled:w,children:r("unfollow")})}):e.jsx("div",{className:h.profileedit,title:"Follow Institute",children:e.jsx("button",{onClick:H,disabled:w,children:r("follow")})})})};export{u as default};
