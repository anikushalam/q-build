import{n as ns,R as A,j as t,L as cs,r as j,d as is,e as D}from"./index-731451a5.js";import{s as o}from"./SubmitExamModal.module-2913af82.js";import{u as ds,a as rs,b as os,c as as}from"./student-api-4ee7144d.js";const ls="_studentMCQTop_yd8c2_5",ms="_examName_yd8c2_13",us="_examTime_yd8c2_29",_s="_studentMCQTop2_yd8c2_40",hs="_subNamep_yd8c2_48",fs="_subImg_yd8c2_59",Ns="_studentMCQBody_yd8c2_64",Cs="_studentMCQBodyLeft_yd8c2_68",ps="_studentMCQBodyRight_yd8c2_75",js="_studentMCQProfile_yd8c2_79",gs="_studentMCQProfileLeft_yd8c2_84",xs="_studentMCQProfileRight_yd8c2_93",Ss="_studentMCQProfileRighth6_yd8c2_97",ys="_studentMCQProfileRighthp_yd8c2_108",bs="_studentMCQButtons_yd8c2_119",Bs="_qButton_yd8c2_139",vs="_qButtonActive_yd8c2_150",Ms="_qButtonActiveBlue_yd8c2_162",As="_qTop_yd8c2_173",Rs="_qtext_yd8c2_178",Os="_qOption_yd8c2_183",Ls="_qOptionActive_yd8c2_192",Is="_qImg_yd8c2_196",ws="_noQImg_yd8c2_211",Ps="_prevNextBtns_yd8c2_215",$s="_submitMCQButtonContainer_yd8c2_233",ks="_submitMCQButtons_yd8c2_238",Ts="_show_question_yd8c2_253",d={studentMCQTop:ls,examName:ms,examTime:us,studentMCQTop2:_s,subNamep:hs,subImg:fs,studentMCQBody:Ns,studentMCQBodyLeft:Cs,studentMCQBodyRight:ps,studentMCQProfile:js,studentMCQProfileLeft:gs,studentMCQProfileRight:xs,studentMCQProfileRighth6:Ss,studentMCQProfileRighthp:ys,studentMCQButtons:bs,qButton:Bs,qButtonActive:vs,qButtonActiveBlue:Ms,qTop:As,qtext:Rs,qOption:Os,qOptionActive:Ls,qImg:Is,noQImg:ws,prevNextBtns:Ps,submitMCQButtonContainer:$s,submitMCQButtons:ks,show_question:Ts},Ys={position:"absolute",left:"35%",top:"10%",zIndex:10},zs={position:"absolute",left:"35%",top:"80%",zIndex:10},Gs={position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",zIndex:10};function Qs({open:m,onClose:b,tsid:C}){var B,u,S,i,l,s,f,_;const{studentMcqTestsetPreviewDetail:c,studentMcqTestsetPreviewDetailRefetch:x}=ds({tsid:C,skip:!C}),p=ns();return A.useEffect(()=>{C&&x()},[C,x]),t.jsxs(t.Fragment,{children:[t.jsx("div",{style:Gs}),t.jsxs("div",{className:o.startModal,style:Ys,children:[t.jsxs("div",{className:o.startModalTop,onClick:b,children:[t.jsx("h6",{children:(B=c==null?void 0:c.testsets)==null?void 0:B.testExamName}),t.jsx("img",{src:"/images/close-post-icon.svg",alt:""})]}),t.jsxs("div",{className:o.startModalBody,children:[t.jsxs("div",{className:o.row,children:[t.jsx("p",{children:"Test Name :"}),t.jsx("p",{className:o.span,children:(u=c==null?void 0:c.testsets)==null?void 0:u.testExamName})]}),t.jsxs("div",{className:o.row,children:[t.jsx("p",{children:"Subject :"}),t.jsxs("p",{className:o.span,children:[" ",(S=c==null?void 0:c.testsets)==null?void 0:S.testSubject]})]}),t.jsxs("div",{className:o.row,children:[t.jsx("p",{children:"Marks :"}),t.jsxs("p",{className:o.span,children:[" ",(i=c==null?void 0:c.testsets)==null?void 0:i.testTotalNumber]})]}),t.jsxs("div",{className:o.row,children:[t.jsx("p",{children:"Date :"}),t.jsxs("p",{className:o.span,children:[" ",(l=c==null?void 0:c.testsets)==null?void 0:l.testDate]})]}),t.jsxs("div",{className:o.row,children:[t.jsx("p",{children:"Duration :"}),t.jsxs("p",{className:o.span,children:[(s=c==null?void 0:c.testsets)==null?void 0:s.testDuration," Min"]})]}),t.jsxs("div",{className:o.row,children:[t.jsx("p",{children:"Marks obtained :"}),t.jsxs("div",{className:o.pentagonContainer,children:[t.jsx("img",{className:o.pentagon1,src:"/images/mcq/Polygon1.svg",alt:""}),t.jsx("img",{className:o.pentagon2,src:"/images/mcq/Polygon2.svg",alt:""}),t.jsx("p",{className:`${o.mark}`,children:(f=c==null?void 0:c.testsets)==null?void 0:f.testObtainMarks})]})]}),t.jsx(cs,{to:`/q/${p.username}/student/${(_=c==null?void 0:c.testsets)==null?void 0:_.testSubject}/mcq/test/result`,state:{tsid:C,username:p.username},children:t.jsx("div",{className:`${o.viewTestbtn} ${o.viewTestbtnActive}`,children:"View Test"})})]})]}),t.jsx("div",{className:o.textModal,style:zs,children:"You can view test only after test time is over"})]})}const Vs=({totalTime:m,setAutoSubmit:b})=>{const[C,c]=j.useState("00:01:00"),x=j.useRef(null),p=i=>{const l=Date.parse(i)-Date.parse(new Date),s=Math.floor(l/1e3%60),f=Math.floor(l/1e3/60%60),_=Math.floor(l/1e3/60/60%24);return{total:l,hours:_,minutes:f,seconds:s}},B=i=>{let{total:l,hours:s,minutes:f,seconds:_}=p(i);l>=0&&c((s>9?s:"0"+s)+":"+(f>9?f:"0"+f)+":"+(_>9?_:"0"+_))},u=i=>{c(`${Math.floor(m/3600)}:${Math.floor(m%3600/60)}:${m%3600%60}`),x.current&&clearInterval(x.current);const l=setInterval(()=>{B(i)},1e3);x.current=l},S=()=>{let i=new Date;return i.setHours(i.getHours()+Math.floor(m/3600)),i.setMinutes(i.getMinutes()+Math.floor(m%3600/60)),i.setSeconds(i.getSeconds()+m%3600%60),i};return j.useEffect(()=>{u(S())},[]),j.useEffect(()=>{C==="00:00:00"&&b(!0)},[C]),t.jsx("h6",{className:d.examTime,children:C})},Fs={position:"relative",zIndex:1};function Ws(){var I,w,P,$,k,T,Y,z,G,Q,V,F,H,U,K,W,X,J,Z,E;const m=is(),[b,C]=j.useState(!1),[c,x]=j.useState(!1),[p,B]=j.useState([]),[u,S]=j.useState([]),[i,l]=j.useState([]),[s,f]=j.useState(""),[_,R]=j.useState(0),[ss]=rs(),[ts]=os(),{studentMcqTestsetExamDetail:e,studentMcqTestsetExamDetailRefetch:O}=as({tsid:m.state.tsid,skip:!m.state.tsid});A.useEffect(()=>{m.state.tsid&&O()},[m.state.tsid,O]),A.useEffect(()=>{var n,h,r,g;if(e!=null&&e.studentTestSet){B((n=e==null?void 0:e.studentTestSet)==null?void 0:n.questions),f((h=e==null?void 0:e.studentTestSet)==null?void 0:h.questions[0]);let M=[];for(let N of(r=e==null?void 0:e.studentTestSet)==null?void 0:r.questions)M.push({_id:N==null?void 0:N._id,givenAnswer:N.givenAnswer}),(g=N.givenAnswer)!=null&&g.length&&S(a=>[...a,N==null?void 0:N._id]);l(N=>[...N,...M])}},[e==null?void 0:e.studentTestSet]),A.useEffect(()=>{var n;f((n=e==null?void 0:e.studentTestSet)==null?void 0:n.questions[_])},[_]),A.useEffect(()=>{c&&L()},[c]);const es=(n,h)=>{if(h)if(f(r=>({...r,givenAnswer:[n]})),u!=null&&u.includes(s==null?void 0:s._id)){const r=i;for(let g of r)(g==null?void 0:g._id)===(s==null?void 0:s._id)&&(g.givenAnswer=[n]);l(r)}else S(r=>[...r,s==null?void 0:s._id]),l(r=>[...r,{_id:s==null?void 0:s._id,givenAnswer:[n]}]);else f(r=>({...r,givenAnswer:[]})),S(u==null?void 0:u.filter(r=>r!==(s==null?void 0:s._id))),l(i==null?void 0:i.filter(r=>(r==null?void 0:r._id)!==(s==null?void 0:s._id)));ss({tsid:m.state.tsid,correctAnswer:{questionSNO:s==null?void 0:s.questionSNO,givenAnswer:[n]}}).then(()=>{}).catch({})},L=()=>{ts({tsid:m.state.tsid,submitTestset:{testSetComplete:!0}}).then(()=>{C(!0)}).catch({})};return t.jsxs("div",{className:d.studentMCQ,children:[t.jsx("div",{className:d.studentMCQTop,children:((I=e==null?void 0:e.studentTestSet)==null?void 0:I.testDuration)&&t.jsx(Vs,{totalTime:((w=e==null?void 0:e.studentTestSet)==null?void 0:w.testDuration)*60,setAutoSubmit:x})}),t.jsxs("div",{className:d.studentMCQBody,children:[t.jsxs("div",{className:d.studentMCQBodyLeft,children:[t.jsxs("div",{className:d.qTop,children:[t.jsxs("h6",{children:["Question ",s==null?void 0:s.questionSNO]}),t.jsx("h6",{children:(s==null?void 0:s.questionNumber)>9?s==null?void 0:s.questionNumber:`0${s==null?void 0:s.questionNumber}`})]}),t.jsx("textarea",{className:d.show_question,readOnly:!0,rows:(P=s==null?void 0:s.questionDescription)==null?void 0:P.split(`
`).length,defaultValue:s==null?void 0:s.questionDescription}),($=s==null?void 0:s.questionImage)!=null&&$.length?t.jsx("img",{src:`${D}/${s==null?void 0:s.questionImage[0].documentKey}`,alt:"",className:d.qImg}):"",t.jsx("div",{className:s!=null&&s.qImg?d.qOptions:d.noQImg,children:(k=s==null?void 0:s.options)==null?void 0:k.map((n,h)=>{var r,g,M,N;return t.jsxs("div",{className:((r=s==null?void 0:s.givenAnswer[0])==null?void 0:r.optionNumber)===(n==null?void 0:n.optionNumber)&&((g=i==null?void 0:i.filter(a=>{var y;return(a==null?void 0:a._id)===(s==null?void 0:s._id)&&((y=a==null?void 0:a.givenAnswer[0])==null?void 0:y.optionNumber)===(n==null?void 0:n.optionNumber)}))!=null&&g.length)?d.qOptionActive:d.qOption,children:[t.jsx("div",{className:((M=s==null?void 0:s.givenAnswer[0])==null?void 0:M.optionNumber)===(n==null?void 0:n.optionNumber)&&((N=i==null?void 0:i.filter(a=>{var y;return(a==null?void 0:a._id)===(s==null?void 0:s._id)&&((y=a==null?void 0:a.givenAnswer[0])==null?void 0:y.optionNumber)===(n==null?void 0:n.optionNumber)}))!=null&&N.length)?d.qButtonActive:d.qButton,onClick:()=>{var a,y;return es(n,((a=s==null?void 0:s.givenAnswer[0])==null?void 0:a.optionNumber)===(n==null?void 0:n.optionNumber)&&((y=i==null?void 0:i.filter(v=>{var q;return(v==null?void 0:v._id)===(s==null?void 0:s._id)&&((q=v==null?void 0:v.givenAnswer[0])==null?void 0:q.optionNumber)===(n==null?void 0:n.optionNumber)}))!=null&&y.length)?"":"another")},children:h===0?"A":h===1?"B":h===2?"C":h===3?"D":"E"}),t.jsx("p",{className:d.qOptionp,children:n==null?void 0:n.option})]})})}),t.jsxs("div",{className:d.prevNextBtns,children:[t.jsx("p",{onClick:()=>R(n=>n-1),children:"Previous"}),t.jsx("p",{onClick:()=>R(n=>n+1),children:"Next"})]}),_===(p==null?void 0:p.length)-1&&t.jsx("div",{className:d.submitMCQButtonContainer,children:t.jsx("div",{className:d.submitMCQButtons,onClick:L,style:Fs,children:"Submit Exam"})})]}),t.jsxs("div",{className:d.studentMCQBodyRight,children:[t.jsxs("div",{className:d.studentMCQProfile,children:[t.jsx("div",{className:d.studentMCQProfileLeft,children:t.jsx("img",{src:(Y=(T=e==null?void 0:e.studentTestSet)==null?void 0:T.student)!=null&&Y.studentProfilePhoto?`${D}/${(G=(z=e==null?void 0:e.studentTestSet)==null?void 0:z.student)==null?void 0:G.studentProfilePhoto}`:"/images/certificate/userImg.jpg",alt:"profile icon"})}),t.jsxs("div",{className:d.studentMCQProfileRight,children:[t.jsxs("h6",{className:d.studentMCQProfileRighth6,children:["Name:"," ",`${(V=(Q=e==null?void 0:e.studentTestSet)==null?void 0:Q.student)==null?void 0:V.studentFirstName} ${(H=(F=e==null?void 0:e.studentTestSet)==null?void 0:F.student)!=null&&H.studentMiddleName?(K=(U=e==null?void 0:e.studentTestSet)==null?void 0:U.student)==null?void 0:K.studentMiddleName:""} ${(X=(W=e==null?void 0:e.studentTestSet)==null?void 0:W.student)==null?void 0:X.studentLastName}`]}),t.jsxs("p",{className:d.studentMCQProfileRightp,children:["Roll No."," ",(Z=(J=e==null?void 0:e.studentTestSet)==null?void 0:J.student)==null?void 0:Z.studentROLLNO]})]})]}),t.jsx("div",{className:d.studentMCQButtons,children:p==null?void 0:p.map((n,h)=>t.jsx("div",{className:u!=null&&u.includes(n==null?void 0:n._id)||_===h?_===h?d.qButtonActiveBlue:d.qButtonActive:d.qButton,onClick:()=>R(r=>h),children:h+1}))})]})]}),b&&t.jsx(Qs,{open:b,onClose:()=>C(!1),tsid:(E=e==null?void 0:e.studentTestSet)==null?void 0:E._id})]})}export{Ws as default};
