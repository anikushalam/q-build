import{u as _t,j as o,r as c,t as dt,S as mt,n as ut,fx as ct,lq as pt,lr as st}from"./index-0ca76035.js";import{s as k}from"./StudentAllFeesData.module-f5c3243d.js";import{S as rt,a as ht}from"./StudentAdmissionFees-18a2bcf2.js";import{a0 as et,a1 as gt}from"./admission-api-925391d9.js";import{j as kt}from"./finance-api-e818490b.js";import{P as xt,p as nt}from"./PaymentGatewayConfig-4c69c63c.js";import{S as lt}from"./StudentInternalFeesCard-d583cef8.js";import{E as bt}from"./EmptyInfo-dd58cebb.js";import{g as it}from"./paytmUpiInitiative-43604424.js";import"./StudentAdmissionPayFees-4659e3f8.js";import"./JoinFormTextArea-394bf055.js";import"./JoinForm.module-212f9bb3.js";import"./PopupWrapper-2578092d.js";import"./Overlay-c8100e0a.js";import"./Overlay.module-9133d1bb.js";import"./SearchModalWrapper-0fa3f9a3.js";import"./SearchModalBackdrop-c4f123e6.js";import"./SearchHeader.module-b69c8942.js";import"./EditConfirm.module-344fbdb9.js";import"./JoinFormInput-82706177.js";import"./BorderBottom-1dc6f53e.js";import"./SelectFeeStructure-915fed5c.js";import"./FeesStructure.module-7a88fbbc.js";import"./pdf-convertor-function-4fe9e778.js";import"./main.receipt.pdf.worker-914052f8.js";import"./numberToWords.min-081ca735.js";import"./DemandProcess-62db6306.js";import"./JoinFormInputView-2b5b0bdd.js";import"./JoinFormCalender-d186c4ef.js";import"./DatePicker-c6d0e911.js";import"./JoinFormFile-a00a41cd.js";import"./hostel-api-9294ced1.js";import"./LoaderButton-56f541f9.js";import"./StudentInternalFeeReceipt-723a549f.js";import"./pdfInternalFeeReceipt-24199e26.js";const yt=({value:x,onTabHandler:s,padiFees:g,remainingFees:b,applicableRemainingFees:y,scholarshipFees:F})=>{const{t:p}=_t();return o.jsxs("div",{className:k.student_fees_header_container,children:[o.jsxs("div",{children:[o.jsxs("div",{className:k.student_fees_row_amount,children:[o.jsxs("h5",{children:[p("rs"),". ",g??0]}),o.jsx("h6",{children:p("total_fees_paid")})]}),o.jsxs("div",{className:k.student_fees_row_amount,style:{marginTop:"1rem"},children:[o.jsxs("h5",{children:[p("rs"),". ",F??0]}),o.jsx("h6",{children:p("by_scholarship")})]})]}),o.jsxs("div",{className:k.student_fees_header_column,children:[o.jsx(rt,{label:"admission_fees",currentValue:0,value:x,onClick:s,customStyleContainer:{marginRight:"2rem"}}),o.jsx(rt,{label:"department_fees",currentValue:1,value:x,onClick:s})]}),o.jsxs("div",{children:[o.jsxs("div",{className:k.student_fees_row_amount,style:{alignItems:"flex-end"},children:[o.jsxs("h5",{style:{color:"#121212"},children:[p("rs"),". ",b??0]}),o.jsx("h6",{children:p("remaining_fees")})]}),o.jsxs("div",{className:k.student_fees_row_amount,style:{alignItems:"flex-end",marginTop:"1rem"},children:[o.jsxs("h5",{style:{color:"#121212"},children:[p("rs"),". ",y??0]}),o.jsx("h6",{children:p("applicable_remaining")}),o.jsx("div",{children:p("to_be_paid_by_student")})]})]})]})},jt=({setAllContent:x,setCharges:s,sid:g,viewAs:b})=>{const[y,F]=c.useState(!0),[p,D]=c.useState(1),[i,C]=dt(),[e,j]=c.useState([]),[n,z]=c.useState(!1),[_,S]=c.useState(!0),{studentDepartmentFees:r,studentDepartmentFeesRefetch:M}=et({data:{sid:g,page:p,limit:10},skip:!g});return c.useEffect(()=>{C&&y&&D(t=>t+1)},[C,y]),c.useEffect(()=>{g&&(M(),S(!0))},[p,g,M]),c.useEffect(()=>{var t,R;n?(j(r==null?void 0:r.all_internal),z(!1),S(!1)):r!=null&&r.all_internal?(j(B=>[...new Set([...B,...r==null?void 0:r.all_internal].map(JSON.stringify))].map(JSON.parse)),S(!1)):((t=r==null?void 0:r.all_internal)==null?void 0:t.length)===0&&S(!1),((R=r==null?void 0:r.all_internal)==null?void 0:R.length)===10?F(!0):F(!1)},[r==null?void 0:r.all_internal]),o.jsxs("div",{className:k.student_admission_fees_container,children:[e==null?void 0:e.map((t,R)=>{var B,Q,A,f,tt,G,L,V,H,O,Y,J,q,U,W,X;return(e==null?void 0:e.length)===R+1?o.jsx("div",{className:k.student_internal_card,ref:i,children:o.jsx(lt,{feesName:t==null?void 0:t.internal_fee_reason,amount:t==null?void 0:t.internal_fee_amount,dateOffCreation:(B=t==null?void 0:t.fees)==null?void 0:B.feeDate,is_paid:t==null?void 0:t.internal_fee_status,feesId:t==null?void 0:t._id,setAllContent:x,setCharges:s,is_checklist:(t==null?void 0:t.internal_fee_type)==="Checklist"||(t==null?void 0:t.internal_fee_type)==="Backlog"||(t==null?void 0:t.internal_fee_type)==="Library Fees",rid:(Q=t==null?void 0:t.fee_receipt)==null?void 0:Q._id,transactionDate:(A=t==null?void 0:t.fee_receipt)==null?void 0:A.created_at,transactionMode:(f=t==null?void 0:t.fee_receipt)==null?void 0:f.fee_payment_mode,moduleType:t==null?void 0:t.internal_fee_type,sid:g,viewAs:b,bookId:(t==null?void 0:t.book)??"",validateId:(tt=t==null?void 0:t.library)==null?void 0:tt._id,financeId:(V=(L=(G=t==null?void 0:t.library)==null?void 0:G.institute)==null?void 0:L.financeDepart)==null?void 0:V[0]})},t==null?void 0:t._id):o.jsx("div",{className:k.student_internal_card,children:o.jsx(lt,{feesName:t==null?void 0:t.internal_fee_reason,amount:t==null?void 0:t.internal_fee_amount,dateOffCreation:(H=t==null?void 0:t.fees)==null?void 0:H.feeDate,is_paid:t==null?void 0:t.internal_fee_status,feesId:t==null?void 0:t._id,setAllContent:x,setCharges:s,is_checklist:(t==null?void 0:t.internal_fee_type)==="Checklist"||(t==null?void 0:t.internal_fee_type)==="Backlog"||(t==null?void 0:t.internal_fee_type)==="Library Fees",rid:(O=t==null?void 0:t.fee_receipt)==null?void 0:O._id,transactionDate:(Y=t==null?void 0:t.fee_receipt)==null?void 0:Y.created_at,transactionMode:(J=t==null?void 0:t.fee_receipt)==null?void 0:J.fee_payment_mode,moduleType:t==null?void 0:t.internal_fee_type,sid:g,viewAs:b,bookId:(t==null?void 0:t.book)??"",validateId:(q=t==null?void 0:t.library)==null?void 0:q._id,financeId:(X=(W=(U=t==null?void 0:t.library)==null?void 0:U.institute)==null?void 0:W.financeDepart)==null?void 0:X[0]})},t==null?void 0:t._id)}),_&&o.jsx(mt,{}),!_&&(e==null?void 0:e.length)===0&&o.jsx(bt,{title:"No department fees created yet.",customStyleContainer:{height:"15rem"}})]})},on=({viewAs:x,sid:s,isFeesEditable:g})=>{var G,L,V,H,O,Y,J,q,U,W,X,at,ot;const b=ut(),[y,F]=c.useState(0),[p,D]=c.useState(!1),[i,C]=c.useState({amount:0,feesId:"",insId:"",type:"",bookId:""}),[e,j]=c.useState(!0),{data:n,refetch:z}=ct(`${s}`,{skip:!s}),{data:_}=pt(),[S]=st(),{sudentAdmissionFeesList:r,sudentAdmissionFeesListRefetch:M}=gt({sid:s,skip:!s}),{merchantId:t,merchantIdRefetch:R}=kt({id:(L=(G=n==null?void 0:n.student)==null?void 0:G.institute)==null?void 0:L._id,skip:!((H=(V=n==null?void 0:n.student)==null?void 0:V.institute)!=null&&H._id)});c.useEffect(()=>{s&&(z(),M(),j(!0))},[s,M,z]),c.useEffect(()=>{var d,h;(h=(d=n==null?void 0:n.student)==null?void 0:d.institute)!=null&&h._id&&R()},[(Y=(O=n==null?void 0:n.student)==null?void 0:O.institute)==null?void 0:Y._id,R]),c.useEffect(()=>{var d;(r!=null&&r.array||((d=r==null?void 0:r.array)==null?void 0:d.length)===0)&&j(!1)},[r==null?void 0:r.array]),c.useEffect(()=>{var d;(n!=null&&n.mergePay||((d=n==null?void 0:n.mergePay)==null?void 0:d.length)===0)&&j(!1)},[n==null?void 0:n.mergePay]);const B=d=>{F(d)},Q=d=>{var w,I,$;let h=+(i==null?void 0:i.amount)*2.1/100,E=+h*18/100,Z=h+E;const K=parseInt(i==null?void 0:i.amount);var l={amount:Math.ceil(K+ +Z.toFixed(2))};d==="PAYTM"?it({amount:+(i==null?void 0:i.amount),amount_nocharges:+l.amount,type:"Fees",paidBy:`${(w=n==null?void 0:n.student)==null?void 0:w._id}`,paidTo:`${($=(I=n==null?void 0:n.student)==null?void 0:I.institute)==null?void 0:$._id}`,moduleId:`${i==null?void 0:i.feesId}`,ad_status_id:null,payment_installment:null,ad_install:null,month:null,payment_remain_1:null,payment_card_type:null,payment_book_id:null,name:b.username,isApk:"web",payment_card_id:null}).then(a=>{var m,u;window.onScriptLoad((u=(m=a==null?void 0:a.response)==null?void 0:m.body)==null?void 0:u.txnToken,a==null?void 0:a.order,a==null?void 0:a.amount)}).catch(a=>{console.info(a)}):_!=null&&_.Key&&(l!=null&&l.amount)?S({amount:l==null?void 0:l.amount}).then(a=>{var m,u,v,P,N,T;(m=a.data)!=null&&m.success&&nt({key:_==null?void 0:_.Key,oid:(u=a.data)==null?void 0:u.order.id,amount_nocharge:(i==null?void 0:i.amount)*100,amount:(v=a.data)==null?void 0:v.order.amount,type:"Fees",pay_by:`${(P=n==null?void 0:n.student)==null?void 0:P._id}`,pay_to:`${(T=(N=n==null?void 0:n.student)==null?void 0:N.institute)==null?void 0:T._id}`,mid:`${i==null?void 0:i.feesId}`,razor_key:t==null?void 0:t.key,razor_author:t==null?void 0:t.bool,status:null,installment_type:null,is_install:null,h_month:null})}).catch(a=>{}):console.log("error")},A=(d,h,E)=>d+h+E,f=d=>{var w,I,$;let h=+(i==null?void 0:i.amount)*2.1/100,E=+h*18/100,Z=h+E;const K=parseInt(i==null?void 0:i.amount);var l={amount:Math.ceil(K+ +Z.toFixed(2))};d==="PAYTM"?it({amount:+(i==null?void 0:i.amount),amount_nocharges:+l.amount,type:"Backlog",paidBy:`${(w=n==null?void 0:n.student)==null?void 0:w._id}`,paidTo:`${($=(I=n==null?void 0:n.student)==null?void 0:I.institute)==null?void 0:$._id}`,moduleId:`${i==null?void 0:i.feesId}`,ad_status_id:null,payment_installment:null,ad_install:null,month:null,payment_remain_1:null,payment_card_type:null,payment_book_id:null,name:b.username,isApk:"web",payment_card_id:null}).then(a=>{var m,u;window.onScriptLoad((u=(m=a==null?void 0:a.response)==null?void 0:m.body)==null?void 0:u.txnToken,a==null?void 0:a.order,a==null?void 0:a.amount)}).catch(a=>{console.info(a)}):_!=null&&_.Key&&(l!=null&&l.amount)?S({amount:l==null?void 0:l.amount}).then(a=>{var m,u,v,P,N,T;(m=a.data)!=null&&m.success&&nt({key:_==null?void 0:_.Key,oid:(u=a.data)==null?void 0:u.order.id,amount_nocharge:(i==null?void 0:i.amount)*100,amount:(v=a.data)==null?void 0:v.order.amount,type:"Backlog",pay_by:`${(P=n==null?void 0:n.student)==null?void 0:P._id}`,pay_to:`${(T=(N=n==null?void 0:n.student)==null?void 0:N.institute)==null?void 0:T._id}`,mid:`${i==null?void 0:i.feesId}`,razor_key:t==null?void 0:t.key,razor_author:t==null?void 0:t.bool,status:null,installment_type:null,is_install:null,h_month:null})}).catch(a=>{}):console.log("error")},tt=d=>{var w,I,$;let h=+(i==null?void 0:i.amount)*2.1/100,E=+h*18/100,Z=h+E;const K=parseInt(i==null?void 0:i.amount);var l={amount:Math.ceil(K+ +Z.toFixed(2))};d==="PAYTM"?it({amount:+(i==null?void 0:i.amount),amount_nocharges:+l.amount,type:"Library Fees",paidBy:`${(w=n==null?void 0:n.student)==null?void 0:w._id}`,paidTo:`${($=(I=n==null?void 0:n.student)==null?void 0:I.institute)==null?void 0:$._id}`,moduleId:`${i==null?void 0:i.feesId}`,ad_status_id:null,payment_installment:null,ad_install:null,month:null,payment_remain_1:null,payment_card_type:null,payment_book_id:i==null?void 0:i.bookId,name:b.username,isApk:"web",payment_card_id:null}).then(a=>{var m,u;window.onScriptLoad((u=(m=a==null?void 0:a.response)==null?void 0:m.body)==null?void 0:u.txnToken,a==null?void 0:a.order,a==null?void 0:a.amount)}).catch(a=>{console.info(a)}):_!=null&&_.Key&&(l!=null&&l.amount)?S({amount:l==null?void 0:l.amount}).then(a=>{var m,u,v,P,N,T;(m=a.data)!=null&&m.success&&nt({key:_==null?void 0:_.Key,oid:(u=a.data)==null?void 0:u.order.id,amount_nocharge:(i==null?void 0:i.amount)*100,amount:(v=a.data)==null?void 0:v.order.amount,type:"Library Fees",pay_by:`${(P=n==null?void 0:n.student)==null?void 0:P._id}`,pay_to:`${(T=(N=n==null?void 0:n.student)==null?void 0:N.institute)==null?void 0:T._id}`,mid:`${i==null?void 0:i.feesId}`,razor_key:t==null?void 0:t.key,razor_author:t==null?void 0:t.bool,status:null,installment_type:null,is_install:null,h_month:null,book_id:i==null?void 0:i.bookId})}).catch(a=>{}):console.log("error")};return o.jsxs("div",{className:k.student_alll_fees_data,children:[o.jsx(yt,{onTabHandler:B,value:y,padiFees:A(((J=n==null?void 0:n.student)==null?void 0:J.studentPaidFeeCount)||0,((q=n==null?void 0:n.student)==null?void 0:q.admissionPaidFeeCount)||0,((U=n==null?void 0:n.student)==null?void 0:U.hostelPaidFeeCount)||0),remainingFees:A(((W=n==null?void 0:n.student)==null?void 0:W.studentRemainingFeeCount)||0,((X=n==null?void 0:n.student)==null?void 0:X.admissionRemainFeeCount)||0,((at=n==null?void 0:n.student)==null?void 0:at.hostelRemainFeeCount)||0),applicableRemainingFees:(ot=n==null?void 0:n.student)==null?void 0:ot.applicable_fees_pending,scholarshipFees:(n==null?void 0:n.paid_by_government)??0}),y===0&&o.jsx(ht,{viewAs:x,sudentAdmissionFeesList:r,sudentAdmissionFeesListRefetch:M,feesQueryRefetch:z,showingDataLoading:e,isFeesEditable:g}),y===1&&o.jsx(jt,{setAllContent:C,setCharges:D,showingDataLoading:e,sid:s,viewAs:x}),p&&o.jsx(xt,{onClose:()=>D(!1),allContent:i,checkoutHandler:Q,checkoutBacklogHandler:f,checkoutLibraryHandler:tt})]})};export{on as default};
