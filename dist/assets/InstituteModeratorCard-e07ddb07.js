import{u as G,r as S,n8 as J,ac as z,j as s,e as u,Q as q,n9 as Y,na as K}from"./index-0ca76035.js";import{s as $}from"./EditConfirm.module-344fbdb9.js";import{O as Z}from"./Overlay-c8100e0a.js";import{S as M}from"./SearchModalBackdrop-c4f123e6.js";import Q from"./AssignStaffModal-e51a4441.js";import{C as P}from"./CustomNormalSelectInput-0a62fa3f.js";import{P as b}from"./PopupWrapper-2578092d.js";import{B as w}from"./BorderBottom-1dc6f53e.js";import{s as A}from"./AdmissionModerator.module-e8abdfd3.js";import{J as X}from"./JoinFormInput-82706177.js";import{C as H}from"./CustomSelectDepartment-11201deb.js";const ss=({instituteId:l,onClose:d,onRefetchWhenAdd:m,openAs:E,openModeratorMenu:c,onEdit:T})=>{var B,U,p;const{t:e}=G(),[r,n]=S.useState(E==="EDIT"?"PREVIEW_FORM":"OPEN_STAFF_LIST"),[_,L]=S.useState(E==="EDIT"?c==null?void 0:c.access_staff:""),[i,N]=S.useState({mod_role:E==="EDIT"?c==null?void 0:c.access_role:"",sid:E==="EDIT"?(B=c==null?void 0:c.access_staff)==null?void 0:B._id:"",social_media_password_query:E==="EDIT"?c==null?void 0:c.social_media_password_query:""}),[a,R]=S.useState(E==="EDIT"?c==null?void 0:c.academic_department:""),[f,D]=S.useState(""),[v]=J(),{allDepartment:x,allDepartmentRefetch:O}=z({id:l,skip:!l});S.useEffect(()=>{l&&O()},[l,O]),S.useEffect(()=>{var t,h;E==="EDIT"&&(N({mod_role:c==null?void 0:c.access_role,sid:(t=c==null?void 0:c.access_staff)==null?void 0:t._id,social_media_password_query:(h=c==null?void 0:c.access_staff)==null?void 0:h.social_media_password_query}),L(c==null?void 0:c.access_staff),R(c==null?void 0:c.academic_department),n("PREVIEW_FORM"))},[E]);const V=t=>{L(t),N(h=>({...h,sid:t==null?void 0:t._id})),n(E==="EDIT"?"PREVIEW_FORM":"ASSIGN_ROLE")},F=()=>{n("OPEN_STAFF_LIST")},o=t=>{N(h=>({...h,mod_role:t==="Certificate Authority"?"CERTIFICATE_ACCESS":t==="Student Section"?"STUDENT_PROMOTE_ACCESS":t==="Examination Section"?"EXAM_MANAGER_ACCESS":t==="Social Media Authority"?"SOCIAL_MEDIA_ACCESS":t==="Site Authority"?"SITE_MANAGE_ACCESS":t==="Id Card Section"?"ID_CARD_ACCESS":t==="Academic Administrator"?"ACADEMIC_ADMINISTRATOR_ACCESS":t==="Leave and Transfer Authority"?"LEAVING_AND_TRANSFER_ACCESS":""}))},y=t=>{R(t)},C=(t,h)=>{const j={};if(t.mod_role==="SOCIAL_MEDIA_ACCESS")for(let k in t)t[k]||(j[k]=`${k} is required!`);else t.mod_role==="ACADEMIC_ADMINISTRATOR_ACCESS"&&(h||(j.depart="depart is required!"));return t.mod_role||(j.mod_role="depart is required!"),j},I=()=>{const t=C(i,a==null?void 0:a._id);let h=!1;for(let j in t)if(j){h=!0;break}h?D(t):(n("LOADING"),v({id:l,addModerator:{...i,academic_department:(i==null?void 0:i.mod_role)==="ACADEMIC_ADMINISTRATOR_ACCESS"?a==null?void 0:a._id:null}}).then(()=>{m(),d(),n("")}).catch({}))},g=()=>{const t=C(i,a==null?void 0:a._id);let h=!1;for(let j in t)if(j){h=!0;break}h?D(t):(T(i,a==null?void 0:a._id),d())},W=()=>{d()};return s.jsxs(s.Fragment,{children:[r==="OPEN_STAFF_LIST"&&s.jsx(Q,{assignHead:r==="OPEN_STAFF_LIST",headSelect:V,title:e("staff_list"),onClose:d,instituteId:l,viewAs:"ADMISSION_ADMIN"}),r==="ASSIGN_ROLE"&&s.jsx(s.Fragment,{children:s.jsx(b,{onClose:F,children:s.jsxs("div",{className:A.assign_role_container,children:[s.jsxs("section",{className:A.assign_role_title,children:[s.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:F,alt:"back icon"}),s.jsx("h6",{children:e("assign_role_to_moderator")})]}),s.jsx(w,{customStyle:{width:"100%"}}),s.jsxs("section",{className:A.selected_staff_container,children:[s.jsx("img",{src:_!=null&&_.staffProfilePhoto?`${u}/${_==null?void 0:_.staffProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"staff profile avatar"}),s.jsxs("div",{className:A.selected_staff_text,children:[s.jsx("h6",{children:`${_==null?void 0:_.staffFirstName} ${(_==null?void 0:_.staffMiddleName)??""} ${_==null?void 0:_.staffLastName}`}),s.jsxs("p",{children:[e("index_number"),_==null?void 0:_.staffROLLNO]})]})]}),s.jsxs("section",{style:{padding:"0.8rem"},children:[s.jsx(P,{selectLabel:e("select_role_of_moderator"),selectedValue:e("please_select_role"),options:["Certificate Authority","Student Section","Examination Section","Id Card Section","Social Media Authority","Academic Administrator","Leave and Transfer Authority"],value:(i==null?void 0:i.mod_role)==="CERTIFICATE_ACCESS"?"Certificate Authority":(i==null?void 0:i.mod_role)==="STUDENT_PROMOTE_ACCESS"?"Student Section":(i==null?void 0:i.mod_role)==="EXAM_MANAGER_ACCESS"?"Examination Section":(i==null?void 0:i.mod_role)==="SOCIAL_MEDIA_ACCESS"?"Social Media Authority":(i==null?void 0:i.mod_role)==="SITE_MANAGE_ACCESS"?"Site Authority":(i==null?void 0:i.mod_role)==="ID_CARD_ACCESS"?"Id Card Section":(i==null?void 0:i.mod_role)==="ACADEMIC_ADMINISTRATOR_ACCESS"?"Academic Administrator":(i==null?void 0:i.mod_role)==="LEAVING_AND_TRANSFER_ACCESS"?"Leave and Transfer Authority":"",onClick:o,errorShow:f.mod_role}),(i==null?void 0:i.mod_role)==="SOCIAL_MEDIA_ACCESS"?s.jsx(X,{labelText:e("add_moderator_passward"),placeholder:e("add_moderator_passward_placeholder"),name:"social_media_password_query",value:i==null?void 0:i.social_media_password_query,type:"text",onChange:t=>N(h=>({...h,social_media_password_query:t.target.value})),errorShow:f.social_media_password_query}):null,(i==null?void 0:i.mod_role)==="ACADEMIC_ADMINISTRATOR_ACCESS"?s.jsx(H,{selectLabel:e("select_department"),selectedValue:e("select_department"),options:((U=x==null?void 0:x.institute)==null?void 0:U.depart)??[],onClick:y,defalutValue:a==null?void 0:a.dName,viewAs:"NORMAL_FILTER",openAs:"PROMOTE",errorShow:f.depart}):null,s.jsxs("button",{className:A.assign_btn,onClick:I,children:[e("assign")," "]})]})]})})}),r==="PREVIEW_FORM"&&s.jsx(s.Fragment,{children:s.jsx(b,{onClose:W,children:s.jsxs("div",{className:A.assign_role_container,children:[s.jsxs("section",{className:A.assign_role_title,children:[s.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:W,alt:"back icon"}),s.jsx("h6",{children:e("update_role_to_moderator")})]}),s.jsx(w,{customStyle:{width:"100%"}}),s.jsxs("section",{className:A.selected_staff_container,onClick:()=>n("OPEN_STAFF_LIST"),children:[s.jsx("img",{src:_!=null&&_.staffProfilePhoto?`${u}/${_==null?void 0:_.staffProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"staff profile avatar"}),s.jsxs("div",{className:A.selected_staff_text,children:[s.jsx("h6",{children:`${_==null?void 0:_.staffFirstName} ${(_==null?void 0:_.staffMiddleName)??""} ${_==null?void 0:_.staffLastName}`}),s.jsxs("p",{children:[e("index_number"),_==null?void 0:_.staffROLLNO]})]})]}),s.jsxs("section",{style:{padding:"0.8rem"},children:[s.jsx(P,{selectLabel:e("select_role_of_moderator"),selectedValue:e("please_select_role"),options:["Certificate Authority","Student Section","Examination Section","Id Card Section","Social Media Authority","Academic Administrator","Leave and Transfer Authority"],value:(i==null?void 0:i.mod_role)==="CERTIFICATE_ACCESS"?"Certificate Authority":(i==null?void 0:i.mod_role)==="STUDENT_PROMOTE_ACCESS"?"Student Section":(i==null?void 0:i.mod_role)==="EXAM_MANAGER_ACCESS"?"Examination Section":(i==null?void 0:i.mod_role)==="SOCIAL_MEDIA_ACCESS"?"Social Media Authority":(i==null?void 0:i.mod_role)==="SITE_MANAGE_ACCESS"?"Site Authority":(i==null?void 0:i.mod_role)==="ID_CARD_ACCESS"?"Id Card Section":(i==null?void 0:i.mod_role)==="ACADEMIC_ADMINISTRATOR_ACCESS"?"Academic Administrator":(i==null?void 0:i.mod_role)==="LEAVING_AND_TRANSFER_ACCESS"?"Leave and Transfer Authority":"",onClick:o,errorShow:f.mod_role}),(i==null?void 0:i.mod_role)==="SOCIAL_MEDIA_ACCESS"?s.jsx(X,{labelText:e("add_moderator_passward"),placeholder:e("add_moderator_passward_placeholder"),name:"social_media_password_query",value:i==null?void 0:i.social_media_password_query,type:"text",onChange:t=>N(h=>({...h,social_media_password_query:t.target.value})),errorShow:f.social_media_password_query}):null,(i==null?void 0:i.mod_role)==="ACADEMIC_ADMINISTRATOR_ACCESS"?s.jsx(H,{selectLabel:e("select_department"),selectedValue:e("select_department"),options:((p=x==null?void 0:x.institute)==null?void 0:p.depart)??[],onClick:y,defalutValue:a==null?void 0:a.dName,viewAs:"NORMAL_FILTER",openAs:"PROMOTE",errorShow:f.depart}):null,s.jsxs("button",{className:A.assign_btn,onClick:g,children:[e("update")," "]})]})]})})}),r==="LOADING"&&s.jsx(q,{})]})},is=({instituteId:l,onClose:d,onRefetchWhenAdd:m,openAs:E,openModeratorMenu:c,onEdit:T})=>{var y;const{t:e}=G(),[r,n]=S.useState(E==="EDIT"?"PREVIEW_FORM":"OPEN_STAFF_LIST"),[_,L]=S.useState(E==="EDIT"?c==null?void 0:c.access_staff:""),[i,N]=S.useState({mod_role:E==="EDIT"?c==null?void 0:c.access_role:"",sid:E==="EDIT"?(y=c==null?void 0:c.access_staff)==null?void 0:y._id:""}),[a,R]=S.useState("");S.useState([]),S.useState([]);const[f]=J();S.useEffect(()=>{var C;E==="EDIT"&&(N({mod_role:c==null?void 0:c.access_role,sid:(C=c==null?void 0:c.access_staff)==null?void 0:C._id}),L(c==null?void 0:c.access_staff),n("PREVIEW_FORM"))},[E]);const D=C=>{L(C),N(I=>({...I,sid:C==null?void 0:C._id})),n(E==="EDIT"?"PREVIEW_FORM":"ASSIGN_ROLE")},v=()=>{d()},x=C=>{N(I=>({...I,mod_role:C==="Leave Recommendation Authority"?"LEAVE_RECOMMENDATION_ACCESS":C==="Leave Review Authority"?"LEAVE_REVIEW_ACCESS":C==="Leave Sanction Authority"?"LEAVE_SANCTION_ACCESS":""}))},O=C=>{const I={};return C.mod_role||(I.mod_role="depart is required!"),C.sid||(I.sid="depart is required!"),I},V=()=>{const C=O(i);let I=!1;for(let g in C)if(g){I=!0;break}I?R(C):(n("LOADING"),f({id:l,addModerator:{mod_role:i.mod_role,staff_array:i.mod_role!=="LEAVE_REVIEW_ACCESS"?[i.sid]:[],rev_array:i.mod_role==="LEAVE_REVIEW_ACCESS"?[i.sid]:[],academic_department:null}}).then(()=>{m(),d(),n("")}).catch({}))},F=()=>{const C=O(i);let I=!1;for(let g in C)if(g){I=!0;break}I?R(C):(T(i),d())},o=()=>{d()};return s.jsxs(s.Fragment,{children:[r==="OPEN_STAFF_LIST"&&s.jsx(Q,{assignHead:r==="OPEN_STAFF_LIST",headSelect:D,title:e("staff_list"),onClose:()=>n("ASSIGN_ROLE"),instituteId:l,viewAs:"ADMISSION_ADMIN",isMultiSelect:!0}),r==="ASSIGN_ROLE"&&s.jsx(s.Fragment,{children:s.jsx(b,{onClose:v,children:s.jsxs("div",{className:A.assign_role_container,children:[s.jsxs("section",{className:A.assign_role_title,children:[s.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:v,alt:"back icon",style:{cursor:"pointer"}}),s.jsx("h6",{children:e("assign_role_to_moderator")})]}),s.jsx(w,{customStyle:{width:"100%"}}),s.jsxs("section",{className:A.selected_staff_container,style:{cursor:"pointer"},children:[s.jsx("img",{src:_!=null&&_.staffProfilePhoto?`${u}/${_==null?void 0:_.staffProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"staff profile avatar"}),s.jsxs("div",{className:A.selected_staff_text,children:[s.jsx("h6",{children:`${_==null?void 0:_.staffFirstName} ${(_==null?void 0:_.staffMiddleName)??""} ${_==null?void 0:_.staffLastName}`}),s.jsxs("p",{children:[e("index_number"),(_==null?void 0:_.staffROLLNO)??""]})]})]}),s.jsx("section",{style:{padding:"0.8rem"},children:s.jsx(P,{selectLabel:e("select_role_of_moderator"),selectedValue:e("please_select_role"),options:["Leave Recommendation Authority","Leave Review Authority","Leave Sanction Authority"],value:(i==null?void 0:i.mod_role)==="LEAVE_RECOMMENDATION_ACCESS"?"Leave Recommendation Authority":(i==null?void 0:i.mod_role)==="LEAVE_REVIEW_ACCESS"?"Leave Review Authority":(i==null?void 0:i.mod_role)==="LEAVE_SANCTION_ACCESS"?"Leave Sanction Authority":"",onClick:x,errorShow:a.mod_role})}),s.jsxs("section",{className:A.selected_staff_container,style:{cursor:"pointer"},onClick:()=>n("OPEN_STAFF_LIST"),children:[s.jsx("img",{src:_!=null&&_.staffProfilePhoto?`${u}/${_==null?void 0:_.staffProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"staff profile avatar"}),s.jsxs("div",{className:A.selected_staff_text,children:[_!=null&&_.staffFirstName?s.jsx("h6",{children:`${_==null?void 0:_.staffFirstName} ${(_==null?void 0:_.staffMiddleName)??""} ${_==null?void 0:_.staffLastName}`}):s.jsxs("h6",{children:[e("select_recommendation_staff")," ",a.sid?s.jsx("span",{style:{color:"red"},children:"* required"}):""]}),s.jsxs("p",{children:[e("index_number"),(_==null?void 0:_.staffROLLNO)??""]})]})]}),s.jsx("section",{style:{padding:"0.8rem"},children:s.jsxs("button",{className:A.assign_btn,onClick:V,children:[e("assign")," "]})})]})})}),r==="PREVIEW_FORM"&&s.jsx(s.Fragment,{children:s.jsx(b,{onClose:o,children:s.jsxs("div",{className:A.assign_role_container,children:[s.jsxs("section",{className:A.assign_role_title,children:[s.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:o,alt:"back icon"}),s.jsx("h6",{children:e("update_role_to_moderator")})]}),s.jsx(w,{customStyle:{width:"100%"}}),s.jsxs("section",{className:A.selected_staff_container,onClick:()=>n("OPEN_STAFF_LIST"),children:[s.jsx("img",{src:_!=null&&_.staffProfilePhoto?`${u}/${_==null?void 0:_.staffProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"staff profile avatar"}),s.jsxs("div",{className:A.selected_staff_text,children:[s.jsx("h6",{children:`${_==null?void 0:_.staffFirstName} ${(_==null?void 0:_.staffMiddleName)??""} ${_==null?void 0:_.staffLastName}`}),s.jsxs("p",{children:[e("index_number"),_==null?void 0:_.staffROLLNO]})]})]}),s.jsxs("section",{style:{padding:"0.8rem"},children:[s.jsx(P,{selectLabel:e("select_role_of_moderator"),selectedValue:e("please_select_role"),options:["Leave Recommendation Authority","Leave Review Authority","Leave Sanction Authority"],value:(i==null?void 0:i.mod_role)==="LEAVE_RECOMMENDATION_ACCESS"?"Leave Recommendation Authority":(i==null?void 0:i.mod_role)==="LEAVE_REVIEW_ACCESS"?"Leave Review Authority":(i==null?void 0:i.mod_role)==="LEAVE_SANCTION_ACCESS"?"Leave Sanction Authority":"",onClick:x,errorShow:a.mod_role}),s.jsxs("button",{className:A.assign_btn,onClick:F,children:[e("update")," "]})]})]})})}),r==="LOADING"&&s.jsx(q,{})]})},ds=({onClose:l,onRefetch:d,openModeratorMenu:m,instituteId:E,viewBy:c})=>{const[T,e]=S.useState(!1),[r,n]=S.useState(!1),[_]=Y(),[L]=K(),i=()=>{e(a=>!a),_({id:E,mid:m==null?void 0:m._id}).then(()=>{d(),l(),e(a=>!a)}).catch({})},N=(a,R)=>{e(f=>!f),L({mid:m==null?void 0:m._id,updateModerator:{role:a==null?void 0:a.mod_role,staffId:a==null?void 0:a.sid,social_media_password_query:(a==null?void 0:a.social_media_password_query)??"",academic_department:R??""}}).then(()=>{d(),e(f=>!f),l()}).catch({})};return s.jsx(s.Fragment,{children:r?c==="LEAVE_AUTHORITY"?s.jsx(is,{onClose:()=>n(!1),instituteId:E,onRefetchWhenAdd:d,openAs:"EDIT",openModeratorMenu:m,onEdit:N,viewBy:c}):s.jsx(ss,{onClose:()=>n(!1),instituteId:E,onRefetchWhenAdd:d,openAs:"EDIT",openModeratorMenu:m,onEdit:N,viewBy:c}):s.jsxs(s.Fragment,{children:[s.jsx(M,{onClose:l}),s.jsxs(Z,{customStyle:{zIndex:"1200"},children:[s.jsxs("div",{className:$.edit_modal_container,style:{width:"200px"},children:[s.jsx("h6",{className:$.edit,onClick:()=>n(a=>!a),children:"Edit"}),s.jsx("h6",{className:$.remove,onClick:i,children:"Delete"})]}),T&&s.jsx(q,{})]})]})})},rs=({moderator:l,setOpenModeratorMenu:d})=>{var E,c,T,e,r,n;const{t:m}=G();return s.jsxs("div",{className:A.moderator_card,style:{position:"relative"},children:[s.jsx("img",{src:(E=l==null?void 0:l.access_staff)!=null&&E.staffProfilePhoto?`${u}/${(c=l==null?void 0:l.access_staff)==null?void 0:c.staffProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"moderator avatar"}),s.jsxs("section",{className:A.moderator_card_text_container,children:[s.jsx("h6",{children:`${(T=l==null?void 0:l.access_staff)==null?void 0:T.staffFirstName} ${((e=l==null?void 0:l.access_staff)==null?void 0:e.staffMiddleName)??""} ${(r=l==null?void 0:l.access_staff)==null?void 0:r.staffLastName}`}),s.jsxs("p",{children:[m("index_number"),(n=l==null?void 0:l.access_staff)==null?void 0:n.staffROLLNO]}),s.jsx("p",{children:(l==null?void 0:l.access_role)==="CERTIFICATE_ACCESS"?"Certificate Authority":(l==null?void 0:l.access_role)==="STUDENT_PROMOTE_ACCESS"?"Student Section":(l==null?void 0:l.access_role)==="EXAM_MANAGER_ACCESS"?"Examination Section":(l==null?void 0:l.access_role)==="SOCIAL_MEDIA_ACCESS"?"Social Media Authority":(l==null?void 0:l.access_role)==="SITE_MANAGE_ACCESS"?"Site Authority":(l==null?void 0:l.access_role)==="ID_CARD_ACCESS"?"Id Card Section":(l==null?void 0:l.access_role)==="ACADEMIC_ADMINISTRATOR_ACCESS"?"Academic Administrator":(l==null?void 0:l.access_role)==="LEAVING_AND_TRANSFER_ACCESS"?"Leave and Transfer Authority":""})]}),s.jsx("img",{src:"/images/three-24-dot-icon.svg",alt:"menu icon",onClick:()=>d(l),className:A.menu_icon,title:"Menu"})]})};export{ss as A,rs as I,ds as a,is as b};
