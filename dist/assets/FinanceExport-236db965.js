import{u as E,r as i,j as e,oz as $,t as O}from"./index-0ca76035.js";import{M as w,U as S,a as p,B as x,f as y,C as z,T as H,V as L,i as R,v as A,W as B,p as Y,q as P,l as V,s as l,r as W,L as X}from"./FinanceConfig-24ef7fd2.js";import{l as q}from"./localTime-4e51d139.js";import{s as C}from"./Income.module-200dd9e8.js";import{H as G,F as J,T as K}from"./HostelFeeHeadFilter-26a6b9ce.js";import"./finance-api-e818490b.js";import"./PopupWrapper-2578092d.js";import"./Overlay-c8100e0a.js";import"./Overlay.module-9133d1bb.js";import"./SearchModalWrapper-0fa3f9a3.js";import"./SearchModalBackdrop-c4f123e6.js";import"./SearchHeader.module-b69c8942.js";import"./CustomNormalSelectInput-0a62fa3f.js";import"./JoinForm.module-212f9bb3.js";import"./JoinFormCalender-d186c4ef.js";import"./DatePicker-c6d0e911.js";import"./BorderBottom-1dc6f53e.js";import"./CustomSelectDepartment-11201deb.js";import"./hostel-api-9294ced1.js";const Q="_export_card_1xzgf_1",Z="_export_card_image_1xzgf_17",I="_export_card_text_1xzgf_22",ee="_export_card_date_1xzgf_36",te="_export_card_menu_1xzgf_49",v={export_card:Q,export_card_image:Z,export_card_text:I,export_card_date:ee,export_card_menu:te},ae=({onEditAction:t,onClose:a,xlsxId:s})=>{const{t:n}=E(),[m,_]=i.useState((s==null?void 0:s.excel_file_name)??""),[d,f]=i.useState("");i.useEffect(()=>{_((s==null?void 0:s.excel_file_name)??"")},[s==null?void 0:s.excel_file_name]);const h=u=>{_(u.target.value)},j=()=>{m?t(m):f({excelName:"excelName is required"})};return e.jsx(w,{onClose:a,children:e.jsxs("div",{className:C.modal_container,children:[e.jsx(S,{children:e.jsxs("div",{className:C.modal_container_outer_header,children:[e.jsx("div",{className:C.modal_container_header,children:e.jsx("h6",{children:n("update_excel_name")})}),e.jsx("img",{src:`${p}/close.svg`,alt:"close icon",onClick:a})]})}),e.jsx(x,{}),e.jsxs(S,{customStyle:{paddingTop:"0"},children:[e.jsx(y,{label:n("excel_name"),placeholder:n("excel_name_plcaeholder"),name:"excelName",value:m,type:"text",onChange:h,errorShow:d.excelName}),e.jsx(z,{label:"update",onAction:j})]})]})})},se=({onClose:t,xlsxId:a,instituteId:s})=>{const{t:n}=E(),[m,_]=i.useState(!1),[d,f]=i.useState(!1),[h]=H(),[j]=L(),u=()=>{s&&(a!=null&&a._id)&&(_(c=>!c),h({id:s,xlsxId:a==null?void 0:a._id}).then(()=>{t(),_(c=>!c)}).catch({}))},g=()=>{f(c=>!c)},N=c=>{s&&(a!=null&&a._id)&&(_(r=>!r),j({id:s,xlsxId:a==null?void 0:a._id,excelUpdate:{excel_file_name:c}}).then(()=>{_(r=>!r),t()}).catch({}))};return d?e.jsx(ae,{onClose:g,onEditAction:N,xlsxId:a}):e.jsxs(R,{onClose:t,disabled:m,children:[e.jsx("h6",{onClick:g,children:n("edit")}),e.jsx("h6",{onClick:u,children:n("delete")})]})},b=({excel:t,instituteId:a})=>{const[s,n]=i.useState(""),m=()=>{n("")},_=d=>{d.preventDefault(),n(t)};return e.jsxs(e.Fragment,{children:[e.jsxs("a",{className:v.export_card,title:"Download File",href:`${$}/${t==null?void 0:t.excel_file}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx("img",{src:`${p}/xsxl.svg`,className:v.export_card_image,alt:"excel icon"}),e.jsxs("section",{className:v.export_card_text,children:[e.jsx("h6",{children:(t==null?void 0:t.excel_file_name)??""}),e.jsxs("div",{className:v.export_card_date,children:[e.jsx("h6",{children:A(t==null?void 0:t.created_at).format("DD MMM YYYY")}),e.jsx("h6",{children:q(t==null?void 0:t.created_at,"LT")})]})]}),e.jsx("img",{src:`${p}/menu.svg`,alt:"menu icon",onClick:_,title:"Menu",className:v.export_card_menu})]},t==null?void 0:t._id),s&&e.jsx(se,{onClose:m,xlsxId:s,instituteId:a})]})},Ce=({instituteId:t,hostelId:a,fid:s})=>{const{t:n}=E(),[m,_]=i.useState(""),[d,f]=i.useState(1),[h,j]=i.useState(!0),[u,g]=O({skip:m}),[N,c]=i.useState(""),{financeAllExcel:r,financeAllExcelLoading:T,financeAllExcelRefetch:M}=B({data:{id:t,page:d,limit:10,search:m},skip:!t});i.useEffect(()=>{g&&h&&f(o=>o+1)},[g,h]),i.useEffect(()=>{r!=null&&r.length&&Y(r==null?void 0:r.length,j)},[r==null?void 0:r.length]);const D=i.useCallback(P(o=>_(o),500),[]),k=o=>{D(o.target.value)},F=()=>{c("")};return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsx(S,{children:e.jsxs("div",{className:l.fm_header_container,children:[e.jsx("h6",{children:n("data_export")}),e.jsxs("div",{className:l.fm_both_filter,children:[e.jsxs("div",{onClick:()=>c("HOSTEL"),className:l.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:n("hostel_fee_receipt_filter")})]}),e.jsxs("div",{onClick:()=>c("ADMISSION"),className:l.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:n("fee_receipt_filter")})]}),e.jsxs("div",{onClick:()=>c("TRANSACTION"),className:l.fm_both_filter_with_name,children:[e.jsx("img",{src:`${p}/filter.svg`,alt:"filter icon"}),e.jsx("h6",{children:n("transaction_filter")})]})]})]})}),e.jsx(x,{}),e.jsxs(S,{customStyle:{paddingTop:"0"},children:[e.jsx("div",{className:l.fm_search_full,children:e.jsx("section",{className:l.fm_search_full_container,children:e.jsxs("div",{className:l.fm_search_full_container_inner,children:[e.jsx("img",{className:l.fm_search_full_icon,alt:"search icon",src:`${W}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:n("search"),onChange:k})]})})}),T&&e.jsx(X,{}),r==null?void 0:r.map((o,U)=>(r==null?void 0:r.length)===U+1?e.jsx("div",{ref:u,children:e.jsx(b,{excel:o,instituteId:t})},o==null?void 0:o._id):e.jsx(b,{excel:o,instituteId:t},o==null?void 0:o._id))]})]}),N==="HOSTEL"?e.jsx(G,{onClose:F,financeId:s,hostelId:a}):N==="ADMISSION"?e.jsx(J,{onClose:F,financeId:s,instituteId:t}):N==="TRANSACTION"?e.jsx(K,{instituteId:t,onClose:F,viewAs:"EXPORT",onRefetch:M}):null]})};export{Ce as default};
