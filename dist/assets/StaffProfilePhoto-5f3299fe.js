import{u as v,R as F,r as N,fw as z,j as s,n as O,fx as Z,L as b,c as K,d as G,Q as D,fy as X,k as Q,bo as tt}from"./index-0ca76035.js";import{s as r,B as st}from"./BorderBottom-1dc6f53e.js";import{e as nt}from"./student-api-05be0424.js";import{S as at}from"./StudentSubjectList-d5c4bef6.js";import{P as U}from"./PopupWrapper-2578092d.js";import{B as ot}from"./BonafideReason-170cf76d.js";import{d as it}from"./institute-staff-student-api-7114d611.js";import{S as rt}from"./SendFilterStudentMessage-e0daf41f.js";import{C as et}from"./index-a0d1f014.js";import{J as lt}from"./JoinFormTextArea-394bf055.js";import{s as P}from"./FeesStructure.module-7a88fbbc.js";import{J as dt}from"./JoinFormInput-82706177.js";import{d as ct}from"./admission-api-925391d9.js";import{b as ut}from"./export-data-api-674b559b.js";const mt=({studentId:e,openAs:c,editAs:m})=>{var C,E,A,y;const{t:g}=v(),[n,u]=F.useState("Month"),[a,l]=N.useState(""),[x,p]=N.useState(!1),_=new Date().toISOString().split("-"),t=+_[1]>9?+_[1]:`0${+_[1]}`,{data:o,refetch:d}=z({sid:e,month:n==="Month"?t:"",year:+_[0]},{skip:!e}),{studentSubjectAttendance:i,studentSubjectAttendanceRefetch:h}=nt({data:{sid:e,month:n==="Month"?t:"",year:+_[0],subjectId:a==null?void 0:a._id},skip:!(a!=null&&a._id)||!e});F.useEffect(()=>{e&&d()},[e,n,d]),F.useEffect(()=>{a!=null&&a._id&&h()},[a==null?void 0:a._id,n,h]);const S=j=>{u(j)},I=()=>{p(j=>!j)},k=j=>{(a==null?void 0:a._id)===(j==null?void 0:j._id)?l(""):l(j),I()};return s.jsxs("div",{className:r.student_attendane_container,style:{right:c==="STUDENT_SECTION"||c==="ADMISSION_ADMIN"?"11%":m==="INSTITUTE"?"10%":c==="INSTITUTE"||c==="CLASS_CATALOG"?"8%":c?"1.6%":"11%"},children:[s.jsxs("div",{className:r.student_attendance_heading,children:[s.jsx("h6",{children:a?(a==null?void 0:a.subjectName)??"":g("class_attendance")}),s.jsx("img",{src:"/images/filter-blue-icon.svg",alt:"filter icon",onClick:I,title:"Filter by subject",style:{cursor:"pointer"}})]}),s.jsxs("div",{className:r.colours,children:[s.jsxs("div",{className:r.monthColours,onClick:()=>S("Month"),children:[s.jsx("p",{children:"Monthly"}),n==="Month"?s.jsx("img",{src:"/images/radio-active.svg",alt:""}):s.jsx("img",{src:"/images/radio-disabled.svg",alt:""})]}),s.jsxs("div",{className:r.monthColours,onClick:()=>S("Year"),children:[s.jsx("p",{children:"Yearly"}),n==="Year"?s.jsx("img",{src:"/images/radio-active.svg",alt:""}):s.jsx("img",{src:"/images/radio-disabled.svg",alt:""})]})]}),s.jsxs("div",{className:r.percentage,children:[s.jsxs("div",{className:r.presentcount,children:[s.jsx("p",{children:"Present Count"}),s.jsxs("p",{children:[a?(C=i==null?void 0:i.presentArray)==null?void 0:C.length:(E=o==null?void 0:o.presentArray)==null?void 0:E.length," ","days"]}),s.jsxs("p",{children:[a?(i==null?void 0:i.present)==="NaN"?0:i==null?void 0:i.present:(o==null?void 0:o.present)==="NaN"?0:o==null?void 0:o.present," ","%"]})]}),s.jsxs("div",{className:r.absentcount,children:[s.jsx("p",{children:"Absent Count"}),s.jsxs("p",{children:[a?(A=i==null?void 0:i.absentArray)==null?void 0:A.length:(y=o==null?void 0:o.absentArray)==null?void 0:y.length," ","days"]}),s.jsxs("p",{children:[a?(i==null?void 0:i.absent)==="NaN"?0:i==null?void 0:i.absent:(o==null?void 0:o.absent)==="NaN"?0:o==null?void 0:o.absent,"%"]})]})]}),x&&s.jsx(U,{onClose:I,children:s.jsx("div",{style:{width:"30rem",minHeight:"10rem",maxHeight:"35rem",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth",padding:"1rem"},children:s.jsx(at,{sid:e,onFilterAttendance:k,filterAttendance:a})})})]})},ht=({carryParrentState:e,studentId:c})=>{var l,x,p,f,_,t,o;const{t:m}=v(),g=O(),{data:n,refetch:u}=Z(`${c}`,{skip:!c});N.useEffect(()=>{c&&u()},[c,u]);const a=(d,i,h)=>d+i+h;return s.jsxs("div",{className:r.admission_fees,children:[s.jsxs("div",{children:[s.jsxs("h5",{style:{color:"#008000"},children:[m("rs"),"."," ",a(((l=n==null?void 0:n.student)==null?void 0:l.studentPaidFeeCount)||0,((x=n==null?void 0:n.student)==null?void 0:x.admissionPaidFeeCount)||0,((p=n==null?void 0:n.student)==null?void 0:p.hostelPaidFeeCount)||0)]}),s.jsx("h6",{style:{marginBottom:"1.5rem"},children:m("total_fees_paid")}),s.jsxs("h5",{style:{color:"#121212"},children:[m("rs"),"."," ",a(((f=n==null?void 0:n.student)==null?void 0:f.studentRemainingFeeCount)||0,((_=n==null?void 0:n.student)==null?void 0:_.admissionRemainFeeCount)||0,((t=n==null?void 0:n.student)==null?void 0:t.hostelRemainFeeCount)||0)]}),s.jsx("h6",{children:m("total_outs")})]}),s.jsxs("div",{children:[s.jsx(b,{to:`/q/${g.username}/student/profile`,state:e,children:s.jsxs("div",{className:r.card_hold_container,children:[s.jsx("img",{src:"/images/link-forword-icon.svg",alt:"forword link"}),s.jsx("h6",{children:m("view_profile")})]})}),s.jsxs("h5",{style:{color:"#121212",marginTop:"1.5rem"},children:[m("rs"),". ",((o=n==null?void 0:n.student)==null?void 0:o.applicable_fees_pending)??0]}),s.jsx("h6",{children:m("applicable_outs")})]})]})},ft=({instituteId:e,uniqueGr:c})=>{var o,d,i;const{t:m}=v(),[g,n]=N.useState(""),[u,a]=N.useState(!1),l=K(),x=O(),p=G(),f=h=>{n(h)},[_]=it(),t=h=>{e&&c&&(a(S=>!S),_({id:e,gr:c,leavingFeedback:{number:c,reason:"",study:"",behaviour:"",remarks:"",udise:""}}).then(S=>{a(I=>!I),h==="LEAVING"?l(`/q/${x.username}/student/certificate/form`,{state:{student:S.data.student,download:S.data.download,instituteId:e,is_leaving:"leaving"}}):l(`/q/${x.username}/student/certificate/form`,{state:{student:S.data.student,download:S.data.download,instituteId:e,is_leaving:"transfer"}})}).catch({}))};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:r.certificate_btn_container,children:[s.jsx("button",{className:r.certificate_btn,onClick:()=>f("BONAFIDE"),children:m("bonafide")}),s.jsx("button",{className:r.certificate_btn,onClick:()=>t("LEAVING"),children:m("leaving")}),s.jsx("button",{className:r.certificate_btn,onClick:()=>t("TRANSFER"),children:m("transfer_certificate")}),s.jsx("button",{className:r.certificate_btn,onClick:()=>f("STUDENT_MESSAGE"),children:m("student_message")})]}),g==="BONAFIDE"&&s.jsx(ot,{onClose:()=>f(""),uniqueGr:c,instituteId:e}),g==="STUDENT_MESSAGE"&&s.jsx(rt,{onClose:()=>f(""),isStudentProfile:!0,viewAs:"CERTIFICATE_AUTHORITY",headId:(o=p.state)==null?void 0:o.headId,messageId:(d=p.state)==null?void 0:d.messageId,sendStudentList:(i=p.state)==null?void 0:i.sid,instituteId:e}),u&&s.jsx(D,{})]})},_t=({sid:e})=>{var _;const{t:c}=v(),[m,g]=N.useState(!1),[n,u]=N.useState([]),[a,l]=N.useState(!1),[x]=X(),p=t=>{var o,d;return[{GRNo:t==null?void 0:t.studentGRNO,Name:(t==null?void 0:t.studentFirstName)+" "+(t==null?void 0:t.studentMiddleName)+" "+(t==null?void 0:t.studentLastName),Gender:t==null?void 0:t.studentGender,MotherName:t!=null&&t.studentMotherName?t==null?void 0:t.studentMotherName:"NA",DOB:t!=null&&t.studentDOB?t==null?void 0:t.studentDOB:"NA","Blood Group":t!=null&&t.student_blood_group?t==null?void 0:t.student_blood_group:"NA","Caste Category":t!=null&&t.studentCastCategory?t==null?void 0:t.studentCastCategory:"NA",Religion:t!=null&&t.studentReligion?t==null?void 0:t.studentReligion:"NA",BirthPlace:t!=null&&t.studentBirthPlace?t==null?void 0:t.studentBirthPlace:"NA",Address:t!=null&&t.studentAddress?t==null?void 0:t.studentAddress:"NA",ParentsName:t!=null&&t.studentParentsName?t==null?void 0:t.studentParentsName:"NA","Parent's Contact":t!=null&&t.studentParentsPhoneNumber?t==null?void 0:t.studentParentsPhoneNumber:"NA",State:t!=null&&t.studentState?t==null?void 0:t.studentState:"NA",District:t!=null&&t.studentDistrict?t==null?void 0:t.studentDistrict:"NA",Nationality:t!=null&&t.studentNationality?t==null?void 0:t.studentNationality:"NA",Class:(o=t==null?void 0:t.studentClass)==null?void 0:o.classTitle,Contact:t==null?void 0:t.studentPhoneNumber,Email:t==null?void 0:t.studentEmail,AdmissionDate:(d=t==null?void 0:t.studentAdmissionDate)==null?void 0:d.split("T")[0],AadharNumber:t!=null&&t.studentAadharNumber?t==null?void 0:t.studentAadharNumber:"NA","Mother Tongue":t!=null&&t.studentMTongue?t==null?void 0:t.studentMTongue:"NA",Caste:t!=null&&t.studentCast?t==null?void 0:t.studentCast:"NA","Current Address":t!=null&&t.studentCurrentAddress?t==null?void 0:t.studentCurrentAddress:"NA","Father Ration Color":t!=null&&t.studentFatherRationCardColor?t==null?void 0:t.studentFatherRationCardColor:"NA","Parent's Occupation":t!=null&&t.studentParentsOccupation?t==null?void 0:t.studentParentsOccupation:"NA","Parent's Annual Income":t!=null&&t.studentParentsAnnualIncom?t==null?void 0:t.studentParentsAnnualIncom:"NA","Previous School":t!=null&&t.studentPreviousSchool?t==null?void 0:t.studentPreviousSchool:"NA","Bank Name":t!=null&&t.studentBankName?t==null?void 0:t.studentBankName:"NA","Bank Account":t!=null&&t.studentBankAccount?t==null?void 0:t.studentBankAccount:"NA","Bank Holder Name":t!=null&&t.studentBankAccountHolderName?t==null?void 0:t.studentBankAccountHolderName:"NA","Bank Ifsc":t!=null&&t.studentBankIfsc?t==null?void 0:t.studentBankIfsc:"NA"}]},f=()=>{e&&(g(!0),x({studentId:{sid:e}}).then(t=>{u(()=>{var o;return p((o=t==null?void 0:t.data)==null?void 0:o.student_card)}),l(!0)}).catch({}))};return N.useEffect(()=>{a&&(document.getElementById("csv_download_file").click(),l(!1),g(o=>!o))},[a]),s.jsxs(s.Fragment,{children:[s.jsx("div",{className:r.certificate_btn_container,children:s.jsx("button",{className:r.certificate_btn,onClick:f,children:c("id_card")})}),s.jsx(et,{data:n,filename:`${(_=n==null?void 0:n[0])==null?void 0:_.Name}-id-card`,id:"csv_download_file"}),m&&s.jsx(D,{})]})},Nt=({uniqueGr:e,onClose:c,studentId:m,onRefetch:g})=>{const{t:n}=v(),[u,a]=N.useState(!1),[l,x]=N.useState(!1),[p]=ct(),[f,_]=N.useState({query_content:"",query_gr:e??""});N.useEffect(()=>{e&&_(d=>({...d,query_gr:e??""}))},[e]);const t=d=>{const i={};for(let h in d)d[h]||(i[h]=`${h} is required!`);return i},o=()=>{const d=t(f);let i=!1;for(let h in d)if(h){i=!0;break}i?x(d):(a(h=>!h),p({sid:m,grNumberContent:f}).then(()=>{g(),a(h=>!h),c()}).catch({}))};return s.jsxs(U,{onClose:c,children:[s.jsx("div",{className:P.add_category_modal,style:{width:"30rem",minHeight:"10rem",height:"fit-content"},children:s.jsxs("section",{className:P.fee_middle_section_container,style:{marginBottom:"1.2rem"},children:[s.jsx("h6",{style:{fontSize:"20px",fontWeight:"600"},children:n("update_student_gr")}),s.jsx(st,{customStyle:{width:"100%",marginTop:"0.7rem",marginBottom:"1rem"}}),s.jsx(dt,{labelText:n("student_gr"),placeholder:n("student_gr_placeholder"),name:"query_gr",value:f==null?void 0:f.query_gr,type:"text",onChange:d=>_(i=>({...i,query_gr:d.target.value})),errorShow:l.query_gr}),s.jsx(lt,{labelText:n("gr_student_message_label"),placeholder:n("gr_student_message_label_placeholder"),name:"query_content",value:f.query_content,type:"text",onChange:d=>_(i=>({...i,query_content:d.target.value})),errorShow:l.query_content}),s.jsx("button",{onClick:o,className:P.fee_middle_confirm_button,style:{marginTop:"4rem"},children:n("update")})]})}),u&&s.jsx(D,{})]})},R=["SUBJECT_TEACHER","LEAVING_FORM","FINANCE_MANAGER","ADMISSION_ADMIN_SCHOLARSHIP","VIEW_ADMISSION_PAGE_FEES","INSTITUTE_ADMIN","STUDENT","CERTIFICATE_AUTHORITY","ID_CARD_SECTION"],w=["ADMISSION_ADMIN","FINANCE_MANAGER","CERTIFICATE_AUTHORITY","STUDENT_SECTION","ID_CARD_SECTION","INSTITUTE_ADMIN"],Dt=({dynamicImage:e,indexNumber:c,designation:m,name:g,activeUrl:n,sid:u,viewAs:a,openAs:l,onEdit:x,grNumber:p,carryParrentState:f,admissionButton:_,is_hostel_link:t,is_view_profile:o,editAs:d,uniqueGr:i,instituteId:h,onRefetchStudentApi:S,isGrButtonLock:I,currentDesignation:k})=>{var L,$,H;const{t:C}=v(),E=O(),A=G(),y=Q(T=>T.idChange.loginProfile),[j,Y]=N.useState(!1),[V,B]=N.useState(!1),[W]=ut(),J=()=>{B(!0),W({instituteId:u}).then(T=>{var q;window.open(`${tt}/${(q=T==null?void 0:T.data)==null?void 0:q.Key}`,"_blank"),B(!1)}).catch({})},M=()=>{if(I==="Locked")return null;Y(T=>!T)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:r.staff_profile_photo_container,style:{minHeight:l==="CERTIFICATE_AUTHORITY"?"12rem":"5rem"},children:[l==="ID_CARD_SECTION"?s.jsx("img",{src:e,alt:"staff avatar",className:r.staff_profile_photo_image,style:{cursor:"pointer"},title:"Download profile photo",onClick:J}):s.jsx("img",{src:e,alt:"staff avatar",className:r.staff_profile_photo_image}),s.jsxs("div",{className:r.staff_profile_photo_info,children:[s.jsxs("h5",{className:r.staff_profile_photo_name,children:[g,o==="HOSTEL"?s.jsx(b,{to:`/q/${E.username}/student/profile/`,state:{sid:u,viewAs:l,instituteId:(L=A.state)==null?void 0:L.instituteId},children:s.jsx("span",{style:{fontSize:"10px",fontWeight:"400",color:"#0000ff"},children:` (${C("view_profile")})`})}):t&&s.jsx(b,{to:`/q/${E.username}/student/profile/hostel`,state:{sid:u,viewAs:l,instituteId:($=A.state)==null?void 0:$.instituteId},children:s.jsx("span",{style:{fontSize:"10px",fontWeight:"400",color:"#0000ff"},children:` (${C("hostel_profile")})`})})]}),s.jsx("p",{className:r.staff_profile_photo_index,children:c}),n==="student"&&s.jsxs("p",{className:r.staff_profile_photo_index,children:[p,(w==null?void 0:w.includes(l))&&s.jsx("span",{style:{fontSize:"12px",fontWeight:"400",color:I==="Locked"?"rgb(177 177 176)":"#0000ff",cursor:"pointer"},onClick:M,children:` (${C(I==="Locked"?"requested":"edit_")})`})]}),s.jsx("p",{className:r.staff_profile_photo_index,children:m}),k&&s.jsx("p",{className:r.staff_profile_photo_index,children:k})]}),n==="student"&&l==="VIEW_ADMISSION_PAGE_FEES"?s.jsx(ht,{carryParrentState:f,studentId:u}):n==="student"&&s.jsx(s.Fragment,{children:s.jsx(b,{to:`/q/${E.username}/student/profile/admission`,state:{sid:u,viewAs:l,instituteId:(H=A.state)==null?void 0:H.instituteId},children:s.jsxs("div",{className:r.link_hold_container,style:{right:_?"40%":"35%"},children:[s.jsx("img",{src:"/images/link-forword-icon.svg",alt:"forword link"}),s.jsx("h6",{children:C("admission_fees")})]})})}),l==="CERTIFICATE_AUTHORITY"?s.jsx(ft,{uniqueGr:i,instituteId:h}):l==="ID_CARD_SECTION"?s.jsx(_t,{sid:u}):n==="student"&&s.jsx(mt,{studentId:u,openAs:l,editAs:d}),d==="STAFF"?null:d==="INSTITUTE"?s.jsx(b,{to:`/q/${y.username}/edit/${n}`,state:{openAs:"INSTITUTE_SIDE",sid:u},children:s.jsx("img",{src:"/images/user-pencil-edit.svg",alt:"edit icon",className:r.staff_profile_photo_edit})}):R!=null&&R.includes(l)?"":a?s.jsx("img",{src:"/images/user-pencil-edit.svg",alt:"edit icon",className:r.staff_profile_photo_edit,onClick:x,style:{cursor:"pointer"}}):s.jsx(b,{to:`/q/${y.username}/edit/${n}`,state:{openAs:"INSTITUTE_SIDE",sid:u},children:s.jsx("img",{src:"/images/user-pencil-edit.svg",alt:"edit icon",className:r.staff_profile_photo_edit})})]}),j&&s.jsx(Nt,{onClose:M,uniqueGr:i,studentId:u,onRefetch:S}),V&&s.jsx(D,{})]})};export{Dt as S};
