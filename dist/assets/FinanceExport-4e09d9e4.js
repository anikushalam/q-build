import{u as T,r as i,j as e,Q as V,k as W,c as X,t as z,v as B,a1 as w,S as K}from"./index-731451a5.js";import{s as r}from"./AdmisisonRefund.module-c6c85188.js";import{E as Y,F as Z,G as A}from"./finance-api-5c6c5671.js";import{O as I}from"./Overlay-07ce6f88.js";import{S as ee}from"./SearchModalBackdrop-5b309d60.js";import{s as k}from"./EditConfirm.module-344fbdb9.js";import{J as te}from"./JoinFormInput-8e74a0e0.js";import{B as H}from"./BorderBottom-47800983.js";import{T as se,F as ae,H as ie}from"./HostelFeeHeadFilter-5f22c367.js";import"./Overlay.module-9133d1bb.js";import"./SearchHeader.module-b69c8942.js";import"./JoinForm.module-212f9bb3.js";import"./PopupWrapper-ffbaef7a.js";import"./SearchModalWrapper-6e85c9f3.js";import"./CustomNormalSelectInput-9ec7329b.js";import"./JoinFormCalender-5158d888.js";import"./DatePicker-305f3dc6.js";import"./CustomSelectDepartment-a5dd9a35.js";import"./hostel-api-4d11cb04.js";const re=({onEdit:n,xlsxId:s})=>{const{t:c}=T(),[l,o]=i.useState((s==null?void 0:s.excel_file_name)??""),[d,_]=i.useState("");i.useEffect(()=>{o((s==null?void 0:s.excel_file_name)??"")},[s==null?void 0:s.excel_file_name]);const f=()=>{l?n(l):_({excelName:"excelName is required"})};return e.jsxs("div",{style:{width:"20rem",minHeight:"10rem",padding:"1rem"},children:[e.jsx("h6",{children:c("update_excel_name")}),e.jsx(H,{customStyle:{width:"100%"}}),e.jsx(te,{labelText:c("excel_name"),placeholder:c("excel_name_plcaeholder"),value:l,name:"excelName",type:"text",onChange:h=>o(h.target.value),errorShow:d.excelName}),e.jsx("button",{className:k.xlsx_update_btn,title:"Update",onClick:f,style:{justifyContent:"center",marginTop:"1rem"},children:c("update")})]})},oe=({onClose:n,xlsxId:s,onRefetch:c,instituteId:l})=>{const[o,d]=i.useState(!1),[_,f]=i.useState(!1),[h]=Y(),[g]=Z(),v=()=>{d(m=>!m),h({id:l,xlsxId:s==null?void 0:s._id}).then(()=>{c(),n(),d(m=>!m)}).catch({})},N=m=>{d(p=>!p),g({id:l,xlsxId:s==null?void 0:s._id,excelUpdate:{excel_file_name:m}}).then(()=>{c(),d(p=>!p),n()}).catch({})};return e.jsxs(e.Fragment,{children:[e.jsx(ee,{onClose:n}),e.jsxs(I,{customStyle:{zIndex:"1200"},children:[_?e.jsx(re,{xlsxId:s,onEdit:N}):e.jsxs("div",{className:k.edit_modal_container,style:{width:"200px"},children:[e.jsx("h6",{className:k.edit,onClick:()=>f(m=>!m),children:"Edit"}),e.jsx("h6",{className:k.remove,onClick:v,children:"Delete"})]}),o&&e.jsx(V,{})]})]})},Ce=({insId:n,financeId:s,hostelId:c})=>{const{t:l}=T(),o=W(t=>t.financeChange.insId),d=X(),[_,f]=z(),[h,g]=i.useState(1),[v,N]=i.useState(!0),[m,p]=i.useState(!1),[R,S]=i.useState(!0),[u,b]=i.useState([]),[L,J]=i.useState(!1),[U,q]=i.useState(!1),[G,Q]=i.useState(!1),[D,y]=i.useState(!1),{getAllExcelByFinance:a,getAllExcelByFinanceRefetch:C}=A({data:{id:o||n,page:h,limit:10},skip:o?!o:!n}),{scrollToTop:$}=B();i.useEffect(()=>{$()},[]),i.useEffect(()=>{(o||n)&&(S(!0),C())},[o,n,h,C]),i.useEffect(()=>{f&&v&&g(t=>t+1)},[f,v]),i.useEffect(()=>{var t,F;m?(b(a==null?void 0:a.all_excel),p(!1),S(!1)):a!=null&&a.all_excel?(b(j=>[...new Set([...j,...a==null?void 0:a.all_excel].map(JSON.stringify))].map(JSON.parse)),S(!1)):((t=a==null?void 0:a.all_excel)==null?void 0:t.length)===0&&S(!1),((F=a==null?void 0:a.all_excel)==null?void 0:F.length)===10?N(!0):N(!1)},[a==null?void 0:a.all_excel]);const P=()=>{d(-1)},E=()=>{J(t=>!t)},M=()=>{g(1),C(),p(!0)},x=()=>{q(t=>!t)},O=()=>{Q(t=>!t)};return e.jsxs("div",{className:r.refund_container,children:[e.jsxs("section",{className:r.refund_container_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:P,alt:"go to previous tab",title:"Go Back",style:{cursor:"pointer"}}),e.jsxs("div",{className:r.refund_container_title,style:{justifyContent:"space-between",width:"95%"},children:[e.jsx("h6",{children:l("data_export")}),e.jsxs("div",{className:r.both_filter,children:[e.jsxs("div",{onClick:O,className:r.both_filter_with_name,children:[e.jsx("img",{src:"/images/export-filter-icon.svg",alt:"filter icon"}),e.jsx("h6",{children:l("hostel_fee_receipt_filter")})]}),e.jsxs("div",{onClick:x,className:r.both_filter_with_name,children:[e.jsx("img",{src:"/images/export-filter-icon.svg",alt:"filter icon"}),e.jsx("h6",{children:l("fee_receipt_filter")})]}),e.jsxs("div",{onClick:E,className:r.both_filter_with_name,children:[e.jsx("img",{src:"/images/export-filter-icon.svg",alt:"filter icon"}),e.jsx("h6",{children:l("transaction_filter")})]})]})]})]}),e.jsx(H,{customStyle:{width:"100%"}}),e.jsxs("div",{className:r.refund_list,children:[u==null?void 0:u.map((t,F)=>(u==null?void 0:u.length)===F+1?e.jsxs("a",{ref:_,className:r.export_card,title:"Download File",href:`https://d3dqpu54js2vfl.cloudfront.net/${t==null?void 0:t.excel_file}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx("img",{src:"/images/export-xsxl-icon.svg",alt:""}),e.jsxs("section",{className:r.export_card_text,children:[e.jsx("h6",{children:(t==null?void 0:t.excel_file_name)??""}),e.jsxs("div",{className:r.export_card_date,children:[e.jsx("h6",{children:w(t==null?void 0:t.created_at).format("DD MMM yyy")}),e.jsx("h6",{children:w(t==null?void 0:t.created_at).format("LT")})]})]}),e.jsx("img",{src:"/images/three-24-dot-icon.svg",alt:"menu icon",onClick:j=>{j.preventDefault(),y(t)},className:r.menu_icon,title:"Menu"})]},t==null?void 0:t._id):e.jsxs("a",{className:r.export_card,title:"Download File",href:`https://d3dqpu54js2vfl.cloudfront.net/${t==null?void 0:t.excel_file}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx("img",{src:"/images/export-xsxl-icon.svg",alt:""}),e.jsxs("section",{className:r.export_card_text,children:[e.jsx("h6",{children:(t==null?void 0:t.excel_file_name)??""}),e.jsxs("div",{className:r.export_card_date,children:[e.jsx("h6",{children:w(t==null?void 0:t.created_at).format("DD MMM yyy")}),e.jsx("h6",{children:w(t==null?void 0:t.created_at).format("LT")})]})]}),e.jsx("img",{src:"/images/three-24-dot-icon.svg",alt:"menu icon",onClick:j=>{j.preventDefault(),y(t)},className:r.menu_icon,title:"Menu"})]},t==null?void 0:t._id)),R&&e.jsx(K,{}),L&&e.jsx(se,{instituteId:o||n,onClose:E,viewAs:"EXPORT",onRefetch:M}),D&&e.jsx(oe,{xlsxId:D,onClose:()=>y(""),onRefetch:M,instituteId:o||n}),U&&e.jsx(ae,{onClose:x,financeId:s,instituteId:n}),G&&e.jsx(ie,{onClose:O,financeId:s,hostelId:c})]})]})};export{Ce as default};
