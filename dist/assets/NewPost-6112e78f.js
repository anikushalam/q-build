import{R as Se,_ as je,u as Ne,r as l,k as Ie,g as be,q as Ce,j as s,e as Te,N as Pe,bS as W}from"./index-731451a5.js";import{C as Le,D as Re,E as we}from"./post-api-f57ebb8f.js";import{L as Oe}from"./LoaderButton-71df50a7.js";import{i as z}from"./constant_value-4cd2b3e0.js";import{P as ye,a as De}from"./PostFooterIcon-e68dad22.js";import{C as Ae}from"./CustomSuspense-e90dc607.js";import{V as $e}from"./VideoPlayer-13a9475c.js";import"./Avatar-c600f05e.js";import"./Avatar.module-fb7ee634.js";import"./FormToggle-bf5ca79b.js";import"./UniversalForm.module-19614663.js";import"./Switch-81e70f2f.js";import"./SwitchBase-2ba5f868.js";import"./index-55f989da.js";import"./index-387d7a00.js";const Fe="_postTitle_1a3ae_1",Ue="_postDesc_1a3ae_27",Ve="_postTextarea_1a3ae_32",Ee="_hashTag_1a3ae_56",ke="_btn_1a3ae_73",He="_upload_1a3ae_91",We="_Container_1a3ae_95",ze="_selectedImg_1a3ae_100",qe="_upload_video_1a3ae_114",Je="_tille_1a3ae_139",Be="_description_1a3ae_149",Ge="_afterbtn_1a3ae_160",Ke="_hashtag_1a3ae_164",Me="_privacyIcon_1a3ae_174",Qe="_userName_1a3ae_177",Xe="_select_1a3ae_100",Ye="_imgContainer_1a3ae_185",Ze="_arrowIcon_1a3ae_189",et="_mainbody_1a3ae_205",tt="_tagList_1a3ae_213",st="_border2_1a3ae_228",at="_border3_1a3ae_229",c={postTitle:Fe,postDesc:Ue,postTextarea:Ve,hashTag:Ee,btn:ke,upload:He,Container:We,selectedImg:ze,upload_video:qe,tille:Je,description:Be,afterbtn:Ge,hashtag:Ke,public:"_public_1a3ae_170",privacyIcon:Me,userName:Qe,select:Xe,imgContainer:Ye,arrowIcon:Ze,mainbody:et,tagList:tt,border2:st,border3:at};const ot=Se.lazy(()=>je(()=>import("./TagPeople-624d2342.js"),["assets/TagPeople-624d2342.js","assets/index-731451a5.js","assets/index-4d24e8f6.css","assets/post-api-f57ebb8f.js","assets/constant_value-4cd2b3e0.js","assets/TagPeople-f39f0e42.css"]));function St({postType:u,setPostType:R,onPostTypeChange:_}){var te,se,ae;const{t:f}=Ne(),[oe,q]=l.useState([]),[J,B]=l.useState(""),[N,G]=l.useState(""),[K,h]=l.useState(""),[x,w]=l.useState(u==="text"?1:u==="video"?3:2),[O,y]=l.useState(""),D=l.useRef(""),A=l.useRef(""),I=l.useRef(""),b=l.useRef(""),i=Ie(e=>e.idChange),$=be(),[ne]=Le(),[ie]=Re(),[le]=we(),[ce,re]=l.useState(!1),[v,C]=l.useState(!1),[F,U]=l.useState(!1),[d,M]=l.useState(""),[pe,T]=l.useState(""),[P,Q]=l.useState([]),[m,X]=l.useState(""),[g,V]=l.useState(""),[L,E]=l.useState("On"),[k,Y]=l.useState({msg:"",run:!1}),{oneInstituteDashboard:p,oneInstituteDashboardRefetch:S}=Ce({id:i==null?void 0:i.id,skip:!(i!=null&&i.id)});l.useEffect(()=>{i!=null&&i.id&&S()},[i==null?void 0:i.id,S]);const ge=e=>{var o,a;const t=(o=e.target.value)==null?void 0:o.length;if(e.target.value[t-1]==="@"){const n=d.length;(d[n-1]===" "||d==="")&&(C(!0),U("title"))}if(v){const n=(a=e.target.value)==null?void 0:a.split("@"),r=n.length;T(n[r-1])}M(e.target.value)},de=e=>{var o,a;const t=(o=e.target.value)==null?void 0:o.length;if(e.target.value[t-1]==="@"){const n=m.length;(m[n-1]===" "||m==="")&&(C(!0),U("description"))}if(v){const n=(a=e.target.value)==null?void 0:a.split("@"),r=n.length;T(n[r-1])}X(e.target.value)},Z=e=>{var o,a;const t=(o=e.target.value)==null?void 0:o.length;if(e.target.value[t-1]==="@"){const n=g.length;(g[n-1]===" "||g==="")&&(C(!0),U("caption"))}if(v){const n=(a=e.target.value)==null?void 0:a.split("@"),r=n.length;T(n[r-1])}V(e.target.value)},me=e=>{if(Q([...P,e]),F==="title"){const t=d==null?void 0:d.split("@"),o=t.length;t[o-1]=e.tagUserName;const a=[""];let n=0;for(let r of t){if(n===0)a[0]=r;else{const j=`${a[0]}@${r}`;a[0]=j}++n}M(a[0])}else if(F==="description"){const t=m==null?void 0:m.split("@"),o=t.length;t[o-1]=e.tagUserName;const a=[""];let n=0;for(let r of t){if(n===0)a[0]=r;else{const j=`${a[0]}@${r}`;a[0]=j}++n}X(a[0])}else{const t=g==null?void 0:g.split("@"),o=t.length;t[o-1]=e.tagUserName;const a=[""];let n=0;for(let r of t){if(n===0)a[0]=r;else{const j=`${a[0]}@${r}`;a[0]=j}++n}V(a[0])}},ee=e=>{if(e.target.files&&e.target.files.length>0){y(e.target.files),B(e.target.files[0]);const t=Array.from(e.target.files).map(o=>URL.createObjectURL(o));q(o=>o.concat(t))}},ue=e=>{var t;if(e.target.files.length>0)if(((t=e.target.files[0])==null?void 0:t.size)>5e7)Y({msg:"Please upload file size less than or equal to 50mb",run:!0});else{y(e.target.files[0]);let o=URL.createObjectURL(e.target.files[0]);G(o)}},fe=()=>{if(h(!0),!J&&!N)D.current.value!==""&&A.current.value!==""?ne({id:i==null?void 0:i.id,viewAs:z,post:{postTitle:D.current.value,postDescription:A.current.value,postStatus:I.current.value,people:P,comment_turned:L}}).then(e=>{var t;$(W.addCreatedPost({post:(t=e.data)==null?void 0:t.post})),_("post"),h(!1),S()}).catch({}):h(!1);else if(N&&O){const e=new FormData,t=P;e.append("postTitle",b.current.value),e.append("postStatus",I.current.value),e.append("people",JSON.stringify(t)),e.append("comment_turned",L),e.append("file",O),le({id:i==null?void 0:i.id,viewAs:z,post:e}).then(o=>{var a;$(W.addCreatedPost({post:(a=o.data)==null?void 0:a.post})),_("post"),h(!1),S()}).catch({})}else{const e=new FormData,t=P;e.append("postTitle",b.current.value),e.append("postStatus",I.current.value),e.append("people",JSON.stringify(t)),e.append("comment_turned",L);for(let o of O)e.append("file",o);ie({id:i==null?void 0:i.id,viewAs:z,post:e}).then(o=>{var a;$(W.addCreatedPost({post:(a=o.data)==null?void 0:a.post})),_("post"),h(!1),S()}).catch({})}},H=()=>{q([]),B(""),G(""),y([]),V(""),Q([]),E("On")},_e=()=>{w(1),R("text"),H()},he=()=>{w(2),R("image"),H()},xe=()=>{w(3),R("video"),H()},ve=e=>{e.target.checked?E("Off"):E("On")};return s.jsxs(s.Fragment,{children:[s.jsxs(ye,{postTitle:f("create_post"),onClose:()=>_("post"),dynamicImage:((te=p==null?void 0:p.institute)==null?void 0:te.photoId)!=="1"?`${Te}/${(se=p==null?void 0:p.institute)==null?void 0:se.insProfilePhoto}`:"/images/ins_default_profile.svg",name:(ae=p==null?void 0:p.institute)==null?void 0:ae.insName,privateImage:ce,setPrivateImage:re,postStatusRef:I,onToggleHandler:ve,checkedToggle:L,children:[v&&s.jsx("div",{className:c.tagList,style:F==="description"?{marginTop:"7vw"}:{marginTop:"0"},children:s.jsx(Ae,{children:s.jsx(ot,{open:v,setOpen:C,postTagSearch:pe,setPostTagSearch:T,taggedPeoplehandler:me})})}),u==="text"&&s.jsx("div",{className:c.postTitle,children:s.jsx("input",{className:c.input,type:"text",placeholder:f("title_post"),ref:D,onChange:ge,value:d})}),u==="text"&&s.jsx("div",{className:c.postDesc,children:s.jsx("textarea",{className:c.postTextarea,rows:"3",type:"text",name:"CreateInsPost",ref:A,placeholder:f("desc_post"),onChange:de,value:m})}),u==="image"&&s.jsxs("div",{className:c.Container,children:[s.jsx("p",{className:c.description,children:s.jsx("textarea",{className:c.postTextarea,rows:"3",type:"text",name:"CreateInsPost",ref:b,placeholder:f("caption_post"),onChange:Z,value:g})}),s.jsx("div",{className:c.selectedImg,children:oe.map((e,t)=>s.jsx("img",{alt:"list",src:e},t))})]}),u==="video"&&s.jsxs("div",{className:c.Container,children:[s.jsx("p",{className:c.description,children:s.jsx("textarea",{className:c.postTextarea,rows:"3",type:"text",name:"CreateInsPost",ref:b,placeholder:f("caption_post"),onChange:Z,value:g})}),N?s.jsx("div",{className:c.upload_video,children:s.jsx($e,{video:N})}):""]}),s.jsxs("button",{className:J?`${c.btn} ${c.afterbtn}`:c.btn,onClick:fe,disabled:K,children:[s.jsx("p",{children:f("post")}),K&&s.jsx("div",{children:s.jsx(Oe,{})})]}),s.jsxs(De,{onEditIocn:_e,onVideoIcon:xe,onPostTypeChange:_,activeIcon:x,addFileToggle:!0,onAddFile:x===2?ee:ue,acceptFormate:x===2?"image/*, image/gif, image/jpeg, image/png":"video/*",children:[s.jsxs("label",{htmlFor:"img",style:{cursor:"pointer"},children:[s.jsx("img",{src:"/images/img-post-icon.svg",onClick:he,alt:"icon upload for post"}),x===2&&s.jsx("div",{className:c.border2})]}),s.jsx("input",{className:c.upload,id:"img",name:"file",multiple:!0,onChange:x===2?ee:()=>{},type:"file",accept:"image/*, image/gif, image/jpeg, image/png"})]})]}),k.run&&s.jsx(Pe,{msg:k.msg,run:k.run,setRun:()=>Y({msg:"",run:!1}),postiton:"bottom",type:"error"})]})}export{St as default};
