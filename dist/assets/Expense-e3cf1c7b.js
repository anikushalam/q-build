import{r as h,u as C,j as e,t as q}from"./index-731451a5.js";import{J as R,v as f,K as V,M as L,U as S,F as U,N as D,a as E,B as W,R as O,O as B,f as Q,r as Y,C as z,Q as H,y as J,z as K,P as G,p as w,q as X,l as Z,s as A,L as ee}from"./FinanceConfig-555e7db6.js";import{s as n}from"./Income.module-200dd9e8.js";import{F as se,a as ae,P as te}from"./PlateformUser-390e1822.js";import{A as re}from"./AddButton-aacd1b4c.js";import{F as oe}from"./FormFile-e835db6a.js";import{T as ne,a as ce}from"./TileCard-60046ca2.js";import{F as le}from"./FormTextarea-f5fb5314.js";import{t as de}from"./transaction_constant-ad8d613b.js";const ie=({fid:s})=>{var a,i,m,u;const{t:c}=C(),{financeExpenseBalance:t}=R({fid:s,skip:!s});return e.jsxs("div",{className:n.right,children:[e.jsxs("div",{className:n.rightHead,style:{"--bg-expense-color":"rgb(231, 75, 75)"},children:[e.jsx("h6",{children:c("total_expense")}),e.jsxs("h6",{children:[c("rs"),((a=t==null?void 0:t.expenseBalance)==null?void 0:a.financeExpenseCashBalance)+((i=t==null?void 0:t.expenseBalance)==null?void 0:i.financeExpenseBankBalance)]})]}),e.jsxs("div",{className:n.rightBody,children:[e.jsxs("h6",{children:[" ",c("by_cash")," : ",c("rs"),(m=t==null?void 0:t.expenseBalance)==null?void 0:m.financeExpenseCashBalance]}),e.jsxs("h6",{children:[" ",c("by_bank")," : ",c("rs"),(u=t==null?void 0:t.expenseBalance)==null?void 0:u.financeExpenseBankBalance]})]})]})},me=h.memo(ie),$=({expense:s,setExpenseId:c})=>{var i;const{t}=C(),a=()=>{c(s==null?void 0:s._id)};return e.jsxs("div",{onClick:a,className:n.card_container,children:[e.jsxs("h6",{className:n.invoice_number,children:[t("invoice_no")," "," : "," ",s==null?void 0:s.invoice_number]}),e.jsxs("div",{className:n.sidebarheader,children:[e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv,children:t("paid_to")}),e.jsx("h6",{children:s!=null&&s.expensePaid?s==null?void 0:s.expensePaid:(i=s==null?void 0:s.expensePaidUser)==null?void 0:i.userLegalName}),e.jsx("p",{className:n.rcv,children:f(s==null?void 0:s.createdAt).format("MMMM D, YYYY")})]}),e.jsxs("div",{className:n.text,children:[e.jsxs("p",{className:n.rcv,children:[s!=null&&s.expense_quantity?s==null?void 0:s.expense_quantity:"N/A"," ",t("quantity")]}),e.jsxs("h6",{children:[t("rs")," ",s==null?void 0:s.expenseAmount]}),e.jsx("p",{className:n.rcv,children:s==null?void 0:s.expenseAccount})]})]})]})},he=({onClose:s,expenseId:c})=>{var i,m,u,v,x,g,p,j,b,_;const{t}=C(),{financeExpenseDetail:a}=V({expenseId:c,skip:!c});return e.jsx(L,{onClose:s,children:e.jsxs("div",{className:n.income_detail,children:[e.jsxs("div",{className:n.detailTop,children:[e.jsx("div",{className:n.detailTopMid,children:e.jsx("h6",{children:(i=a==null?void 0:a.oneExpense)!=null&&i.expensePaid?(m=a==null?void 0:a.oneExpense)==null?void 0:m.expensePaid:(v=(u=a==null?void 0:a.oneExpense)==null?void 0:u.expensePaidUser)==null?void 0:v.userLegalName})}),e.jsx("div",{className:n.detailTopMid,children:e.jsxs("h6",{children:["Rs. ",(x=a==null?void 0:a.oneExpense)==null?void 0:x.expenseAmount]})})]}),e.jsxs(S,{children:[e.jsx(U,{label:`${t("transaction_mode")}: `,value:(g=a==null?void 0:a.oneExpense)==null?void 0:g.expenseAccount,customFormInput:{fontWeight:"500"}}),e.jsx(U,{label:`${t("description")}: `,value:(p=a==null?void 0:a.oneExpense)==null?void 0:p.expenseDesc,customFormInput:{fontWeight:"500"}}),e.jsx(U,{label:`${t("day_date")}: `,value:f((j=a==null?void 0:a.oneExpense)==null?void 0:j.createdAt).format("MMMM D, YYYY"),customFormInput:{fontWeight:"500"}}),(b=a==null?void 0:a.oneExpense)!=null&&b.expenseAck?e.jsx(se,{label:`${t("acknowlegement")}: `,value:{key:(_=a==null?void 0:a.oneExpense)==null?void 0:_.expenseAck},customFormInput:{fontWeight:"500"}}):null]})]})})},ue=({onClose:s,fid:c})=>{var o;const{t}=C(),[a,i]=h.useState({expenseAmount:"",expensePaid:"",expenseDesc:"",expenseAccount:"By Bank"}),[m,u]=h.useState(""),[v,x]=h.useState(!1),[g,p]=h.useState(!1),[j,b]=h.useState(""),[_,l]=h.useState(""),[T]=D(),N=r=>{r.target.name==="expenseAmount"?i(d=>({...d,[r.target.name]:r.target.value})):i(d=>({...d,[r.target.name]:r.target.value}))},I=r=>{i(d=>({...d,expenseAccount:r}))},M=r=>{u(r.target.files[0])},k=()=>{let r=J(a,["expenseDesc"]);if(K(r)){if(c){x(y=>!y);const d=new FormData;d.append("expenseAmount",a.expenseAmount),j||d.append("expensePaid",a.expensePaid),d.append("expenseDesc",a.expenseDesc),d.append("expenseAccount",a.expenseAccount),d.append("file",m),T({fData:d,fid:c,is_inventory:"",user_query:j}).then(()=>{x(y=>!y),s()}).catch(()=>{x(y=>!y)})}}else l(r)},P=r=>{b(r==null?void 0:r._id),p(!1),i(d=>({...d,expensePaid:r==null?void 0:r.userLegalName}))},F=()=>{p(r=>!r)};return e.jsx(e.Fragment,{children:g?e.jsx(te,{onSelectUser:P,selectedId:j,onClose:F}):e.jsx(L,{onClose:s,children:e.jsxs("div",{className:n.modal_container,children:[e.jsx(S,{children:e.jsxs("div",{className:n.modal_container_outer_header,children:[e.jsx("div",{className:n.modal_container_header,children:e.jsx("h6",{children:t("add_expense_receipt")})}),e.jsx("img",{src:`${E}/close.svg`,alt:"close icon",onClick:s})]})}),e.jsx(W,{customStyleBorder:{marginBottom:"0"}}),e.jsxs(O,{children:[e.jsx(B,{label:"nominal_expenses",isActive:!0}),e.jsx(B,{label:"assets_inventory"})]}),e.jsxs(S,{customStyle:{paddingTop:"0"},children:[e.jsx(ne,{label:"select_transaction_mode",children:(o=de)==null?void 0:o.map(r=>e.jsx(ce,{tile:r,onTile:I,activeTile:a.expenseAccount},r==null?void 0:r.key))}),e.jsx(Q,{label:t("amount"),placeholder:t("amount_placeholder"),name:"expenseAmount",value:a.expenseAmount,type:"text",onChange:N,errorShow:_.expenseAmount}),e.jsx(ae,{label:t("paid_to"),placeholder:t("paid_to_placeholder"),name:"expensePaid",value:a.expensePaid,type:"text",onChange:N,errorShow:_.expensePaid,iconUrl:`${Y}/navbar-search.svg`,searchLabel:"search_and_select",onSearchAction:F}),e.jsx(le,{label:t("description"),placeholder:t("description_placeholder"),name:"expenseDesc",value:a.expenseDesc,type:"text",onChange:N,errorShow:_.expenseDesc}),e.jsx(oe,{label:t("acknowlegement_receipt"),name:"acknowlegement_receipt",value:m!=null&&m.name?{name:m==null?void 0:m.name}:"",onChange:M}),e.jsx(z,{label:"save_receipt",onAction:k})]}),v&&e.jsx(H,{})]})})})},Fe=({fid:s})=>{var P,F;const{t:c}=C(),[t,a]=h.useState(""),[i,m]=h.useState(1),[u,v]=h.useState(!0),[x,g]=q({skip:t}),[p,j]=h.useState(""),[b,_]=h.useState(!1),{financeExpense:l,financeExpenseLoading:T}=G({data:{fid:s,page:i,limit:10,search:t},skip:!s});h.useEffect(()=>{g&&u&&m(o=>o+1)},[g,u]),h.useEffect(()=>{var o;(o=l==null?void 0:l.allIncome)!=null&&o.length&&w(l==null?void 0:l.length,v)},[(P=l==null?void 0:l.allIncome)==null?void 0:P.length,w]);const N=h.useCallback(X(o=>a(o),500),[]),I=o=>{N(o.target.value)},M=()=>{j("")},k=()=>{_(o=>!o)};return e.jsxs(e.Fragment,{children:[e.jsxs(Z,{children:[e.jsx(S,{children:e.jsxs("div",{className:A.fm_header_container,children:[e.jsx("h6",{children:c("expense_history")}),e.jsx("div",{className:A.fm_search,children:e.jsx("section",{className:A.fm_search_container,children:e.jsxs("div",{className:A.fm_search_container_inner,children:[e.jsx("img",{className:A.fm_search_icon,alt:"search icon",src:`${Y}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:c("search"),onChange:I})]})})})]})}),e.jsx(W,{}),e.jsxs(S,{customStyle:{paddingTop:"0.2rem"},children:[e.jsxs("div",{className:A.fm_add_button,children:[e.jsx(me,{fid:s}),e.jsx(re,{label:"add_new_expense",onAction:k})]}),T&&e.jsx(ee,{}),(F=l==null?void 0:l.allIncome)==null?void 0:F.map((o,r)=>{var d;return((d=l==null?void 0:l.allIncome)==null?void 0:d.length)===r+1?e.jsx("div",{ref:x,children:e.jsx($,{expense:o,setExpenseId:j})},o==null?void 0:o._id):e.jsx($,{expense:o,setExpenseId:j},o==null?void 0:o._id)})]})]}),p&&e.jsx(he,{onClose:M,expenseId:p}),b&&e.jsx(ue,{onClose:k,fid:s})]})};export{Fe as default};
