import{j as t,a1 as h,k as L,r as f,S as N,u as S,R as b,_ as w}from"./index-0ca76035.js";import{G as m}from"./institute-staff-student-api-7114d611.js";import{U as D}from"./UniversalTab-73e7f63a.js";import{B as T}from"./BorderBottom-1dc6f53e.js";import{C as $}from"./CustomSuspense-25f8db15.js";const E="_complaints_m7dvb_1",A="_complaintList_m7dvb_8",R="_complaintDetail_m7dvb_14",l={complaints:E,complaintList:A,complaintDetail:R},k="_complaintList_12ayx_1",H="_listHead_12ayx_12",M="_tabs_12ayx_16",g={complaintList:k,listHead:H,tabs:M};const U="_list_1gwig_1",B="_item_1gwig_6",F="_datetime_1gwig_16",O="_item_active_1gwig_45",x={list:U,item:B,datetime:F,item_active:O},y=({setShowDetails:u,setOnComplaintId:n,complaint:s,onComplaintId:d})=>{var _,e,o,r;return t.jsxs("div",{className:(d==null?void 0:d.cid)===(s==null?void 0:s._id)?`${x.item} ${x.item_active}`:x.item,onClick:()=>{var a,c,v,i;n({cid:s==null?void 0:s._id,name:(s==null?void 0:s.complaintType)==="Anonymous"?"Anonymous":`${(a=s==null?void 0:s.staff)==null?void 0:a.staffFirstName} ${(c=s==null?void 0:s.staff)!=null&&c.staffMiddleName?(v=s==null?void 0:s.staff)==null?void 0:v.staffMiddleName:""} ${(i=s==null?void 0:s.staff)==null?void 0:i.staffLastName}`}),u(!0)},children:[t.jsx("img",{src:"/images/complainIcon.svg",alt:"complant icon"}),t.jsxs("div",{children:[t.jsx("h6",{children:(s==null?void 0:s.complaintType)==="Anonymous"?"Anonymous":`${(_=s==null?void 0:s.staff)==null?void 0:_.staffFirstName} ${(e=s==null?void 0:s.staff)!=null&&e.staffMiddleName?(o=s==null?void 0:s.staff)==null?void 0:o.staffMiddleName:""} ${(r=s==null?void 0:s.staff)==null?void 0:r.staffLastName}`}),t.jsxs("div",{className:x.datetime,children:[t.jsxs("p",{children:[h(s==null?void 0:s.createdAt).format("LL"),","]}),t.jsx("p",{children:h(s==null?void 0:s.createdAt).format("LT")})]})]})]})};function P({setOnComplaintId:u,setShowDetails:n,onComplaintId:s,refetchStatus:d,setRefetchStatus:_}){var v;const e=L(i=>i.idChange),[o,r]=f.useState(!0),{staffComplaintList:a,staffComplaintListRefetch:c}=m({data:{id:e==null?void 0:e.id,status:"Unsolved"},skip:!(e!=null&&e.id)});return f.useEffect(()=>{(e!=null&&e.id||d.unsolved)&&(r(!0),c(),_(i=>({...i,unsolved:!1})))},[e==null?void 0:e.id,d.unsolved,c]),f.useEffect(()=>{a!=null&&a.complaints&&r(!1)},[a==null?void 0:a.complaints]),f.useEffect(()=>{setTimeout(()=>r(!1),2e3)},[]),t.jsxs("div",{className:x.list,children:[(v=a==null?void 0:a.complaints)==null?void 0:v.map((i,j)=>t.jsx(y,{setShowDetails:n,setOnComplaintId:u,complaint:i,onComplaintId:s},j)),o&&t.jsx(N,{})]})}function z({setOnComplaintId:u,setShowDetails:n,onComplaintId:s,refetchStatus:d,setRefetchStatus:_}){var v;const e=L(i=>i.idChange),[o,r]=f.useState(!0),{staffComplaintList:a,staffComplaintListRefetch:c}=m({data:{id:e==null?void 0:e.id,status:"Solved"},skip:!(e!=null&&e.id)});return f.useEffect(()=>{(e!=null&&e.id||d.solved)&&(r(!0),c(),_(i=>({...i,solved:!1})))},[e==null?void 0:e.id,d.solved,c]),f.useEffect(()=>{a!=null&&a.complaints&&r(!1)},[a==null?void 0:a.complaints]),f.useEffect(()=>{setTimeout(()=>r(!1),2e3)},[]),t.jsxs("div",{className:x.list,children:[(v=a==null?void 0:a.complaints)==null?void 0:v.map((i,j)=>t.jsx(y,{setShowDetails:n,setOnComplaintId:u,complaint:i,onComplaintId:s},j)),o&&t.jsx(N,{})]})}function G({setOnComplaintId:u,setShowDetails:n,onComplaintId:s,refetchStatus:d,setRefetchStatus:_}){const{t:e}=S(),[o,r]=f.useState(0),a=[{name:e("unsolved"),id:0},{name:e("solved"),id:1}];return t.jsx("div",{className:g.complaintList,children:t.jsxs("div",{className:g.listHead,children:[t.jsx(D,{tabList:a,activeIndexTab:o,setActiveIndexTab:r,customStyleTab:{width:"100%"}}),t.jsx(T,{customStyle:{width:"100%"}}),o===0&&t.jsx(P,{setShowDetails:n,setOnComplaintId:u,onComplaintId:s,setRefetchStatus:_,refetchStatus:d}),o===1&&t.jsx(z,{setShowDetails:n,setOnComplaintId:u,onComplaintId:s,setRefetchStatus:_,refetchStatus:d})]})})}const Q=b.lazy(()=>w(()=>import("./ComplaintDetails-c56417d2.js"),["assets/ComplaintDetails-c56417d2.js","assets/index-0ca76035.js","assets/index-4d24e8f6.css","assets/institute-staff-student-api-7114d611.js","assets/ComplaintDetails-a7195ac2.css"]));function K(){const[u,n]=f.useState(""),[s,d]=f.useState(!1),[_,e]=f.useState(!1);return t.jsxs("div",{className:l.complaints,children:[t.jsx("div",{className:l.complaintList,children:t.jsx(G,{setShowDetails:d,setOnComplaintId:n,onComplaintId:u,setRefetchStatus:e,refetchStatus:_})}),t.jsx("div",{className:l.complaintDetail,children:s&&t.jsx($,{children:t.jsx(Q,{setShowDetails:d,onComplaintId:u,setRefetchStatus:e})})})]})}export{K as default};
