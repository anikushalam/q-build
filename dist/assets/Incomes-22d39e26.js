import{u as R,k as O,oe as U,r as m,j as e,Q as q,R as V,a1 as $,of as P,t as Y,og as z,oh as G,v as J,S as W}from"./index-0ca76035.js";import{S as A}from"./SearchUniversalUser-b1b04b2c.js";import"./search-api-b192a53f.js";const K="_incomeForm_1jvue_1",X="_top_1jvue_8",Z="_mid_1jvue_12",B="_row_1jvue_16",Q="_input_1jvue_63",ee="_down_1jvue_85",se="_options_1jvue_91",te="_option_1jvue_91",ne="_aadhar_1jvue_141",ce="_btn_1jvue_167",ie="_row_search_1jvue_193",h={incomeForm:K,top:X,mid:Z,row:B,input:Q,down:ee,options:se,option:te,aadhar:ne,btn:ce,row_search:ie},oe={position:"relative",zIndex:1},ae={position:"absolute",right:"0",top:"2.2vw",zIndex:10},de={position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:10};function me({setIncomeData:s,open:d,onClose:a,incomeData:n,setIsOpen:l}){const{t:c}=R();return d?e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:a,style:de}),e.jsxs("div",{style:ae,className:h.options,children:[e.jsx("div",{className:h.option,onClick:()=>{s({...n,tMode:"By Cash"}),l(!1)},children:c("by_cash")}),e.jsx("div",{className:h.option,onClick:()=>{s({...n,tMode:"By Bank"}),l(!1)},children:c("by_bank")})]})]}):null}function re({onRefetchWhenCreateIncome:s,setViewIndex:d}){const{t:a}=R(),n=O(t=>t.financeChange),[l]=U(),[c,r]=m.useState(!1),[g,v]=m.useState(!1),[f,w]=m.useState(""),[b,N]=m.useState(!1),j=document.querySelector("textarea");j==null||j.addEventListener("keyup",t=>{j.style.height="auto";let _=t.target.scrollHeight;j.style.height=`${_}px`});const[u,I]=m.useState({tMode:""}),[k,S]=m.useState(""),C=t=>{S(()=>t.target.files[0])},[x,i]=m.useState({incomeFrom:"",incomeAmount:"",incomePurpose:"",incomeDesc:""}),L=t=>{w(t==null?void 0:t._id),v(!1),i(_=>({..._,incomeFrom:t==null?void 0:t.userLegalName}))},T=t=>{t.preventDefault(),N(y=>!y);const _=new FormData;_.append("incomeAmount",x.incomeAmount),f||_.append("incomeFrom",x.incomeFrom),_.append("incomeDesc",x.incomeDesc),_.append("incomeAccount",u.tMode),_.append("file",k),_&&l({fData:_,fid:n==null?void 0:n.fid,user_query:f}).then(y=>{y.data.status&&(s(),d(0),N(F=>!F))}).catch(()=>{N(y=>!y)})};return e.jsxs("div",{className:h.incomeForm,children:[e.jsx("div",{className:h.top,children:a("add_receipt")}),e.jsx("form",{onSubmit:T,children:e.jsxs("div",{className:h.mid,children:[e.jsxs("div",{className:h.row,children:[e.jsx("h6",{children:a("select_transaction_mode")}),e.jsxs("div",{className:h.input,style:oe,children:[e.jsxs("div",{children:[(u==null?void 0:u.tMode)!==""?e.jsx("h6",{onClick:()=>r(!0),children:u.tMode}):e.jsxs("h6",{onClick:()=>r(!0),children:[" ",a("please_select_transaction_mode")]}),e.jsx("img",{className:h.down,src:"/images/downn-icon.svg",alt:""})]}),e.jsx(me,{open:c,onClose:()=>r(!1),setIncomeData:I,incomeData:u,setIsOpen:r})]})]}),e.jsxs("div",{className:h.row,children:[e.jsx("h6",{children:a("amount")}),e.jsx("input",{type:"number",name:"incomeAmount",min:"1",placeholder:a("enter_amount"),value:x.incomeAmount,onChange:t=>i({...x,incomeAmount:t.target.value}),required:!0})]}),e.jsxs("div",{className:h.row,children:[e.jsxs("h6",{children:[a("from")," ",e.jsxs("span",{className:h.row_search,onClick:()=>v(!0),children:[e.jsx("img",{style:{width:"16px",height:"16px"},src:"/images/search-icon.svg",alt:"search icon"}),"Search & Select"]})]}),e.jsx("input",{type:"text",name:"incomeFrom",placeholder:a("enter_income_from"),value:x.incomeFrom,onChange:t=>{i({...x,incomeFrom:t.target.value}),w("")},required:!0})]}),e.jsxs("div",{className:h.row,children:[e.jsx("h6",{children:a("description")}),e.jsx("textarea",{className:h.postTextarea,type:"text",name:"incomeDesc",placeholder:a("description_details"),value:x.incomeDesc,onChange:t=>i({...x,incomeDesc:t.target.value})})]}),e.jsxs("div",{className:h.row,children:[e.jsx("h6",{children:a("ack_rcpt")}),e.jsx("input",{type:"file",className:h.aadhar,name:"file",onChange:C})]}),e.jsx("button",{type:"submit",className:h.btn,children:a("save_receipt")})]})}),g&&e.jsx(A,{onClose:()=>v(!1),title:"Search User",disabledId:f,assignHead:g,headSelect:L}),b&&e.jsx(q,{})]})}const he="_incomeContainer_1utwa_1",_e="_income_1utwa_1",le="_incomeLeft_1utwa_12",ue="_incomeRight_1utwa_16",xe="_incomeLeftt_1utwa_21",je="_itemsContainer_1utwa_25",ve="_rcv_1utwa_30",fe="_text_1utwa_42",ge="_btn_sticky_1utwa_52",we="_btn_1utwa_52",Ne="_history_1utwa_68",be="_incomeRightt_1utwa_78",Ie="_incomeTop_1utwa_82",Se="_right_1utwa_94",Ce="_rightHead_1utwa_102",ye="_rightBody_1utwa_126",pe="_detail_1utwa_159",Le="_detailTop_1utwa_163",Re="_detailTopLeft_1utwa_173",ke="_detailTopMid_1utwa_189",Te="_visibility_1utwa_215",Fe="_detailTopRight_1utwa_219",Ee="_detailContent_1utwa_234",Me="_imagediv_1utwa_265",Oe="_backh_1utwa_286",Ve="_invoice_number_1utwa_299",$e="_card_container_1utwa_311",De="_sidebarheader_1utwa_322",o={incomeContainer:he,income:_e,incomeLeft:le,incomeRight:ue,incomeLeftt:xe,itemsContainer:je,rcv:ve,text:fe,btn_sticky:ge,btn:we,history:Ne,incomeRightt:be,incomeTop:Ie,right:Se,rightHead:Ce,rightBody:ye,detail:pe,detailTop:Le,detailTopLeft:Re,detailTopMid:ke,visibility:Te,detailTopRight:Fe,detailContent:Ee,imagediv:Me,backh:Oe,invoice_number:Ve,card_container:$e,sidebarheader:De};function M({income:s,setDetailView:d,setIncomeId:a,all:n}){var c;const{t:l}=R();return e.jsxs("div",{onClick:()=>{d(!0),a(s)},className:o.card_container,children:[e.jsxs("h6",{className:o.invoice_number,children:["Invoice No: ",n==null?void 0:n.invoice_number]}),e.jsxs("div",{className:o.sidebarheader,children:[e.jsxs("div",{className:o.text,children:[e.jsx("p",{className:o.rcv,children:l("recived_from")}),e.jsx("h6",{children:n!=null&&n.incomeFrom?n==null?void 0:n.incomeFrom:(c=n==null?void 0:n.incomeFromUser)==null?void 0:c.userLegalName}),e.jsx("p",{className:o.rcv,children:$(n==null?void 0:n.createdAt).format("LL")})]}),e.jsxs("div",{className:o.text,children:[e.jsx("p",{className:o.rcv1}),e.jsxs("h6",{children:["Rs. ",n==null?void 0:n.incomeAmount]}),e.jsx("p",{className:o.rcv,children:n==null?void 0:n.incomeAccount})]})]})]})}const He=V.forwardRef((s,d)=>{var a;return e.jsxs("div",{className:o.incomeLeftt,children:[!(s!=null&&s.fId)&&e.jsx("div",{className:`${o.btn} ${o.btn_sticky}`,onClick:s==null?void 0:s.viewForm,children:e.jsx("img",{src:"/images/addplus.svg",alt:""})}),e.jsx("div",{className:o.itemsContainer,children:(a=s==null?void 0:s.allIncome)==null?void 0:a.map((n,l)=>{var c;return((c=s==null?void 0:s.allIncome)==null?void 0:c.length)===l+1?e.jsx("div",{ref:d,children:e.jsx(M,{setDetailView:s==null?void 0:s.setDetailView,setIncomeId:s==null?void 0:s.setIncomeId,all:n})},l):e.jsx(M,{income:`${n==null?void 0:n._id}`,setDetailView:s==null?void 0:s.setDetailView,setIncomeId:s==null?void 0:s.setIncomeId,all:n},l)})})]})});function Ue({detailview:s,iBalance:d,incomeId:a,setIncomeId:n,setDetailView:l}){var g,v,f,w,b,N,j,u,I;const{data:c}=P(`${a}`,{skip:!a}),{t:r}=R();return e.jsx(e.Fragment,{children:e.jsx("div",{className:o.incomeRightt,children:s?e.jsxs("div",{className:o.detail,children:[e.jsxs("div",{className:o.detailTop,children:[e.jsx("div",{className:o.detailTopLeft,children:e.jsx("h6",{onClick:()=>l(!1),children:r("back")})}),e.jsx("div",{className:o.detailTopMid,children:e.jsx("h6",{children:(g=c==null?void 0:c.oneIncome)!=null&&g.incomeFrom?(v=c==null?void 0:c.oneIncome)==null?void 0:v.incomeFrom:(w=(f=c==null?void 0:c.oneIncome)==null?void 0:f.incomeFromUser)==null?void 0:w.userLegalName})}),e.jsx("div",{className:o.detailTopRight,children:e.jsxs("h6",{children:["Rs. ",(b=c==null?void 0:c.oneIncome)==null?void 0:b.incomeAmount]})})]}),e.jsxs("div",{className:o.detailContent,children:[e.jsx("p",{children:r("transaction_mode")}),e.jsxs("h6",{children:[(N=c==null?void 0:c.oneIncome)==null?void 0:N.incomeAccount," ",r("payment")," "]})]}),e.jsxs("div",{className:o.detailContent,children:[e.jsx("p",{children:r("reason")}),e.jsx("h6",{children:(j=c==null?void 0:c.oneIncome)==null?void 0:j.incomePurpose})]}),e.jsxs("div",{className:o.detailContent,children:[e.jsx("p",{children:r("description")}),e.jsx("h6",{children:(u=c==null?void 0:c.oneIncome)==null?void 0:u.incomeDesc})]}),e.jsxs("div",{className:o.detailContent,children:[e.jsx("p",{children:r("day_date")}),e.jsx("h6",{children:$((I=c==null?void 0:c.oneIncome)==null?void 0:I.createdAt).format("LL")})]}),e.jsxs("div",{className:o.detailContent,children:[e.jsx("p",{children:r("acknowlegement")}),e.jsxs("div",{className:o.imagediv,children:[e.jsx("img",{src:"/images/image-icon.svg",alt:""}),e.jsx("p",{children:"img07.png"})]})]})]}):e.jsxs("div",{className:o.right,children:[e.jsxs("div",{className:o.rightHead,children:[e.jsx("h6",{children:r("total_income")}),e.jsxs("h6",{children:["Rs."," ",(d==null?void 0:d.financeIncomeCashBalance)+(d==null?void 0:d.financeIncomeBankBalance)]})]}),e.jsxs("div",{className:o.rightBody,children:[e.jsxs("h6",{children:[" ",r("by_cash")," : Rs. ",d==null?void 0:d.financeIncomeCashBalance]}),e.jsxs("h6",{children:[" ",r("by_bank")," : Rs. ",d==null?void 0:d.financeIncomeBankBalance]})]})]})})})}function ze({fId:s}){const{t:d}=R(),[a,n]=m.useState(0),[l,c]=m.useState(!1),[r,g]=m.useState(""),[v,f]=m.useState(1),[w,b]=m.useState(!0),[N,j]=Y(),[u,I]=V.useState([]),[k,S]=m.useState(!0),[C,x]=m.useState(!1),i=O(p=>p.financeChange),{data:L,refetch:T}=z(`${i!=null&&i.fid?i==null?void 0:i.fid:s}`),{data:t,refetch:_}=G({fid:`${i!=null&&i.fid?i==null?void 0:i.fid:s}`,page:v,limit:10},{skip:i!=null&&i.fid?!(i!=null&&i.fid):!s}),{scrollToTop:y}=J();m.useEffect(()=>{y()},[]),m.useEffect(()=>{j&&w&&f(p=>p+1)},[j,w]),m.useEffect(()=>{C&&f(1)},[C]),m.useEffect(()=>{(s||i!=null&&i.fid)&&(S(!0),_())},[v,s,i==null?void 0:i.fid,_]),m.useEffect(()=>{C&&(i!=null&&i.fid)&&(S(!0),_())},[C,i==null?void 0:i.fid,_]),m.useEffect(()=>{var p,E;if(C)I(t==null?void 0:t.allIncome),x(!1),S(!1);else if(t!=null&&t.allIncome){const D=[...u,...t==null?void 0:t.allIncome],H=[...new Set(D.map(JSON.stringify))].map(JSON.parse);I(H),S(!1)}else((p=t==null?void 0:t.allIncome)==null?void 0:p.length)===0&&S(!1);((E=t==null?void 0:t.allIncome)==null?void 0:E.length)===10?b(!0):b(!1)},[t==null?void 0:t.allIncome]);const F=()=>{x(!0),T()};return e.jsxs(e.Fragment,{children:[a===1&&e.jsx("div",{className:o.income,children:e.jsx(re,{setViewIndex:n,onRefetchWhenCreateIncome:F})}),a===0&&e.jsxs("div",{className:o.incomeContainer,children:[e.jsx("div",{className:o.incomeTop,children:e.jsx("div",{className:o.history,children:d("income_history")})}),e.jsxs("div",{className:o.income,children:[e.jsxs("div",{className:o.incomeLeft,children:[e.jsx(He,{viewForm:()=>n(1),setDetailView:c,allIncome:u,setIncomeId:g,fId:s,ref:N}),k&&e.jsx(W,{})]}),e.jsx("div",{className:o.incomeRight,children:e.jsx(Ue,{detailview:l,iBalance:L==null?void 0:L.incomeBalance,incomeId:r,setIncomeId:g,setDetailView:c})})]})]})]})}export{ze as default};
