import{u as L,r as a,t as A,j as e,S as J}from"./index-0ca76035.js";import{s as n}from"./FeesStructure.module-7a88fbbc.js";import{P as M}from"./PopupWrapper-2578092d.js";import{i as V}from"./finance-api-e818490b.js";import{B as b}from"./BorderBottom-1dc6f53e.js";const X=({onClose:o,departmentId:r,classMasterId:P,batchId:D,onSelectedStudent:x,onSelectedStrucutre:c,asOpen:l})=>{var I;const{t:i}=L(),[p,v]=a.useState(!1),[B,j]=A(),[N,C]=a.useState(1),[u,T]=a.useState(!0),[R,O]=a.useState(!1),[U,d]=a.useState(!0),[m,S]=a.useState([]),[_,W]=a.useState(""),{getAllFeesStructure:t,getAllFeesStructureRefetch:E}=V({data:{did:r,filterBy:P,page:N,limit:10,batch_by:D??""},skip:!r});a.useEffect(()=>{r&&(d(!0),E())},[r,N,E]),a.useEffect(()=>{j&&u&&C(s=>s+1)},[j,u]),a.useEffect(()=>{var s,f;R?(S(h=>[...new Set([...t==null?void 0:t.all_structures,...h].map(JSON.stringify))].map(JSON.parse)),d(!1),O(!1)):t!=null&&t.all_structures?(S(h=>[...new Set([...h,...t==null?void 0:t.all_structures].map(JSON.stringify))].map(JSON.parse)),d(!1)):((s=t==null?void 0:t.all_structures)==null?void 0:s.length)===0&&d(!1),((f=t==null?void 0:t.all_structures)==null?void 0:f.length)===10?T(!0):T(!1)},[t==null?void 0:t.all_structures]);const k=()=>{x(_==null?void 0:_._id),o()},w=s=>{l==="STUDENT_JOINING_FORM"?(x(s),o()):l==="ADMISSION_APPLICATION_WISE"?(c(s),o()):l==="ADMISSION_APPLICATION"?c(s):l==="STUDENT_VIEW_STRUCTURE"?c(s==null?void 0:s._id):(v(f=>!f),W(s))};return e.jsx(M,{onClose:o,children:e.jsxs("div",{className:n.add_category_modal,style:p?{width:"30rem",minHeight:"10rem",height:"fit-content"}:{width:"40rem",minHeight:"10rem",maxHeight:"35rem",overflowY:"auto",overflowX:"hidden",scrollBehavior:"smooth"},children:[p?e.jsxs("section",{className:n.fee_middle_section_container,style:{marginBottom:"1.2rem"},children:[e.jsx("h6",{children:i("fee_structure")}),e.jsx(b,{customStyle:{width:"100%",marginTop:"0.7rem"}}),e.jsxs("div",{className:n.fee_middle_section,children:[e.jsx("p",{children:i("fee_structure_of_student_is")}),e.jsx("h6",{children:(I=_==null?void 0:_.category_master)==null?void 0:I.category_name}),e.jsxs("p",{children:[" ",i("total_admission_fees")," "," : "," ",i("rs")," ",e.jsx("span",{style:{fontWeight:"600"},children:(_==null?void 0:_.total_admission_fees)??0})]}),e.jsxs("p",{children:[i("applicable_fees_amount")," "," : "," ",i("rs")," ",e.jsx("span",{style:{fontWeight:"600"},children:(_==null?void 0:_.applicable_fees)??0})]})]}),e.jsx("button",{onClick:k,className:n.fee_middle_confirm_button,children:i("confirm")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:n.add_category_modal_title_left,style:{marginBottom:"1.2rem"},children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:o,alt:"back arrow"}),e.jsx("h6",{children:i(l==="SELECTED_TAB"||l==="ADMISSION_APPLICATION_WISE"?"edit_fee_structure":l==="ADMISSION_APPLICATION"?"select_fee_structure_for_application":l==="STUDENT_VIEW_STRUCTURE"?"admission_fees":"select_fee_structure_of_student")})]}),e.jsx(b,{customStyle:{width:"100%",marginTop:"-0.5rem",marginBottom:"1rem"}}),m==null?void 0:m.map((s,f)=>(m==null?void 0:m.length)===f+1?e.jsxs("div",{className:`${n.fees_card} ${n.fees_card_hover}`,ref:B,onClick:()=>w(s),children:[e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),e.jsxs("div",{className:n.fees_card_text,children:[e.jsx("h6",{children:(s==null?void 0:s.unique_structure_name)??""}),e.jsxs("div",{className:n.fees_card_text_bottom,style:{marginTop:"0.3rem"},children:[e.jsxs("h6",{children:[i("applicable_fees_only")," ",i("rs"),".",(s==null?void 0:s.applicable_fees)??0]}),e.jsxs("h6",{children:[i("total_admission_fees")," "," : "," ",i("rs"),".",(s==null?void 0:s.total_admission_fees)??0]})]})]})]},s==null?void 0:s._id):e.jsxs("div",{className:`${n.fees_card} ${n.fees_card_hover}`,onClick:()=>w(s),children:[e.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),e.jsxs("div",{className:n.fees_card_text,children:[e.jsx("h6",{children:(s==null?void 0:s.unique_structure_name)??""}),e.jsxs("div",{className:n.fees_card_text_bottom,style:{marginTop:"0.3rem"},children:[e.jsxs("h6",{children:[i("applicable_fees_only")," ",i("rs"),".",(s==null?void 0:s.applicable_fees)??0]}),e.jsxs("h6",{children:[i("total_admission_fees")," "," : "," ",i("rs"),".",(s==null?void 0:s.total_admission_fees)??0]})]})]})]},s==null?void 0:s._id))]}),U&&e.jsx(J,{})]})})};export{X as S};
