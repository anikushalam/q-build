import{j as e,e as k,r as o,u as T,t as O,k as I,g as U,q as V,bS as p}from"./index-0ca76035.js";import{g as F,h as H}from"./post-api-b04eb54b.js";import{f as z}from"./index-c08ef366.js";import{i as R}from"./constant_value-4cd2b3e0.js";import{A as B}from"./Avatar-e65c49d9.js";import"./Avatar.module-fb7ee634.js";const D="_eachComment_18ld4_1",G="_imgcontainer_18ld4_9",J="_commentText_18ld4_21",K="_likeReply_18ld4_39",L="_eachCommentContainer_18ld4_52",M="_dots_18ld4_56",Q="_time_18ld4_62",c={eachComment:D,imgcontainer:G,commentText:J,likeReply:K,eachCommentContainer:L,dots:M,time:Q};function $({comment:t}){return e.jsxs("div",{className:c.eachCommentContainer,children:[e.jsxs("div",{className:c.eachComment,children:[e.jsx("div",{className:c.imgcontainer,children:e.jsx("img",{src:(t==null?void 0:t.authorPhotoId)!=="1"?`${k}/${t.authorProfilePhoto}`:"/images/dummy-avatar-icon.svg",alt:""})}),e.jsxs("div",{className:c.commentText,children:[e.jsx("h6",{children:t==null?void 0:t.authorUserName}),e.jsx("p",{children:t==null?void 0:t.repliedComment})]})]}),e.jsx("div",{className:c.dots,children:e.jsx("p",{className:c.time,children:z(t==null?void 0:t.createdAt)})})]})}const W="_eachComment_ch70q_1",X="_addComment_ch70q_5",Y="_imgcontainer_ch70q_13",Z="_inputContainer_ch70q_24",ee="_hr_ch70q_32",te="_icons_ch70q_51",se="_btn_ch70q_63",i={eachComment:W,addComment:X,imgcontainer:Y,inputContainer:Z,hr:ee,icons:te,btn:se};function me({pcid:t,pid:E}){var y,N;const[C,S]=o.useState(1),{t:f}=T(),[P,x]=O(),[d,g]=o.useState(!0),h=o.useRef(""),n=I(s=>s.idChange),_=I(s=>s.postChange.replyComments),l=U(),{allReplyComment:a,allReplyCommentRefetch:j}=F({data:{pcid:t||"",page:C,limit:10,viewAs:R},skip:!1}),[b]=H(),{oneInstituteDashboard:r,oneInstituteDashboardRefetch:v}=V({id:n==null?void 0:n.id,skip:!(n!=null&&n.id)});o.useEffect(()=>{n!=null&&n.id&&v()},[n==null?void 0:n.id,v]),o.useEffect(()=>{x&&d&&S(s=>s+1)},[x,d]),o.useEffect(()=>{j()},[C,j,d]),o.useEffect(()=>{var s;a!=null&&a.replyComment&&l(p.addReplyComment({commentId:t,reply:a==null?void 0:a.replyComment})),((s=a==null?void 0:a.replyComment)==null?void 0:s.length)===10?g(!0):g(!1)},[a==null?void 0:a.replyComment,l,t]);const w=()=>{l(p.addReplyCommentCount({commentId:t,postId:E})),b({replyComment:{comment:h.current.value,uid:n.id},pcid:t,viewAs:R}).then(s=>{var m;l(p.addReplyCreatedComment({commentId:t,reply:(m=s.data)==null?void 0:m.childReplyComment}))}).catch({}),h.current.value=""};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:i.eachComment,children:[e.jsxs("div",{className:i.addComment,children:[e.jsxs("div",{className:i.imgcontainer,children:[e.jsx(B,{dynamicImage:((y=r==null?void 0:r.institute)==null?void 0:y.photoId)!=="1"?`${k}/${(N=r==null?void 0:r.institute)==null?void 0:N.insProfilePhoto}`:"/images/ins_default_profile.svg"})," "]}),e.jsxs("div",{className:i.inputContainer,children:[e.jsx("input",{type:"text",ref:h,placeholder:f("add_a_reply"),className:`form-control ${i.searchinput}`}),e.jsxs("div",{className:i.icons,children:[e.jsx("img",{src:"/images/img-icon.svg",alt:""}),e.jsx("img",{src:"/images/emoji-icon.svg",alt:""})]})]})]}),e.jsx("div",{className:i.btn,onClick:w,children:f("reply")})]}),_==null?void 0:_.map(s=>{var m;return s.commentId===t?(m=s==null?void 0:s.reply)==null?void 0:m.map((q,u)=>{var A;return((A=s==null?void 0:s.reply)==null?void 0:A.length)===u+1?e.jsxs("div",{className:i.eachComment,ref:P,children:[e.jsx($,{comment:q}),e.jsx("hr",{})]},u):e.jsxs("div",{className:i.eachComment,children:[e.jsx($,{comment:q}),e.jsx("hr",{})]},u)}):""})]})}export{me as default};
