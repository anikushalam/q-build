import{n as Q,j as e,e as k,L as V,u as q,r as m,Q as A,t as H,l as G,S as z}from"./index-0ca76035.js";import{ac as K,c as X}from"./hostel-api-9294ced1.js";import{s as $}from"./InstituteHostel.module-b6b254cc.js";import{S as Y,I as Z,b as t}from"./UnitRoomInfo-8df0e6b1.js";import{s as o}from"./Hostel.module-50da11fe.js";import{B as h}from"./BorderBottom-1dc6f53e.js";import M from"./AssignStaffModal-e51a4441.js";import{J as U}from"./JoinFormInput-82706177.js";import{P as aa}from"./PopupWrapper-2578092d.js";import{s as y}from"./HostelFeeStructure.module-5a40a31e.js";const P=({hostelUnit:a,carryParentState:f,viewAs:s,callApi:S,pageOpenAs:T})=>{var E,u,l,i,g,p,c,b,v,I,N,j;const w=Q();return e.jsx(e.Fragment,{children:s==="STUDENT"?e.jsx(Y,{carryParentState:{...f,huid:a==null?void 0:a._id},activeTab:"unit&n=menu&n=room",children:e.jsxs("div",{className:$.hostel_warden_card,children:[e.jsx("img",{src:a!=null&&a.hostel_unit_photo?`${k}/${a==null?void 0:a.hostel_unit_photo}`:"/images/member_tab/class/default_avatar.svg",alt:""}),e.jsxs("div",{className:$.warden_card_text,children:[e.jsx("h6",{children:(a==null?void 0:a.hostel_unit_name)??""}),e.jsx("p",{children:`${((E=a==null?void 0:a.hostel_unit_head)==null?void 0:E.staffFirstName)??""} ${((u=a==null?void 0:a.hostel_unit_head)==null?void 0:u.staffMiddleName)??""} ${((l=a==null?void 0:a.hostel_unit_head)==null?void 0:l.staffLastName)??""}`})]})]})}):s==="HOSTEL_SEARCH"?e.jsx(V,{to:`/q/${w.username}/hostel/profile?a=unit&n=menu&n=room`,state:{...f,huid:a==null?void 0:a._id},children:e.jsxs("div",{className:$.hostel_warden_card,children:[e.jsx("img",{src:a!=null&&a.hostel_unit_photo?`${k}/${a==null?void 0:a.hostel_unit_photo}`:"/images/member_tab/class/default_avatar.svg",alt:""}),e.jsxs("div",{className:$.warden_card_text,children:[e.jsx("h6",{children:(a==null?void 0:a.hostel_unit_name)??""}),e.jsx("p",{children:`${((i=a==null?void 0:a.hostel_unit_head)==null?void 0:i.staffFirstName)??""} ${((g=a==null?void 0:a.hostel_unit_head)==null?void 0:g.staffMiddleName)??""} ${((p=a==null?void 0:a.hostel_unit_head)==null?void 0:p.staffLastName)??""}`})]})]})}):T==="INSTITUTE"?e.jsx(Z,{carryParentState:{...f,huid:a==null?void 0:a._id,unitName:a==null?void 0:a.hostel_unit_name},activeTab:s==="RENEWAL"?"request&renewal&application":"unit&n=info",children:e.jsxs("div",{className:$.hostel_warden_card,children:[e.jsx("img",{src:a!=null&&a.hostel_unit_photo?`${k}/${a==null?void 0:a.hostel_unit_photo}`:"/images/member_tab/class/default_avatar.svg",alt:""}),e.jsxs("div",{className:$.warden_card_text,children:[e.jsx("h6",{children:(a==null?void 0:a.hostel_unit_name)??""}),e.jsx("p",{children:`${((c=a==null?void 0:a.hostel_unit_head)==null?void 0:c.staffFirstName)??""} ${((b=a==null?void 0:a.hostel_unit_head)==null?void 0:b.staffMiddleName)??""} ${((v=a==null?void 0:a.hostel_unit_head)==null?void 0:v.staffLastName)??""}`})]})]})}):e.jsx(t,{carryParentState:{...f,huid:a==null?void 0:a._id,unitName:a==null?void 0:a.hostel_unit_name},activeTab:s==="RENEWAL"?"request&renewal&application":"unit&n=info",callApi:S,children:e.jsxs("div",{className:$.hostel_warden_card,children:[e.jsx("img",{src:a!=null&&a.hostel_unit_photo?`${k}/${a==null?void 0:a.hostel_unit_photo}`:"/images/member_tab/class/default_avatar.svg",alt:""}),e.jsxs("div",{className:$.warden_card_text,children:[e.jsx("h6",{children:(a==null?void 0:a.hostel_unit_name)??""}),e.jsx("p",{children:`${((I=a==null?void 0:a.hostel_unit_head)==null?void 0:I.staffFirstName)??""} ${((N=a==null?void 0:a.hostel_unit_head)==null?void 0:N.staffMiddleName)??""} ${((j=a==null?void 0:a.hostel_unit_head)==null?void 0:j.staffLastName)??""}`})]})]})})})},ea=({onClose:a,openAs:f,openUnitMenu:s,hid:S,onEdit:T,instituteId:w,onRefetch:E})=>{const{t:u}=q(),[l,i]=m.useState({hostel_unit_name:f==="EDIT"?s==null?void 0:s.hostel_unit_name:"",sid:f==="EDIT"?s==null?void 0:s.sid:""}),[g,p]=m.useState(!1),[c,b]=m.useState(""),[v,I]=m.useState(""),[N,j]=m.useState(!1),[C]=K();m.useEffect(()=>{f==="EDIT"&&i({hostel_unit_name:s==null?void 0:s.hostel_unit_name,sid:s==null?void 0:s.sid})},[f]);const D=_=>{b(_),i(r=>({...r,sid:_==null?void 0:_._id})),p(r=>!r)},F=_=>{const r={};for(let x in _)_[x]||(r[x]=`${x} is required!`);return r},R=()=>{const _=F(l);let r=!1;for(let x in _)if(x){r=!0;break}r?I(_):f==="EDIT"?T(l):(j(x=>!x),C({hid:S,addHostel:l}).then(()=>{E(),a(),j(x=>!x)}).catch({}))};return e.jsxs(aa,{onClose:a,children:[e.jsxs("div",{className:y.add_category_modal,children:[e.jsxs("div",{className:y.add_category_modal_title,children:[e.jsx("h6",{children:u(f==="EDIT"?"edit_fee_head":"add_new_unit")}),e.jsx("img",{src:"/images/close-post-icon.svg",onClick:a,alt:""})]}),e.jsx(U,{labelText:u("hoste_unit_name"),placeholder:u("hoste_unit_name_placeholder"),name:"hostel_unit_name",value:l==null?void 0:l.hostel_unit_name,type:"text",onChange:_=>i(r=>({...r,hostel_unit_name:_.target.value})),errorShow:v.hostel_unit_name}),e.jsxs("div",{className:y.leading_person_container,onClick:()=>p(!0),children:[e.jsx("img",{src:c!=null&&c.staffProfilePhoto?`${k}/${c.staffProfilePhoto}`:"/images/user-icon.svg",alt:"avatar"}),e.jsxs("div",{className:y.leading_person_text,children:[e.jsx("h6",{children:c?`${(c==null?void 0:c.staffFirstName)??""} 
                  ${(c==null?void 0:c.staffMiddleName)??""}
                  ${(c==null?void 0:c.staffLastName)??""} `:u("secect_hostel_unit_head")}),e.jsxs("p",{children:[u("search_joined_list")," ",v.sid&&e.jsxs("span",{style:{color:"red",marginLeft:"15px"},children:["* ",u("form_require_label")]})]})]})]}),e.jsx("button",{className:y.set_fees_structure_btn,title:"Add Hostel Unit",onClick:R,style:{justifyContent:"center"},children:u(f==="EDIT"?"update":"create")}),N&&e.jsx(A,{})]}),g&&e.jsx(M,{assignHead:g,headSelect:D,title:u("secect_hostel_unit_head"),onClose:()=>p(_=>!_),viewAs:"ADMISSION_ADMIN",instituteId:w})]})},la=({hid:a,instituteId:f,carryParentState:s,viewAs:S,callApi:T,pageOpenAs:w})=>{const{t:E}=q(),[u,l]=m.useState(!1),[i,g]=H(),[p,c]=m.useState(1),[b,v]=m.useState(!0),[I,N]=m.useState(!0),[j,C]=m.useState([]),[D,F]=m.useState(""),[R,_]=m.useState(!1),{getHostelUnitList:r,getHostelUnitListRefetch:x}=X({data:{hid:a,page:p,limit:10,search:D},skip:!a});m.useEffect(()=>{a&&(N(!0),x())},[a,p,D,x]),m.useEffect(()=>{g&&b&&c(d=>d+1)},[g,b]),m.useEffect(()=>{var d,n;R?(C(r==null?void 0:r.all_units),N(!1),_(!1)):D?(C(r==null?void 0:r.all_units),N(!1)):r!=null&&r.all_units?(C(O=>[...new Set([...O,...r==null?void 0:r.all_units].map(JSON.stringify))].map(JSON.parse)),N(!1)):((d=r==null?void 0:r.all_units)==null?void 0:d.length)===0&&N(!1),((n=r==null?void 0:r.all_units)==null?void 0:n.length)===10?v(!0):v(!1)},[r==null?void 0:r.all_units]);const W=m.useCallback(G.debounce(d=>F(d),500),[]),B=d=>{W(d.target.value)},L=()=>{l(d=>!d)},J=()=>{c(1),_(!0),N(!0),x()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:o.with_search,children:[e.jsx("h6",{children:E("hostel_units")}),e.jsx("section",{className:o.search_container,children:e.jsxs("div",{className:o.search_container_input,children:[e.jsx("img",{className:o.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search hostel units...",onChange:B})]})})]}),e.jsx(h,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),S==="STUDENT"||S==="HOSTEL_SEARCH"||S==="RENEWAL"?"":e.jsx("p",{className:o.add_new_category,onClick:L,children:E("create_new_unit")}),j==null?void 0:j.map((d,n)=>(j==null?void 0:j.length)===n+1?e.jsx("div",{ref:i,children:e.jsx(P,{hostelUnit:d,carryParentState:s,viewAs:S,callApi:T,pageOpenAs:w})},d==null?void 0:d._id):e.jsx(P,{hostelUnit:d,carryParentState:s,viewAs:S,callApi:T,pageOpenAs:w},d==null?void 0:d._id)),I&&e.jsx(z,{}),u&&e.jsx(ea,{onClose:L,hid:a,instituteId:f,onRefetch:J})]})};export{la as H};
