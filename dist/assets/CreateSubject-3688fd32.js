import{u as Be,r,o7 as Le,ni as Re,o8 as $e,U as qe,Y as Ae,a2 as Ie,j as s,D as we,e as Ve}from"./index-731451a5.js";/* empty css                   */import{L as Ue}from"./LoaderButton-71df50a7.js";import he from"./AssignStaffModal-61be8e90.js";import{S as Ge}from"./StringLength-222a9fd1.js";import{M as Ye}from"./MarkValue-3df2c354.js";import{C as ze}from"./CustomSelectDepartment-a5dd9a35.js";import{d as Je}from"./class-api-ec8ace00.js";import"./search-api-15f7f9f9.js";import"./AssignStaffModal.module-a60b32e1.js";import"./StringLength.module-75a6e080.js";import"./JoinForm.module-212f9bb3.js";const Ke="_DModal_odbhx_1",Qe="_title_odbhx_9",We="_input_odbhx_26",Xe="_mid_odbhx_64",Ze="_text_odbhx_77",He="_btn_odbhx_99",De="_notFound_odbhx_136",Ee="_item_odbhx_141",es="_select_odbhx_156",ss="_tooltip_odbhx_182",ts="_profileToolTip_odbhx_190",cs="_triangle_odbhx_203",as="_triangleDisplay_odbhx_213",ls="_profilelist_odbhx_217",ns="_academic_container_odbhx_246",rs="_subject_tile_container_odbhx_253",is="_subject_tile_odbhx_253",os="_subject_tile_active_odbhx_261",c={DModal:Ke,title:Qe,input:We,mid:Xe,text:Ze,btn:He,notFound:De,item:Ee,select:es,tooltip:ss,profileToolTip:ts,triangle:cs,triangleDisplay:as,profilelist:ls,academic_container:ns,subject_tile_container:rs,subject_tile:is,subject_tile_active:os};function us({options:d,switchOption:x}){return s.jsxs("div",{className:c.profileToolTip,children:[s.jsx("div",{className:c.triangle}),s.jsx("div",{className:c.profilelist,children:d==null?void 0:d.map((i,F)=>s.jsxs("div",{value:i._id,onClick:()=>x(i),children:[i.subjectName," ",(i==null?void 0:i.subjectType)==="Optional"&&`(${i==null?void 0:i.subjectType})`]},F))})]})}function Ns({departmentModal:d,hideModal:x,id:i,did:F,bid:be,cid:j,edit:_,setEdit:U,editSubject:O,isEditBy:G,onRefetch:me}){var H,D,E,ee,se,te,ce,ae,le,ne;const{t:a}=Be(),[Y,de]=r.useState(!1),{subjectEditDetail:e,subjectEditDetailRefetch:z}=Le({sid:O,skip:!O});r.useEffect(()=>{O&&z()},[O,d,z]);const[xe,B]=r.useState(_&&((H=e==null?void 0:e.subject)==null?void 0:H.subjectName)||a("please_select_subject_")),[J,L]=r.useState(!1),[fe,f]=r.useState(!0),[ge,pe]=r.useState(!1),[ve,Te]=r.useState([]),[q,R]=r.useState(!1),[h,A]=r.useState("Full Class"),[l,I]=r.useState([]),[Ne,K]=r.useState(""),[o,g]=r.useState(_&&((D=e==null?void 0:e.subject)==null?void 0:D.subjectTeacherName)),[n,b]=r.useState({msid:_&&((E=e==null?void 0:e.subject)==null?void 0:E.subjectMasterName)||"",subjectTitle:_&&((ee=e==null?void 0:e.subject)==null?void 0:ee.subjectTitle)||"",sid:_&&((te=(se=e==null?void 0:e.subject)==null?void 0:se.subjectTeacherName)==null?void 0:te._id)||"",subjectPassingMarks:_&&((ae=(ce=e==null?void 0:e.subject)==null?void 0:ce.setting)==null?void 0:ae.subjectPassingMarks)||0,subject_category:_&&((le=e==null?void 0:e.subject)==null?void 0:le.subject_category)||"Full Class"}),{allSubjectMaster:m}=Re({data:{id:i,did:F},skip:!i}),[Ce]=$e(),{oneClassAllSubjectRefetch:Q}=qe({cid:j,skip:!j}),{oneClassProfileRefetch:ye}=Ae({cid:j,skip:!j}),{getClassAllBatch:w,getClassAllBatchRefetch:W}=Je({cid:j,skip:h==="Particular Batch"?!j:!0}),[ke]=Ie();r.useEffect(()=>{var t,u,p,v,T,N,C,y,k,P,S;_&&(e!=null&&e.subject)&&(b({msid:((t=e==null?void 0:e.subject)==null?void 0:t.subjectMasterName)||"",subjectTitle:((u=e==null?void 0:e.subject)==null?void 0:u.subjectTitle)||"",sid:((v=(p=e==null?void 0:e.subject)==null?void 0:p.subjectTeacherName)==null?void 0:v._id)||"",subjectPassingMarks:((N=(T=e==null?void 0:e.subject)==null?void 0:T.setting)==null?void 0:N.subjectPassingMarks)||0,subject_category:((C=e==null?void 0:e.subject)==null?void 0:C.subject_category)||"Full Class"}),B(((y=e==null?void 0:e.subject)==null?void 0:y.subjectName)||a("select_standerd_")),g((k=e==null?void 0:e.subject)==null?void 0:k.subjectTeacherName),(P=e==null?void 0:e.subject)!=null&&P.selected_batch_query&&(I([(S=e==null?void 0:e.subject)==null?void 0:S.selected_batch_query]),A("Particular Batch")))},[_,e==null?void 0:e.subject]),r.useEffect(()=>{j&&h==="Particular Batch"&&W()},[h,j,W]),r.useEffect(()=>{m!=null&&m.subjectMaster&&Te(m==null?void 0:m.subjectMaster)},[m]);const X=t=>{g(t),b({...n,sid:t._id}),f(!0)},Pe=t=>{(t==null?void 0:t.subjectType)==="Optional"?B(`${t.subjectName} (${t==null?void 0:t.subjectType})`):B(t.subjectName),b({...n,msid:t._id}),f(!0)},V=()=>{b({msid:"",subjectTitle:"",sid:"",subjectPassingMarks:0,subject_category:"Theory"}),I([]),A("")},Se=()=>{var t,u,p,v,T,N,C,y,k,P,S,re,ie,oe,ue,_e,je;if(n.msid&&n.subjectTitle)if(_){L(!0);const M={smId:n.msid,subjectTitle:((p=e==null?void 0:e.subject)==null?void 0:p.subjectTitle)===n.subjectTitle?"":n.subjectTitle,sid:((T=(v=e==null?void 0:e.subject)==null?void 0:v.subjectTeacherName)==null?void 0:T._id)===n.sid?"":n.sid,subjectPassingMarks:+n.subjectPassingMarks,subject_category:n.subject_category,batch_arr:((C=(N=e==null?void 0:e.subject)==null?void 0:N.selected_batch_query)==null?void 0:C._id)===((y=l==null?void 0:l[0])==null?void 0:y._id)?[]:[(k=l==null?void 0:l[0])==null?void 0:k._id],delete_arr:((S=(P=e==null?void 0:e.subject)==null?void 0:P.selected_batch_query)==null?void 0:S._id)===((re=l==null?void 0:l[0])==null?void 0:re._id)?[]:(oe=(ie=e==null?void 0:e.subject)==null?void 0:ie.selected_batch_query)!=null&&oe._id?[(_e=(ue=e==null?void 0:e.subject)==null?void 0:ue.selected_batch_query)==null?void 0:_e._id]:[]};ke({subject:M,sid:(je=e==null?void 0:e.subject)==null?void 0:je._id}).then(()=>{G==="DEPARTMENT_HEAD"&&me(),x(!1),L(!1),U(!1),V(),g(""),Q()}).catch({})}else{let M=!0;h?h==="Particular Batch"&&!(l!=null&&l.length)&&(K({batchList:"* required"}),M=!1):(K({batch:"* required"}),M=!1),M&&(L(!0),Ce({subjectAdd:{...n,batch_arr:(t=l==null?void 0:l[0])!=null&&t._id?[(u=l==null?void 0:l[0])==null?void 0:u._id]:[]},id:i,did:F,bid:be,cid:j}).then(Oe=>{Oe&&(x(!1),L(!1),V(),g(""),ye(),Q())}).catch({}))}else f(!1)},Me=()=>{x(!1),U(!1),B(a("please_select_subject_")),V(),g("")},Z=t=>{A(u=>t)},Fe=t=>{I(()=>[t])},$=t=>{b(u=>({...u,subject_category:t}))};return s.jsxs(s.Fragment,{children:[s.jsx(we,{open:d,children:s.jsxs("div",{className:c.DModal,children:[s.jsxs("div",{className:c.title,children:[_?s.jsx("h5",{children:"Edit Subject"}):s.jsx("h5",{children:a("add-subject-n-place")}),s.jsx("img",{src:"/images/close-post-icon.svg",onClick:Me,alt:""})]}),s.jsx("div",{hidden:fe,className:c.notFound,children:a("fill_all_fields_to_add_subject")}),s.jsxs("div",{className:c.item,onClick:()=>de(!Y),children:[s.jsx("h6",{children:a("select-subject-place")}),s.jsxs("div",{className:c.select,children:[s.jsx("p",{children:xe}),s.jsx("img",{src:"/images/select-icon.svg",alt:""})]}),Y&&s.jsx("div",{className:c.tooltip,children:s.jsx(us,{options:ve,switchOption:Pe})})]}),s.jsx("h6",{style:{marginTop:"0.7rem"},children:a("subject_category")}),s.jsxs("section",{className:c.subject_tile_container,children:[s.jsx("div",{className:n.subject_category==="Full Class"?c.subject_tile_active:c.subject_tile,onClick:()=>$("Full Class"),children:a("all")}),s.jsx("div",{className:n.subject_category==="Theory"?c.subject_tile_active:c.subject_tile,onClick:()=>$("Theory"),children:a("theory")}),s.jsx("div",{className:n.subject_category==="Tutorial"?c.subject_tile_active:c.subject_tile,onClick:()=>$("Tutorial"),children:a("tutorial")}),s.jsx("div",{className:n.subject_category==="Practical"?c.subject_tile_active:c.subject_tile,onClick:()=>$("Practical"),children:a("practical")})]}),s.jsxs("div",{className:c.mid,onClick:()=>R(!0),children:[s.jsx("img",{src:o!=null&&o.staffProfilePhoto?`${Ve}/${o.staffProfilePhoto}`:"/images/avatar-icon.png",alt:""}),s.jsxs("div",{className:c.text,children:[s.jsx("h6",{children:o?`${o==null?void 0:o.staffFirstName} ${(o==null?void 0:o.staffMiddleName)||""} ${o==null?void 0:o.staffLastName}`:`${a("assign_subject_head")} ${a("optional")}`}),s.jsx("p",{children:a("search_from_joined_list")})]})]}),s.jsxs("div",{className:c.input,children:[s.jsx("h6",{children:a("give-s-head-title")}),s.jsx("input",{type:"text",value:n.subjectTitle,onChange:t=>{var u;((u=t.target.value)==null?void 0:u.length)<=40&&(b({...n,subjectTitle:t.target.value}),f(!0))},required:!0,placeholder:a("shead_example")}),s.jsx(Ge,{maxLength:40,valueLength:n.subjectTitle})]}),s.jsx("h6",{children:a("batch")}),s.jsxs("section",{className:c.subject_tile_container,children:[s.jsx("div",{className:h==="Full Class"?c.subject_tile_active:c.subject_tile,onClick:()=>Z("Full Class"),children:"Full Class"}),s.jsx("div",{className:h==="Particular Batch"?c.subject_tile_active:c.subject_tile,onClick:()=>Z("Particular Batch"),children:"Particular Batch"})]}),h==="Particular Batch"?s.jsx(ze,{selectLabel:a("select_batch"),selectedValue:a("please_select_batch"),options:(w==null?void 0:w.all_batches)??[],onClick:Fe,viewAs:"NORMAL_FILTER",defalutValue:((ne=l==null?void 0:l[0])==null?void 0:ne.batchName)??"",openAs:"PROMOTE",errorShow:Ne.batchList}):null,s.jsxs("div",{className:c.input,children:[s.jsx("h6",{children:a("subject_passing")}),s.jsx("input",{type:"tel",value:n.subjectPassingMarks,onChange:t=>{+t.target.value<=100?(b({...n,subjectPassingMarks:+t.target.value}),f(!0)):pe(!0)},placeholder:"E.g. 40"}),ge&&s.jsx(Ye,{message:"Mark is not greater than 100"})]}),s.jsxs("button",{className:c.btn,onClick:Se,disabled:J,children:[_?s.jsx("p",{children:a("update")}):s.jsx("p",{children:a("create")}),J&&s.jsx("div",{children:s.jsx(Ue,{})})]})]})}),q&&(G==="DEPARTMENT_HEAD"?s.jsx(he,{assignHead:q,headSelect:t=>{X(t),R(u=>!u)},title:a("assign_shead"),onClose:()=>R(t=>!t),instituteId:i,viewAs:"ADMISSION_ADMIN"}):s.jsx(he,{assignHead:q,headSelect:X,title:a("assign_shead"),onClose:()=>R(t=>!t)}))]})}export{Ns as default};
