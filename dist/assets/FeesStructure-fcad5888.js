import{u as I,R as W,ac as g,j as s,S as G,H as Q,r as h,a1 as z,t as y,W as H,Q as Z,d as q}from"./index-731451a5.js";import{F as K}from"./FinanceTabChangeLink-0f6c1098.js";import{s as d}from"./FeesStructure.module-7a88fbbc.js";import{I as O}from"./InstituteFinanceTabChangeLink-4ab7a57f.js";import{F as ss}from"./FeesCategoryList-8131ad8c.js";import{B as A}from"./BorderBottom-47800983.js";import{s as p}from"./ExamDepartment.module-77071acd.js";import{Z as es}from"./admission-api-56b87fde.js";import{z as X,i as is}from"./finance-api-5c6c5671.js";import{a as Y,A as as}from"./ApplicationPreviewDetail-fd29a331.js";import"./UniversalTab-d4f2174c.js";import"./JoinFormInput-8e74a0e0.js";import"./JoinForm.module-212f9bb3.js";import"./PopupWrapper-ffbaef7a.js";import"./Overlay-07ce6f88.js";import"./Overlay.module-9133d1bb.js";import"./SearchModalWrapper-6e85c9f3.js";import"./SearchModalBackdrop-5b309d60.js";import"./SearchHeader.module-b69c8942.js";import"./StringLength-222a9fd1.js";import"./StringLength.module-75a6e080.js";import"./ButtonWithAction-805b1066.js";import"./LoaderButton-71df50a7.js";import"./EditConfirm.module-344fbdb9.js";import"./JoinFormInputView-879755fe.js";import"./CustomNormalSelectInput-9ec7329b.js";import"./DatePicker-305f3dc6.js";import"./SeatingArrangement.module-3f4ae6aa.js";import"./CustomSelectDepartment-a5dd9a35.js";import"./hostel-api-4d11cb04.js";import"./transport-api-9ab21e71.js";import"./JoinFormCalender-5158d888.js";const ns=({instituteId:l,carryParentState:a,accessRole:x,callApi:r,viewAs:_})=>{var c,v,E;const{t:n}=I(),[f,o]=W.useState(!0),{allDepartment:e,allDepartmentRefetch:j}=g({id:l,skip:!l});return W.useEffect(()=>{l&&j()},[l]),W.useEffect(()=>{var t,C,N;((t=e==null?void 0:e.institute)!=null&&t.depart||((N=(C=e==null?void 0:e.institute)==null?void 0:C.depart)==null?void 0:N.length)===0)&&o(!1)},[(c=e==null?void 0:e.institute)==null?void 0:c.depart]),s.jsxs("div",{className:d.department_container,children:[(E=(v=e==null?void 0:e.institute)==null?void 0:v.depart)==null?void 0:E.map(t=>_==="INSTITUTE"?s.jsx(O,{carryParentState:{...a,did:t==null?void 0:t._id,dName:t==null?void 0:t.dName},activeTab:"?a=fee&n=structure&batch",children:s.jsxs("div",{className:d.department_card_container,children:[s.jsx("img",{src:"/images/profileAndCover/department-profile-img.svg",alt:"department avatar",className:d.department_card_image}),s.jsxs("div",{children:[s.jsx("h6",{className:d.department_card_name,children:(t==null?void 0:t.dName)||""}),s.jsxs("p",{className:d.department_card_head,children:[n("total_masters")," ",(t==null?void 0:t.classMasterCount)??0]})]})]})},t==null?void 0:t._id):s.jsx(K,{carryParentState:{...a,did:t==null?void 0:t._id,dName:t==null?void 0:t.dName},activeTab:"fee&n=structure&batch",accessRole:x,callApi:r,children:s.jsxs("div",{className:d.department_card_container,children:[s.jsx("img",{src:"/images/profileAndCover/department-profile-img.svg",alt:"department avatar",className:d.department_card_image}),s.jsxs("div",{children:[s.jsx("h6",{className:d.department_card_name,children:(t==null?void 0:t.dName)||""}),s.jsxs("p",{className:d.department_card_head,children:[n("total_masters")," ",(t==null?void 0:t.classMasterCount)??0]})]})]})},t==null?void 0:t._id)),f&&s.jsx(G,{})]})},ts=({instituteId:l,fees_category_count:a,fee_master_array_count:x,carryParentState:r,accessRole:_,callApi:n,viewAs:f})=>{const{t:o}=I();return s.jsxs(s.Fragment,{children:[f==="INSTITUTE"?s.jsx(O,{carryParentState:r,activeTab:"?a=fee&n=category",children:s.jsxs("div",{className:d.fees_category,children:[s.jsx("div",{className:d.fees_category_icon,children:s.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"})}),s.jsxs("div",{className:d.fees_category_text,children:[s.jsx("h6",{children:o("fees_master")}),s.jsxs("p",{children:[o("fees_total")," ",a+x]})]})]})}):s.jsx(K,{carryParentState:r,activeTab:"fee&n=category",accessRole:_,callApi:n,children:s.jsxs("div",{className:d.fees_category,children:[s.jsx("div",{className:d.fees_category_icon,children:s.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"})}),s.jsxs("div",{className:d.fees_category_text,children:[s.jsx("h6",{children:o("fees_master")}),s.jsxs("p",{children:[o("fees_total")," ",a+x]})]})]})}),s.jsx(ns,{instituteId:l,carryParentState:r,accessRole:_,callApi:n,viewAs:f})]})},cs=({departmentId:l,carryParentState:a,accessRole:x,callApi:r,viewAs:_})=>{var e,j;const{t:n}=I(),{oneDepartment:f,oneDepartmentRefetch:o}=Q({did:l,skip:!l});return h.useEffect(()=>{l&&o()},[l,o]),s.jsx(s.Fragment,{children:(j=(e=f==null?void 0:f.department)==null?void 0:e.batches)==null?void 0:j.map(c=>_==="INSTITUTE"?s.jsx(O,{carryParentState:{...a,batchId:c==null?void 0:c._id},activeTab:"?a=fee&n=structure&standard",children:s.jsxs("div",{className:p.class_container,children:[s.jsx("img",{className:p.oneRowImage,src:"/images/master-24-grey-icon.svg",alt:"batch icon"}),s.jsxs("div",{className:p.class_container_text,children:[s.jsx("h6",{children:c==null?void 0:c.batchName}),s.jsxs("p",{children:[n("created_on"),z(c.createdAt).format("DD MMM yyyy")]})]})]})},c==null?void 0:c._id):s.jsx(K,{carryParentState:{...a,batchId:c==null?void 0:c._id},activeTab:"fee&n=structure&standard",accessRole:x,callApi:r,children:s.jsxs("div",{className:p.class_container,children:[s.jsx("img",{className:p.oneRowImage,src:"/images/master-24-grey-icon.svg",alt:"batch icon"}),s.jsxs("div",{className:p.class_container_text,children:[s.jsx("h6",{children:c==null?void 0:c.batchName}),s.jsxs("p",{children:[n("created_on"),z(c.createdAt).format("DD MMM yyyy")]})]})]})},c==null?void 0:c._id))})},ds=({carryParentState:l,accessRole:a,departmentId:x,callApi:r,viewAs:_})=>{var o;const{admissionClassMasterList:n,admissionClassMasterListRefetch:f}=es({did:x,skip:!x});return h.useEffect(()=>{x&&f()},[x,f]),s.jsx(s.Fragment,{children:(o=n==null?void 0:n.classMasters)==null?void 0:o.map(e=>_==="INSTITUTE"?s.jsx(O,{carryParentState:{...l,clsId:e==null?void 0:e._id},activeTab:"?a=fee&n=structure",children:s.jsxs("div",{className:p.class_container,children:[s.jsx("img",{className:p.oneRowImage,src:"/images/master-24-grey-icon.svg",alt:"batch icon"}),s.jsx("div",{className:p.class_container_text,children:s.jsx("h6",{children:e==null?void 0:e.className})})]})},e==null?void 0:e._id):s.jsx(K,{carryParentState:{...l,clsId:e==null?void 0:e._id},activeTab:"fee&n=structure",accessRole:a,callApi:r,children:s.jsxs("div",{className:p.class_container,children:[s.jsx("img",{className:p.oneRowImage,src:"/images/master-24-grey-icon.svg",alt:"batch icon"}),s.jsx("div",{className:p.class_container_text,children:s.jsx("h6",{children:e==null?void 0:e.className})})]})},e==null?void 0:e._id))})},ls=({financeId:l,getQuery:a,instituteId:x})=>{const{t:r}=I(),[_,n]=h.useState(!1),[f,o]=y(),[e,j]=h.useState(1),[c,v]=h.useState(!0),[E,t]=h.useState(!1),[C,N]=h.useState(!0),[u,M]=h.useState([]),[R,w]=h.useState(""),[B,L]=h.useState(!1),[D]=H(),[P]=X(),{getAllFeesStructure:m,getAllFeesStructureRefetch:F}=is({data:{did:a==null?void 0:a.did,filterBy:a==null?void 0:a.clsId,page:e,limit:10,batch_by:a==null?void 0:a.batchId},skip:!(a!=null&&a.did)});h.useEffect(()=>{a!=null&&a.did&&(N(!0),F())},[a==null?void 0:a.did,e,F]),h.useEffect(()=>{o&&c&&j(i=>i+1)},[o,c]),h.useEffect(()=>{var i,T;E?(M(m==null?void 0:m.all_structures),N(!1),t(!1)):m!=null&&m.all_structures?(M(S=>[...new Set([...S,...m==null?void 0:m.all_structures].map(JSON.stringify))].map(JSON.parse)),N(!1)):((i=m==null?void 0:m.all_structures)==null?void 0:i.length)===0&&N(!1),((T=m==null?void 0:m.all_structures)==null?void 0:T.length)===10?v(!0):v(!1)},[m==null?void 0:m.all_structures]);const U=()=>{n(i=>!i)},b=()=>{j(1),t(!0),N(!0),F()},$=i=>{L(S=>!S);const T=new FormData;T.append("file",i.target.files[0]),D({fileUpload:T}).then(S=>{var k,J;(k=S.data)!=null&&k.imageKey?P({fid:l,did:a==null?void 0:a.did,excelFile:{excel_file:(J=S.data)==null?void 0:J.imageKey}}).then(()=>{L(V=>!V)}).catch({}):L(V=>!V)}).catch({})};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:d.structure_container_title,children:[s.jsx("h6",{children:(a==null?void 0:a.dName)??""}),s.jsxs("div",{className:d.upload_excel_container,children:[s.jsx("label",{className:d.upload_excel_file,htmlFor:"uploadExcel",children:s.jsx("img",{src:"/images/upload-xslx-icon.svg",alt:"add student icon",title:"Upload excel file"})}),s.jsx("input",{type:"file",id:"uploadExcel",accept:".xlsx",onChange:$,style:{display:"none"}}),s.jsx("p",{className:d.add_new_category,onClick:U,children:r("add_new_fees_structure")})]})]}),s.jsx(A,{customStyle:{marginBottom:"1rem"}}),u==null?void 0:u.map((i,T)=>{var S,k;return(u==null?void 0:u.length)===T+1?s.jsxs("div",{className:d.fees_card,ref:f,onClick:()=>w(i==null?void 0:i._id),style:{cursor:"pointer"},children:[s.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),s.jsxs("div",{className:d.fees_card_text,children:[s.jsxs("div",{className:d.fees_card_text_bottom,children:[s.jsx("h6",{children:((S=i==null?void 0:i.category_master)==null?void 0:S.category_name)??""}),s.jsx("h6",{children:`(${r("rs")}. ${(i==null?void 0:i.applicable_fees)??0})`})]}),s.jsxs("div",{className:d.fees_card_text_bottom,children:[s.jsx("h6",{children:(i==null?void 0:i.structure_name)??""}),s.jsxs("h6",{children:[r("rs"),".",(i==null?void 0:i.total_admission_fees)??0]})]})]})]},i==null?void 0:i._id):s.jsxs("div",{className:d.fees_card,onClick:()=>w(i==null?void 0:i._id),style:{cursor:"pointer"},children:[s.jsx("img",{src:"/images/fees-category-icon.svg",alt:"categor icon"}),s.jsxs("div",{className:d.fees_card_text,children:[s.jsxs("div",{className:d.fees_card_text_bottom,children:[s.jsx("h6",{children:((k=i==null?void 0:i.category_master)==null?void 0:k.category_name)??""}),s.jsx("h6",{children:`(${r("rs")}. ${(i==null?void 0:i.applicable_fees)??0})`})]}),s.jsxs("div",{className:d.fees_card_text_bottom,children:[s.jsx("h6",{children:(i==null?void 0:i.structure_name)??""}),s.jsxs("h6",{children:[r("rs"),".",(i==null?void 0:i.total_admission_fees)??0]})]})]})]},i==null?void 0:i._id)}),B&&s.jsx(Z,{}),C&&s.jsx(G,{}),_&&s.jsx(Y,{onClose:U,financeId:l,departmentId:a==null?void 0:a.did,onRefetch:b,instituteId:x,flowAs:"Finance_Manager"}),R&&s.jsx(as,{structureId:R,setStructureId:w,onRefetch:b,departmentId:a==null?void 0:a.did,instituteId:x,financeId:l,flowAs:"Finance_Manager"})]})},os=({financeId:l,instituteId:a,accessRole:x,callApi:r,viewAs:_})=>{var N,u,M,R,w,B,L;const n=q(),{t:f}=I(),[o,e]=h.useState(!1),[j,c]=h.useState(!1),[v]=H(),[E]=X(),t=()=>{e(D=>!D)},C=D=>{var P;if((P=D.target.files)!=null&&P.length){c(F=>!F);const m=new FormData;m.append("file",D.target.files[0]),v({fileUpload:m}).then(F=>{var U,b,$;(U=F.data)!=null&&U.imageKey?E({fid:l,did:(b=n.state)==null?void 0:b.did,excelFile:{excel_file:($=F.data)==null?void 0:$.imageKey}}).then(()=>{c(i=>!i)}).catch({}):c(i=>!i)}).catch({})}};return s.jsxs(s.Fragment,{children:[((N=n==null?void 0:n.search)==null?void 0:N.substring(9))==="structure"?s.jsx(ls,{financeId:l,instituteId:a,getQuery:n.state}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:d.structure_container_title,children:[s.jsx("h6",{children:((u=n.state)==null?void 0:u.dName)??""}),s.jsxs("div",{className:d.upload_excel_container,children:[s.jsx("label",{className:d.upload_excel_file,htmlFor:"uploadExcel",children:s.jsx("img",{src:"/images/upload-xslx-icon.svg",alt:"add student icon",title:"Upload excel file"})}),s.jsx("input",{type:"file",id:"uploadExcel",accept:".xlsx",onChange:C,style:{display:"none"}}),s.jsx("p",{className:d.add_new_category,onClick:t,children:f("add_new_fees_structure")})]})]}),s.jsx(A,{customStyle:{marginBottom:"1rem"}})]}),((M=n==null?void 0:n.search)==null?void 0:M.substring(9))==="structure&batch"&&s.jsx(s.Fragment,{children:s.jsx(cs,{departmentId:((R=n==null?void 0:n.state)==null?void 0:R.did)??"",carryParentState:n==null?void 0:n.state,accessRole:x,callApi:r,viewAs:_})}),((w=n==null?void 0:n.search)==null?void 0:w.substring(9))==="structure&standard"&&s.jsx(s.Fragment,{children:s.jsx(ds,{departmentId:((B=n==null?void 0:n.state)==null?void 0:B.did)??"",carryParentState:n==null?void 0:n.state,accessRole:x,callApi:r,viewAs:_})}),j&&s.jsx(Z,{}),o&&s.jsx(Y,{onClose:t,financeId:l,departmentId:(L=n.state)==null?void 0:L.did,onRefetch:()=>{},instituteId:a,flowAs:"Finance_Manager"})]})},Js=({financeId:l,instituteId:a,fees_category_count:x,fee_master_array_count:r,carryParentState:_,accessRole:n,callApi:f,viewAs:o})=>{var j,c,v;const e=q();return s.jsxs("div",{className:d.fess_container,children:[((j=e==null?void 0:e.search)==null?void 0:j.substring(3))==="fee"&&s.jsx(ts,{instituteId:a,fees_category_count:x,carryParentState:_,fee_master_array_count:r,accessRole:n,callApi:f,viewAs:o}),((c=e==null?void 0:e.search)==null?void 0:c.substring(9))==="category"&&s.jsx(ss,{financeId:l}),((v=e==null?void 0:e.search)==null?void 0:v.substring(9,18))==="structure"&&s.jsx(os,{financeId:l,instituteId:a,accessRole:n,callApi:f,viewAs:o})]})};export{Js as default};
