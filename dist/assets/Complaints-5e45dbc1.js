import{j as e,a1 as j,k as L,r as o,S as g,u as b,R as D,_ as E}from"./index-0ca76035.js";import{I as S}from"./institute-staff-student-api-7114d611.js";import{U as T}from"./UniversalTab-73e7f63a.js";import{B as $}from"./BorderBottom-1dc6f53e.js";import{C as w}from"./CustomSuspense-25f8db15.js";const y="_complaints_m7dvb_1",I="_complaintList_m7dvb_8",R="_complaintDetail_m7dvb_14",x={complaints:y,complaintList:I,complaintDetail:R},k="_complaintList_2cqxs_1",z="_listHead_2cqxs_12",A="_tabs_2cqxs_16",h={complaintList:k,listHead:z,tabs:A};const C="_list_1otza_1",H="_item_1otza_6",U="_datetime_1otza_16",q="_item_active_1otza_42",m={list:C,item:H,datetime:U,item_active:q},N=({complaint:s,setComplaintId:c,setShowDetails:l,complaintId:i})=>{var a,u,d,t;const r=_=>{c(_),l(!0)};return e.jsxs("div",{className:i===(s==null?void 0:s._id)?`${m.item} ${m.item_active}`:m.item,onClick:()=>r(s==null?void 0:s._id),children:[e.jsx("img",{src:"/images/complainIcon.svg",alt:"compalint avatar"}),e.jsxs("div",{children:[e.jsx("h6",{children:`${(a=s==null?void 0:s.student)==null?void 0:a.studentFirstName} ${(u=s==null?void 0:s.student)!=null&&u.studentMiddleName?(d=s==null?void 0:s.student)==null?void 0:d.studentMiddleName:""} ${(t=s==null?void 0:s.student)==null?void 0:t.studentLastName}`}),e.jsxs("div",{className:m.datetime,children:[e.jsxs("p",{children:[j(s==null?void 0:s.createdAt).format("LL"),","]}),e.jsx("p",{children:j(s==null?void 0:s.createdAt).format("LT")})]})]})]})};function B({setComplaintId:s,setShowDetails:c,complaintId:l,refetchStatus:i,setRefetchStatus:r}){var v;const a=L(n=>n.idChange.id),[u,d]=o.useState(!0),{studentComplaintList:t,studentComplaintListRefetch:_}=S({data:{id:a,status:"Unsolved"},skip:!a});return o.useEffect(()=>{(a||i.unsolved)&&(d(!0),_(),r(n=>({...n,unsolved:!1})))},[a,i.unsolved,_]),o.useEffect(()=>{t!=null&&t.complaints&&d(!1)},[t==null?void 0:t.complaints]),o.useEffect(()=>{setTimeout(()=>d(!1),2e3)},[]),e.jsxs("div",{className:m.list,children:[(v=t==null?void 0:t.complaints)==null?void 0:v.map((n,f)=>e.jsx(N,{setComplaintId:s,setShowDetails:c,complaint:n,complaintId:l},f)),u&&e.jsx(g,{})]})}function M({setComplaintId:s,setShowDetails:c,complaintId:l,refetchStatus:i,setRefetchStatus:r}){var v;const a=L(n=>n.idChange.id),[u,d]=o.useState(!0),{studentComplaintList:t,studentComplaintListRefetch:_}=S({data:{id:a,status:"Solved"},skip:!a});return o.useEffect(()=>{(a||i.solved)&&(d(!0),_(),r(n=>({...n,solved:!1})))},[a,i.solved,_]),o.useEffect(()=>{t!=null&&t.complaints&&d(!1)},[t==null?void 0:t.complaints]),o.useEffect(()=>{setTimeout(()=>d(!1),2e3)},[]),e.jsxs("div",{className:m.list,children:[(v=t==null?void 0:t.complaints)==null?void 0:v.map((n,f)=>e.jsx(N,{setComplaintId:s,setShowDetails:c,complaint:n,complaintId:l},f)),u&&e.jsx(g,{})]})}function P({setComplaintId:s,setShowDetails:c,complaintId:l,refetchStatus:i,setRefetchStatus:r}){const{t:a}=b(),[u,d]=o.useState(0),t=[{name:a("unsolved"),id:0},{name:a("solved"),id:1}];return e.jsx("div",{className:h.complaintList,children:e.jsxs("div",{className:h.listHead,children:[e.jsx(T,{tabList:t,activeIndexTab:u,setActiveIndexTab:d,customStyleTab:{width:"100%"}}),e.jsx($,{customStyle:{width:"100%"}}),u===0&&e.jsx(B,{setShowDetails:c,setComplaintId:s,complaintId:l,setRefetchStatus:r,refetchStatus:i}),u===1&&e.jsx(M,{setShowDetails:c,setComplaintId:s,complaintId:l,setRefetchStatus:r,refetchStatus:i})]})})}const p=D.lazy(()=>E(()=>import("./ComplaintDetails-603844df.js"),["assets/ComplaintDetails-603844df.js","assets/index-0ca76035.js","assets/index-4d24e8f6.css","assets/institute-staff-student-api-7114d611.js","assets/ComplaintDetails-5d31abca.css"]));function J(){const[s,c]=o.useState(""),[l,i]=o.useState(!1),[r,a]=o.useState(!1);return e.jsxs("div",{className:x.complaints,children:[e.jsx("div",{className:x.complaintList,children:e.jsx(P,{setShowDetails:i,setComplaintId:c,complaintId:s,setRefetchStatus:a,refetchStatus:r})}),e.jsx("div",{className:x.complaintDetail,children:l&&e.jsx(w,{children:e.jsx(p,{setShowDetails:i,complaintId:s,setRefetchStatus:a})})})]})}export{J as default};
