import{r as h,u as C,j as e,t as W}from"./index-731451a5.js";import{t as D,v as $,w as q,M as L,U as y,F as I,x as P,a as V,B as Y,f as R,r as E,C as Q,Q as z,y as H,z as O,A as G,p as w,q as J,l as K,s as b,L as X}from"./FinanceConfig-555e7db6.js";import{s as n}from"./Income.module-200dd9e8.js";import{F as Z,a as ee,P as se}from"./PlateformUser-390e1822.js";import{A as ae}from"./AddButton-aacd1b4c.js";import{F as te}from"./FormFile-e835db6a.js";import{T as re,a as oe}from"./TileCard-60046ca2.js";import{F as ne}from"./FormTextarea-f5fb5314.js";import{t as ce}from"./transaction_constant-ad8d613b.js";const le=({fid:a})=>{var s,i,m,u;const{t:c}=C(),{financeIncomeBalance:t}=D({fid:a,skip:!a});return e.jsxs("div",{className:n.right,children:[e.jsxs("div",{className:n.rightHead,style:{"--bg-expense-color":"#20b038"},children:[e.jsx("h6",{children:c("total_income")}),e.jsxs("h6",{children:[c("rs"),((s=t==null?void 0:t.incomeBalance)==null?void 0:s.financeIncomeCashBalance)+((i=t==null?void 0:t.incomeBalance)==null?void 0:i.financeIncomeBankBalance)]})]}),e.jsxs("div",{className:n.rightBody,children:[e.jsxs("h6",{children:[" ",c("by_cash")," : ",c("rs"),(m=t==null?void 0:t.incomeBalance)==null?void 0:m.financeIncomeCashBalance]}),e.jsxs("h6",{children:[" ",c("by_bank")," : ",c("rs"),(u=t==null?void 0:t.incomeBalance)==null?void 0:u.financeIncomeBankBalance]})]})]})},de=h.memo(le),B=({income:a,setIncomeId:c})=>{var i;const{t}=C(),s=()=>{c(a==null?void 0:a._id)};return e.jsxs("div",{onClick:s,className:n.card_container,children:[e.jsxs("h6",{className:n.invoice_number,children:[t("invoice_no")," "," : "," ",a==null?void 0:a.invoice_number]}),e.jsxs("div",{className:n.sidebarheader,children:[e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv,children:t("recived_from")}),e.jsx("h6",{children:a!=null&&a.incomeFrom?a==null?void 0:a.incomeFrom:(i=a==null?void 0:a.incomeFromUser)==null?void 0:i.userLegalName}),e.jsx("p",{className:n.rcv,children:$(a==null?void 0:a.createdAt).format("MMMM D, YYYY")})]}),e.jsxs("div",{className:n.text,children:[e.jsx("p",{className:n.rcv1}),e.jsxs("h6",{children:[t("rs")," ",a==null?void 0:a.incomeAmount]}),e.jsx("p",{className:n.rcv,children:a==null?void 0:a.incomeAccount})]})]})]})},ie=({onClose:a,incomeId:c})=>{var i,m,u,g,p,_,j,x,F,v;const{t}=C(),{financeIncomeDetail:s}=q({incomeId:c,skip:!c});return e.jsx(L,{onClose:a,children:e.jsxs("div",{className:n.income_detail,children:[e.jsxs("div",{className:n.detailTop,children:[e.jsx("div",{className:n.detailTopMid,children:e.jsx("h6",{children:(i=s==null?void 0:s.oneIncome)!=null&&i.incomeFrom?(m=s==null?void 0:s.oneIncome)==null?void 0:m.incomeFrom:(g=(u=s==null?void 0:s.oneIncome)==null?void 0:u.incomeFromUser)==null?void 0:g.userLegalName})}),e.jsx("div",{className:n.detailTopMid,children:e.jsxs("h6",{children:["Rs. ",(p=s==null?void 0:s.oneIncome)==null?void 0:p.incomeAmount]})})]}),e.jsxs(y,{children:[e.jsx(I,{label:`${t("transaction_mode")}: `,value:(_=s==null?void 0:s.oneIncome)==null?void 0:_.incomeAccount,customFormInput:{fontWeight:"500"}}),e.jsx(I,{label:`${t("description")}: `,value:(j=s==null?void 0:s.oneIncome)==null?void 0:j.incomeDesc,customFormInput:{fontWeight:"500"}}),e.jsx(I,{label:`${t("day_date")}: `,value:$((x=s==null?void 0:s.oneIncome)==null?void 0:x.createdAt).format("MMMM D, YYYY"),customFormInput:{fontWeight:"500"}}),(F=financeExpenseDetail==null?void 0:financeExpenseDetail.oneIncome)!=null&&F.incomeAck?e.jsx(Z,{label:`${t("acknowlegement")}: `,value:{key:(v=s==null?void 0:s.oneIncome)==null?void 0:v.incomeAck},customFormInput:{fontWeight:"500"}}):null]})]})})},me=({onClose:a,fid:c})=>{var o;const{t}=C(),[s,i]=h.useState({incomeAmount:"",incomeFrom:"",incomeDesc:"",incomeAccount:"By Bank"}),[m,u]=h.useState(""),[g,p]=h.useState(!1),[_,j]=h.useState(!1),[x,F]=h.useState(""),[v,l]=h.useState(""),[T]=P(),A=r=>{r.target.name==="incomeAmount"?i(d=>({...d,[r.target.name]:r.target.value})):i(d=>({...d,[r.target.name]:r.target.value}))},U=r=>{i(d=>({...d,incomeAccount:r}))},f=r=>{u(r.target.files[0])},k=()=>{let r=H(s,["incomeDesc"]);if(O(r)){if(c){p(S=>!S);const d=new FormData;d.append("incomeAmount",s.incomeAmount),x||d.append("incomeFrom",s.incomeFrom),d.append("incomeDesc",s.incomeDesc),d.append("incomeAccount",s.incomeAccount),d.append("file",m),T({fData:d,fid:c,user_query:x}).then(()=>{p(S=>!S),a()}).catch(()=>{p(S=>!S)})}}else l(r)},M=r=>{F(r==null?void 0:r._id),j(!1),i(d=>({...d,incomeFrom:r==null?void 0:r.userLegalName}))},N=()=>{j(r=>!r)};return e.jsx(e.Fragment,{children:_?e.jsx(se,{onSelectUser:M,selectedId:x,onClose:N}):e.jsx(L,{onClose:a,children:e.jsxs("div",{className:n.modal_container,children:[e.jsx(y,{children:e.jsxs("div",{className:n.modal_container_outer_header,children:[e.jsx("div",{className:n.modal_container_header,children:e.jsx("h6",{children:t("add_income_receipt")})}),e.jsx("img",{src:`${V}/close.svg`,alt:"close icon",onClick:a})]})}),e.jsx(Y,{}),e.jsxs(y,{customStyle:{paddingTop:"0"},children:[e.jsx(re,{label:"select_transaction_mode",children:(o=ce)==null?void 0:o.map(r=>e.jsx(oe,{tile:r,onTile:U,activeTile:s.incomeAccount},r==null?void 0:r.key))}),e.jsx(R,{label:t("amount"),placeholder:t("amount_placeholder"),name:"incomeAmount",value:s.incomeAmount,type:"text",onChange:A,errorShow:v.incomeAmount}),e.jsx(ee,{label:t("from"),placeholder:t("from_placeholder"),name:"incomeFrom",value:s.incomeFrom,type:"text",onChange:A,errorShow:v.incomeFrom,iconUrl:`${E}/navbar-search.svg`,searchLabel:"search_and_select",onSearchAction:N}),e.jsx(ne,{label:t("description"),placeholder:t("description_placeholder"),name:"incomeDesc",value:s.incomeDesc,type:"text",onChange:A,errorShow:v.incomeDesc}),e.jsx(te,{label:t("acknowlegement_receipt"),name:"acknowlegement_receipt",value:m!=null&&m.name?{name:m==null?void 0:m.name}:"",onChange:f}),e.jsx(Q,{label:"save_receipt",onAction:k})]}),g&&e.jsx(z,{})]})})})},be=({fid:a})=>{var M,N;const{t:c}=C(),[t,s]=h.useState(""),[i,m]=h.useState(1),[u,g]=h.useState(!0),[p,_]=W({skip:t}),[j,x]=h.useState(""),[F,v]=h.useState(!1),{financeIncome:l,financeIncomeLoading:T}=G({data:{fid:a,page:i,limit:10,search:t},skip:!a});h.useEffect(()=>{_&&u&&m(o=>o+1)},[_,u]),h.useEffect(()=>{var o;(o=l==null?void 0:l.allIncome)!=null&&o.length&&w(l==null?void 0:l.length,g)},[(M=l==null?void 0:l.allIncome)==null?void 0:M.length,w]);const A=h.useCallback(J(o=>s(o),500),[]),U=o=>{A(o.target.value)},f=()=>{x("")},k=()=>{v(o=>!o)};return e.jsxs(e.Fragment,{children:[e.jsxs(K,{children:[e.jsx(y,{children:e.jsxs("div",{className:b.fm_header_container,children:[e.jsx("h6",{children:c("income_history")}),e.jsx("div",{className:b.fm_search,children:e.jsx("section",{className:b.fm_search_container,children:e.jsxs("div",{className:b.fm_search_container_inner,children:[e.jsx("img",{className:b.fm_search_icon,alt:"search icon",src:`${E}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:c("search"),onChange:U})]})})})]})}),e.jsx(Y,{}),e.jsxs(y,{customStyle:{paddingTop:"0.2rem"},children:[e.jsxs("div",{className:b.fm_add_button,children:[e.jsx(de,{fid:a}),e.jsx(ae,{label:"add_new_income",onAction:k})]}),T&&e.jsx(X,{}),(N=l==null?void 0:l.allIncome)==null?void 0:N.map((o,r)=>{var d;return((d=l==null?void 0:l.allIncome)==null?void 0:d.length)===r+1?e.jsx("div",{ref:p,children:e.jsx(B,{income:o,setIncomeId:x})},o==null?void 0:o._id):e.jsx(B,{income:o,setIncomeId:x},o==null?void 0:o._id)})]})]}),j&&e.jsx(ie,{onClose:f,incomeId:j}),F&&e.jsx(me,{onClose:k,fid:a})]})};export{be as default};
