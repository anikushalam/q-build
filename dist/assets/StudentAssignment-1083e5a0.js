import{j as s,u as M,a1 as ss,d as as,c as es,r as h,kX as D,Q as cs,b as rs,t as is,v as os,S as ts}from"./index-0ca76035.js";import{s as r}from"./Assignment.module-f9381027.js";import{t as ms,v as ds,w as ls,x as ps}from"./student-api-05be0424.js";import{E as hs}from"./EmptyInfo-dd58cebb.js";import{S as O}from"./LibraryBookCard-77f4a0ab.js";import{i as A}from"./image_extenstion-bbfb153e.js";import"./library-api-cd2cf9e9.js";const I=({text:i,background:l,progress:d,number:F})=>s.jsxs("div",{className:r.rangeRow,children:[s.jsx("div",{className:r.rangeColumn1,children:s.jsx("div",{className:`${r.rangecircle}`,style:{backgroundColor:l}})}),s.jsx("div",{className:r.rangeColumn2,children:s.jsx("h6",{children:i})}),s.jsx("div",{className:r.rangeColumn3,children:s.jsx("div",{className:r.progressdiv,children:s.jsx("div",{className:r.progress,style:{width:d===0?"0.5%":`${d}%`,backgroundColor:l}})})}),s.jsx("div",{className:r.rangeColumn4,children:s.jsx("h6",{children:F})})]}),B=({assignment:i})=>{var d;const{t:l}=M();return s.jsxs("div",{className:r.assignmentCard,children:[s.jsx("h6",{className:r.subject,children:((d=i==null?void 0:i.subject)==null?void 0:d.subjectName)??""}),s.jsx("p",{className:r.title,children:(i==null?void 0:i.assignmentName)??""}),s.jsxs("p",{className:r.duetime,children:[l("due_on")," ",ss(i==null?void 0:i.dueDate).format("Do MMM YY")]}),s.jsx("div",{className:`${r.rangecirclestatus}`,style:{backgroundColor:i!=null&&i.assignmentSubmit&&(i!=null&&i.assignmentSubmitRequest)?" #06BB06":!(i!=null&&i.assignmentSubmit)&&(i!=null&&i.assignmentSubmitRequest)?"#001A72":"#FFC700"}})]})},xs=({onRefetch:i})=>{var k,L,$,t,N,q,P,G,Q,V,H,J,Y,z,X,W,Z,C,U,y,S;const{t:l}=M(),d=as(),F=es(),[E,R]=h.useState(!1),[m,b]=h.useState({studentDescritpion:"",testSet:"",file:[]}),[u,T]=h.useState([]),[x,g]=h.useState([]),[f]=ms(),{getOneAssignmentDetailByStudent:e,getOneAssignmentDetailByStudentRefetch:v}=ds({aid:(k=d.state)==null?void 0:k.aid,skip:!((L=d.state)!=null&&L.aid)});h.useEffect(()=>{var a;(a=d.state)!=null&&a.aid&&v()},[($=d.state)==null?void 0:$.aid,v]);const c=document.querySelector("textarea");c==null||c.addEventListener("keyup",a=>{c.style.height="auto";let p=a.target.scrollHeight;c.style.height=`${p}px`}),h.useEffect(()=>{if(m.file){const a=[],p=[];for(let j in m.file)for(let n in m.file[j])n==="type"&&(m.file[j][n].includes("image/")?a.push(URL.createObjectURL(m.file[j])):p.push({name:m.file[j].name}));T(a),g(p)}},[m.file]);const _=a=>{var p;(p=a.target.files)!=null&&p.length&&b(j=>({...j,file:[...j.file,...a.target.files]}))},o=()=>{var a,p;if(m.studentDescritpion||(a=m.file)!=null&&a.length){R(w=>!w);const j=new Date,n=new FormData;n.append("studentDescritpion",m.studentDescritpion),n.append("submmittedDate",j),n.append("assignmentSubmitRequest",!0),n.append("testSet","");for(let w in m.file)m.file[w].size&&n.append("file",m.file[w]);f({aid:(p=d.state)==null?void 0:p.aid,assignmentData:n}).then(()=>{v(),i(),b({studentDescritpion:"",testSet:"",file:[]}),T([]),g([]),R(w=>!w)}).catch({})}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:r.assignmentDetailTop,children:[s.jsx("img",{src:"/images/members/arrow-left.svg",alt:"",onClick:()=>F(-1)}),s.jsx("h6",{children:(N=(t=e==null?void 0:e.assignment)==null?void 0:t.subject)==null?void 0:N.subjectName}),s.jsx("img",{className:r.menu,src:"/images/menu-dots-dark-icon.svg",alt:""})]}),s.jsxs("div",{className:r.assignmentDetailBody,children:[s.jsx("p",{children:"Assignement Name"}),s.jsx("h6",{children:(q=e==null?void 0:e.assignment)==null?void 0:q.assignmentName}),s.jsx("p",{children:"Assignement Due Date"}),s.jsx("h6",{children:ss((P=e==null?void 0:e.assignment)==null?void 0:P.dueDate).format("DD-MM-yyyy")}),s.jsx("p",{children:"Description"}),s.jsx("h6",{style:{whiteSpace:"break-spaces"},children:(G=e==null?void 0:e.assignment)==null?void 0:G.descritpion}),((V=(Q=e==null?void 0:e.assignment)==null?void 0:Q.files)==null?void 0:V.length)>0?s.jsxs("div",{className:r.files,children:[s.jsx("p",{className:r.typeFile,children:l("file_image")}),(J=(H=e==null?void 0:e.assignment)==null?void 0:H.files)==null?void 0:J.map((a,p)=>(a==null?void 0:a.documentType)==="application/octet-stream"||(a==null?void 0:a.documentType)==="image/jpeg"||(a==null?void 0:a.documentType)==="image/png"||A(a==null?void 0:a.documentKey)?s.jsx("a",{href:`${D}/${a==null?void 0:a.documentKey}`,target:"_blank",children:s.jsxs("div",{className:r.img,children:[s.jsx("img",{src:"/images/members/img-icon.svg",alt:""}),s.jsx("p",{children:a==null?void 0:a.documentName})]},p)}):s.jsx("a",{href:`${D}/${a==null?void 0:a.documentKey}`,target:"_blank",children:s.jsxs("div",{className:r.img,children:[s.jsx("img",{src:"/images/admin/pdf-icon.svg",alt:""}),s.jsx("p",{children:a==null?void 0:a.documentName})]},p)}))]}):"",s.jsx("h6",{className:r.des,children:l("description")}),(Y=e==null?void 0:e.assignment)!=null&&Y.assignmentSubmitRequest?s.jsx("p",{className:r.studentDescritpion,style:{marginBottom:"2vw",whiteSpace:"break-spaces"},children:(z=e==null?void 0:e.assignment)==null?void 0:z.studentDescritpion}):s.jsx("textarea",{className:r.assignment_text,type:"text",name:"description",placeholder:"Type Answer",value:m.studentDescritpion,onChange:a=>b(p=>({...p,studentDescritpion:a.target.value}))}),(X=e==null?void 0:e.assignment)!=null&&X.assignmentSubmitRequest?((Z=(W=e==null?void 0:e.assignment)==null?void 0:W.studentFiles)==null?void 0:Z.length)>0?s.jsxs("div",{className:r.files,children:[s.jsx("p",{className:r.typeFile,children:l("file_image")}),(U=(C=e==null?void 0:e.assignment)==null?void 0:C.studentFiles)==null?void 0:U.map(a=>(a==null?void 0:a.documentType)==="application/octet-stream"||(a==null?void 0:a.documentType)==="image/jpeg"||(a==null?void 0:a.documentType)==="image/png"||A(a==null?void 0:a.documentKey)?s.jsx("a",{href:`${D}/${a==null?void 0:a.documentKey}`,target:"_blank",children:s.jsxs("div",{className:r.img,children:[s.jsx("img",{src:"/images/members/img-icon.svg",alt:""}),s.jsx("p",{children:a==null?void 0:a.documentName})]})}):s.jsx("a",{href:`${D}/${a==null?void 0:a.documentKey}`,target:"_blank",children:s.jsxs("div",{className:r.img,children:[s.jsx("img",{src:"/images/admin/pdf-icon.svg",alt:""}),s.jsx("p",{children:a==null?void 0:a.documentName})]})}))]}):"":s.jsxs("div",{children:[s.jsx("label",{htmlFor:"img",style:{cursor:"pointer"},children:s.jsxs("div",{className:r.addImage,children:[s.jsx("img",{src:"/images/members/img-icon.svg",alt:""}),s.jsx("p",{className:r.addImgFile,children:"Add Image/File"})]})}),s.jsx("input",{className:r.upload,id:"img",multiple:!0,name:"file",onChange:_,type:"file",accept:"image/gif, image/jpeg, image/png,text/plain, application/pdf"})]}),((u==null?void 0:u.length)>0||(x==null?void 0:x.length)>0)&&s.jsxs("div",{className:r.files,children:[s.jsx("p",{className:r.typeFile,children:l("file_image")}),u==null?void 0:u.map(a=>s.jsxs("div",{className:r.img,children:[s.jsx("img",{src:"/images/members/img-icon.svg",alt:""}),s.jsx("p",{children:a})]},a)),x==null?void 0:x.map(a=>s.jsxs("div",{className:r.img,children:[s.jsx("img",{src:"/images/admin/pdf-icon.svg",alt:""}),s.jsx("p",{children:a==null?void 0:a.name})]},a==null?void 0:a.name))]}),(y=e==null?void 0:e.assignment)!=null&&y.assignmentSubmitRequest?"":!((S=e==null?void 0:e.assignment)!=null&&S.assignmentSubmitRequest)&&s.jsx("div",{className:`${r.btn} ${r.btnActive}`,onClick:o,children:l("submit")}),E&&s.jsx(cs,{})]})]})},K=(i,l)=>Math.ceil(i/l*100),ws=({sid:i,carryParentState:l})=>{var $;const{t:d}=M(),[F]=rs(),[E,R]=h.useState(!0),[m,b]=h.useState(1),[u,T]=is(),[x,g]=h.useState([]),[f,e]=h.useState(!0),{scrollToTop:v}=os(),{getAssignmentCountByStudent:c,getAssignmentCountByStudentRefetch:_}=ls({sid:i,skip:!i}),{getAssignmentByStudent:o,getAssignmentByStudentRefetch:k}=ps({data:{sid:i,page:m,limit:10},skip:!i});h.useEffect(()=>{i&&_()},[i,_]),h.useEffect(()=>{i&&(e(!0),k())},[i,m,k]),h.useEffect(()=>{v()},[v]),h.useEffect(()=>{T&&E&&b(t=>t+1)},[T,E]),h.useEffect(()=>{var t,N;o!=null&&o.assignments?(g(m===1?o==null?void 0:o.assignments:q=>[...new Set([...q,...o==null?void 0:o.assignments].map(JSON.stringify))].map(JSON.parse)),e(!1)):((t=o==null?void 0:o.assignments)==null?void 0:t.length)===0&&e(!1),((N=o==null?void 0:o.assignments)==null?void 0:N.length)===10?R(!0):R(!1)},[o==null?void 0:o.assignments]);const L=()=>{b(1),k(),_()};return s.jsx("div",{className:r.student_assignment,children:F.get("type")?s.jsx(xs,{onRefetch:L}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:r.rangeCard,children:[s.jsx(I,{text:d("total"),background:"#a0a0a0",progress:K(c==null?void 0:c.totalAssignment,c==null?void 0:c.totalAssignment),number:c==null?void 0:c.totalAssignment}),s.jsx(I,{text:d("submitted"),background:"#001A72",progress:K(c==null?void 0:c.submittedAssignment,c==null?void 0:c.totalAssignment),number:c==null?void 0:c.submittedAssignment}),s.jsx(I,{text:d("incomplete"),background:"#FFC700",progress:K(c==null?void 0:c.incompletedAssignment,c==null?void 0:c.totalAssignment),number:c==null?void 0:c.incompletedAssignment}),s.jsx(I,{text:d("completed"),background:"#06BB06",progress:K(c==null?void 0:c.completedAssignment,c==null?void 0:c.totalAssignment),number:c==null?void 0:c.completedAssignment})]}),s.jsx("div",{className:r.assignmentCards,style:{width:"100%"},children:x.map((t,N)=>(x==null?void 0:x.length)===N+1?s.jsx(O,{carryParentState:{...l,aid:t==null?void 0:t._id},activeTab:"assignment&type=detail",customStyleLink:{width:"48%"},children:s.jsx("div",{className:r.itemref,ref:u,children:s.jsx(B,{assignment:t})})},t==null?void 0:t._id):s.jsx(O,{carryParentState:{...l,aid:t==null?void 0:t._id},activeTab:"assignment&type=detail",customStyleLink:{width:"48%"},children:s.jsx("div",{className:r.itemref,children:s.jsx(B,{assignment:t})})},t==null?void 0:t._id))}),!f&&!(($=o==null?void 0:o.assignments)!=null&&$.length)&&s.jsx(hs,{customStyleContainer:{marginTop:"9rem"},title:"No assignments found"}),f&&s.jsx(ts,{status:"white"})]})})};export{ws as default};
