import{u as R,k as F,oi as H,r as _,j as e,Q as U,R as $,a1 as M,oj as Y,t as z,ok as G,ol as J,v as W,S as D}from"./index-0ca76035.js";import{S as K}from"./SearchUniversalUser-b1b04b2c.js";import"./search-api-b192a53f.js";const X="_incomeForm_9m20r_1",Z="_expense_tab_9m20r_8",Q="_expense_tabh6_9m20r_17",B="_expense_tabh6_active_9m20r_32",A="_top_9m20r_39",ee="_mid_9m20r_43",se="_row_9m20r_47",ne="_input_9m20r_94",te="_down_9m20r_116",ie="_options_9m20r_122",ce="_option_9m20r_122",ae="_aadhar_9m20r_172",oe="_btn_9m20r_198",de="_row_search_9m20r_224",r={incomeForm:X,expense_tab:Z,expense_tabh6:Q,expense_tabh6_active:B,top:A,mid:ee,row:se,input:ne,down:te,options:ie,option:ce,aadhar:ae,btn:oe,row_search:de},re={position:"relative",zIndex:1},xe={position:"absolute",right:"0",top:"2.2vw",zIndex:10},_e={position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:10};function me({setIncomeData:i,open:x,onClose:a,incomeData:n,setIsOpen:s}){const{t:o}=R();return x?e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:a,style:_e}),e.jsxs("div",{style:xe,className:r.options,children:[e.jsx("div",{className:r.option,onClick:()=>{i({...n,tMode:"By Cash"}),s(!1)},children:o("by_cash")}),e.jsx("div",{className:r.option,onClick:()=>{i({...n,tMode:"By Bank"}),s(!1)},children:o("by_bank")})]})]}):null}function he({onRefetchWhenCreateExpense:i,setViewIndex:x}){const{t:a}=R(),n=F(d=>d.financeChange),[s]=H(),[o,b]=_.useState(!1),[j,S]=_.useState(0),[w,y]=_.useState(!1),[q,k]=_.useState(""),[E,C]=_.useState(!1),u=document.querySelector("textarea");u==null||u.addEventListener("keyup",d=>{u.style.height="auto";let l=d.target.scrollHeight;u.style.height=`${l}px`});const[g,v]=_.useState({tMode:""}),[f,T]=_.useState(""),t=d=>{T(()=>d.target.files[0])},[h,N]=_.useState({expensePaid:"",expenseAmount:"",expenseDesc:"",expense_quantity:"",expense_good_name:""}),m=d=>{k(d==null?void 0:d._id),y(!1),N(l=>({...l,expensePaid:d==null?void 0:d.userLegalName}))},L=d=>{d.preventDefault(),C(p=>!p);const l=new FormData;q||l.append("expensePaid",h.expensePaid),j===1&&(l.append("expense_quantity",h.expense_quantity),l.append("expense_good_name",h.expense_good_name)),l.append("expenseAmount",h.expenseAmount),l.append("expenseDesc",h.expenseDesc),l.append("expenseAccount",g.tMode),l.append("file",f),l&&s({fData:l,fid:n==null?void 0:n.fid,is_inventory:j===1?!0:"",user_query:q}).then(p=>{p.data.status&&(i(),x(0),C(I=>!I))}).catch(()=>{C(p=>!p)})};return e.jsxs("div",{className:r.incomeForm,children:[e.jsxs("div",{className:r.expense_tab,children:[e.jsx("h6",{className:j===0?`${r.expense_tabh6_active} ${r.expense_tabh6}`:r.expense_tabh6,onClick:()=>S(0),children:"Nominal Expenses"}),e.jsx("h6",{className:j===1?`${r.expense_tabh6_active} ${r.expense_tabh6}`:r.expense_tabh6,onClick:()=>S(1),children:"Assets / Inventory"})]}),e.jsxs("form",{onSubmit:L,children:[e.jsxs("div",{className:r.mid,children:[e.jsxs("div",{className:r.row,children:[e.jsx("h6",{children:a("select_transaction_mode")}),e.jsxs("div",{className:r.input,style:re,children:[e.jsxs("div",{children:[(g==null?void 0:g.tMode)!==""?e.jsx("h6",{onClick:()=>b(!0),children:g.tMode}):e.jsxs("h6",{onClick:()=>b(!0),children:[" ",a("please_select_transaction_mode")]}),e.jsx("img",{className:r.down,src:"/images/downn-icon.svg",alt:""})]}),e.jsx(me,{open:o,onClose:()=>b(!1),setIncomeData:v,incomeData:g,setIsOpen:b})]})]}),j===1&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:r.row,children:[e.jsx("h6",{children:a("name_of_good")}),e.jsx("input",{type:"text",placeholder:a("name_of_good_placeholder"),name:"expense_good_name",value:h.expense_good_name,onChange:d=>N({...h,expense_good_name:d.target.value}),required:!0})]}),e.jsxs("div",{className:r.row,children:[e.jsx("h6",{children:a("quantity_of_goods")}),e.jsx("input",{type:"number",placeholder:a("quantity_of_goods_placeholder"),name:"expense_quantity",value:h.expense_quantity,onChange:d=>N({...h,expense_quantity:d.target.value}),required:!0})]})]}),e.jsxs("div",{className:r.row,children:[e.jsx("h6",{children:a("amount")}),e.jsx("input",{type:"number",placeholder:a("enter_amount"),name:"expenseAmount",value:h.expenseAmount,onChange:d=>N({...h,expenseAmount:d.target.value}),required:!0})]}),e.jsxs("div",{className:r.row,children:[e.jsxs("h6",{children:[a("paid_to"),e.jsxs("span",{className:r.row_search,onClick:()=>y(!0),children:[e.jsx("img",{style:{width:"16px",height:"16px"},src:"/images/search-icon.svg",alt:"search icon"}),"Search & Select"]})]}),e.jsx("input",{type:"text",placeholder:a("paid_to_user"),name:"expensePaid",value:h.expensePaid,onChange:d=>N({...h,expensePaid:d.target.value}),required:!0})]}),e.jsxs("div",{className:r.row,children:[e.jsx("h6",{children:a("description")}),e.jsx("textarea",{className:r.postTextarea,type:"text",name:"expenseDesc",placeholder:a("description_details"),value:h.expenseDesc,onChange:d=>N({...h,expenseDesc:d.target.value})})]}),e.jsxs("div",{className:r.row,children:[e.jsx("h6",{children:a("ack_rcpt")}),e.jsx("input",{type:"file",className:r.aadhar,name:"file",onChange:t})]}),e.jsx("button",{type:"submit",className:r.btn,children:a("save_receipt")})]}),w&&e.jsx(K,{onClose:()=>y(!1),title:"Search User",disabledId:q,assignHead:w,headSelect:m})]}),E&&e.jsx(U,{})]})}const le="_incomeContainer_1ql8e_1",pe="_income_1ql8e_1",je="_incomeLeft_1ql8e_12",ue="_incomeRight_1ql8e_16",ge="_incomeLeftt_1ql8e_21",ve="_itemsContainer_1ql8e_25",fe="_rcv_1ql8e_30",Ne="_text_1ql8e_42",be="_btn_sticky_1ql8e_53",ye="_btn_1ql8e_53",qe="_history_1ql8e_69",Ce="_incomeRightt_1ql8e_79",Se="_incomeTop_1ql8e_83",we="_right_1ql8e_95",Ee="_rightHead_1ql8e_103",ke="_rightBody_1ql8e_127",Le="_detail_1ql8e_160",Re="_detailTop_1ql8e_164",Te="_detailTopLeft_1ql8e_174",Ie="_detailTopMid_1ql8e_191",Pe="_detailTopRight_1ql8e_202",Fe="_detailContent_1ql8e_217",$e="_imagediv_1ql8e_248",Me="_backh_1ql8e_269",Oe="_invoice_number_1ql8e_282",Ve="_card_container_1ql8e_294",He="_sidebarheader_1ql8e_305",c={incomeContainer:le,income:pe,incomeLeft:je,incomeRight:ue,incomeLeftt:ge,itemsContainer:ve,rcv:fe,text:Ne,btn_sticky:be,btn:ye,history:qe,incomeRightt:Ce,incomeTop:Se,right:we,rightHead:Ee,rightBody:ke,detail:Le,detailTop:Re,detailTopLeft:Te,detailTopMid:Ie,detailTopRight:Pe,detailContent:Fe,imagediv:$e,backh:Me,invoice_number:Oe,card_container:Ve,sidebarheader:He};function P({expense:i,setDetailView:x,setExpenseId:a,all:n}){var o;const{t:s}=R();return e.jsxs("div",{onClick:()=>{x(!0),a(i)},className:c.card_container,children:[e.jsxs("h6",{className:c.invoice_number,children:["Invoice No: ",n==null?void 0:n.invoice_number]}),e.jsxs("div",{className:c.sidebarheader,children:[e.jsxs("div",{className:c.text,children:[e.jsxs("p",{className:c.rcv,children:[s("paid_to"),e.jsxs("span",{style:{position:"absolute",right:"2%",marginTop:"-5px"},children:[n!=null&&n.expense_quantity?n==null?void 0:n.expense_quantity:"N/A "," Quantity"]})]}),e.jsx("h6",{children:n!=null&&n.expensePaid?n==null?void 0:n.expensePaid:(o=n==null?void 0:n.expensePaidUser)==null?void 0:o.userLegalName}),e.jsx("p",{className:c.rcv,children:M(n==null?void 0:n.createdAt).format("LL")})]}),e.jsxs("div",{className:c.text,children:[e.jsx("p",{className:c.rcv1}),e.jsxs("h6",{children:["Rs. ",n==null?void 0:n.expenseAmount]}),e.jsx("p",{className:c.rcv,children:n==null?void 0:n.expenseAccount})]})]})]})}const Ue=$.forwardRef((i,x)=>{var a;return e.jsxs("div",{className:c.incomeLeftt,children:[!(i!=null&&i.fId)&&e.jsx("div",{className:`${c.btn} ${c.btn_sticky}`,onClick:i==null?void 0:i.viewForm,children:e.jsx("img",{src:"/images/addplus.svg",alt:""})}),e.jsx("div",{className:c.itemsContainer,children:(a=i==null?void 0:i.allExpense)==null?void 0:a.map((n,s)=>{var o;return((o=i==null?void 0:i.allExpense)==null?void 0:o.length)===s+1?e.jsx("div",{ref:x,children:e.jsx(P,{expense:`${n==null?void 0:n._id}`,setDetailView:i==null?void 0:i.setDetailView,setExpenseId:i==null?void 0:i.setExpenseId,all:n})},s):e.jsx(P,{expense:`${n==null?void 0:n._id}`,setDetailView:i==null?void 0:i.setDetailView,setExpenseId:i==null?void 0:i.setExpenseId,all:n},s)})})]})});function Ye({detailview:i,eBalance:x,expenseId:a,setDetailView:n}){var b,j,S,w,y,q,k,E,C,u,g,v,f;const{data:s}=Y(`${a}`,{skip:!a}),{t:o}=R();return e.jsx(e.Fragment,{children:e.jsx("div",{className:c.incomeRightt,children:i?e.jsxs("div",{className:c.detail,children:[e.jsxs("div",{className:c.detailTop,children:[e.jsx("div",{className:c.detailTopLeft,children:e.jsx("h6",{onClick:()=>n(!1),children:o("back")})}),e.jsx("div",{className:c.detailTopMid,children:e.jsx("h6",{children:(b=s==null?void 0:s.oneExpense)!=null&&b.expensePaid?(j=s==null?void 0:s.oneExpense)==null?void 0:j.expensePaid:(w=(S=s==null?void 0:s.oneExpense)==null?void 0:S.expensePaidUser)==null?void 0:w.userLegalName})}),e.jsxs("div",{className:c.detailTopRight,children:["Rs. ",(y=s==null?void 0:s.oneExpense)==null?void 0:y.expenseAmount]})]}),e.jsxs("div",{className:c.detailContent,children:[e.jsx("p",{children:o("transaction_mode")}),e.jsxs("h6",{children:[(q=s==null?void 0:s.oneExpense)==null?void 0:q.expenseAccount," ",o("payment")," "]})]}),(k=s==null?void 0:s.oneExpense)!=null&&k.expense_good_name?e.jsxs("div",{className:c.detailContent,children:[e.jsx("p",{children:o("name_of_good")}),e.jsx("h6",{children:(E=s==null?void 0:s.oneExpense)==null?void 0:E.expense_good_name})]}):"",(C=s==null?void 0:s.oneExpense)!=null&&C.expense_quantity?e.jsxs("div",{className:c.detailContent,children:[e.jsx("p",{children:o("quantity_of_goods")}),e.jsx("h6",{children:(u=s==null?void 0:s.oneExpense)==null?void 0:u.expense_quantity})]}):"",e.jsxs("div",{className:c.detailContent,children:[e.jsx("p",{children:o("reason")}),e.jsx("h6",{children:(g=s==null?void 0:s.oneExpense)==null?void 0:g.expensePurpose})]}),e.jsxs("div",{className:c.detailContent,children:[e.jsx("p",{children:o("description")}),e.jsx("h6",{children:(v=s==null?void 0:s.oneExpense)==null?void 0:v.expenseDesc})]}),e.jsxs("div",{className:c.detailContent,children:[e.jsx("p",{children:o("day_date")}),e.jsx("h6",{children:M((f=s==null?void 0:s.oneExpense)==null?void 0:f.createdAt).format("LL")})]}),e.jsxs("div",{className:c.detailContent,children:[e.jsx("p",{children:o("ack_rcpt")}),e.jsxs("div",{className:c.imagediv,children:[e.jsx("img",{src:"/images/image-icon.svg",alt:""}),e.jsx("p",{children:"img07.png"})]})]})]}):e.jsxs("div",{className:c.right,children:[e.jsxs("div",{className:c.rightHead,children:[e.jsx("h6",{children:o("total_expenditure")}),e.jsxs("h6",{children:["Rs."," ",(x==null?void 0:x.financeExpenseCashBalance)+(x==null?void 0:x.financeExpenseBankBalance)]})]}),e.jsxs("div",{className:c.rightBody,children:[e.jsxs("h6",{children:[" ",o("by_cash")," : Rs. ",x==null?void 0:x.financeExpenseCashBalance]}),e.jsxs("h6",{children:[" ",o("by_bank")," : Rs. ",x==null?void 0:x.financeExpenseBankBalance]})]})]})})})}function We({fId:i}){const{t:x}=R(),[a,n]=_.useState(0),[s,o]=_.useState(!1),[b,j]=_.useState(""),[S,w]=_.useState(1),[y,q]=_.useState(!0),[k,E]=z(),[C,u]=$.useState([]),[g,v]=_.useState(!0),[f,T]=_.useState(!1),t=F(p=>p.financeChange),{data:h,refetch:N}=G(`${t!=null&&t.fid?t==null?void 0:t.fid:i}`,{skip:t!=null&&t.fid?!(t!=null&&t.fid):!i}),{data:m,refetch:L}=J({fid:`${t!=null&&t.fid?t==null?void 0:t.fid:i}`,page:S,limit:10},{skip:t!=null&&t.fid?!(t!=null&&t.fid):!i}),{scrollToTop:d}=W();_.useEffect(()=>{d()},[]),_.useEffect(()=>{(i||t!=null&&t.fid)&&N()},[N,t==null?void 0:t.fid,i]),_.useEffect(()=>{E&&y&&w(p=>p+1)},[E,y]),_.useEffect(()=>{f&&w(1)},[f]),_.useEffect(()=>{(i||t!=null&&t.fid)&&(v(!0),L())},[S,i,t==null?void 0:t.fid,L]),_.useEffect(()=>{f&&(t!=null&&t.fid)&&(v(!0),L())},[f,t==null?void 0:t.fid,L]),_.useEffect(()=>{var p,I;if(f)u(m==null?void 0:m.allIncome),T(!1),v(!1);else if(m!=null&&m.allIncome){const O=[...C,...m==null?void 0:m.allIncome],V=[...new Set(O.map(JSON.stringify))].map(JSON.parse);u(V),v(!1)}else((p=m==null?void 0:m.allIncome)==null?void 0:p.length)===0&&v(!1);((I=m==null?void 0:m.allIncome)==null?void 0:I.length)===10?q(!0):q(!1)},[m==null?void 0:m.allIncome]);const l=()=>{T(!0),N()};return e.jsxs(e.Fragment,{children:[a===0&&e.jsxs("div",{className:c.incomeContainer,children:[e.jsx("div",{className:c.incomeTop,children:e.jsx("div",{className:c.history,children:x("payment_history")})}),e.jsxs("div",{className:c.income,children:[e.jsxs("div",{className:c.incomeLeft,children:[e.jsx(Ue,{viewForm:()=>n(1),setDetailView:o,allExpense:C,setExpenseId:j,fId:i,ref:k}),g&&e.jsx(D,{})]}),e.jsx("div",{className:c.incomeRight,children:e.jsx(Ye,{detailview:s,eBalance:h==null?void 0:h.expenseBalance,expenseId:b,setExpenseId:j,setDetailView:o})})]})]}),a===1&&e.jsx("div",{className:c.income,children:e.jsx(he,{setViewIndex:n,onRefetchWhenCreateExpense:l})})]})}export{We as default};
