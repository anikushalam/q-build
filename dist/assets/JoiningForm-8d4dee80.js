import{r as a,u as E,k as T,t as ms,j as s,g as us,a_ as hs,c as os,f as xs,Q as rs,N as ds,kf as _,bo as js}from"./index-731451a5.js";import{s as t}from"./JoiningForm.module-3d067e90.js";import{f as fs,g as ps,h as gs}from"./admission-api-56b87fde.js";import{A as _s}from"./ApplicationPreviewDetail-fd29a331.js";import{S as Ns}from"./SelectFeeStructure-05d0a31f.js";import"./finance-api-5c6c5671.js";import"./JoinFormInputView-879755fe.js";import"./JoinForm.module-212f9bb3.js";import"./FeesStructure.module-7a88fbbc.js";import"./Overlay-07ce6f88.js";import"./Overlay.module-9133d1bb.js";import"./SearchModalBackdrop-5b309d60.js";import"./SearchHeader.module-b69c8942.js";import"./EditConfirm.module-344fbdb9.js";import"./CustomNormalSelectInput-9ec7329b.js";import"./DatePicker-305f3dc6.js";import"./JoinFormInput-8e74a0e0.js";import"./StringLength.module-75a6e080.js";import"./SeatingArrangement.module-3f4ae6aa.js";import"./PopupWrapper-ffbaef7a.js";import"./SearchModalWrapper-6e85c9f3.js";import"./CustomSelectDepartment-a5dd9a35.js";import"./hostel-api-4d11cb04.js";import"./transport-api-9ab21e71.js";import"./BorderBottom-47800983.js";import"./JoinFormCalender-5158d888.js";function vs({setIndex:d,key:r,ref:n,applyData:i}){const{t:m}=E(),j=us();return s.jsx(s.Fragment,{children:(i==null?void 0:i.applicationTypeStatus)==="Normal Application"?s.jsxs("div",{className:t.card,onClick:()=>{var o;j(hs.admissionQuery({studentAppId:i==null?void 0:i._id,studentAdminId:(o=i==null?void 0:i.admissionAdmin)==null?void 0:o._id})),d(5)},ref:n,style:{display:"flex",alignItems:"center",justifyContent:"flex-start",gap:"1rem"},children:[s.jsx("img",{src:"/images/members/admission-application-icon.svg",alt:"admission icon"}),s.jsxs("div",{style:{width:"100%"},children:[s.jsxs("div",{className:t.cardRow,children:[s.jsx("h6",{children:i==null?void 0:i.applicationName}),(i==null?void 0:i.application_type)==="Direct Admisison"&&s.jsx("img",{src:"/images/members/application-hotspot-icon.svg",alt:"admission icon"})]}),s.jsxs("div",{className:t.cardRow,children:[(i==null?void 0:i.applicationEndDate)&&s.jsx("p",{children:m("last_date_to_apply")}),i!=null&&i.applicationEndDate?s.jsx("h6",{style:{marginBottom:"0"},children:i==null?void 0:i.applicationEndDate}):""]})]})]},r):s.jsx("div",{ref:n},r)})}function Ss({setIndex:d}){const[r,n]=a.useState(!0),[i,m]=a.useState(1),{t:j}=E(),o=T(e=>e.idChange.searchProfile),[u,p]=ms(),[f,N]=a.useState([]),{allAppAtInstitute:l,allAppAtInstituteRefetch:c}=fs({data:{id:o==null?void 0:o.id,page:i,limit:10},skip:!(o!=null&&o.id)});return a.useEffect(()=>{o!=null&&o.id&&c()},[i,o==null?void 0:o.id,c]),a.useEffect(()=>{p&&r&&m(e=>e+1)},[p,r]),a.useEffect(()=>{var e;l!=null&&l.allApp&&N([...new Set([...f,...l==null?void 0:l.allApp])]),((e=l==null?void 0:l.allApp)==null?void 0:e.length)===10?n(!0):n(!1)},[l==null?void 0:l.allApp]),s.jsxs("div",{className:t.applications,children:[s.jsx("div",{className:t.top,children:j("join_or_apply_instutude")}),s.jsxs("div",{className:t.content,children:[s.jsxs("div",{className:t.contenttop,children:[s.jsx("p",{style:{fontWeight:"600"},children:j("existing_student_and_staff_join")}),s.jsx("div",{className:t.btn,onClick:()=>d(2),children:j("apply")})]}),s.jsxs("div",{className:t.contentBottom,children:[s.jsx("h6",{children:j("new_application")}),s.jsx("div",{className:t.cardsContainer,children:f==null?void 0:f.map((e,v)=>s.jsx(vs,{setIndex:d,ref:u,applyData:e},v))})]})]})]})}function bs({join:d,applicantUserName:r}){var S;const{t:n}=E(),[i,m]=a.useState(!1),[j,o]=a.useState(!0),[u,p]=a.useState(""),[f,N]=a.useState({msg:"",run:!1}),l=os(),{searchCodeForJoin:c,searchCodeForJoinRefetch:e}=xs({data:{code:u,joinAs:d},skip:j}),v=()=>{u&&(m(!0),o(h=>!h),e())};a.useEffect(()=>{var h,b;c!=null&&c.seen?(h=c==null?void 0:c.classes)!=null&&h.classCode?(m(!1),l("/q/joining",{state:{joinCode:u,formAs:"STUDENT",urlUsername:r}})):(b=c==null?void 0:c.one_ins)!=null&&b.staffJoinCode?(m(!1),l("/q/joining",{state:{joinCode:u,formAs:"STAFF",urlUsername:r}})):(m(!1),N({msg:"Enter code is not valid!",run:!!u})):(m(!1),N({msg:"Enter code is not valid!",run:!!u}))},[(S=c==null?void 0:c.classes)==null?void 0:S.classCode,c==null?void 0:c.one_ins,c==null?void 0:c.seen]);const w=()=>{u&&(m(!0),o(h=>!h),e())};return s.jsxs(s.Fragment,{children:[d==="Student"&&s.jsxs("div",{className:t.applications,children:[s.jsx("div",{className:t.top,children:n("existing_student")}),s.jsxs("div",{className:t.content2,children:[s.jsx("h6",{children:n("enter_code")}),s.jsx("input",{type:"text",pattern:"[a-zA-Z0-9]+",maxlength:"6",value:u,onChange:h=>p(h.target.value)}),u.length!==6?s.jsx("button",{type:"submit",className:t.disabledBtn,children:n("fill_the_form")}):s.jsx("button",{type:"submit",className:t.fillbtn,onClick:w,children:n("fill_the_form")}),s.jsx("h6",{className:t.tips,children:n("get_registration_code")}),s.jsxs("ol",{children:[s.jsx("li",{children:s.jsx("p",{className:t.tip,children:n("registration_step_1")})}),s.jsx("li",{children:s.jsx("p",{className:t.tip,children:n("registration_step_2")})}),s.jsx("li",{children:s.jsx("p",{className:t.tip,children:n("registration_step_3")})})]})]})]}),d==="Staff"&&s.jsxs("div",{className:t.applications,children:[s.jsx("div",{className:t.top,children:n("existing_student")}),s.jsxs("div",{className:t.content2,children:[s.jsx("h6",{children:n("enter_code")}),s.jsx("input",{type:"text",pattern:"[a-zA-Z0-9]+",maxlength:"6",value:u,onChange:h=>p(h.target.value)}),u.length!==6?s.jsx("button",{type:"submit",className:t.disabledBtn,children:n("fill_the_form")}):s.jsx("button",{type:"submit",className:t.fillbtn,onClick:v,children:s.jsxs("span",{children:[" ",n("fill_the_form")]})})]})]}),i&&s.jsx(rs,{}),s.jsx(ds,{msg:f.msg,run:f.run,setRun:()=>N({msg:"",run:!1}),postiton:"bottom",type:"error"})]})}function cs({text:d,img:r,setJoin:n,option:i,setIndex:m}){return s.jsxs("div",{className:t.singleOption,onClick:()=>{n(i),m(3)},children:[s.jsx("img",{src:r,alt:""}),s.jsx("h6",{children:d})]})}function Cs({setJoin:d,setIndex:r}){const{t:n}=E();return s.jsxs("div",{className:t.applications,children:[s.jsx("div",{className:t.top,children:n("existing_student_and_join")}),s.jsxs("div",{className:t.content,children:[s.jsx("div",{className:t.contenttop,children:s.jsx("p",{children:n("to_join_or_appy")})}),s.jsxs("div",{className:t.contentBottom,children:[s.jsx(cs,{text:n("as_staff_"),option:"Staff",img:"/images/members/staff.svg",setJoin:d,setIndex:r}),s.jsx(cs,{text:n("as_student_"),img:"/images/members/student.svg",setJoin:d,setIndex:r,option:"Student"})]})]})]})}function Es({setIndex:d,applicantUserName:r}){var R,A,k,y,P,B,O,U,F,L,M,V,q,I,Q,W,z,Y,Z,$;const n=T(x=>x.admissionChange),i=T(x=>x.idChange.id),[m,j]=a.useState(!1),[o,u]=a.useState(""),[p,f]=a.useState({msg:"",run:!1}),[N,l]=a.useState(!1),c=os(),{oneApplicationDetail:e,oneApplicationDetailRefetch:v}=ps({apid:n==null?void 0:n.studentAppId,skip:!(n!=null&&n.studentAppId)}),[w]=gs();a.useEffect(()=>{n!=null&&n.studentAppId&&v()},[n==null?void 0:n.studentAppId,v]);const S=()=>{var x,C;(x=e==null?void 0:e.oneApply)!=null&&x._id&&i&&(l(g=>!g),w({uid:i,aid:(C=e==null?void 0:e.oneApply)==null?void 0:C._id}).then(g=>{var G,H,K,X,J,D,ss,es,ts,ns,is;l(as=>!as),(G=g==null?void 0:g.data)!=null&&G.denied?f({msg:(H=g==null?void 0:g.data)==null?void 0:H.message,run:!0}):c("/q/joining",{state:{formAs:"STUDENT",openAs:((K=e==null?void 0:e.oneApply)==null?void 0:K.application_type)==="Direct Admisison"?"ADMISSION_DIRECT_APPLY":"ADMISSION_APPLY",appId:(X=e==null?void 0:e.oneApply)==null?void 0:X._id,urlUsername:r,first_install:((J=e==null?void 0:e.oneApply)==null?void 0:J.application_type)==="Direct Admisison"?(es=(ss=(D=e==null?void 0:e.oneApply)==null?void 0:D.direct_linked_structure)==null?void 0:ss.one_installments)==null?void 0:es.fees:0,applicationName:(ts=e==null?void 0:e.oneApply)==null?void 0:ts.applicationName,departmentId:(is=(ns=e==null?void 0:e.oneApply)==null?void 0:ns.applicationDepartment)==null?void 0:is._id,whichFormShow:"DEPARTMENT"}})}).catch({}))},h=()=>{j(x=>!x)},b=x=>{u(x),h()},ls=()=>{u(""),h()};return s.jsxs("div",{className:t.applications,children:[s.jsxs("div",{className:t.top1,children:[s.jsx("img",{src:"/images/left-nav-icon.svg",alt:"",onClick:()=>d(1)}),s.jsx("h6",{children:(R=e==null?void 0:e.oneApply)==null?void 0:R.applicationName}),s.jsx("div",{})]}),s.jsxs("div",{className:t.content,children:[s.jsxs("div",{className:t.contentColumn,children:[s.jsx("p",{children:_("department")}),s.jsx("h6",{children:(k=(A=e==null?void 0:e.oneApply)==null?void 0:A.applicationDepartment)==null?void 0:k.dName})]}),s.jsx("div",{className:t.contentRow,children:s.jsxs("button",{className:t.admission_fees_btn,title:"See All Fees",onClick:h,children:[s.jsx("div",{children:_("admission_fees")}),s.jsx("img",{src:"/images/forward-right-icon.svg",alt:"next step"})]})}),s.jsxs("div",{className:t.contentRow,children:[(y=e==null?void 0:e.oneApply)!=null&&y.applicationStartDate?s.jsxs("div",{className:t.contentColumn,children:[s.jsx("p",{children:_("starting_date")}),s.jsx("h6",{children:(P=e==null?void 0:e.oneApply)==null?void 0:P.applicationStartDate})]}):"",(B=e==null?void 0:e.oneApply)!=null&&B.applicationEndDate?s.jsxs("div",{className:t.contentColumn,children:[s.jsx("p",{children:_("last_date")}),s.jsx("h6",{children:(O=e==null?void 0:e.oneApply)==null?void 0:O.applicationEndDate})]}):""]}),s.jsxs("div",{className:t.contentRow,children:[(U=e==null?void 0:e.oneApply)!=null&&U.applicationSeats?s.jsxs("div",{className:t.contentColumn,children:[s.jsx("p",{children:_("available_sets")}),s.jsx("h6",{children:(F=e==null?void 0:e.oneApply)==null?void 0:F.applicationSeats})]}):"",(L=e==null?void 0:e.oneApply)!=null&&L.applicationPhoto?s.jsx("div",{className:t.contentColumn,children:s.jsx("a",{title:"Download File",href:`${js}/${(M=e==null?void 0:e.oneApply)==null?void 0:M.applicationPhoto}`,target:"_blank",rel:"noopener noreferrer",children:s.jsx("button",{className:t.admission_fees_btn,children:s.jsx("div",{children:_("application_brochure")})})})}):""]}),(V=e==null?void 0:e.oneApply)!=null&&V.applicationAbout?s.jsxs("div",{className:t.contentColumn,children:[s.jsx("p",{children:_("application_info")}),(Q=(I=(q=e==null?void 0:e.oneApply)==null?void 0:q.applicationAbout)==null?void 0:I.split(`
`))==null?void 0:Q.map((x,C)=>s.jsx("h6",{children:x},C))]}):"",s.jsx("div",{className:t.applyBtn,onClick:S,children:_("apply_to_fill_application_form")}),m&&s.jsx(Ns,{onClose:h,departmentId:((z=(W=e==null?void 0:e.oneApply)==null?void 0:W.applicationDepartment)==null?void 0:z._id)??"",classMasterId:((Y=e==null?void 0:e.oneApply)==null?void 0:Y.applicationMaster)??"",batchId:($=(Z=e==null?void 0:e.oneApply)==null?void 0:Z.applicationBatch)==null?void 0:$._id,onSelectedStrucutre:b,asOpen:"STUDENT_VIEW_STRUCTURE"}),o&&s.jsx(_s,{structureId:o,setStructureId:ls,viewAs:"STUDENT"}),s.jsx(ds,{msg:p.msg,run:p.run,setRun:()=>f({msg:"",run:!1}),postiton:"bottom",type:"error"})]}),N&&s.jsx(rs,{})]})}function Js({applicantUserName:d}){const[r,n]=a.useState(1),[i,m]=a.useState("");return s.jsxs("div",{className:t.joiningForm,children:[r===1&&s.jsx(Ss,{setIndex:n}),r===2&&s.jsx(Cs,{setIndex:n,setJoin:m}),r===3&&s.jsx(bs,{join:i,applicantUserName:d}),r===5&&s.jsx(Es,{setIndex:n,applicantUserName:d})]})}export{Js as default};
