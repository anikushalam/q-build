import{u as F,d as V,j as e,n as ce,r as o,lv as ne,Q as B,t as D,l as Q,a1 as X,S as A,e as Z,N as me,c as oe,b as re,lw as le}from"./index-731451a5.js";import{s as $}from"./Hostel.module-50da11fe.js";import{B as de,C as he,D as _e,E as xe,F as je,d as fe}from"./transport-api-9ab21e71.js";import{s as U,h as pe,i as G,T as ge,g as ve,V as Ne,b as be,P as Se,c as ue,d as we,f as Ie,e as $e,a as ye}from"./TransportPendingFees-e5010396.js";import{s as m}from"./Deposit.module-954352af.js";import{B as H}from"./BorderBottom-47800983.js";import{U as Ee}from"./UniversalTab-d4f2174c.js";import{J as Re}from"./JoinFormInput-8e74a0e0.js";import{w as Oe,x as Pe}from"./finance-api-5c6c5671.js";import{P as Te}from"./PopupWrapper-ffbaef7a.js";import{P as Ue}from"./PaymentModeType-cf3d04e2.js";import"./HostelSiteInfo.module-332fbdef.js";import"./JoinFormTextArea-7f6dded0.js";import"./JoinForm.module-212f9bb3.js";import"./JoinFormFileEdit-e41481d6.js";import"./ViewFileDialog-0c131c06.js";import"./Overlay-07ce6f88.js";import"./Overlay.module-9133d1bb.js";import"./SearchModalBackdrop-5b309d60.js";import"./SearchHeader.module-b69c8942.js";import"./Funds.module-7551169c.js";import"./FeesCategoryList-8131ad8c.js";import"./FeesStructure.module-7a88fbbc.js";import"./StringLength-222a9fd1.js";import"./StringLength.module-75a6e080.js";import"./ButtonWithAction-805b1066.js";import"./LoaderButton-71df50a7.js";import"./EditConfirm.module-344fbdb9.js";import"./ApplicationPreviewDetail-fd29a331.js";import"./JoinFormInputView-879755fe.js";import"./CustomNormalSelectInput-9ec7329b.js";import"./DatePicker-305f3dc6.js";import"./SeatingArrangement.module-3f4ae6aa.js";import"./CustomSelectDepartment-a5dd9a35.js";import"./hostel-api-4d11cb04.js";import"./JoinFormCalender-5158d888.js";import"./HostelFeeStructure.module-5a40a31e.js";import"./AssignStaffModal-61be8e90.js";import"./search-api-15f7f9f9.js";import"./AssignStaffModal.module-a60b32e1.js";import"./SearchUniversalUser-4ed43b07.js";import"./AdmissionApplicationRequest.module-43e4e129.js";import"./pdf-convertor-function-e794de58.js";import"./main.receipt.pdf.worker-5753b302.js";import"./numberToWords.min-dbca819b.js";import"./institute-staff-student-api-7f4890fe.js";import"./AdmissionScholarship.module-d4281c11.js";import"./SearchModalWrapper-6e85c9f3.js";function Ge({tid:s,transport:c,onRefetch:l,carryParentState:t,accessRole:h,accessTpye:f,callApi:x}){var N,w,j,_,b,I,u,r,R,d,T,P,p,i;const{t:g}=F(),n=V();return e.jsx("div",{className:U.MiddleContent,style:((N=n==null?void 0:n.search)==null?void 0:N.substring(9))==="category"||((w=n==null?void 0:n.search)==null?void 0:w.substring(9))==="structure"?{marginTop:"0"}:{color:"inherit"},children:e.jsxs("div",{className:U.MiddleContentLeft,children:[e.jsx("div",{className:U.tabs,children:e.jsx(pe,{search:n==null?void 0:n.search,carryParentState:t})}),!(n!=null&&n.search)&&e.jsxs("div",{className:U.item,children:[e.jsx(G,{carryParentState:t,activeTab:"vehicle",accessRole:h,accessTpye:f,callApi:x,children:e.jsxs("div",{className:U.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/transport/transport-vehicle-icon.svg",alt:"moderator icon"}),e.jsx("p",{children:g("transport_vehicles")})]})}),e.jsx(G,{carryParentState:t,activeTab:"personal",accessRole:h,accessTpye:f,callApi:x,children:e.jsxs("div",{className:U.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/transport/transport-personal-icon.svg",alt:"completed"}),e.jsx("p",{children:g("transportation_personal")})]})}),e.jsx(G,{carryParentState:t,activeTab:"passenger",accessRole:h,accessTpye:f,callApi:x,children:e.jsxs("div",{className:U.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/transport/transport-passenger-icon.svg",alt:"inquery"}),e.jsx("p",{children:g("all_passengers_student")})]})}),e.jsx(G,{carryParentState:t,activeTab:"pending",accessRole:h,accessTpye:f,callApi:x,children:e.jsxs("div",{className:U.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/finance/finance-pending-icon.svg",alt:"refund"}),e.jsx("p",{children:g("pending_fees")})]})}),e.jsx(G,{activeTab:"deposit",carryParentState:t,accessRole:h,accessTpye:f,callApi:x,children:e.jsxs("div",{className:U.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/finance/finance-deposit-icon.svg",alt:"refund"}),e.jsx("p",{children:g("finance_deposit")})]})}),e.jsx(G,{carryParentState:t,activeTab:"batch",accessRole:h,accessTpye:f,callApi:x,children:e.jsxs("div",{className:U.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/hostel/hostel-batch-icon.svg",alt:"completed"}),e.jsx("p",{children:g("hostel_tab_batch")})]})}),e.jsx(G,{carryParentState:t,activeTab:"linked",accessRole:h,accessTpye:f,callApi:x,children:e.jsxs("div",{className:U.itemIcon,children:[e.jsx("img",{src:"/images/member_tab/transport/transport-institute-link-icon.svg",alt:"completed"}),e.jsx("p",{children:g("linked_institute")})]})})]}),((j=n==null?void 0:n.search)==null?void 0:j.substring(3))==="fund"&&e.jsx("div",{className:U.classList,children:e.jsx(ge,{tid:s,transport:c,onRefetch:l})}),((_=n==null?void 0:n.search)==null?void 0:_.substring(3,6))==="fee"&&e.jsx(ve,{financeId:(u=(I=(b=c==null?void 0:c.institute)==null?void 0:b.financeDepart)==null?void 0:I[0])==null?void 0:u._id,fees_category_count:(d=(R=(r=c==null?void 0:c.institute)==null?void 0:r.financeDepart)==null?void 0:R[0])==null?void 0:d.fees_category_count,fee_master_array_count:(p=(P=(T=c==null?void 0:c.institute)==null?void 0:T.financeDepart)==null?void 0:P[0])==null?void 0:p.fee_master_array_count,fee_structure_count:c==null?void 0:c.fees_structures_count,carryParentState:t,accessRole:h,transportId:c==null?void 0:c._id,instituteId:(i=c==null?void 0:c.institute)==null?void 0:i._id,callApi:x})]})})}const Fe=({transport:s,tid:c,carryParentState:l,onRefetch:t})=>{var P,p,i;const{t:h}=F(),f=ce(),[x,g]=o.useState(""),[n,N]=o.useState(""),[w,j]=o.useState(!1),[_,b]=o.useState(!1),[I,u]=o.useState(""),[r]=de(),[R,d]=o.useState(!1);o.useEffect(()=>{if(_){d(O=>!O);let y=new FormData;y.append("file",n),r({uploadFile:y,tid:c}).then(()=>{d(O=>!O)}).catch({})}},[_,n]);const T=y=>{const O=URL.createObjectURL(y.target.files[0]);N(y.target.files[0]),u(O),g(O),j(!0)};return e.jsxs(e.Fragment,{children:[e.jsx(ne,{coverKey:s==null?void 0:s.transport_photo,coverId:s!=null&&s.transport_photo?"0":"2",defaultCover:"/images/profileAndCover/transport-cover.svg",textLarge:h("transport_manager"),textSmall:`${((P=s==null?void 0:s.transport_manager)==null?void 0:P.staffFirstName)??""} ${((p=s==null?void 0:s.transport_manager)==null?void 0:p.staffMiddleName)??""} ${((i=s==null?void 0:s.transport_manager)==null?void 0:i.staffLastName)??""}`,count1:s==null?void 0:s.vehicle_count,count1label:h("vechiles"),count2:s==null?void 0:s.transport_staff_count,count2label:h("transport_personal"),count3:s==null?void 0:s.passenger_count,count3label:h("passengers"),profilePhoto:I,profileChange:T,openCrop:w,setOpenCrop:j,setPhotoURL:g,photoURL:x,setFile:N,setUpload:b,setProfilePhoto:u,coverUpdate:!0,isTransport:"TRANSPORT_MANAGER",redirectUrl:`/q/${f.username}/member/transport?a=site`,carryParentState:l,coverImageStyle:{height:"auto"}}),e.jsx(Ge,{transport:s,onRefetch:t,tid:c,carryParentState:l}),R&&e.jsx(B,{})]})},Je=({refund_amount:s,refund_student_count:c,transportId:l})=>{const{t}=F(),[h,f]=o.useState(!0),[x,g]=o.useState(""),[n,N]=o.useState(1),[w,j]=D(),[_,b]=o.useState([]),[I,u]=o.useState(!0),[r,R]=o.useState(!1),{getAllDepositRefundByTransport:d,getAllDepositRefundByTransportRefetch:T}=he({data:{tid:l,page:n,limit:10,search:x},skip:!l});o.useEffect(()=>{j&&h&&N(i=>i+1)},[j,h]),o.useEffect(()=>{l&&T()},[n,l,T]),o.useEffect(()=>{var i,y;x?(b(d==null?void 0:d.all_receipts),u(!1)):r?(b(d==null?void 0:d.all_receipts),R(!1),u(!1)):d!=null&&d.all_receipts?(b(O=>[...new Set([...O,...d==null?void 0:d.all_receipts].map(JSON.stringify))].map(JSON.parse)),u(!1)):((i=d==null?void 0:d.all_receipts)==null?void 0:i.length)===0&&u(!1),((y=d==null?void 0:d.all_receipts)==null?void 0:y.length)===10?f(!0):f(!1)},[d==null?void 0:d.all_receipts]);const P=o.useCallback(Q.debounce(i=>g(i),500),[]),p=i=>{P(i.target.value)};return e.jsxs("div",{children:[e.jsxs("section",{className:m.unused_container,children:[e.jsx("img",{src:"/images/rupee-symobl-icon.svg",alt:"rupee symobl"}),e.jsxs("div",{className:m.unused_container_text,children:[e.jsxs("div",{className:m.unused_container_text_inner,children:[e.jsx("h6",{children:t("total_refunded")}),e.jsxs("h6",{children:[t("rs")," ",s??0]})]}),e.jsx("div",{className:m.unused_container_text_inner,children:e.jsxs("p",{children:[t("deposit_of")," ",c??0," ",t("deposit_student")]})})]})]}),e.jsxs("div",{className:m.with_search,style:{marginBottom:"1rem"},children:[e.jsx("h6",{children:t("refunded_history")}),e.jsx("section",{className:m.search_container,children:e.jsxs("div",{className:m.search_container_input,children:[e.jsx("img",{className:m.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search",onChange:p})]})})]}),e.jsxs("div",{className:m.refund_list,children:[_==null?void 0:_.map((i,y)=>{var O,L,M,W,z,v,J,K,Y,q;return(_==null?void 0:_.length)===y+1?e.jsxs("div",{className:m.corpus_card,ref:w,children:[e.jsxs("h6",{style:{textAlign:"center"},children:[t("invoice_number"),(i==null?void 0:i.invoice_count)??""]}),e.jsx("p",{className:m.recieve_from,children:t("paid_to")}),e.jsxs("div",{className:m.unused_container_text_inner,children:[e.jsx("h6",{children:`${((O=i==null?void 0:i.student)==null?void 0:O.studentFirstName)??""} ${((L=i==null?void 0:i.student)==null?void 0:L.studentMiddleName)??""} ${((M=i==null?void 0:i.student)==null?void 0:M.studentLastName)??""}`}),e.jsxs("h6",{children:[t("rs")," ",(i==null?void 0:i.fee_payment_amount)??0]})]}),e.jsxs("div",{className:m.unused_container_text_inner,children:[e.jsxs("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:[(W=X(i==null?void 0:i.created_at))==null?void 0:W.format("DD MMM yyyy"),","," ",(z=X(i==null?void 0:i.created_at))==null?void 0:z.format("LT")]}),e.jsx("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:(i==null?void 0:i.fee_payment_mode)==="Online"?"Bank":"Cash"})]})]},y):e.jsxs("div",{className:m.corpus_card,children:[e.jsxs("h6",{style:{textAlign:"center"},children:[t("invoice_number"),(i==null?void 0:i.invoice_count)??""]}),e.jsx("p",{className:m.recieve_from,children:t("paid_to")}),e.jsxs("div",{className:m.unused_container_text_inner,children:[e.jsx("h6",{children:`${((v=i==null?void 0:i.student)==null?void 0:v.studentFirstName)??""} ${((J=i==null?void 0:i.student)==null?void 0:J.studentMiddleName)??""} ${((K=i==null?void 0:i.student)==null?void 0:K.studentLastName)??""}`}),e.jsxs("h6",{children:[t("rs")," ",(i==null?void 0:i.fee_payment_amount)??0]})]}),e.jsxs("div",{className:m.unused_container_text_inner,children:[e.jsxs("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:[(Y=X(i==null?void 0:i.created_at))==null?void 0:Y.format("DD MMM yyyy"),","," ",(q=X(i==null?void 0:i.created_at))==null?void 0:q.format("LT")]}),e.jsx("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:(i==null?void 0:i.fee_payment_mode)==="Online"?"Bank":"Cash"})]})]},y)}),I&&e.jsx(A,{})]})]})},Le=({onClose:s,fmid:c,onRefecthParent:l})=>{const{t}=F(),[h,f]=D(),[x,g]=o.useState(1),[n,N]=o.useState(!0),[w,j]=o.useState(!0),[_,b]=o.useState([]),[I,u]=o.useState(""),[r,R]=o.useState(""),[d,T]=o.useState({amount:"",mode:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:""}),[P,p]=o.useState(""),[i,y]=o.useState(!1),[O,L]=o.useState({msg:"",run:!1}),[M,W]=o.useState(!1),[z]=Oe(),{getMasterDepositAllByFinance:v,getMasterDepositAllByFinanceRefetch:J}=Pe({data:{search:I,page:x,limit:10,fmid:c},skip:!c});o.useEffect(()=>{c&&(j(!0),J())},[c,x,I,J]),o.useEffect(()=>{f&&n&&g(a=>a+1)},[f,n]),o.useEffect(()=>{var a,E;I?(b(v==null?void 0:v.all_students),j(!1)):i?(b(v==null?void 0:v.all_students),y(!1),j(!1)):v!=null&&v.all_students?(b(S=>[...new Set([...S,...v==null?void 0:v.all_students].map(JSON.stringify))].map(JSON.parse)),j(!1)):((a=v==null?void 0:v.all_students)==null?void 0:a.length)===0&&j(!1),((E=v==null?void 0:v.all_students)==null?void 0:E.length)===10?N(!0):N(!1)},[v==null?void 0:v.all_students]);const K=o.useCallback(Q.debounce(a=>u(a),500),[]),Y=a=>{K(a.target.value)},q=()=>{R("")},ee=a=>{T(E=>({...E,amount:+a.target.value,fee_payment_amount:+a.target.value}))},se=a=>{T(E=>({...E,mode:a==="By Bank"?"Online":"Offline",fee_payment_mode:a}))},ae=a=>{const E={};for(let S in a)S==="fee_bank_name"||S==="fee_bank_holder"||S==="fee_utr_reference"||S==="amount"||S==="transaction_date"||S==="mode"||(a[S]?S==="fee_payment_amount"&&a[S]>(r==null?void 0:r.deposit_pending_amount)&&(L({msg:"You can not enter amount greater than Deposit amount",run:!0}),E.fee_payment_amount=`${S} is required!`):E[S]=`${S} is required!`);return E},ie=()=>{g(1),y(!0),J()},te=()=>{const a=ae(d);let E=!1;for(let S in a){E=!0;break}E?p(a):(W(S=>!S),z({fmid:c,sid:r==null?void 0:r._id,refundDeposit:d}).then(()=>{ie(),l(),q(),W(S=>!S)}).catch({}))};return e.jsxs(Te,{onClose:s,children:[!r&&e.jsxs("div",{className:m.student_container_modal,style:{minWidth:"43rem",maxWidth:"50rem"},children:[e.jsx("div",{className:m.with_search,style:{marginTop:"1rem",width:"100%",border:"0.4px solid rgba(0, 0, 0, 0.15)",borderRadius:"6px",marginBottom:"0.3rem"},children:e.jsxs("div",{className:m.search_container_input,style:{width:"100%"},children:[e.jsx("img",{className:m.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search Student...",style:{width:"100%"},onChange:Y})]})}),_==null?void 0:_.map((a,E)=>{var S,C;return(_==null?void 0:_.length)===E+1?e.jsxs("section",{className:m.student_container,title:"Refund deposit",ref:h,onClick:()=>R(a),children:[e.jsx("img",{src:a.photoId!=="1"?`${Z}/${a==null?void 0:a.studentProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"student avatar"}),e.jsxs("div",{className:m.conainter_main,children:[e.jsxs("div",{className:m.student_container_name,children:[e.jsx("h6",{children:`${a==null?void 0:a.studentFirstName} ${a!=null&&a.studentMiddleName?a==null?void 0:a.studentMiddleName:""} ${a==null?void 0:a.studentLastName}`}),e.jsxs("h6",{className:m.student_container_gr,children:[t("rs"),". ",(a==null?void 0:a.deposit_pending_amount)??0]})]}),e.jsxs("div",{className:m.student_container_name,children:[e.jsxs("h6",{children:[t("gr_number"),(a==null?void 0:a.studentGRNO)??""," ",", ",((S=a==null?void 0:a.department)==null?void 0:S.dName)??""]}),e.jsx("p",{className:m.student_container_gr,children:t("pending_deposit")})]})]})]},a==null?void 0:a._id):e.jsxs("section",{className:m.student_container,title:"Refund deposit",onClick:()=>R(a),children:[e.jsx("img",{src:a.photoId!=="1"?`${Z}/${a==null?void 0:a.studentProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:"student avatar"}),e.jsxs("div",{className:m.conainter_main,children:[e.jsxs("div",{className:m.student_container_name,children:[e.jsx("h6",{children:`${a==null?void 0:a.studentFirstName} ${a!=null&&a.studentMiddleName?a==null?void 0:a.studentMiddleName:""} ${a==null?void 0:a.studentLastName}`}),e.jsxs("h6",{className:m.student_container_gr,children:[t("rs"),". ",(a==null?void 0:a.deposit_pending_amount)??0]})]}),e.jsxs("div",{className:m.student_container_name,children:[e.jsxs("h6",{children:[t("gr_number"),(a==null?void 0:a.studentGRNO)??""," ",", ",((C=a==null?void 0:a.department)==null?void 0:C.dName)??""]}),e.jsx("p",{className:m.student_container_gr,children:t("pending_deposit")})]})]})]},a==null?void 0:a._id)}),w&&e.jsx(A,{})]}),r&&e.jsxs("div",{className:m.student_container_modal,children:[e.jsxs("section",{className:m.moderator_container_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:q,alt:"go to previous tab",title:"Go Back",style:{cursor:"pointer"}}),e.jsx("div",{className:m.with_search,children:e.jsx("h6",{children:t("refund_deposit")})})]}),e.jsx(H,{customStyle:{width:"100%"}}),e.jsxs("div",{className:m.unused_container_text_inner,style:{marginTop:"1rem"},children:[e.jsx("h6",{children:t("pending_deposit")}),e.jsxs("h6",{children:[t("rs")," ",(r==null?void 0:r.deposit_pending_amount)??0]})]}),e.jsx(Ue,{paymentHeading:t("payment_type_mode"),paymentHeadingPlaceholder:t("refund_cash_bank"),onInputChange:se,errorShow:P.fee_payment_mode,openAs:"DEPOSIT_REFUND_LIST"}),e.jsx(Re,{labelText:t("amount"),name:"fee_payment_amount",type:"tel",value:d==null?void 0:d.fee_payment_amount,onChange:ee,placeholder:t("please_enter_amount_paid"),errorShow:P.fee_payment_amount}),e.jsx("button",{className:m.applicable_to_btn,style:{marginTop:"2rem",marginBottom:"1rem",justifyContent:"center"},onClick:te,children:t("confirm")}),M&&e.jsx(B,{})]}),e.jsx(me,{msg:O.msg,run:O.run,setRun:()=>L({msg:"",run:!1}),postiton:"bottom",type:"error"})]})},We=({transportId:s})=>{var j,_,b,I,u;const{t:c}=F(),l=oe(),[t,h]=o.useState(!1),f=[{name:c("deposit_collection"),id:0},{name:c("deposit_refund"),id:1},{name:c("deposit_data_file"),id:3}],[x,g]=o.useState(0),{getMasterDepositByTransport:n,getMasterDepositByTransportRefetch:N}=_e({tid:s,skip:!s});o.useEffect(()=>{s&&N()},[s,N]);const w=()=>{l(-1)};return e.jsxs("div",{className:m.moderator_container,style:{marginTop:"0"},children:[e.jsxs("section",{className:m.moderator_container_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:w,alt:"go to previous tab",title:"Go Back",style:{cursor:"pointer"}}),e.jsxs("div",{className:m.with_search,children:[e.jsx("h6",{children:c("finance_deposit")}),e.jsx("div",{className:m.search_container_filter,children:e.jsx("img",{src:"/images/filter-blue-icon.svg",alt:"filter icon"})})]})]}),e.jsx(H,{customStyle:{width:"100%"}}),e.jsx(Ee,{tabList:f,activeIndexTab:x,setActiveIndexTab:g,showAs:!1,customStyleTab:{width:"33.33%"}}),e.jsx(H,{customStyle:{width:"100%",marginBottom:"0.5rem"}}),x===0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:m.applicable_to_btn,onClick:()=>h(!0),style:{width:"50%",marginTop:"2rem",marginBottom:"1rem"},children:[e.jsxs("div",{children:[c("deposit_fee_head_linking")," "]}),e.jsx("img",{src:"/images/forward-right-icon.svg",alt:"next step"})]}),e.jsx("div",{className:m.refund_list,children:e.jsxs("section",{className:m.unused_container,children:[e.jsx("img",{src:"/images/rupee-symobl-icon.svg",alt:"rupee symobl"}),e.jsxs("div",{className:m.unused_container_text,children:[e.jsxs("div",{className:m.unused_container_text_inner,children:[e.jsx("h6",{children:c("total_deposit")}),e.jsxs("h6",{children:[c("rs")," ",((j=n==null?void 0:n.master)==null?void 0:j.deposit_amount)??0]})]}),e.jsx("div",{className:m.unused_container_text_inner,children:e.jsxs("p",{children:[c("deposit_of")," ",((_=n==null?void 0:n.master)==null?void 0:_.paid_student_count)??0," ",c("deposit_student")]})})]})]})})]}),x===1&&e.jsx(Je,{refund_amount:(b=n==null?void 0:n.master)==null?void 0:b.refund_amount,refund_student_count:(I=n==null?void 0:n.master)==null?void 0:I.refund_student_count,transportId:s}),t&&e.jsx(Le,{onClose:()=>h(!1),fmid:(u=n==null?void 0:n.master)==null?void 0:u._id,onRefecthParent:N})]})},k=({institute:s,border:c,transportId:l,onRefetch:t})=>{var N,w;const{t:h}=F(),[f]=xe(),[x,g]=o.useState(!1),n=()=>{l&&(s!=null&&s._id)&&(g(j=>!j),f({tid:l,id:s==null?void 0:s._id}).then(()=>{t(),g(j=>!j)}).catch({}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:$.transpotation_card,style:{justifyContent:"space-between"},children:[e.jsxs("div",{className:$.transpotation_card_detail,children:[e.jsx("img",{src:s!=null&&s.insProfilePhoto?`${Z}/${s.insProfilePhoto}`:"/images/user-icon.svg",alt:"avatar"}),e.jsxs("div",{className:$.transpotation_card_detail_text,children:[e.jsx("h6",{children:(s==null?void 0:s.insName)??""}),e.jsx("h6",{style:{fontSize:"12px"},children:(s==null?void 0:s.name)??""})]})]}),((N=s==null?void 0:s.transportDepart)==null?void 0:N.length)>0?l===((w=s==null?void 0:s.transportDepart)==null?void 0:w[0])?e.jsx("div",{className:$.linked_institute_btn,children:h("linked")}):null:e.jsx("div",{className:$.linked_institute_btn,onClick:n,children:h("linked_institute")})]}),c&&e.jsx(H,{customStyle:{width:"100%"}}),x&&e.jsx(B,{})]})},qe=({transportId:s})=>{const{t:c}=F(),[l,t]=o.useState(""),[h,f]=D({skip:l}),[x,g]=o.useState(1),[n,N]=o.useState(!0),[w,j]=o.useState(!0),[_,b]=o.useState([]),[I,u]=o.useState(!1),{getTransportLinkedList:r,getTransportLinkedListRefetch:R}=je({data:{tid:s,page:x,limit:10,search:l},skip:!s});o.useEffect(()=>{s&&(j(!0),R())},[s,x,l,R]),o.useEffect(()=>{f&&n&&g(p=>p+1)},[f,n]),o.useEffect(()=>{var p,i;I?(b(r==null?void 0:r.all_ins),j(!1),u(!1)):l?(b(r==null?void 0:r.all_ins),j(!1)):r!=null&&r.all_ins?(b(y=>[...new Set([...y,...r==null?void 0:r.all_ins].map(JSON.stringify))].map(JSON.parse)),j(!1)):((p=r==null?void 0:r.all_ins)==null?void 0:p.length)===0&&j(!1),((i=r==null?void 0:r.all_ins)==null?void 0:i.length)===10?N(!0):N(!1)},[r==null?void 0:r.all_ins]);const d=o.useCallback(Q.debounce(p=>t(p),500),[]),T=p=>{p.target.value?d(p.target.value):(d(""),g(i=>1))},P=()=>{g(1),u(!0),j(!0),R()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:$.with_search,children:[e.jsx("h6",{children:c("linked_institute")}),e.jsx("section",{className:$.search_container,children:e.jsxs("div",{className:$.search_container_input,children:[e.jsx("img",{className:$.searchIcon,alt:"search icon",src:"/images/search-dash-icon.svg"}),e.jsx("input",{type:"text",placeholder:"Search institutes...",onChange:T})]})})]}),e.jsx(H,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),e.jsx("div",{className:$.vehicle_list,children:_==null?void 0:_.map((p,i)=>(_==null?void 0:_.length)===i+1?e.jsx("div",{ref:h,style:{width:"100%"},children:e.jsx(k,{institute:p,transportId:s,onRefetch:P})},p==null?void 0:p._id):e.jsx(k,{institute:p,border:!0,transportId:s,onRefetch:P},p==null?void 0:p._id))}),w&&e.jsx(A,{status:"white"})]})},He=({onClickValue:s,carryParentState:c})=>{var f,x,g,n,N,w,j,_,b,I,u;const[l]=re(),{transportDetail:t,transportDetailRefetch:h}=fe({tid:s==null?void 0:s._id,skip:!(s!=null&&s._id)});return o.useEffect(()=>{s!=null&&s._id&&h()},[s==null?void 0:s._id,h]),e.jsxs("div",{style:{marginTop:"1rem"},children:[[null,"fee","fund"].includes(l.get("a"))&&e.jsx(Fe,{tid:s==null?void 0:s._id,transport:t==null?void 0:t.trans_panel,carryParentState:c,onRefetch:h}),l.get("a")==="vehicle"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(Ne,{tid:s==null?void 0:s._id,carryParentState:c,instituteId:((x=(f=t==null?void 0:t.trans_panel)==null?void 0:f.institute)==null?void 0:x._id)??""})}),l.get("a")==="personal"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(be,{tid:s==null?void 0:s._id,carryParentState:c,instituteId:((n=(g=t==null?void 0:t.trans_panel)==null?void 0:g.institute)==null?void 0:n._id)??""})}),l.get("a")==="passenger"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(Se,{tid:s==null?void 0:s._id,carryParentState:c,instituteId:((w=(N=t==null?void 0:t.trans_panel)==null?void 0:N.institute)==null?void 0:w._id)??""})}),l.get("a")==="batch"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(ue,{transportId:s==null?void 0:s._id,selectedBacthId:(j=t==null?void 0:t.trans_panel)==null?void 0:j.departmentSelectBatch,onMasterApiRefetch:h,carryParentState:c,instituteId:((b=(_=t==null?void 0:t.trans_panel)==null?void 0:_.institute)==null?void 0:b._id)??""})}),l.get("a")==="standard"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(we,{transportId:s==null?void 0:s._id,carryParentState:c})}),l.get("a")==="deposit"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(We,{transportId:s==null?void 0:s._id})}),l.get("a")==="pending"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(Ie,{transportId:s==null?void 0:s._id,instituteId:((u=(I=t==null?void 0:t.trans_panel)==null?void 0:I.institute)==null?void 0:u._id)??""})}),l.get("a")==="vehicle-detail"&&e.jsx($e,{transportId:s==null?void 0:s._id,carryParentState:c}),l.get("a")==="linked"&&e.jsx("div",{className:$.hostel_container,children:e.jsx(qe,{transportId:s==null?void 0:s._id})})]})},Fs=()=>{var c,l,t,h,f,x;const s=V();return e.jsx(e.Fragment,{children:((c=s==null?void 0:s.search)==null?void 0:c.substring(3))==="site"?e.jsx(ye,{tid:(t=(l=s==null?void 0:s.state)==null?void 0:l.onClickValue)==null?void 0:t._id}):e.jsx(le,{index:"30",sid:((h=s==null?void 0:s.state)==null?void 0:h.sid)??"",onClickValue:((f=s==null?void 0:s.state)==null?void 0:f.onClickValue)??"",children:e.jsx(He,{onClickValue:((x=s==null?void 0:s.state)==null?void 0:x.onClickValue)??"",carryParentState:s==null?void 0:s.state})})})};export{Fs as default};
