import{r as f,j as t,u as C,N as Q,lU as G,W as X,Q as Z}from"./index-731451a5.js";import{P as E}from"./PopupWrapper-ffbaef7a.js";import{s as F}from"./FeesStructure.module-7a88fbbc.js";import{B as q}from"./BorderBottom-47800983.js";import{J as V}from"./JoinFormTextArea-7f6dded0.js";import{T as ee}from"./TileWrapper-be9153cb.js";import{J as te}from"./JoinFormFile-110be590.js";import{a6 as ae}from"./department-api-a4f0b4b7.js";const se=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],ne=["January","February","March","April","May","June","July","August","September","October","November","December"],oe=(d=se,j=ne)=>{const h=new Date,n=`${h.getDate()}-${h.getMonth()+1}-${h.getFullYear()}`,x=[1,2,3,4,5,6,0],[e,r]=f.useState(h),u=new Date(e.getFullYear(),e.getMonth()+1,0),M=new Date(e.getFullYear(),e.getMonth(),0),b=u.getDate(),m=new Date(e.getFullYear(),e.getMonth(),1).getDay(),$=x.indexOf(m)+1;let p=M.getDate()-x.indexOf(m)+1,v=1,c=1;const a=6,_=7,g={};for(let o=1;o<a+1;o++)for(let S=1;S<_+1;S++)g[o]||(g[o]=[]),o===1?S<$?(g[o]=[...g[o],{classes:"in-prev-month",date:`${p}-${e.getMonth()===0?12:e.getMonth()}-${e.getMonth()===0?e.getFullYear()-1:e.getFullYear()}`,value:p}],p++):(g[o]=[...g[o],{classes:"",date:`${v}-${e.getMonth()+1}-${e.getFullYear()}`,value:v}],v++):o>1&&v<b+1?(g[o]=[...g[o],{classes:"",date:`${v}-${e.getMonth()+1}-${e.getFullYear()}`,value:v}],v++):(g[o]=[...g[o],{classes:"in-next-month",date:`${c}-${e.getMonth()+2===13?1:e.getMonth()+2}-${e.getMonth()+2===13?e.getFullYear()+1:e.getFullYear()}`,value:c}],c++);return{daysShort:d,monthNames:j,todayFormatted:n,calendarRows:g,selectedDate:e,getPrevMonth:()=>{r(o=>new Date(o.getFullYear(),o.getMonth()-1,1))},getNextMonth:()=>{r(o=>new Date(o.getFullYear(),o.getMonth()+1,1))}}},re=({dateSelected:d,setSelectedDate:j,removeDateArray:h,addDateArray:n})=>{const{calendarRows:x,selectedDate:e,todayFormatted:r,daysShort:u,monthNames:M,getNextMonth:b,getPrevMonth:m}=oe(),[$,p]=f.useState([]),v=c=>{if(d.length>0&&d.includes(c)){const a=d.filter(function(_){return _!==c});h(a),p(a)}else n(c),p(a=>[...a,c])};return t.jsxs(f.Fragment,{children:[t.jsxs("div",{className:"calenderheader",children:[t.jsx("div",{className:"monthbtn",onClick:m,children:t.jsx("img",{alt:"not found",src:"/images/members/arrow-left.svg"})}),t.jsxs("div",{className:"yearmonth",children:[t.jsx("h6",{children:`${M[e.getMonth()]}`}),t.jsx("p",{children:`${e.getFullYear()}`})]}),t.jsx("div",{className:"monthbtn",onClick:b,children:t.jsx("img",{alt:"not found",src:"/images/members/arrow-right.svg"})})]}),t.jsxs("table",{className:"table",children:[t.jsx("thead",{children:t.jsx("tr",{children:u.map(c=>t.jsx("th",{className:"day",children:c},c))})}),t.jsx("tbody",{children:Object.values(x).map(c=>t.jsx("tr",{children:c.map(a=>a.date===r?t.jsx("td",{className:`${a.classes} date`,onClick:()=>v(`${a.value<10?`0${a.value}`:a.value}/${e.getMonth()+1<10?`0${e.getMonth()+1}`:e.getMonth()+1}/${e.getFullYear()}`),children:t.jsx("div",{className:d.includes(`${a.value<10?`0${a.value}`:a.value}/${e.getMonth()+1<10?`0${e.getMonth()+1}`:e.getMonth()+1}/${e.getFullYear()}`)?`${a.classes} datediv aaji active`:`${a.classes} datediv aaji`,children:a.value})},a.date):a.classes==="in-prev-month"||a.classes==="in-next-month"?t.jsx("td",{className:`${a.classes} date`,children:t.jsx("div",{className:d.includes(`${a.value<10?`0${a.value}`:a.value}/${e.getMonth()+1<10?`0${e.getMonth()+1}`:e.getMonth()+1}/${e.getFullYear()}`)?`${a.classes} datediv `:`${a.classes} datediv `,children:a.value})},a.date):t.jsx("td",{className:`${a.classes} date`,onClick:()=>v(`${a.value<10?`0${a.value}`:a.value}/${e.getMonth()+1<10?`0${e.getMonth()+1}`:e.getMonth()+1}/${e.getFullYear()}`),children:t.jsx("div",{className:d.includes(`${a.value<10?`0${a.value}`:a.value}/${e.getMonth()+1<10?`0${e.getMonth()+1}`:e.getMonth()+1}/${e.getFullYear()}`)?`${a.classes} datediv  active`:`${a.classes} datediv `,children:a.value})},a.date))},c[0].date))})]})]})},le="_newComplain_1s13h_1",ie="_header_1s13h_8",ce="_calender_1s13h_16",de="_btncontainer_1s13h_24",he="_reasonbtn_1s13h_29",ue="_disabled_1s13h_45",w={newComplain:le,header:ie,calender:ce,btncontainer:de,reasonbtn:he,disabled:ue},me=({onClose:d,onGrabDates:j,alradyDates:h,currentTileActive:n,createdBy:x})=>{const{t:e}=C(),[r,u]=f.useState([]),[M,b]=f.useState({msg:"",run:!1}),m=new Date,$=`${m.getDate()<10?`0${m.getDate()}`:m.getDate()}/${m.getMonth()+1<10?`0${m.getMonth()+1}`:m.getMonth()+1}/${m.getFullYear()}`;f.useEffect(()=>{(h==null?void 0:h.length)>0&&u(h)},[h]);function p(_){return new Date(_.split("/").reverse().join("/"))}const v=_=>{u(_)},c=_=>{+p(_)>=+p($)&&u(g=>[...g,_])},a=()=>{x==="OWN_PROFILE"?(j(r),d()):(n==null?void 0:n.count)<(r==null?void 0:r.length)?b({msg:`You have not sufficient ${n==null?void 0:n.key}.`,run:!0}):(j(r),d())};return t.jsxs(t.Fragment,{children:[t.jsx(E,{onClose:d,children:t.jsx("div",{className:F.add_category_modal,style:{width:"35rem",minHeight:"10rem",height:"fit-content"},children:t.jsxs("section",{className:F.fee_middle_section_container,style:{marginBottom:"1.2rem"},children:[t.jsx("h6",{style:{fontSize:"20px",fontWeight:"600"},children:e("choose_leave_dates")}),t.jsx(q,{customStyle:{width:"100%",marginTop:"0.7rem"}}),t.jsxs("div",{className:w.calender,children:[t.jsx(re,{dateSelected:r,setSelectedDate:u,removeDateArray:v,addDateArray:c}),t.jsx("div",{className:w.btncontainer,children:t.jsx("div",{className:w.reasonbtn,onClick:a,children:e("select")})})]})]})})}),t.jsx(Q,{msg:M.msg,run:M.run,setRun:()=>b({msg:"",run:!1}),postiton:"bottom",type:"error"})]})},R=[{name:"casual_leave",key:"Casual Leave",isAvaiable:!0,count:0},{name:"medical_leave",key:"Medical Leave",isAvaiable:!0,count:0},{name:"sick_leave",key:"Sick Leave",isAvaiable:!0,count:0},{name:"compensation_off_leave",key:"Compensation Off Leave",isAvaiable:!0,count:0},{name:"on_duty_leave",key:"On Duty Leave"},{name:"leave_without_pay",key:"Leave Without Pay"}],je=({staffId:d,onRefetch:j,onClose:h,leaveConfig:n,createdBy:x})=>{var T;const{t:e}=C(),[r,u]=f.useState({reason:"",dates:[],attach:"",leave_type:"Casual Leave"}),[M,b]=f.useState(R),[m,$]=f.useState(!1),[p,v]=f.useState(""),[c,a]=f.useState(""),[_]=G(),[g]=ae(),[L]=X(),[N,o]=f.useState(""),[S,k]=f.useState("");f.useEffect(()=>{if(n){let s=R;s[0].count=n==null?void 0:n.casual_leave,s[1].count=n==null?void 0:n.medical_leave,s[2].count=n==null?void 0:n.sick_leave,s[3].count=n==null?void 0:n.c_off_leave,b(s),k(s[0])}},[n]),f.useEffect(()=>{x&&u(s=>({...s,leave_type:"Compensation Off Leave"}))},[x]);const A=s=>{var l;const i={};for(let y in s)["attach"].includes(y)||(y==="dates"?(l=s[y])!=null&&l.length||(i[y]=`${y} is required!`):s[y]||(i[y]=`${y} is required!`));return i},I=()=>{if(d){const s=A(r);let i=!1;for(let l in s)if(l){i=!0;break}i?v(s):($(l=>!l),x==="OWN_PROFILE"?g({sid:d,leaveConfig:r}).then(()=>{j(),$(l=>!l),h()}).catch({}):_({sid:d,LeaveData:r}).then(()=>{j(),$(l=>!l),h()}).catch({}))}},J=()=>{m||h()},U=s=>{u(i=>({...i,leave_type:s}))},B=s=>{u(i=>({...i,leave_type:s==null?void 0:s.key})),k(s)},H=s=>{u(i=>({...i,[s.target.name]:s.target.value}))},Y=()=>{a(s=>!s)},K=s=>{u(i=>({...i,dates:s}))},z=s=>{if(s.target.files[0]){$(l=>!l);const i=new FormData;i.append("file",s.target.files[0]),L({fileUpload:i}).then(l=>{var y,O,P;$(D=>!D),o({documentName:(y=s.target.files[0])==null?void 0:y.name,documentKey:(O=l.data)==null?void 0:O.imageKey,documentType:(P=s.target.files[0])==null?void 0:P.type}),u(D=>{var W;return{...D,attach:(W=l.data)==null?void 0:W.imageKey}})}).catch(()=>{$(l=>!l)})}};return t.jsx(t.Fragment,{children:c?t.jsx(me,{onClose:Y,alradyDates:r.dates,onGrabDates:K,currentTileActive:S,createdBy:x}):t.jsxs(E,{onClose:J,children:[t.jsx("div",{className:F.add_category_modal,style:{width:"35rem",minHeight:"10rem",height:"fit-content",maxHeight:"35rem",overflowY:"auto",scrollBehavior:"smooth"},children:t.jsxs("section",{className:F.fee_middle_section_container,style:{marginBottom:"1.2rem"},children:[t.jsx("h6",{style:{fontSize:"20px",fontWeight:"600"},children:e(x==="OWN_PROFILE"?"request_c_off_leave":"create_new_leave")}),t.jsx(q,{customStyle:{width:"100%",marginTop:"0.7rem"}}),x==="OWN_PROFILE"?null:t.jsx(ee,{labelText:"leave_type",tileList:M,activeTile:r.leave_type,onTile:U,onParentTile:B,customTileContainer:{flexWrap:"wrap"},customTileAvailableChild:{flexDirection:"column",alignItems:"flex-start"}}),t.jsx(V,{labelText:e("enter_reason"),placeholder:e("enter_reason"),name:"reason",value:r.reason,type:"text",onChange:H,errorShow:p.reason}),t.jsxs("div",{onClick:Y,className:F.set_fees_structure_btn,style:{width:"fit-content",cursor:"pointer",backgroundColor:"white",height:"34px",padding:"15px 13px"},children:[e("select_dates"),p.dates&&t.jsx("span",{style:{color:"red"},children:"* required"})]}),t.jsx("div",{className:F.leave_dates,children:(T=r.dates)==null?void 0:T.map((s,i)=>{var l;return t.jsxs("h6",{children:[s,((l=r.dates)==null?void 0:l.length)===i+1?"":", "]},s)})}),t.jsx(te,{labelText:e("leave_attachment"),name:"leave_attachment",value:N?{originalName:N==null?void 0:N.documentName}:"",onChange:z,customStyleContainer:{width:"100%"}}),t.jsx("button",{className:F.fee_middle_confirm_button,onClick:I,style:{marginTop:"2rem"},children:e("create")})]})}),m&&t.jsx(Z,{})]})})};export{je as C};
