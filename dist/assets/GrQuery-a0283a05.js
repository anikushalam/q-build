import{u as N,r as c,j as e,e as $,a1 as u,Q as k,k as C,t as D,S as E}from"./index-0ca76035.js";import{h as M,i as Q}from"./activity-api-dbe5a9e3.js";import{B}from"./BorderBottom-1dc6f53e.js";const L="_grquery_container_1vnmi_1",I="_with_search_1vnmi_10",T="_query_card_1vnmi_25",F="_query_card_head_1vnmi_39",J="_query_card_text_1vnmi_46",O="_query_card_content_1vnmi_65",V="_button_container_1vnmi_74",W="_reject_btn_1vnmi_80",U="_approve_btn_1vnmi_93",z="_query_date_1vnmi_106",n={grquery_container:L,with_search:I,query_card:T,query_card_head:F,query_card_text:J,query_card_content:O,button_container:V,reject_btn:W,approve_btn:U,query_date:z},w=({query:t,onRefetch:r})=>{var m,p,d,_,j;const{t:i}=N(),[x,l]=c.useState(!1),[f]=M(),h=v=>{t!=null&&t._id&&v&&(l(o=>!o),f({qid:t==null?void 0:t._id,status:`${v}`}).then(()=>{r(),l(o=>!o)}).catch({}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:n.query_card,children:[e.jsxs("div",{className:n.query_card_head,children:[e.jsx("img",{src:(m=t==null?void 0:t.query_by_student)!=null&&m.studentProfilePhoto?`${$}/${(p=t==null?void 0:t.query_by_student)==null?void 0:p.studentProfilePhoto}`:"/images/member_tab/class/default_avatar.svg",alt:""}),e.jsxs("div",{className:n.query_card_text,children:[e.jsx("h6",{children:`${((d=t==null?void 0:t.query_by_student)==null?void 0:d.studentFirstName)??""} ${((_=t==null?void 0:t.query_by_student)==null?void 0:_.studentMiddleName)??""} ${((j=t==null?void 0:t.query_by_student)==null?void 0:j.studentLastName)??""}`}),e.jsxs("h6",{children:[e.jsx("span",{style:{fontWeight:"400"},children:i("gr_number")})," ",(t==null?void 0:t.query_gr)??""]})]})]}),e.jsx("p",{className:n.query_card_content,children:(t==null?void 0:t.query_content)??""}),(t==null?void 0:t.query_status)==="Pending"?e.jsxs("div",{className:n.button_container,children:[e.jsx("button",{className:n.reject_btn,onClick:()=>h("Rejected"),children:i("reject")}),e.jsx("button",{className:n.approve_btn,onClick:()=>h("Approved"),children:i("approve")})]}):null,e.jsxs("div",{className:n.query_date,children:[e.jsx("p",{children:u(t==null?void 0:t.created_at).format("DD MMMM, yyyy")}),e.jsx("p",{children:u(t==null?void 0:t.created_at).format("LT")})]})]}),x&&e.jsx(k,{})]})},X=()=>{const{t}=N(),r=C(a=>a.idChange.id),[i,x]=D(),[l,f]=c.useState(1),[h,m]=c.useState(!0),[p,d]=c.useState(!0),[_,j]=c.useState([]),[v,o]=c.useState(!1),{instituteAllGRNotification:s,instituteAllGRNotificationRefetch:b}=Q({data:{id:r,page:l,limit:10},skip:!r});c.useEffect(()=>{r&&(d(!0),b())},[r,l,b]),c.useEffect(()=>{x&&h&&f(a=>a+1)},[x,h]),c.useEffect(()=>{var a,g;v?(j(s==null?void 0:s.all_query),d(!1),o(!1)):s!=null&&s.all_query?(j(P=>[...new Set([...P,...s==null?void 0:s.all_query].map(JSON.stringify))].map(JSON.parse)),d(!1)):((a=s==null?void 0:s.all_query)==null?void 0:a.length)===0&&d(!1),((g=s==null?void 0:s.all_query)==null?void 0:g.length)===10?m(!0):m(!1)},[s==null?void 0:s.all_query]);const S=()=>{f(1),o(!0),d(!0),b()};return e.jsxs("div",{className:n.grquery_container,children:[e.jsx("div",{className:n.with_search,children:e.jsx("h6",{children:t("gr_internal_query")})}),e.jsx(B,{customStyle:{marginTop:"0.5rem",marginBottom:"0.6rem",width:"100%"}}),_==null?void 0:_.map((a,g)=>(_==null?void 0:_.length)===g+1?e.jsx("div",{ref:i,children:e.jsx(w,{query:a,onRefetch:S})},a==null?void 0:a._id):e.jsx(w,{query:a,onRefetch:S},a==null?void 0:a._id)),p&&e.jsx(E,{status:"white"})]})};export{X as default};
