import{u as E,r as l,j as e,a1 as S,c as y,t as D,v as b,S as C}from"./index-0ca76035.js";import{r as O}from"./institute-staff-student-api-7114d611.js";import{s as N}from"./AdmissionApplicationRequest.module-43e4e129.js";import{B as R}from"./BorderBottom-1dc6f53e.js";import{s as n}from"./History.module-4b700312.js";import{R as $}from"./ReminderMessageStudentList-c2ed7cf8.js";const T=({data:s})=>{var m,r,h;const{t:f}=E(),[x,j]=l.useState(!1),t=()=>{j(p=>!p)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:n.sidebarheader,children:[e.jsxs("div",{className:n.text,style:{width:"80%"},children:[e.jsx("p",{className:n.rcv,children:f("message")}),e.jsx("h6",{children:(s==null?void 0:s.message)??""}),e.jsxs("p",{className:n.rcv,children:[f("by")," "," : ",(s==null?void 0:s.message_type)??"",s!=null&&s.from?`(${((m=s==null?void 0:s.from)==null?void 0:m.staffFirstName)??""} ${((r=s==null?void 0:s.from)==null?void 0:r.staffMiddleName)??""} ${((h=s==null?void 0:s.from)==null?void 0:h.staffLastName)??""})`:""]})]}),e.jsxs("div",{className:n.text,children:[e.jsxs("h6",{style:{cursor:"pointer",color:"#00f"},onClick:t,children:[f("student")," "," : "," ",(s==null?void 0:s.student_list_count)??0]}),e.jsxs("p",{className:n.rcv,children:[S(s==null?void 0:s.created_at).format("DD MMM, yyyy"),", ",S(s==null?void 0:s.created_at).format("LT")]})]})]}),x&&e.jsx($,{studentList:s==null?void 0:s.student_list,onClose:t})]})},U=({sid:s,isInstitute:f})=>{const{t:x}=E(),j=y(),[t,m]=D(),[r,h]=l.useState(1),[p,g]=l.useState(!0),[k,_]=l.useState(!0),[c,v]=l.useState([]),{getStudentMessageHistoryGenerate:o,getStudentMessageHistoryGenerateRefetch:w}=O({data:{sid:s,page:r,limit:10,flow:"INSTITUTE_ADMIN"},skip:!s}),{scrollToTop:B}=b();l.useEffect(()=>{B()},[]),l.useEffect(()=>{s&&(_(!0),w())},[s,r,w]),l.useEffect(()=>{m&&p&&h(i=>i+1)},[m,p]),l.useEffect(()=>{var i,u;o!=null&&o.all_message?(v(r===1?o==null?void 0:o.all_message:L=>[...new Set([...L,...o==null?void 0:o.all_message].map(JSON.stringify))].map(JSON.parse)),_(!1)):((i=o==null?void 0:o.all_message)==null?void 0:i.length)===0&&_(!1),((u=o==null?void 0:o.all_message)==null?void 0:u.length)===10?g(!0):g(!1)},[o==null?void 0:o.all_message]);const I=()=>{j(-1)};return e.jsxs("div",{className:N.admission_application_container,children:[e.jsxs("section",{className:N.moderator_container_title,children:[e.jsx("img",{src:"/images/arrow-left-fees-icon.svg",onClick:I,alt:"go to previous tab",title:"Go Back",style:{cursor:"pointer"}}),e.jsx("div",{className:N.with_search,children:e.jsx("h6",{children:x("message_history")})})]}),e.jsx(R,{customStyle:{width:"100%",marginTop:"0.5rem",marginBottom:"0.5rem"}}),c==null?void 0:c.map((i,u)=>(c==null?void 0:c.length)===u+1?e.jsx("div",{ref:t,children:e.jsx(T,{data:i})},i==null?void 0:i._id):e.jsx(T,{data:i},i==null?void 0:i._id)),k&&e.jsx(C,{status:"white"})]})};export{U as S};
