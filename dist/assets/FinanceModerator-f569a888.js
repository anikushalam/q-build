import{u,j as s,lH as I,r as x,t as k}from"./index-731451a5.js";import{M as b,U as S,B as R,n as O,Z as B,C as U,E as P,_ as H,p as V,q as w,a as Y,r as W,$ as K,Q as L,a0 as X,a1 as Q,i as q,a2 as Z,l as z,s as F,a3 as J,L as f}from"./FinanceConfig-555e7db6.js";import{A as M}from"./AddButton-aacd1b4c.js";const ss="_moderator_container_1ytv1_1",cs="_moderator_container_title_1ytv1_4",ns="_add_new_moderator_1ytv1_10",is="_moderator_card_1ytv1_20",_s="_moderator_card_text_container_1ytv1_42",es="_menu_icon_1ytv1_63",ls="_assign_role_container_1ytv1_70",ts="_assign_role_title_1ytv1_77",as="_selected_staff_container_1ytv1_84",hs="_selected_staff_text_1ytv1_96",xs="_assign_btn_1ytv1_110",os="_select_application_btn_1ytv1_125",Es="_select_btn_1ytv1_144",Cs="_application_card_1ytv1_160",js="_application_card_active_1ytv1_177",rs="_application_card_text_1ytv1_180",ds="_application_card_text_bottom_1ytv1_193",As="_modal_container_1ytv1_207",gs="_modal_container_header_1ytv1_216",p={moderator_container:ss,moderator_container_title:cs,add_new_moderator:ns,moderator_card:is,moderator_card_text_container:_s,menu_icon:es,assign_role_container:ls,assign_role_title:ts,selected_staff_container:as,selected_staff_text:hs,assign_btn:xs,select_application_btn:os,select_btn:Es,application_card:Cs,application_card_active:js,application_card_text:rs,application_card_text_bottom:ds,modal_container:As,modal_container_header:gs},ps=({onCloseEdit:c,setActivePopup:o,selectedStaff:i,moderatorState:n,onSelectRole:a,onUpdateModerator:d})=>{const{t:h}=u();return s.jsx(s.Fragment,{children:s.jsx(b,{onClose:c,children:s.jsxs("div",{className:p.modal_container,children:[s.jsx(S,{children:s.jsx("div",{className:p.modal_container_header,children:s.jsx("h6",{children:h("update_role_to_moderator")})})}),s.jsx(R,{}),s.jsxs(S,{customStyle:{paddingTop:"0"},children:[s.jsxs("section",{className:p.selected_staff_container,onClick:()=>o("OPEN_STAFF_LIST"),style:{cursor:"pointer"},children:[s.jsx("img",{src:i!=null&&i.staffProfilePhoto?`${I}/${i==null?void 0:i.staffProfilePhoto}`:`${O}/feed-user-avatar.svg`,alt:"staff profile avatar"}),s.jsxs("div",{className:p.selected_staff_text,children:[s.jsx("h6",{children:`${i==null?void 0:i.staffFirstName} ${(i==null?void 0:i.staffMiddleName)??""} ${i==null?void 0:i.staffLastName}`}),s.jsxs("p",{children:[h("index_number")," "," : ",i==null?void 0:i.staffROLLNO]})]})]}),s.jsx(B,{selectLabel:h("select_role_of_moderator"),selectedValue:h("please_select_role"),options:["Cash Receipt Section","Inventories Section","Fees Master Section","Payroll Section","Deposit Section","Bank Account Section","Data Export Authority"],defalutValue:(n==null?void 0:n.mod_role)==="CASH_RECEIPT_ACCESS"?"Cash Receipt Section":(n==null?void 0:n.mod_role)==="INVENTORY_ACCESS"?"Inventories Section":(n==null?void 0:n.mod_role)==="FEE_MASTER_ACCESS"?"Fees Master Section":(n==null?void 0:n.mod_role)==="PAYROLL_ACCESS"?"Payroll Section":(n==null?void 0:n.mod_role)==="DEPOSIT_ACCESS"?"Deposit Section":(n==null?void 0:n.mod_role)==="BANK_ACCOUNT_ACCESS"?"Bank Account Section":(n==null?void 0:n.mod_role)==="DATA_EXPORT_ACCESS"?"Data Export Authority":"",onClick:a}),s.jsx(U,{label:"update",onAction:d})]})]})})})},$=({staff:c,selectedId:o,onSelect:i})=>{const{t:n}=u(),a=()=>{i(c)};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:P.assign_show_list_each,style:o===(c==null?void 0:c._id)?{backgroundColor:"rgba(75, 26, 133, 0.1)"}:null,onClick:a,children:[s.jsx("img",{src:c!=null&&c.staffProfilePhoto?`${I}/${c.staffProfilePhoto}`:`${O}/feed-staff-avatar.svg`,alt:"profile avatar"}),s.jsxs("div",{className:P.assign_each_paragraph,children:[s.jsx("h6",{children:`${(c==null?void 0:c.staffFirstName)??""} ${(c==null?void 0:c.staffMiddleName)??""} ${(c==null?void 0:c.staffLastName)??""}`}),s.jsxs("p",{children:[n("index")," "," : ",c==null?void 0:c.staffRollNo]})]})]}),s.jsx(R,{customStyleBorder:{margin:"0"}})]})},Ns=({onClose:c,selectedId:o,onSelectStaff:i,instituteId:n})=>{const{t:a}=u(),[d,h]=x.useState(""),[r,C]=x.useState(1),[t,g]=x.useState(!0),[l,A]=k({skip:d}),{instituteAllStaff:_,instituteAllStaffLoading:E}=H({data:{id:n,page:r,limit:10,search:d},skip:!n});x.useEffect(()=>{A&&t&&C(e=>e+1)},[A,t]),x.useEffect(()=>{_!=null&&_.length&&V(_==null?void 0:_.length,g)},[_==null?void 0:_.length]);const N=x.useCallback(w(e=>h(e),500),[]),y=e=>{N(e.target.value)},v=e=>{o===(e==null?void 0:e._id)||i(e)};return s.jsx(b,{onClose:c,children:s.jsxs("div",{className:P.modal_container,children:[s.jsx(S,{children:s.jsxs("div",{className:P.modal_container_outer_header,children:[s.jsx("div",{className:P.modal_container_header,children:s.jsx("h6",{children:a("staff_list")})}),s.jsx("img",{src:`${Y}/close.svg`,alt:"close icon",onClick:c})]})}),s.jsx(R,{}),s.jsxs(S,{customStyle:{paddingBottom:"1rem"},children:[s.jsxs("div",{className:P.assign_search_container,style:{marginBottom:"1rem"},children:[s.jsx("input",{type:"text",placeholder:a("search"),className:P.assign_search_input,onChange:y}),s.jsx("img",{src:`${W}/navbar-search.svg`,alt:"search icon"})]}),_==null?void 0:_.map((e,T)=>(_==null?void 0:_.length)===T+1?s.jsx("div",{ref:l,children:s.jsx($,{staff:e,selectedId:o,onSelect:v})},e==null?void 0:e._id):s.jsx($,{staff:e,selectedId:o,onSelect:v},e==null?void 0:e._id))]})]})})},G=({instituteId:c,fid:o,onClose:i,openModeratorMenu:n,openAs:a,onEdit:d})=>{var T;const{t:h}=u(),[r,C]=x.useState(a==="EDIT"?"PREVIEW_FORM":"OPEN_STAFF_LIST"),[t,g]=x.useState(a==="EDIT"?n==null?void 0:n.access_staff:""),[l,A]=x.useState({mod_role:a==="EDIT"?n==null?void 0:n.access_role:"",sid:a==="EDIT"?(T=n==null?void 0:n.access_staff)==null?void 0:T._id:""}),[_]=K();x.useEffect(()=>{var j;a==="EDIT"&&(g(n==null?void 0:n.access_staff),A({mod_role:n==null?void 0:n.access_role,sid:(j=n==null?void 0:n.access_staff)==null?void 0:j._id}),C("PREVIEW_FORM"))},[a]);const E=j=>{g(j),A(D=>({...D,sid:j==null?void 0:j._id})),C(a==="EDIT"?"PREVIEW_FORM":"ASSIGN_ROLE")},N=j=>{A(D=>({...D,mod_role:j==="Cash Receipt Section"?"CASH_RECEIPT_ACCESS":j==="Inventories Section"?"INVENTORY_ACCESS":j==="Fees Master Section"?"FEE_MASTER_ACCESS":j==="Payroll Section"?"PAYROLL_ACCESS":j==="Deposit Section"?"DEPOSIT_ACCESS":j==="Bank Account Section"?"BANK_ACCOUNT_ACCESS":j==="Data Export Authority"?"DATA_EXPORT_ACCESS":""}))},y=()=>{C("LOADING"),_({fid:o,addModerator:l}).then(()=>{C(""),i()}).catch({})},v=()=>{d(l)},e=()=>{i()};return s.jsxs(s.Fragment,{children:[r==="OPEN_STAFF_LIST"&&s.jsx(Ns,{onSelectStaff:E,onClose:i,instituteId:c}),r==="ASSIGN_ROLE"&&s.jsx(s.Fragment,{children:s.jsx(b,{onClose:i,children:s.jsxs("div",{className:p.modal_container,children:[s.jsx(S,{children:s.jsx("div",{className:p.modal_container_header,children:s.jsx("h6",{children:h("assign_role_to_moderator")})})}),s.jsx(R,{}),s.jsxs(S,{customStyle:{paddingTop:"0"},children:[s.jsxs("section",{className:p.selected_staff_container,children:[s.jsx("img",{src:t!=null&&t.staffProfilePhoto?`${I}/${t==null?void 0:t.staffProfilePhoto}`:`${O}/feed-user-avatar.svg`,alt:"staff profile avatar"}),s.jsxs("div",{className:p.selected_staff_text,children:[s.jsx("h6",{children:`${t==null?void 0:t.staffFirstName} ${(t==null?void 0:t.staffMiddleName)??""} ${t==null?void 0:t.staffLastName}`}),s.jsxs("p",{children:[h("index_no"),t==null?void 0:t.staffROLLNO]})]})]}),s.jsx(B,{selectLabel:h("select_role_of_moderator"),selectedValue:h("please_select_role"),options:["Cash Receipt Section","Inventories Section","Fees Master Section","Payroll Section","Deposit Section","Bank Account Section","Data Export Authority"],defalutValue:(l==null?void 0:l.mod_role)==="CASH_RECEIPT_ACCESS"?"Cash Receipt Section":(l==null?void 0:l.mod_role)==="INVENTORY_ACCESS"?"Inventories Section":(l==null?void 0:l.mod_role)==="FEE_MASTER_ACCESS"?"Fees Master Section":(l==null?void 0:l.mod_role)==="PAYROLL_ACCESS"?"Payroll Section":(l==null?void 0:l.mod_role)==="DEPOSIT_ACCESS"?"Deposit Section":(l==null?void 0:l.mod_role)==="BANK_ACCOUNT_ACCESS"?"Bank Account Section":(l==null?void 0:l.mod_role)==="DATA_EXPORT_ACCESS"?"Data Export Authority":"",onClick:N}),s.jsx(U,{label:"assign",onAction:y})]}),r==="LOADING"&&s.jsx(L,{})]})})}),r==="PREVIEW_FORM"&&s.jsx(ps,{onCloseEdit:e,setActivePopup:C,selectedStaff:t,moderatorState:l,onSelectRole:N,onUpdateModerator:v}),r==="LOADING"&&s.jsx(L,{})]})},Ss=({onClose:c,financeId:o,openModeratorMenu:i,instituteId:n})=>{const{t:a}=u(),[d,h]=x.useState(!1),[r,C]=x.useState(!1),[t]=X(),[g]=Q(),l=()=>{h(E=>!E),t({fid:o,modId:i==null?void 0:i._id}).then(()=>{c(),h(E=>!E)}).catch({})},A=E=>{h(N=>!N),_(),g({modId:i==null?void 0:i._id,updateModerator:{role:E==null?void 0:E.mod_role,staffId:E==null?void 0:E.sid}}).then(()=>{h(N=>!N),c()}).catch({})},_=()=>{C(E=>!E)};return s.jsx(s.Fragment,{children:r?s.jsx(G,{onClose:_,onEdit:A,openModeratorMenu:i,openAs:"EDIT",fid:o,instituteId:n}):s.jsxs(q,{onClose:c,disabled:d,children:[s.jsx("h6",{onClick:_,children:a("edit")}),s.jsx("h6",{onClick:l,children:a("delete")})]})})},m=({moderator:c,instituteId:o,financeId:i})=>{var C,t,g,l,A,_;const{t:n}=u(),[a,d]=x.useState(""),h=()=>{d(c)},r=()=>{d("")};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:p.moderator_card,children:[s.jsx("img",{src:(C=c==null?void 0:c.access_staff)!=null&&C.staffProfilePhoto?`${I}/${(t=c==null?void 0:c.access_staff)==null?void 0:t.staffProfilePhoto}`:`${O}/feed-user-avatar.svg`,alt:"moderator avatar"}),s.jsxs("section",{className:p.moderator_card_text_container,children:[s.jsx("h6",{children:`${(g=c==null?void 0:c.access_staff)==null?void 0:g.staffFirstName} ${((l=c==null?void 0:c.access_staff)==null?void 0:l.staffMiddleName)??""} ${(A=c==null?void 0:c.access_staff)==null?void 0:A.staffLastName}`}),s.jsxs("p",{children:[n("index_number")," "," : ",(_=c==null?void 0:c.access_staff)==null?void 0:_.staffROLLNO]}),s.jsx("p",{children:(c==null?void 0:c.access_role)==="CASH_RECEIPT_ACCESS"?"Cash Receipt Section":(c==null?void 0:c.access_role)==="INVENTORY_ACCESS"?"Inventories Section":(c==null?void 0:c.access_role)==="FEE_MASTER_ACCESS"?"Fees Master Section":(c==null?void 0:c.access_role)==="PAYROLL_ACCESS"?"Payroll Section":(c==null?void 0:c.access_role)==="DEPOSIT_ACCESS"?"Deposit Section":(c==null?void 0:c.access_role)==="BANK_ACCOUNT_ACCESS"?"Bank Account Section":(c==null?void 0:c.access_role)==="DATA_EXPORT_ACCESS"?"Data Export Authority":""})]}),s.jsx("img",{src:`${Y}/menu.svg`,alt:"menu icon",onClick:h,className:p.menu_icon,title:"Menu"})]}),a&&s.jsx(Ss,{onClose:r,financeId:i,openModeratorMenu:a,instituteId:o})]})},Ts=({fid:c,instituteId:o})=>{const{t:i}=u(),[n,a]=x.useState(""),[d,h]=x.useState(1),[r,C]=x.useState(!0),[t,g]=k({skip:n}),[l,A]=x.useState(!1),{financeModerator:_,financeModeratorLoading:E}=Z({data:{fid:c,page:d,limit:10,search:n},skip:!c});x.useEffect(()=>{g&&r&&h(e=>e+1)},[g,r]),x.useEffect(()=>{_!=null&&_.length&&V(_==null?void 0:_.length,C)},[_==null?void 0:_.length]);const N=x.useCallback(w(e=>a(e),500),[]),y=e=>{N(e.target.value)},v=()=>{A(e=>!e)};return s.jsxs(s.Fragment,{children:[s.jsxs(z,{children:[s.jsx(S,{children:s.jsxs("div",{className:F.fm_header_container,children:[s.jsx("h6",{children:i("finance_moderators")}),s.jsx("div",{className:F.fm_search,children:s.jsx("section",{className:F.fm_search_container,children:s.jsxs("div",{className:F.fm_search_container_inner,children:[s.jsx("img",{className:F.fm_search_icon,alt:"search icon",src:`${W}/navbar-search.svg`}),s.jsx("input",{type:"text",placeholder:i("search"),onChange:y})]})})})]})}),s.jsx(R,{}),s.jsxs(S,{customStyle:{paddingTop:"0.2rem"},children:[s.jsx(J,{children:s.jsx(M,{label:"add_new_moderator",onAction:v})}),E&&s.jsx(f,{}),_==null?void 0:_.map((e,T)=>(_==null?void 0:_.length)===T+1?s.jsx("div",{ref:t,children:s.jsx(m,{moderator:e,financeId:c,instituteId:o})},e==null?void 0:e._id):s.jsx(m,{moderator:e,financeId:c,instituteId:o},e==null?void 0:e._id))]})]}),l&&s.jsx(G,{instituteId:o,fid:c,onClose:v})]})};export{Ts as default};
