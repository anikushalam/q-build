import{u as Pe,r as a,j as s,H as Sr,N as Es,k as Js,W as Qs,f as jr,ln as yr,lI as os,D as Fs,C as gs,Q as Os,F as Ir,c as Nr,n as Ar,or as Dr,os as Cr,ot as wr,ou as kr,nm as Tr,lq as vr,lr as Pr,z as Mr}from"./index-731451a5.js";import{s as f}from"./JoinForm.module-212f9bb3.js";import{s as ls,a as Ss,b as js,d as ys,e as Is,N as Ns,O as As,g as xs,h as bs,j as is,k as Ls,l as er,o as sr,p as rr,q as tr,P as ur,Q as nr,R as Ws,S as Zs,J as Er,K as Or}from"./constant_value-4cd2b3e0.js";import{J as v}from"./JoinFormInput-8e74a0e0.js";import{J as Ve}from"./JoinFormSelect-a3c930fc.js";import{J as _r}from"./JoinFormTextArea-7f6dded0.js";import{J as $e}from"./JoinFormFile-110be590.js";import{B as i}from"./BorderBottom-47800983.js";import{B as mr}from"./ButtonWithTypeSubmit-71da32d7.js";import{F as Ms}from"./FormCheckbox-3a5ba026.js";import{S as dr,A as Br}from"./main.form.pdf.worker-13bf8267.js";import{J as Ye}from"./JoinFormCalender-5158d888.js";import{w as pr}from"./timeComparison-f15c3247.js";import{C as hr}from"./CustomAvatar-7aa8aa6e.js";import{aM as Ur,aN as fr,aO as Vr,aP as $r}from"./admission-api-56b87fde.js";import{J as cr}from"./JoinFormExistingSelect-8a136293.js";import{i as Rr,j as qr}from"./finance-api-5c6c5671.js";import{S as ar}from"./SelectFeeStructure-05d0a31f.js";import{P as Hr}from"./PopupWrapper-ffbaef7a.js";import{C as Gr}from"./CustomNormalSelectInput-9ec7329b.js";import{s as as}from"./PaymentPendingFee.module-4ffad14d.js";import{u as Yr}from"./use-login-02f54549.js";import{P as Kr,p as zr}from"./PaymentGatewayConfig-78c07c77.js";import{g as Xr}from"./paytmUpiInitiative-bed1cea7.js";import{c as Wr}from"./pdf-convertor-function-e794de58.js";import"./LoaderButton-71df50a7.js";import"./UniversalForm.module-19614663.js";import"./FormControlLabel-1c6af80c.js";import"./SwitchBase-2ba5f868.js";import"./Checkbox-1498c124.js";import"./JoinFormInputView-879755fe.js";import"./JoinFormFileView-d3f85876.js";import"./ViewFileDialog-0c131c06.js";import"./Overlay-07ce6f88.js";import"./Overlay.module-9133d1bb.js";import"./SearchModalBackdrop-5b309d60.js";import"./SearchHeader.module-b69c8942.js";import"./numberToWords.min-dbca819b.js";import"./DatePicker-305f3dc6.js";import"./Avatar.module-fb7ee634.js";import"./FeesStructure.module-7a88fbbc.js";import"./SearchModalWrapper-6e85c9f3.js";import"./verifyUserNameSpaces-1eb95efa.js";const or=({selectLabel:t,selectedValue:M,name:u,customStyleContainer:h,errorShow:l,departmentId:H,classMasterId:k,batchId:I,onFeeStructureSelect:C})=>{var T;const{t:G}=Pe(),{getAllFeesStructure:A,getAllFeesStructureRefetch:P}=Rr({data:{did:H,filterBy:k,page:1,limit:1e3,batch_by:I},skip:!H});a.useEffect(()=>{H&&P()},[H,P]);const J=$=>{var Z;(Z=A==null?void 0:A.all_structures)==null||Z.filter(N=>(N==null?void 0:N._id)===$.target.value?C(N):"")};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:f.join_form_container,style:{...h},children:[s.jsxs("p",{className:f.join_form_select_paragraph,children:[t," ",l&&s.jsxs("span",{style:{color:"red",marginLeft:"15px"},children:["* ",G("form_require_label")]})]}),s.jsxs("select",{className:f.join_form_select,onChange:J,name:u,children:[s.jsx("option",{selected:!0,children:M}),(T=A==null?void 0:A.all_structures)==null?void 0:T.map(($,Z)=>s.jsx("option",{value:$==null?void 0:$._id,children:($==null?void 0:$.unique_structure_name)??""},Z))]})]})})},Zr=({selectLabel:t,selectedValue:M,studentNewFieldIds:u,name:h,customStyleContainer:l,errorShow:H,admissionId:k,onApplicationSelect:I})=>{var J;const{t:C}=Pe(),{data:G,refetch:A}=Ur({aid:k,page:1,limit:1e3});a.useEffect(()=>{k&&A()},[k,A]);const P=T=>{var $;($=G==null?void 0:G.completed)==null||$.filter(Z=>(Z==null?void 0:Z._id)===T.target.value?I(Z):"")};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:f.join_form_container,style:{...l},children:[s.jsxs("p",{className:f.join_form_select_paragraph,children:[t," ",H&&s.jsxs("span",{style:{color:"red",marginLeft:"15px"},children:["* ",C("form_require_label")]})]}),s.jsxs("select",{className:f.join_form_select,onChange:P,name:h,children:[s.jsx("option",{selected:!0,children:M}),(J=G==null?void 0:G.completed)==null?void 0:J.map((T,$)=>s.jsx("option",{value:T==null?void 0:T._id,children:T==null?void 0:T.applicationName},$))]})]})})},Jr=({selectLabel:t,selectedValue:M,name:u,customStyleContainer:h,errorShow:l,departmentId:H,onBatchSelect:k})=>{var P,J;const{t:I}=Pe(),{oneDepartment:C,oneDepartmentRefetch:G}=Sr({did:H,skip:!H});a.useEffect(()=>{H&&G()},[H,G]);const A=T=>{var $,Z;(Z=($=C==null?void 0:C.department)==null?void 0:$.batches)==null||Z.filter(N=>(N==null?void 0:N._id)===T.target.value?k(N):"")};return s.jsx(s.Fragment,{children:s.jsxs("div",{className:f.join_form_container,style:{...h},children:[s.jsxs("p",{className:f.join_form_select_paragraph,children:[t," ",l&&s.jsxs("span",{style:{color:"red",marginLeft:"15px"},children:["* ",I("form_require_label")]})]}),s.jsxs("select",{className:f.join_form_select,onChange:A,name:u,children:[s.jsx("option",{selected:!0,children:M}),(J=(P=C==null?void 0:C.department)==null?void 0:P.batches)==null?void 0:J.map((T,$)=>s.jsx("option",{value:T==null?void 0:T._id,children:(T==null?void 0:T.batchName)??""},$))]})]})})},Qr=({admissionId:t,onNewFieldInputChange:M,index:u,classMasterId:h})=>{const{t:l}=Pe(),[H,k]=a.useState(""),[I,C]=a.useState(""),[G,A]=a.useState({amount:"",appName:"",fee_struct_name_amount:"",batchName:""}),P=()=>{},J=N=>{var w;A(Q=>({...Q,appName:(N==null?void 0:N.applicationName)??""})),k(((w=N==null?void 0:N.applicationDepartment)==null?void 0:w._id)??""),M({name:"appId",value:N==null?void 0:N._id},u)},T=N=>{A(w=>({...w,fee_struct_name_amount:N==null?void 0:N.total_admission_fees})),M({name:"fee_struct",value:N==null?void 0:N._id},u)},$=N=>{A(w=>({...w,batchName:N==null?void 0:N.batchName})),M({name:"batchId",value:N==null?void 0:N._id},u),C(N==null?void 0:N._id)},Z=N=>{A(w=>({...w,amount:+N.target.value})),M({name:"amount",value:G.fee_struct_name_amount-+N.target.value},u)};return s.jsxs(s.Fragment,{children:[s.jsx(Zr,{selectLabel:l("form_select_application_label"),selectedValue:l("form_select_application_placeholder"),name:"application",onChange:P,customStyleContainer:{width:"24%"},admissionId:t,setDepartmentId:k,onApplicationSelect:J}),s.jsx(Jr,{selectLabel:l("form_select_batch_label"),selectedValue:l("form_select_batch_placeholder"),name:"batch",customStyleContainer:{width:"24%"},departmentId:H,onBatchSelect:$}),s.jsx(or,{selectLabel:l("form_select_fee_structure_label"),selectedValue:l("form_select_fee_structure_label"),value:G.fee_struct_name,name:"fees",customStyleContainer:{width:"24%"},departmentId:H,classMasterId:h,batchId:I,onFeeStructureSelect:T}),s.jsx(v,{labelText:l("form_remaining_amount_label"),placeholder:l("form_remaining_amount_label_placeholder"),name:"amount",value:G.amount,type:"text",onChange:Z,customStyleContainer:{width:"24%"}})]})},Fr=({labelText:t,name:M,value:u,onChange:h,customStyleContainer:l,customStyleLabel:H})=>{const{t:k}=Pe();return s.jsxs("div",{className:f.join_form_container,style:{...l},children:[s.jsx("label",{className:f.join_form_label,htmlFor:M,style:{...H},children:t}),s.jsxs("div",{className:f.join_form_file_container,children:[s.jsx("label",{className:`${f.join_form_yes} ${u&&f.join_form_active_background}`,onClick:h,children:k("yes")}),s.jsx("label",{className:`${f.join_form_no} ${!u&&f.join_form_active_background}`,onClick:h,children:k("no")})]})]})},lr=({onClose:t,openFeesQuery:M,setStudentAdmission:u,onCloseFunction:h})=>{const{t:l}=Pe(),[H,k]=a.useState(""),[I,C]=a.useState({amount:"",mode:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:""}),[G,A]=a.useState({msg:"",run:!1}),P=w=>{C(Q=>({...Q,amount:+w.target.value,fee_payment_amount:+w.target.value}))},J=w=>{C(Q=>({...Q,[w.target.name]:w.target.value}))},T=w=>{const Q=w==null?void 0:w.split("/");C(z=>({...z,transaction_date:`${Q[2]}-${Q[1]}-${Q[0]}`}))},$=w=>{const Q={};for(let z in w)z==="fee_bank_name"||z==="fee_bank_holder"||z==="fee_utr_reference"||z==="amount"||z==="mode"||(w[z]?z==="fee_payment_amount"&&w[z]>(M==null?void 0:M.total_admission_fees)&&(A({msg:"You can not enter amount greater than total Admission fees",run:!0}),Q.fee_payment_amount=`${z} is required!`):Q[z]=`${z} is required!`);return Q},Z=w=>{C(Q=>({...Q,mode:w==="By Bank"?"Online":"Offline",fee_payment_mode:w}))},N=()=>{const w=$(I);let Q=!1;for(let z in w){Q=!0;break}Q?k(w):(u(z=>({...z,...I,fee_struct:M==null?void 0:M._id})),h())};return s.jsxs(Hr,{onClose:t,children:[s.jsxs("div",{className:as.add_category_modal,style:{width:"30rem",minHeight:"10rem",maxHeight:"35rem",overflowY:"scroll",overflowX:"hidden",scrollBehavior:"smooth",padding:"1rem"},children:[s.jsxs("section",{className:as.admission_fees_amount,children:[s.jsx("h6",{children:l("admission_fees")}),s.jsxs("h6",{children:[l("rs"),".",(M==null?void 0:M.total_admission_fees)??0]})]}),s.jsxs("section",{className:as.admission_fees_amount,children:[s.jsx("h6",{children:l("applicable_amount")}),s.jsxs("h6",{children:[l("rs"),".",(M==null?void 0:M.applicable_fees)??0]})]}),s.jsx(Gr,{selectLabel:l("payment_type"),value:I.mode?I.mode==="Online"?"By Bank":"By Cash":"",onClick:Z,selectedValue:"Select Payment Type By Bank/By Cash",options:["By Bank","By Cash"],customLabelStyle:{marginTop:"7px",marginBottom:"7px",fontWeight:"400",fontSize:"12px",color:"rgba(18, 18, 18, 0.8)"},customListStyle:{maxHeight:"fit-content"},errorShow:H.fee_payment_mode}),s.jsx(v,{labelText:l("amount"),name:"fee_payment_amount",type:"tel",value:I==null?void 0:I.fee_payment_amount,onChange:P,placeholder:l("please_enter_amount_paid"),errorShow:H.fee_payment_amount}),s.jsx(Ye,{labelText:l("select_date_of_transaction"),placeholder:l("please_select_date"),name:"transaction_date",value:I.transaction_date,onDateFunction:T,customStyleContainer:{position:"relative",marginTop:"0.5rem",marginBottom:"0.5rem"},datePickerPosition:{top:"-3rem"},customStyleLabel:{marginTop:"7px"},errorShow:H.transaction_date}),I.fee_payment_mode==="By Cash"||I.mode==="Offline"?"":s.jsxs(s.Fragment,{children:[s.jsx(v,{labelText:l("bank_name_collect"),name:"fee_bank_name",type:"text",value:I.fee_bank_name,onChange:J,placeholder:l("please_enter_bank_name"),customStyleLabel:{marginTop:"7px",marginBottom:"7px"}}),s.jsx(v,{labelText:l("banke_holder_name"),name:"fee_bank_holder",type:"text",value:I.fee_bank_holder,onChange:J,placeholder:l("please_enter_name_of_bank_holder"),customStyleLabel:{marginTop:"7px",marginBottom:"7px"}}),s.jsx(v,{labelText:l("cheque_dd_neft"),name:"fee_utr_reference",type:"tel",value:I.fee_utr_reference,onChange:J,placeholder:l("please_enter_utr_ref_number"),customStyleLabel:{marginTop:"7px",marginBottom:"7px"}})]}),s.jsx("button",{className:as.btn,style:{width:"100%",margin:"1rem 0"},onClick:N,children:l("confirm")})]}),s.jsx(Es,{msg:G.msg,run:G.run,setRun:()=>A({msg:"",run:!1}),postiton:"bottom",type:"error"})]})},gr=({preview:t,setPreview:M,location:u,onApplyForm:h})=>{var We,Ze,Je,Qe,Fe,ge,xe,_,e,j,O,W,x,ye,Ie,Ne,Ae,ce,pe,b,R,Oe,Be,Bs,Us,Vs,$s,Rs,qs,Hs,Gs,Ys,Ks,zs,Xs;const l=Js(n=>n.idChange),[H,k]=a.useState(""),[I,C]=a.useState({}),[G,A]=a.useState(""),[P,J]=a.useState([]),[T,$]=a.useState({studentFirstName:"",studentMiddleName:"",studentLastName:"",studentDOB:"",studentGender:"",studentMotherName:""}),[Z,N]=a.useState([]),[w,Q]=a.useState([]),[z,re]=a.useState({}),[me,Re]=a.useState(!1),[te,Me]=a.useState(""),[ve,we]=a.useState(!1),[Xe,he]=a.useState(""),[ae,Y]=a.useState(""),[qe,ke]=a.useState({msg:"",run:!1}),[U,Ke]=a.useState({}),[c,se]=a.useState(""),[m]=Qs(),{t:d}=Pe(),[g,fe]=a.useState({sample_pic:"",mode:"",amount:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:"",fee_struct:""}),[p,V]=a.useState(""),[X,E]=a.useState(!1),[L,ee]=a.useState(!1),[de,ue]=a.useState(!1),[Ee,le]=a.useState(""),[Te,o]=a.useState({student_prn_enroll_number:"",fee_struct:"",is_remain:"",batch_set:[]}),[ze,Le]=a.useState(!1),{searchCodeForJoin:S,searchCodeForJoinRefetch:es}=jr({data:{code:u==null?void 0:u.joinCode,joinAs:"Student"},skip:!(u!=null&&u.joinCode)}),{getAccountWithNumber:oe,getAccountWithNumberRefetch:Se}=fr({phoneKey:G,skip:(G==null?void 0:G.length)!==10}),{instituteStudentForm:D,instituteStudentFormRefetch:ss}=yr({id:(u==null?void 0:u.openAs)==="INSTITUTE_SIDE"?l==null?void 0:l.id:(u==null?void 0:u.openAs)==="DIRECT"?(We=S==null?void 0:S.one_ins)==null?void 0:We._id:(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"||(u==null?void 0:u.openAs)==="landing_page"||(u==null?void 0:u.openAs)==="landing_page_and_existing"?u==null?void 0:u.instituteId:(Ze=l.searchProfile)==null?void 0:Ze.id,skip:(u==null?void 0:u.openAs)==="INSTITUTE_SIDE"?!(l!=null&&l.id):(u==null?void 0:u.openAs)==="DIRECT"?!((Je=S==null?void 0:S.one_ins)!=null&&Je._id):(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"||(u==null?void 0:u.openAs)==="landing_page"||(u==null?void 0:u.openAs)==="landing_page_and_existing"?!(u!=null&&u.instituteId):!((Qe=l.searchProfile)!=null&&Qe.id)});a.useEffect(()=>{u!=null&&u.joinCode&&es()},[u==null?void 0:u.joinCode,es]),a.useEffect(()=>{var n,r;((n=l.searchProfile)!=null&&n.id||l!=null&&l.id||u!=null&&u.openAs||(r=S==null?void 0:S.one_ins)!=null&&r._id)&&ss()},[(Fe=l.searchProfile)==null?void 0:Fe.id,l==null?void 0:l.id,u==null?void 0:u.openAs,ss,(ge=S==null?void 0:S.one_ins)==null?void 0:ge._id]),a.useEffect(()=>{var n,r;if((n=S==null?void 0:S.classes)!=null&&n.optionalSubjectCount)for(let y of(r=S==null?void 0:S.classes)==null?void 0:r.subject)N(B=>({...B,[y._id]:""}))},[(xe=S==null?void 0:S.classes)==null?void 0:xe.optionalSubjectCount,(_=S==null?void 0:S.classes)==null?void 0:_.subject]),a.useEffect(()=>{var n,r,y,B,q,Ue,De,Ce;if(D!=null&&D.studentFormSetting){const ne=[];for(let K in D.studentFormSetting)if(K==="previousSchoolAndDocument"){let _e=(n=D==null?void 0:D.studentFormSetting)==null?void 0:n.previousSchoolAndDocument,F=[];for(let be in _e)_e[be]&&(be==="aadharCard"?(re(ie=>({...ie,addharFrontCard:"",addharBackCard:""})),F.push("addharFrontCard","addharBackCard")):be==="previousSchoolDocument"?(re(ie=>({...ie,studentPreviousSchool:"",previousSchoolDocument:""})),F.push("previousSchoolDocument","studentPreviousSchool")):(re(ie=>({...ie,[be]:""})),F.push(be)));Q([...F])}else D.studentFormSetting[K]&&(K==="otherPersonalInfo"?(C(_e=>{var F;return{..._e,...(F=ls)==null?void 0:F.withValue}}),ne.push(...(r=ls)==null?void 0:r.keys)):K==="identityDetails"?(C(_e=>{var F;return{..._e,...(F=Ss)==null?void 0:F.withValue}}),ne.push(...(y=Ss)==null?void 0:y.keys)):K==="addressInfo"?(C(_e=>{var F;return{..._e,...(F=js)==null?void 0:F.withValue}}),ne.push(...(B=js)==null?void 0:B.keys)):K==="parentsInfo"?(C(_e=>{var F;return{..._e,...(F=ys)==null?void 0:F.withValue}}),ne.push(...(q=ys)==null?void 0:q.keys)):K==="bankDetails"?(C(_e=>{var F;return{..._e,...(F=Is)==null?void 0:F.withValue}}),ne.push(...(Ue=Is)==null?void 0:Ue.keys)):K==="id_card"?(C(_e=>{var F;return{..._e,...(F=Ns)==null?void 0:F.withValue}}),ne.push(...(De=Ns)==null?void 0:De.keys)):K==="anti_ragging"&&(C(_e=>{var F;return{..._e,...(F=As)==null?void 0:F.withValue}}),ne.push(...(Ce=As)==null?void 0:Ce.keys)));J([...ne])}},[D==null?void 0:D.studentFormSetting]),a.useEffect(()=>{if(H){const n=H.split(" ");n.length>=3?$(r=>({...r,studentFirstName:n[0],studentMiddleName:n[1],studentLastName:n.slice(2).toString().replaceAll(","," ")})):$(r=>({...r,studentFirstName:n[0],studentMiddleName:"",studentLastName:n[1]===void 0?"":n[1]}))}},[H]);const rs=n=>{if((u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE")E(!0);else{const r=URL.createObjectURL(n.target.files[0]);Me(n.target.files[0]),he(r),Y(r),we(!0)}};a.useEffect(()=>{me&&Ge({target:{name:"file",files:[te]}})},[me,te]);const He=(n,r)=>{const y={};te||(ke({msg:"Please Select Image",run:!0}),y.file="profile image is required!"),r||(y.studentPhoneNumberAdd="* required");for(let B in n)B==="studentMiddleName"||B==="studentMotherName"||n[B]||(y[B]=`${B} is required!`);return y},Ds=(n,r,y)=>{const B={};te||(ke({msg:"Please Select Image",run:!0}),B.file="profile image is required!"),r||(B.studentPhoneNumberAdd="* required");for(let q in n)q==="studentMiddleName"||q==="studentMotherName"||n[q]||(B[q]=`${q} is required!`);for(let q in y)q==="sample_pic"||q==="fee_bank_holder"||q==="fee_bank_name"||q==="fee_utr_reference"||y[q]||(B[q]=`${q} is required!`);return B},Cs=(n,r,y,B)=>{var De,Ce,ne;const q={};te||(ke({msg:d("form_select_image_label"),run:!0}),q.file="profile image is required!"),r.studentBankAccount&&r.studentBankAccount!==r.studentBankReAccount&&(q.studentBankReAccount=`${d("form_account_dose_not_match_label")}`);let Ue=0;for(let K in B)B[K]&&(Ue+=1);Ue<((De=S==null?void 0:S.classes)==null?void 0:De.optionalSubjectCount)&&(q.optionalSubject=`atleast ${(Ce=S==null?void 0:S.classes)==null?void 0:Ce.optionalSubjectCount} optional subject required`);for(let K in n)K==="studentMiddleName"||n[K]||(q[K]=`${K} is required!`);for(let K in r)K==="studentPhoneNumber"||K==="studentEmail"||K==="student_anti_ragging"||K==="student_id_card_front"||K==="student_id_card_back"||K==="studentFatherRationCardColor"||r[K]||(q[K]=`${K} is required!`);return(ne=D==null?void 0:D.studentFormSetting)!=null&&ne.enrollmentPrn&&(Te!=null&&Te.student_prn_enroll_number||(q.student_prn_enroll_number="student_prn_enroll_number is required!")),q},ts=n=>{$(r=>({...r,[n.target.name]:n.target.value}))},je=n=>{n.target.name==="studentPhoneNumber"||n.target.name==="studentParentsPhoneNumber"?C(r=>{var y;return{...r,[n.target.name]:(y=n.target.value)==null?void 0:y.trim()}}):C(r=>({...r,[n.target.name]:n.target.value}))},ws=n=>{n.target.name==="previousSchoolDocument"?n.target.value?re(r=>({...r,[n.target.name]:n.target.value,studentPreviousSchool:"No"})):re(r=>({...r,[n.target.name]:n.target.value,studentPreviousSchool:""})):n.target.name==="studentPreviousSchool"?re(r=>({...r,[n.target.name]:n.target.value})):re(r=>({...r,[n.target.name]:n.target.files[0]}))},ks=n=>{n.target.checked?C(r=>({...r,asSameAddress:n.target.checked,studentAddress:r.studentCurrentAddress,studentPincode:r.studentCurrentPincode})):C(r=>({...r,asSameAddress:n.target.checked,studentAddress:"",studentPincode:""}))},Ts=n=>{n.target.checked?N(r=>({...r,[n.target.name]:n.target.name})):N(r=>({...r,[n.target.name]:""}))},Ge=n=>{var r;if((r=n.target.files)!=null&&r.length){se(B=>!B);const y=new FormData;y.append("file",n.target.files[0]),m({fileUpload:y}).then(B=>{var q,Ue;n.target.name==="file"?(Re(!1),Me({name:n.target.name,key:(q=B.data)==null?void 0:q.imageKey,type:(Ue=n.target.files[0])==null?void 0:Ue.type})):n.target.name==="bankPassbook"?C(De=>{var Ce,ne,K;return{...De,[n.target.name]:{originalName:(Ce=n.target.files[0])==null?void 0:Ce.name,name:n.target.name,key:(ne=B.data)==null?void 0:ne.imageKey,type:(K=n.target.files[0])==null?void 0:K.type}}}):re(De=>{var Ce,ne,K;return{...De,[n.target.name]:{originalName:(Ce=n.target.files[0])==null?void 0:Ce.name,name:n.target.name,key:(ne=B.data)==null?void 0:ne.imageKey,type:(K=n.target.files[0])==null?void 0:K.type}}}),se(De=>!De)}).catch({})}},vs=n=>{Me(n),fe(r=>({...r,sample_pic:n}))},Ps=()=>{o(n=>({...n,batch_set:[...n.batch_set,{appId:"",fee_struct:"",amount:"",batchId:""}]}))},us=(n,r)=>{var B;const y={...Te};for(let q=0;q<((B=y==null?void 0:y.batch_set)==null?void 0:B.length);q++)q===r&&(y.batch_set[q][n.name]=n.value,y.is_remain="Yes");o(y)},ns=n=>{n.preventDefault();const r=(u==null?void 0:u.openAs)==="INSTITUTE_SIDE"?He(T,G):(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?Ds(T,G,g):Cs(T,I,z,Z);let y=!1;for(let B in r){y=!0;break}y?Ke(r):M(B=>!B)},_s=n=>{if(pr(n)){let y=n==null?void 0:n.split("/"),B=`${y[2]}-${y[1]}-${y[0]}`;$(q=>({...q,studentDOB:B}))}else ke({msg:`You cannot select upcoming date ${n}`,run:!0})},ms=n=>{var r,y,B;A((r=n.target.value)==null?void 0:r.trim()),((B=(y=n.target.value)==null?void 0:y.trim())==null?void 0:B.length)===10&&((u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"||(u==null?void 0:u.openAs)==="INSTITUTE_SIDE")&&Se()},ds=n=>{V(n.target.value)},ps=()=>{Le(n=>!n),o(n=>({...n,fee_struct:"",is_remain:"",batch_set:[]}))},hs=n=>{o(r=>({...r,fee_struct:n==null?void 0:n._id,is_remain:"No",batch_set:[]}))},fs=n=>{le(n),ue(!0),fe(r=>({...r,fee_struct:n==null?void 0:n._id}))},cs=()=>{h({studentPhoneNumberAdd:G,file:te,formData:T,studentForm:I,dynamicDocument:z,optinalSubject:Z,studentAdmission:g,selectedUser:p,studentNewField:Te})};return s.jsxs(s.Fragment,{children:[t?s.jsx(dr,{studentForm:I,dynamicForm:P,formData:T,dynamicFormDocument:w,dynamicDocument:z,fileUrl:(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?`${os}/${te}`:ae,formSetting:D==null?void 0:D.studentFormSetting,onApplyStudentForm:cs,location:u,studentPhoneNumber:G,subjects:(Xs=S==null?void 0:S.classes)==null?void 0:Xs.subject,optinalSubject:Z,studentAdmission:g,showingExistingUser:oe==null?void 0:oe.all_account,selectedUser:p,studentNewField:Te,openFeesQuery:Ee}):s.jsxs("form",{onSubmit:ns,children:[s.jsxs("div",{className:f.form_container,children:[((u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"||(u==null?void 0:u.openAs)==="INSTITUTE_SIDE")&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:f.form_other_field,children:[s.jsx(v,{labelText:d("form_mobile_no_label"),placeholder:d("form_student_mobile_number_placeholder"),name:"mobileNumber",value:G,type:"text",onChange:ms,customStyleContainer:{width:"49.5%"},errorShow:U.studentPhoneNumberAdd}),(e=oe==null?void 0:oe.all_account)!=null&&e.length?s.jsx(cr,{selectLabel:d("existing_account"),selectedValue:d("select_existing_account"),value:p,name:"user",onChange:ds,options:oe==null?void 0:oe.all_account,customStyleContainer:{width:"49.5%"}}):""]}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),s.jsxs("h4",{children:[d("form_personal_info_label"),":"]}),s.jsxs("div",{className:f.form_container_profile,children:[s.jsx(v,{labelText:d("form_name_label"),placeholder:d("form_name_placeholder"),name:"fullname",value:H,type:"text",onChange:n=>k(n.target.value),customStyleContainer:(u==null?void 0:u.openAs)==="INSTITUTE_SIDE"||(j=D==null?void 0:D.studentFormSetting)!=null&&j.enrollmentPrn?{width:"56%"}:{width:"86%"},errorShow:U.studentFirstName||U.studentLastName}),((u==null?void 0:u.openAs)==="INSTITUTE_SIDE"||((O=D==null?void 0:D.studentFormSetting)==null?void 0:O.enrollmentPrn))&&s.jsx(v,{labelText:d((u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"||(u==null?void 0:u.openAs)==="INSTITUTE_SIDE"?"form_prn_enr_label":"form_prn_enr_student_label"),placeholder:d("form_prn_enr_placeholder"),name:"prn",value:Te.student_prn_enroll_number,type:"text",onChange:n=>o(r=>({...r,student_prn_enroll_number:n.target.value})),customStyleContainer:{width:"30%"},errorShow:U.student_prn_enroll_number}),s.jsxs("div",{className:f.form_container_profile_image,children:[s.jsxs("label",{htmlFor:"profile",className:f.form_container_profile_image_label,onClick:()=>(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?rs():{},children:[(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?s.jsx("img",{className:f.form_container_profile_photo,src:te?`${os}/${te}`:"/images/ins_default_profile.svg",alt:"student avatar"}):s.jsx("img",{className:f.form_container_profile_photo,src:ae||"/images/ins_default_profile.svg",alt:"student avatar"}),s.jsx("img",{src:"/images/user-pencil-edit-transparent.svg",alt:"edit icon",className:f.form_edit_icon})]}),(u==null?void 0:u.openAs)!=="ADMISSION_ADMIN_SIDE"&&s.jsx("input",{type:"file",id:"profile",onChange:rs,style:{display:"none"}})]})]}),s.jsxs("div",{className:f.form_profile_info,children:[s.jsx(Ve,{selectLabel:d("form_gender_label"),selectedValue:d("form_gender_placeholder"),value:T.studentGender,name:"studentGender",onChange:ts,options:xs,optionsValue:bs,errorShow:U.studentGender}),s.jsx(Ye,{labelText:d("form_date_of_birth_label"),placeholder:d("form_date_of_birth_placeholder"),name:"studentDOB",value:T.studentDOB,onDateFunction:_s,errorShow:U.studentDOB,customStyleContainer:{position:"relative"}}),s.jsx(v,{labelText:d("form_mother_name_label"),placeholder:d("form_mother_name_placeholder"),name:"studentMotherName",value:T.studentMotherName,type:"text",onChange:ts,errorShow:U.studentMotherName})]}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}}),(u==null?void 0:u.openAs)==="INSTITUTE_SIDE"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:f.is_fee_remain,children:[s.jsxs("div",{children:[s.jsx("h6",{className:f.add_batch_wise,children:d("form_add_batch_wise")}),s.jsx("p",{className:f.only_admssion_fees,children:d("form_only_admssion_fees")})]}),s.jsx(Fr,{name:"remaintoggle",labelText:d("is_ther_any_fee_remain"),value:ze,onChange:ps,customStyleContainer:{width:"50%"}})]}),ze&&s.jsxs(s.Fragment,{children:[(W=Te.batch_set)==null?void 0:W.map((n,r)=>s.jsx("div",{className:f.form_other_field,children:s.jsx(Qr,{batches:n,formErrors:U,admissionId:D==null?void 0:D.admissionId[0],onNewFieldInputChange:us,index:r,classMasterId:u==null?void 0:u.classMasterId,batchId:u==null?void 0:u.batchId})},r)),s.jsx("div",{className:f.form_other_field,children:s.jsx("div",{className:f.form_add_fee_btn,onClick:Ps,children:d("form_add_batch_wise_fees_data")})})]}),!ze&&s.jsx(or,{selectLabel:d("form_select_fee_structure_label"),selectedValue:d("form_select_fee_structure_label"),name:"fees",customStyleContainer:{width:"60%"},departmentId:(l==null?void 0:l.did)??"",classMasterId:u==null?void 0:u.classMasterId,batchId:u==null?void 0:u.batchId,onFeeStructureSelect:hs}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_admission_fees_details"),":"]}),g.fee_struct&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:f.form_other_field,children:[s.jsx(v,{labelText:d("selected_fee_structure"),name:"selected_fee_structure",value:Ee.unique_structure_name??"",type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}}),s.jsx(v,{labelText:d("payment_type"),name:"payment_type",value:g.fee_payment_mode,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}})]}),s.jsxs("div",{className:f.form_other_field,children:[s.jsx(v,{labelText:d("amount"),name:"fee_payment_amount",value:g.fee_payment_amount,type:"tel",onChange:()=>{},customStyleContainer:{width:"49.5%"}}),s.jsx(Ye,{labelText:d("select_date_of_transaction"),name:"transaction_date",value:g.transaction_date,onDateFunction:()=>{},customStyleContainer:{position:"relative",marginTop:"0.5rem",marginBottom:"0.5rem",width:"49.5%"},datePickerPosition:{top:"-3rem"},customStyleLabel:{marginTop:"7px"}})]}),s.jsxs("div",{className:f.form_other_field,children:[g.fee_bank_name&&s.jsx(v,{labelText:d("bank_name_collect"),name:"bank_name_collect",value:g.fee_bank_name,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}}),g.fee_bank_holder&&s.jsx(v,{labelText:d("banke_holder_name"),name:"banke_holder_name",value:g.fee_bank_holder,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}})]}),s.jsx("div",{className:f.form_other_field,children:g.fee_utr_reference&&s.jsx(v,{labelText:d("cheque_dd_neft"),name:"cheque_dd_neft",value:g.fee_utr_reference,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}})})]}),s.jsx("div",{className:f.form_other_field,children:s.jsx("div",{className:f.form_add_fee_btn,onClick:()=>ee(!0),children:d(g.fee_struct?"edit_select_fee_structure":"select_fee_structure")})}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),(ye=(x=S==null?void 0:S.classes)==null?void 0:x.subject)!=null&&ye.length||(Ie=S==null?void 0:S.classes)!=null&&Ie.optionalSubjectCount?s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_optional_subjects_label"),":"]}),s.jsxs("p",{className:f.optional_subject,children:[d("form_choose_minimum_label"),` ${(Ne=S==null?void 0:S.classes)==null?void 0:Ne.optionalSubjectCount}`," or",d("form_maximum_label"),` ${(Ae=S==null?void 0:S.classes)!=null&&Ae.optionalSubjectCount?((ce=S==null?void 0:S.classes)==null?void 0:ce.optionalSubjectCount)>((b=(pe=S==null?void 0:S.classes)==null?void 0:pe.subject)==null?void 0:b.length)?(R=S==null?void 0:S.classes)==null?void 0:R.optionalSubjectCount:(Be=(Oe=S==null?void 0:S.classes)==null?void 0:Oe.subject)==null?void 0:Be.length:""}`,(U==null?void 0:U.optionalSubject)&&s.jsx("span",{style:{color:"red",marginLeft:"15px"},children:U==null?void 0:U.optionalSubject})]}),(Us=(Bs=S==null?void 0:S.classes)==null?void 0:Bs.subject)==null?void 0:Us.map(n=>s.jsx(Ms,{checkLabel:n==null?void 0:n.subjectName,checkedValue:!!Z[n==null?void 0:n._id],name:n==null?void 0:n._id,onCheckboxAction:Ts,customStyle:{display:"block",width:"100%",marginLeft:"0"},customStyleLabel:{color:"rgba(18, 18, 18, 0.7)",fontSize:"12px"}},n==null?void 0:n._id))]}):"",((Vs=D==null?void 0:D.studentFormSetting)==null?void 0:Vs.otherPersonalInfo)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_other_personal_info_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:P==null?void 0:P.map(n=>is.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.type?s.jsx(Ve,{selectLabel:d(r==null?void 0:r.label),selectedValue:d(r==null?void 0:r.placeHolder),value:I[n],name:n,onChange:je,options:r==null?void 0:r.chooseOptions,optionsValue:r==null?void 0:r.chooseOptionsValue,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):s.jsx(v,{labelText:d(r==null?void 0:r.label),placeholder:d(r==null?void 0:r.placeHolder),name:n,value:I[n],type:["studentPhoneNumber","studentAadharNumber"].includes(n)?"tel":"text",inputLength:n==="studentPhoneNumber"?10:12,onChange:je,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),(($s=D==null?void 0:D.studentFormSetting)==null?void 0:$s.identityDetails)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_identity_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:P==null?void 0:P.map(n=>Ls.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.type?s.jsx(Ve,{selectLabel:d(r==null?void 0:r.label),selectedValue:d(r==null?void 0:r.placeHolder),value:I[n],onChange:je,options:r==null?void 0:r.chooseOptions,optionsValue:r==null?void 0:r.chooseOptionsValue,name:n,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):s.jsx(v,{labelText:d(r==null?void 0:r.label),placeholder:d(r==null?void 0:r.placeHolder),name:n,value:I[n],type:"text",onChange:je,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((Rs=D==null?void 0:D.studentFormSetting)==null?void 0:Rs.addressInfo)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_address_info_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:P==null?void 0:P.map(n=>er.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.type?s.jsx(_r,{labelText:d(r==null?void 0:r.label),placeholder:d(r==null?void 0:r.placeHolder),name:n,value:I[n],type:"text",onChange:je,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):r!=null&&r.checkbox?s.jsx(Ms,{checkLabel:d(r==null?void 0:r.label),checkedValue:I.asSameAddress,onCheckboxAction:ks,customStyle:{display:"block",width:"100%",marginLeft:"0"}},r==null?void 0:r.id):s.jsx(v,{labelText:d(r==null?void 0:r.label),placeholder:d(r==null?void 0:r.placeHolder),name:n,value:I[n],type:["studentCurrentPincode","studentPincode"].includes(n)?"tel":"text",inputLength:6,onChange:je,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((qs=D==null?void 0:D.studentFormSetting)==null?void 0:qs.parentsInfo)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_parent_guardian_info_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:P==null?void 0:P.map(n=>sr.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.type?s.jsx(Ve,{selectLabel:d(r==null?void 0:r.label),selectedValue:d(r==null?void 0:r.placeHolder),value:I[n],onChange:je,options:r==null?void 0:r.chooseOptions,optionsValue:r==null?void 0:r.chooseOptionsValue,name:n,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):s.jsx(v,{labelText:d(r==null?void 0:r.label),placeholder:d(r==null?void 0:r.placeHolder),name:n,value:I[n],type:["studentParentsPhoneNumber"].includes(n)?"tel":"text",inputLength:n==="studentParentsPhoneNumber"?10:30,onChange:je,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((Gs=(Hs=D==null?void 0:D.studentFormSetting)==null?void 0:Hs.previousSchoolAndDocument)==null?void 0:Gs.previousSchoolDocument)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_previous_school_document_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:w==null?void 0:w.map(n=>rr.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.fileType?s.jsx($e,{labelText:d(r==null?void 0:r.label),name:n,value:z[n],onChange:Ge,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):r!=null&&r.checkbox?"":!(z!=null&&z.previousSchoolDocument)&&s.jsx(v,{labelText:d(r==null?void 0:r.label),placeholder:d(r==null?void 0:r.placeHolder),name:n,value:z[n],type:"text",onChange:ws,customStyleContainer:{width:"100%"},errorShow:U[n]},r==null?void 0:r.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((Ys=D==null?void 0:D.studentFormSetting)==null?void 0:Ys.bankDetails)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_student_bank_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:P==null?void 0:P.map(n=>tr.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.fileType?s.jsx($e,{labelText:d(r==null?void 0:r.label),name:n,value:I[n],onChange:Ge,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):s.jsx(v,{labelText:d(r==null?void 0:r.label),placeholder:d(r==null?void 0:r.placeHolder),name:n,value:I[n],type:["studentBankAccount","studentBankReAccount"].includes(n)?"tel":"text",reAccount:n==="studentBankReAccount"?U[n]:"",inputLength:50,onChange:je,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((Ks=D==null?void 0:D.studentFormSetting)==null?void 0:Ks.id_card)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_student_idcard_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:P==null?void 0:P.map(n=>ur.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.fileType?s.jsx($e,{labelText:d(r==null?void 0:r.label),name:n,value:I[n],onChange:Ge,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):null)}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((zs=D==null?void 0:D.studentFormSetting)==null?void 0:zs.anti_ragging)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[d("form_student_antiragging_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:P==null?void 0:P.map(n=>nr.map(r=>{var y;return((y=r==null?void 0:r.lists)==null?void 0:y.includes(n))&&(r!=null&&r.fileType?s.jsx($e,{labelText:d(r==null?void 0:r.label),name:n,value:I[n],onChange:Ge,customStyleContainer:{width:"49.5%"},errorShow:U[n]},r==null?void 0:r.id):null)}))})]}),s.jsx(mr,{type:"submit",buttonText:d("form_preview"),customStyleButton:{marginTop:"1.5vw"}})]}),ve&&s.jsx(Fs,{open:ve,children:s.jsx(gs,{setPhotoURL:Y,photoURL:ae,setFile:Me,setOpenCrop:we,setProfilePhoto:he,first:1,second:1,setUpload:Re})}),s.jsx(Es,{msg:qe.msg,run:qe.run,setRun:()=>ke({msg:"",run:!1}),postiton:"bottom",type:"error"})]}),c&&s.jsx(Os,{}),X&&s.jsx(hr,{onClose:()=>E(!1),showContent:"Select Avatar",onClick:vs}),L&&s.jsx(ar,{onClose:()=>ee(!1),departmentId:u==null?void 0:u.applicationDepartment,classMasterId:u==null?void 0:u.applicationMaster,batchId:u==null?void 0:u.batchId,onSelectedStudent:fs,asOpen:"STUDENT_JOINING_FORM"}),de&&s.jsx(lr,{onClose:()=>{ue(!1),fe(n=>({...n,mode:"",amount:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:"",fee_struct:""}))},onCloseFunction:()=>ue(!1),openFeesQuery:Ee,setStudentAdmission:fe})]})},xr=({preview:t,setPreview:M,location:u,onApplyForm:h})=>{var us,ns,_s,ms,ds,ps,hs,fs,cs,We,Ze,Je,Qe,Fe,ge,xe;const[l,H]=a.useState(""),[k,I]=a.useState({}),[C,G]=a.useState(""),[A,P]=a.useState([]),[J,T]=a.useState({studentFirstName:"",studentMiddleName:"",studentLastName:"",studentDOB:"",studentGender:"",studentMotherName:""}),[$,Z]=a.useState([]),[N,w]=a.useState({}),[Q,z]=a.useState(!1),[re,me]=a.useState(""),[Re,te]=a.useState(!1),[Me,ve]=a.useState(""),[we,Xe]=a.useState(""),[he,ae]=a.useState({msg:"",run:!1}),[Y,qe]=a.useState({}),[ke,U]=a.useState(""),[Ke]=Qs(),{t:c}=Pe(),[se,m]=a.useState({sample_pic:"",mode:"",amount:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:"",fee_struct:""}),[d,g]=a.useState(""),[fe,p]=a.useState(!1),[V,X]=a.useState(!1),[E,L]=a.useState(!1),[ee,de]=a.useState(""),[ue,Ee]=a.useState({student_prn_enroll_number:"",fee_struct:"",is_remain:"",batch_set:[]}),{getAccountWithNumber:le,getAccountWithNumberRefetch:Te}=fr({phoneKey:C,skip:(C==null?void 0:C.length)!==10}),{departmentStudentForm:o,departmentStudentFormRefetch:ze}=Ir({did:u==null?void 0:u.departmentId,skip:!(u!=null&&u.departmentId)});a.useEffect(()=>{u!=null&&u.departmentId&&ze()},[ze,u==null?void 0:u.departmentId]),a.useEffect(()=>{var _,e,j,O,W,x,ye,Ie,Ne,Ae;if(o!=null&&o.studentFormSetting){const ce=[];for(let pe in o.studentFormSetting)if(pe==="previousSchoolAndDocument"){let b=(_=o==null?void 0:o.studentFormSetting)==null?void 0:_.previousSchoolAndDocument,R=[];for(let Oe in b)b[Oe]&&(Oe==="aadharCard"?(w(Be=>({...Be,addharFrontCard:"",addharBackCard:""})),R.push("addharFrontCard","addharBackCard")):Oe==="previousSchoolDocument"?(w(Be=>({...Be,studentPreviousSchool:"",previousSchoolDocument:""})),R.push("previousSchoolDocument","studentPreviousSchool")):(w(Be=>({...Be,[Oe]:""})),R.push(Oe)));Z([...R])}else o.studentFormSetting[pe]&&(pe==="otherPersonalInfo"?(I(b=>{var R;return{...b,...(R=ls)==null?void 0:R.withValue}}),ce.push(...(e=ls)==null?void 0:e.keys)):pe==="identityDetails"?(I(b=>{var R;return{...b,...(R=Ss)==null?void 0:R.withValue}}),ce.push(...(j=Ss)==null?void 0:j.keys)):pe==="addressInfo"?(I(b=>{var R;return{...b,...(R=js)==null?void 0:R.withValue}}),ce.push(...(O=js)==null?void 0:O.keys)):pe==="parentsInfo"?(I(b=>{var R;return{...b,...(R=ys)==null?void 0:R.withValue}}),ce.push(...(W=ys)==null?void 0:W.keys)):pe==="bankDetails"?(I(b=>{var R;return{...b,...(R=Is)==null?void 0:R.withValue}}),ce.push(...(x=Is)==null?void 0:x.keys)):pe==="gate_score"?(I(b=>{var R;return{...b,...(R=Ws)==null?void 0:R.withValue}}),ce.push(...(ye=Ws)==null?void 0:ye.keys)):pe==="marks_and_degree_score"?(I(b=>{var R;return{...b,...(R=Zs)==null?void 0:R.withValue}}),ce.push(...(Ie=Zs)==null?void 0:Ie.keys)):pe==="id_card"?(I(b=>{var R;return{...b,...(R=Ns)==null?void 0:R.withValue}}),ce.push(...(Ne=Ns)==null?void 0:Ne.keys)):pe==="anti_ragging"&&(I(b=>{var R;return{...b,...(R=As)==null?void 0:R.withValue}}),ce.push(...(Ae=As)==null?void 0:Ae.keys)));P([...ce])}},[o==null?void 0:o.studentFormSetting]),a.useEffect(()=>{if(l){const _=l.split(" ");_.length>=3?T(e=>({...e,studentFirstName:_[0],studentMiddleName:_[1],studentLastName:_.slice(2).toString().replaceAll(","," ")})):T(e=>({...e,studentFirstName:_[0],studentMiddleName:"",studentLastName:_[1]===void 0?"":_[1]}))}},[l]);const Le=_=>{if((u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE")p(!0);else{const e=URL.createObjectURL(_.target.files[0]);me(_.target.files[0]),ve(e),Xe(e),te(!0)}};a.useEffect(()=>{Q&&He({target:{name:"file",files:[re]}})},[Q,re]);const S=(_,e,j)=>{const O={};re||(ae({msg:"Please Select Image",run:!0}),O.file="profile image is required!"),e||(O.studentPhoneNumberAdd="* required");for(let W in _)W==="studentMiddleName"||W==="studentMotherName"||_[W]||(O[W]=`${W} is required!`);for(let W in j)W==="sample_pic"||W==="fee_bank_holder"||W==="fee_bank_name"||W==="fee_utr_reference"||j[W]||(O[W]=`${W} is required!`);return O},es=(_,e,j)=>{var W;const O={};re||(ae({msg:c("form_select_image_label"),run:!0}),O.file="profile image is required!"),e.studentBankAccount&&e.studentBankAccount!==e.studentBankReAccount&&(O.studentBankReAccount=`${c("form_account_dose_not_match_label")}`);for(let x in _)x==="studentMiddleName"||_[x]||(O[x]=`${x} is required!`);for(let x in e)x==="studentPhoneNumber"||x==="studentEmail"||x==="student_anti_ragging"||x==="student_id_card_front"||x==="student_id_card_back"||x==="studentFatherRationCardColor"||e[x]||(O[x]=`${x} is required!`);return(W=o==null?void 0:o.studentFormSetting)!=null&&W.enrollmentPrn&&(ue!=null&&ue.student_prn_enroll_number||(O.student_prn_enroll_number="student_prn_enroll_number is required!")),O},oe=_=>{T(e=>({...e,[_.target.name]:_.target.value}))},Se=_=>{_.target.name==="studentPhoneNumber"||_.target.name==="studentParentsPhoneNumber"?I(e=>{var j;return{...e,[_.target.name]:(j=_.target.value)==null?void 0:j.trim()}}):I(e=>({...e,[_.target.name]:_.target.value}))},D=_=>{["student_gate_score","student_degree_marks","student_percentage","student_class_cpi","student_pre_sem_points","student_final_sem_points"].includes(_.target.name)?I(e=>{var j;return{...e,[_.target.name]:(j=_.target.value)==null?void 0:j.trim()}}):I(e=>({...e,[_.target.name]:_.target.value}))},ss=_=>{_.target.name==="previousSchoolDocument"?_.target.value?w(e=>({...e,[_.target.name]:_.target.value,studentPreviousSchool:"No"})):w(e=>({...e,[_.target.name]:_.target.value,studentPreviousSchool:""})):_.target.name==="studentPreviousSchool"?w(e=>({...e,[_.target.name]:_.target.value})):w(e=>({...e,[_.target.name]:_.target.files[0]}))},rs=_=>{_.target.checked?I(e=>({...e,asSameAddress:_.target.checked,studentAddress:e.studentCurrentAddress,studentPincode:e.studentCurrentPincode})):I(e=>({...e,asSameAddress:_.target.checked,studentAddress:"",studentPincode:""}))},He=_=>{var e;if((e=_.target.files)!=null&&e.length){U(O=>!O);const j=new FormData;j.append("file",_.target.files[0]),Ke({fileUpload:j}).then(O=>{var W,x;_.target.name==="file"?(z(!1),me({name:_.target.name,key:(W=O.data)==null?void 0:W.imageKey,type:(x=_.target.files[0])==null?void 0:x.type})):["bankPassbook","student_id_card_front","student_id_card_back","student_anti_ragging"].includes(_.target.name)?I(ye=>{var Ie,Ne,Ae;return{...ye,[_.target.name]:{originalName:(Ie=_.target.files[0])==null?void 0:Ie.name,name:_.target.name,key:(Ne=O.data)==null?void 0:Ne.imageKey,type:(Ae=_.target.files[0])==null?void 0:Ae.type}}}):w(ye=>{var Ie,Ne,Ae;return{...ye,[_.target.name]:{originalName:(Ie=_.target.files[0])==null?void 0:Ie.name,name:_.target.name,key:(Ne=O.data)==null?void 0:Ne.imageKey,type:(Ae=_.target.files[0])==null?void 0:Ae.type}}}),U(ye=>!ye)}).catch({})}},Ds=_=>{me(_),m(e=>({...e,sample_pic:_}))},Cs=_=>{_.preventDefault();const e=(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?S(J,C,se):es(J,k);let j=!1;for(let O in e){j=!0;break}j?qe(e):M(O=>!O)},ts=_=>{if(pr(_)){let j=_==null?void 0:_.split("/"),O=`${j[2]}-${j[1]}-${j[0]}`;T(W=>({...W,studentDOB:O}))}else ae({msg:`You cannot select upcoming date ${_}`,run:!0})},je=_=>{var e,j,O;G((e=_.target.value)==null?void 0:e.trim()),((O=(j=_.target.value)==null?void 0:j.trim())==null?void 0:O.length)===10&&(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"&&Te()},ws=_=>{g(_.target.value)},ks=_=>{de(_),L(!0),m(e=>({...e,fee_struct:_==null?void 0:_._id}))},Ts=()=>{h({studentPhoneNumberAdd:C,file:re,formData:J,studentForm:k,dynamicDocument:N,optinalSubject:null,studentAdmission:se,selectedUser:d,studentNewField:ue,pdfUndertaking:o!=null&&o.pg_undertakings_admission?"PG":o!=null&&o.ug_undertakings_admission?"UG":"OFF"})},Ge=()=>{L(!1),m(_=>({..._,mode:"",amount:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:"",fee_struct:""}))},vs=_=>{let e=_==null?void 0:_.split("/"),j=`${e[2]}-${e[1]}`;I(O=>({...O,student_degree_year:j}))},Ps=_=>{let j=`${(_==null?void 0:_.split("/"))[2]}`;I(O=>({...O,student_gate_year:j}))};return s.jsxs(s.Fragment,{children:[t?s.jsx(dr,{studentForm:k,dynamicForm:A,formData:J,dynamicFormDocument:$,dynamicDocument:N,fileUrl:(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?`${os}/${re}`:we,formSetting:o==null?void 0:o.studentFormSetting,onApplyStudentForm:Ts,location:u,studentPhoneNumber:C,studentAdmission:se,showingExistingUser:le==null?void 0:le.all_account,selectedUser:d,studentNewField:ue,openFeesQuery:ee}):s.jsxs("form",{onSubmit:Cs,children:[s.jsxs("div",{className:f.form_container,children:[(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:f.form_other_field,children:[s.jsx(v,{labelText:c("form_mobile_no_label"),placeholder:c("form_student_mobile_number_placeholder"),name:"mobileNumber",value:C,type:"text",onChange:je,customStyleContainer:{width:"49.5%"},errorShow:Y.studentPhoneNumberAdd}),(us=le==null?void 0:le.all_account)!=null&&us.length?s.jsx(cr,{selectLabel:c("existing_account"),selectedValue:c("select_existing_account"),value:d,name:"user",onChange:ws,options:le==null?void 0:le.all_account,customStyleContainer:{width:"49.5%"}}):""]}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),s.jsxs("h4",{children:[c("form_personal_info_label"),":"]}),s.jsxs("div",{className:f.form_container_profile,children:[s.jsx(v,{labelText:c("form_name_label"),placeholder:c("form_name_placeholder"),name:"fullname",value:l,type:"text",onChange:_=>H(_.target.value),customStyleContainer:(ns=o==null?void 0:o.studentFormSetting)!=null&&ns.enrollmentPrn?{width:"56%"}:{width:"86%"},errorShow:Y.studentFirstName||Y.studentLastName}),((_s=o==null?void 0:o.studentFormSetting)==null?void 0:_s.enrollmentPrn)&&s.jsx(v,{labelText:c((u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?"form_prn_enr_label":"form_prn_enr_student_label"),placeholder:c("form_prn_enr_placeholder"),name:"prn",value:ue.student_prn_enroll_number,type:"text",onChange:_=>Ee(e=>({...e,student_prn_enroll_number:_.target.value})),customStyleContainer:{width:"30%"},errorShow:Y.student_prn_enroll_number}),s.jsxs("div",{className:f.form_container_profile_image,children:[s.jsxs("label",{htmlFor:"profile",className:f.form_container_profile_image_label,onClick:()=>(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?Le():{},children:[(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"?s.jsx("img",{className:f.form_container_profile_photo,src:re?`${os}/${re}`:"/images/ins_default_profile.svg",alt:"student avatar"}):s.jsx("img",{className:f.form_container_profile_photo,src:we||"/images/ins_default_profile.svg",alt:"student avatar"}),s.jsx("img",{src:"/images/user-pencil-edit-transparent.svg",alt:"edit icon",className:f.form_edit_icon})]}),(u==null?void 0:u.openAs)!=="ADMISSION_ADMIN_SIDE"&&s.jsx("input",{type:"file",id:"profile",onChange:Le,style:{display:"none"}})]})]}),s.jsxs("div",{className:f.form_profile_info,children:[s.jsx(Ve,{selectLabel:c("form_gender_label"),selectedValue:c("form_gender_placeholder"),value:J.studentGender,name:"studentGender",onChange:oe,options:xs,optionsValue:bs,errorShow:Y.studentGender}),s.jsx(Ye,{labelText:c("form_date_of_birth_label"),placeholder:c("form_date_of_birth_placeholder"),name:"studentDOB",value:J.studentDOB,onDateFunction:ts,errorShow:Y.studentDOB,customStyleContainer:{position:"relative"}}),s.jsx(v,{labelText:c("form_mother_name_label"),placeholder:c("form_mother_name_placeholder"),name:"studentMotherName",value:J.studentMotherName,type:"text",onChange:oe,errorShow:Y.studentMotherName})]}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}}),(u==null?void 0:u.openAs)==="ADMISSION_ADMIN_SIDE"&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_admission_fees_details"),":",Y.fee_payment_mode?s.jsx("span",{style:{color:"red",marginLeft:"15px"},children:"* required"}):""]}),se.fee_struct&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:f.form_other_field,children:[s.jsx(v,{labelText:c("selected_fee_structure"),name:"selected_fee_structure",value:ee.unique_structure_name??"",type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}}),s.jsx(v,{labelText:c("payment_type"),name:"payment_type",value:se.fee_payment_mode,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}})]}),s.jsxs("div",{className:f.form_other_field,children:[s.jsx(v,{labelText:c("amount"),name:"fee_payment_amount",value:se.fee_payment_amount,type:"tel",onChange:()=>{},customStyleContainer:{width:"49.5%"}}),s.jsx(Ye,{labelText:c("select_date_of_transaction"),name:"transaction_date",value:se.transaction_date,onDateFunction:()=>{},customStyleContainer:{position:"relative",marginTop:"0.5rem",marginBottom:"0.5rem",width:"49.5%"},datePickerPosition:{top:"-3rem"},customStyleLabel:{marginTop:"7px"}})]}),s.jsxs("div",{className:f.form_other_field,children:[se.fee_bank_name&&s.jsx(v,{labelText:c("bank_name_collect"),name:"bank_name_collect",value:se.fee_bank_name,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}}),se.fee_bank_holder&&s.jsx(v,{labelText:c("banke_holder_name"),name:"banke_holder_name",value:se.fee_bank_holder,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}})]}),s.jsx("div",{className:f.form_other_field,children:se.fee_utr_reference&&s.jsx(v,{labelText:c("cheque_dd_neft"),name:"cheque_dd_neft",value:se.fee_utr_reference,type:"text",onChange:()=>{},customStyleContainer:{width:"49.5%"}})})]}),s.jsx("div",{className:f.form_other_field,children:s.jsx("div",{className:f.form_add_fee_btn,onClick:()=>X(!0),children:c(se.fee_struct?"edit_select_fee_structure":"select_fee_structure")})}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((ms=o==null?void 0:o.studentFormSetting)==null?void 0:ms.otherPersonalInfo)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_other_personal_info_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>is.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.type?s.jsx(Ve,{selectLabel:c(e==null?void 0:e.label),selectedValue:c(e==null?void 0:e.placeHolder),value:k[_],name:_,onChange:Se,options:e==null?void 0:e.chooseOptions,optionsValue:e==null?void 0:e.chooseOptionsValue,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:["studentPhoneNumber","studentAadharNumber"].includes(_)?"tel":"text",inputLength:_==="studentPhoneNumber"?10:12,onChange:Se,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((ds=o==null?void 0:o.studentFormSetting)==null?void 0:ds.identityDetails)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_identity_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>Ls.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.type?s.jsx(Ve,{selectLabel:c(e==null?void 0:e.label),selectedValue:c(e==null?void 0:e.placeHolder),value:k[_],onChange:Se,options:e==null?void 0:e.chooseOptions,optionsValue:e==null?void 0:e.chooseOptionsValue,name:_,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:"text",onChange:Se,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((ps=o==null?void 0:o.studentFormSetting)==null?void 0:ps.addressInfo)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_address_info_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>er.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.type?s.jsx(_r,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:"text",onChange:Se,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):e!=null&&e.checkbox?s.jsx(Ms,{checkLabel:c(e==null?void 0:e.label),checkedValue:k.asSameAddress,onCheckboxAction:rs,customStyle:{display:"block",width:"100%",marginLeft:"0"}},e==null?void 0:e.id):s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:["studentCurrentPincode","studentPincode"].includes(_)?"tel":"text",inputLength:6,onChange:Se,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((hs=o==null?void 0:o.studentFormSetting)==null?void 0:hs.parentsInfo)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_parent_guardian_info_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>sr.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.type?s.jsx(Ve,{selectLabel:c(e==null?void 0:e.label),selectedValue:c(e==null?void 0:e.placeHolder),value:k[_],onChange:Se,options:e==null?void 0:e.chooseOptions,optionsValue:e==null?void 0:e.chooseOptionsValue,name:_,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:["studentParentsPhoneNumber"].includes(_)?"tel":"text",inputLength:_==="studentParentsPhoneNumber"?10:30,onChange:Se,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((cs=(fs=o==null?void 0:o.studentFormSetting)==null?void 0:fs.previousSchoolAndDocument)==null?void 0:cs.previousSchoolDocument)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_previous_school_document_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:$==null?void 0:$.map(_=>rr.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.fileType?s.jsx($e,{labelText:c(e==null?void 0:e.label),name:_,value:N[_],onChange:He,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):e!=null&&e.checkbox?null:!(N!=null&&N.previousSchoolDocument)&&s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:N[_],type:"text",onChange:ss,customStyleContainer:{width:"100%"},errorShow:Y[_]},e==null?void 0:e.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((We=o==null?void 0:o.studentFormSetting)==null?void 0:We.bankDetails)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_student_bank_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>tr.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.fileType?s.jsx($e,{labelText:c(e==null?void 0:e.label),name:_,value:k[_],onChange:He,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:["studentBankAccount","studentBankReAccount"].includes(_)?"tel":"text",reAccount:_==="studentBankReAccount"?Y[_]:"",inputLength:50,onChange:Se,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id))}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),(((Ze=o==null?void 0:o.studentFormSetting)==null?void 0:Ze.gate_score)||((Je=o==null?void 0:o.studentFormSetting)==null?void 0:Je.marks_and_degree_score))&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_student_pg_details_label"),":"]}),((Qe=o==null?void 0:o.studentFormSetting)==null?void 0:Qe.gate_score)&&s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>Er.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.isCalender?s.jsx(Ye,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],onDateFunction:Ps,errorShow:Y[_],customStyleContainer:{position:"relative",width:"49.5%"}},e==null?void 0:e.id):s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:"tel",onChange:D,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id))}))}),((Fe=o==null?void 0:o.studentFormSetting)==null?void 0:Fe.marks_and_degree_score)&&s.jsx(s.Fragment,{children:s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>Or.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.isCalender?s.jsx(Ye,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],onDateFunction:vs,errorShow:Y[_],customStyleContainer:{position:"relative",width:"49.5%"}},e==null?void 0:e.id):(e==null?void 0:e.isPreheading)==="Heading"?s.jsxs("h4",{children:[c(e==null?void 0:e.label),":"]}):(e==null?void 0:e.isPreheading)==="SUBHEADING"?s.jsxs("h5",{children:[c(e==null?void 0:e.label),":"]}):s.jsx(v,{labelText:c(e==null?void 0:e.label),placeholder:c(e==null?void 0:e.placeHolder),name:_,value:k[_],type:["student_degree_marks","student_percentage","student_class_cpi","student_pre_sem_points","student_final_sem_points"].includes(_)?"tel":"text",onChange:D,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id))}))})}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((ge=o==null?void 0:o.studentFormSetting)==null?void 0:ge.id_card)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_student_idcard_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>ur.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.fileType?s.jsx($e,{labelText:c(e==null?void 0:e.label),name:_,value:k[_],onChange:He,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):null)}))}),s.jsx(i,{customStyle:{width:"104.5%",marginTop:"15px",marginLeft:"-24px"}})]}),((xe=o==null?void 0:o.studentFormSetting)==null?void 0:xe.anti_ragging)&&s.jsxs(s.Fragment,{children:[s.jsxs("h4",{children:[c("form_student_antiragging_details_label"),":"]}),s.jsx("div",{className:f.form_other_field,children:A==null?void 0:A.map(_=>nr.map(e=>{var j;return((j=e==null?void 0:e.lists)==null?void 0:j.includes(_))&&(e!=null&&e.fileType?s.jsx($e,{labelText:c(e==null?void 0:e.label),name:_,value:k[_],onChange:He,customStyleContainer:{width:"49.5%"},errorShow:Y[_]},e==null?void 0:e.id):null)}))})]}),s.jsx(mr,{type:"submit",buttonText:c("form_preview"),customStyleButton:{marginTop:"1.5vw"}})]}),Re&&s.jsx(Fs,{open:Re,children:s.jsx(gs,{setPhotoURL:Xe,photoURL:we,setFile:me,setOpenCrop:te,setProfilePhoto:ve,first:1,second:1,setUpload:z})}),s.jsx(Es,{msg:he.msg,run:he.run,setRun:()=>ae({msg:"",run:!1}),postiton:"bottom",type:"error"})]}),ke&&s.jsx(Os,{}),fe&&s.jsx(hr,{onClose:()=>p(!1),showContent:"Select Avatar",onClick:Ds}),V&&s.jsx(ar,{onClose:()=>X(!1),departmentId:u==null?void 0:u.applicationDepartment,classMasterId:u==null?void 0:u.applicationMaster,batchId:u==null?void 0:u.batchId,onSelectedStudent:ks,asOpen:"STUDENT_JOINING_FORM"}),E&&s.jsx(lr,{onClose:Ge,onCloseFunction:()=>L(!1),openFeesQuery:ee,setStudentAdmission:m})]})};function Yt({location:t}){var qe,ke,U,Ke,c,se;const M=Nr(),u=Ar(),h=Js(m=>m.idChange),{t:l}=Pe(),[H,k]=a.useState(!1),[I,C]=a.useState(!1),[G,A]=a.useState(!1),[P,J]=a.useState(null),[T]=Dr(),[$]=Cr(),[Z]=Vr(),[N]=wr(),{existingAccountLogin:w}=Yr(),[Q]=$r(),[z]=kr(),[re]=Tr(),{data:me}=vr(),[Re]=Pr(),{merchantId:te,merchantIdRefetch:Me}=qr({id:(t==null?void 0:t.openAs)==="INSTITUTE_SIDE"?h==null?void 0:h.id:(t==null?void 0:t.openAs)==="ADMISSION_ADMIN_SIDE"||(t==null?void 0:t.openAs)==="landing_page"||(t==null?void 0:t.openAs)==="landing_page_and_existing"?t==null?void 0:t.instituteId:(qe=h.searchProfile)==null?void 0:qe.id,skip:(t==null?void 0:t.openAs)==="INSTITUTE_SIDE"?!(h!=null&&h.id):(t==null?void 0:t.openAs)==="ADMISSION_ADMIN_SIDE"||(t==null?void 0:t.openAs)==="landing_page"||(t==null?void 0:t.openAs)==="landing_page_and_existing"?!(t!=null&&t.instituteId):!((ke=h.searchProfile)!=null&&ke.id)}),{oneInstituteProfile:ve,oneInstituteProfileRefetch:we}=Mr({data:{id:(t==null?void 0:t.openAs)==="INSTITUTE_SIDE"?h==null?void 0:h.id:(t==null?void 0:t.openAs)==="ADMISSION_ADMIN_SIDE"||(t==null?void 0:t.openAs)==="landing_page"||(t==null?void 0:t.openAs)==="landing_page_and_existing"?t==null?void 0:t.instituteId:(U=h.searchProfile)==null?void 0:U.id,type:"ID"},skip:(t==null?void 0:t.openAs)==="INSTITUTE_SIDE"?!(h!=null&&h.id):(t==null?void 0:t.openAs)==="ADMISSION_ADMIN_SIDE"||(t==null?void 0:t.openAs)==="landing_page"||(t==null?void 0:t.openAs)==="landing_page_and_existing"?!(t!=null&&t.instituteId):!((Ke=h.searchProfile)!=null&&Ke.id)});a.useEffect(()=>{var m;(m=document.getElementById("scrollView"))==null||m.scrollIntoView({behavior:"smooth",block:"end",inline:"nearest"})},[H]),a.useEffect(()=>{var m;((m=h.searchProfile)!=null&&m.id||h!=null&&h.id||t!=null&&t.instituteId)&&we()},[(c=h.searchProfile)==null?void 0:c.id,h==null?void 0:h.id,t==null?void 0:t.instituteId,we]),a.useEffect(()=>{var m;((m=h.searchProfile)!=null&&m.id||h!=null&&h.id||t!=null&&t.instituteId)&&Me()},[(se=h.searchProfile)==null?void 0:se.id,h==null?void 0:h.id,t==null?void 0:t.instituteId,Me]);const Xe=()=>{H?k(m=>!m):M(-1)},he=async(m,d,g,fe=null,p=!1)=>{const V=new Worker(new URL(Br,import.meta.url),{type:"module"}),{institute:X,studentInfo:E}=Wr(ve==null?void 0:ve.institute,m,{imageKey:d,isAdmission:p,applicationName:t==null?void 0:t.applicationName});V.postMessage({printFormType:"STUDENT_FORM",studentInfo:E,institute:X,pdfUndertaking:fe}),V.onmessage=L=>{if(L&&g){window.open(URL.createObjectURL(L.data),"_blank");const ee=new FormData;ee.append("file",L.data),re({sid:g,pdf_file:ee}).then(()=>{C(de=>!de)}).catch({})}}},ae=m=>{var g,fe;C(p=>!p);const d={studentCode:t==null?void 0:t.joinCode,fileArray:[],optionalSubject:[]};(t==null?void 0:t.openAs)==="ADMISSION_ADMIN_SIDE"||d.fileArray.push(m==null?void 0:m.file);for(let p in m==null?void 0:m.formData)d[p]=m==null?void 0:m.formData[p];for(let p in m==null?void 0:m.studentForm)p==="asSameAddress"||(["bankPassbook","student_id_card_front","student_id_card_back","student_anti_ragging"].includes(p)?m!=null&&m.studentForm[p]&&d.fileArray.push(m==null?void 0:m.studentForm[p]):d[p]=m==null?void 0:m.studentForm[p]);for(let p in m==null?void 0:m.dynamicDocument)p==="previousSchoolDocument"||(p==="studentPreviousSchool"?d[p]=m==null?void 0:m.dynamicDocument[p]:m!=null&&m.dynamicDocument[p]&&d.fileArray.push(m==null?void 0:m.dynamicDocument[p]));for(let p in m==null?void 0:m.optinalSubject)m!=null&&m.optinalSubject[p]&&d.optionalSubject.push(m==null?void 0:m.optinalSubject[p]);if((t==null?void 0:t.openAs)==="ADMISSION_ADMIN_SIDE")for(let p in m==null?void 0:m.studentAdmission)d[p]=m==null?void 0:m.studentAdmission[p];if((t==null?void 0:t.openAs)==="INSTITUTE_SIDE")for(let p in m==null?void 0:m.studentNewField)d[p]=m==null?void 0:m.studentNewField[p];d.student_prn_enroll_number=m==null?void 0:m.studentNewField.student_prn_enroll_number,(t==null?void 0:t.openAs)==="DIRECT"&&(t!=null&&t.verifyNumber)?N({phoneNumber:t==null?void 0:t.verifyNumber,direct_student:d}).then(async p=>{var V,X,E,L,ee,de,ue,Ee;await he(d,(V=m==null?void 0:m.file)==null?void 0:V.key,(L=(E=(X=p==null?void 0:p.data)==null?void 0:X.user)==null?void 0:E.student)==null?void 0:L._id),w({token:(ee=p==null?void 0:p.data)==null?void 0:ee.token,_id:(ue=(de=p==null?void 0:p.data)==null?void 0:de.user)==null?void 0:ue._id,username:(Ee=p==null?void 0:p.data)==null?void 0:Ee.student})}).catch({}):(t==null?void 0:t.openAs)==="landing_page"&&(t!=null&&t.verifyNumber)?z({phoneNumber:t==null?void 0:t.verifyNumber,aid:t.appId,direct_student:d}).then(async p=>{var V,X,E,L,ee,de,ue;await he(d,(V=m==null?void 0:m.file)==null?void 0:V.key,(X=p==null?void 0:p.data)==null?void 0:X.student,m==null?void 0:m.pdfUndertaking),w({token:(E=p==null?void 0:p.data)==null?void 0:E.token,_id:(ee=(L=p==null?void 0:p.data)==null?void 0:L.user)==null?void 0:ee._id,username:(ue=(de=p==null?void 0:p.data)==null?void 0:de.user)==null?void 0:ue.username})}).catch({}):(t==null?void 0:t.openAs)==="landing_page_and_existing"&&(t!=null&&t.userId)?Z({uid:t==null?void 0:t.userId,aid:t==null?void 0:t.appId,apply_data:d}).then(async p=>{var V,X;await he(d,(V=m==null?void 0:m.file)==null?void 0:V.key,(X=p==null?void 0:p.data)==null?void 0:X.student,m==null?void 0:m.pdfUndertaking),p.data.status&&(C(E=>!E),M(`/q/${t==null?void 0:t.username}/feed`))}).catch({}):(t==null?void 0:t.openAs)==="INSTITUTE_SIDE"&&(t!=null&&t.classId)?$({phoneNumber:m==null?void 0:m.studentPhoneNumberAdd,uid:(m==null?void 0:m.selectedUser)??"",cid:t==null?void 0:t.classId,addStudent:d}).then(async p=>{var V,X;await he(d,(V=m==null?void 0:m.file)==null?void 0:V.key,(X=p==null?void 0:p.data)==null?void 0:X.student),M(-1)}).catch({}):(t==null?void 0:t.openAs)==="ADMISSION_APPLY"&&(h!=null&&h.id)&&(t!=null&&t.appId)?Z({uid:h==null?void 0:h.id,aid:t==null?void 0:t.appId,apply_data:d}).then(async p=>{var V,X;await he(d,(V=m==null?void 0:m.file)==null?void 0:V.key,(X=p==null?void 0:p.data)==null?void 0:X.student,m==null?void 0:m.pdfUndertaking),p.data.status&&(C(E=>!E),M(`/q/${t==null?void 0:t.urlUsername}/membersTab`))}).catch({}):(t==null?void 0:t.openAs)==="ADMISSION_DIRECT_APPLY"&&(h!=null&&h.id)&&(t!=null&&t.appId)?G||(A(!0),J(d),C(p=>!p)):(t==null?void 0:t.openAs)==="ADMISSION_ADMIN_SIDE"&&(t!=null&&t.appId)?Q({phoneNumber:m==null?void 0:m.studentPhoneNumberAdd,uid:(m==null?void 0:m.selectedUser)??"",aid:t==null?void 0:t.appId,addStudent:d}).then(async p=>{var V;await he(d,m==null?void 0:m.file,(V=p==null?void 0:p.data)==null?void 0:V.student,m==null?void 0:m.pdfUndertaking,!!(d!=null&&d.sample_pic)),M(-1)}).catch({}):(g=h==null?void 0:h.searchProfile)!=null&&g.id&&(h!=null&&h.id)&&(t!=null&&t.joinCode)?T({insId:(fe=h==null?void 0:h.searchProfile)==null?void 0:fe.id,studentData:d,uid:h==null?void 0:h.id}).then(async p=>{var V,X;await he(d,(V=m==null?void 0:m.file)==null?void 0:V.key,(X=p==null?void 0:p.data)==null?void 0:X.student),p.data.status&&(C(E=>!E),M(`/q/${t==null?void 0:t.urlUsername}/memberstab`))}).catch({}):C(p=>!p)};function Y(m){var X;let d=+(t==null?void 0:t.first_install)*2.1/100,g=+d*18/100,fe=+d+g;const p=parseInt(t==null?void 0:t.first_install);var V={amount:Math.ceil(p+ +fe.toFixed(2))};m==="PAYTM"?Xr({amount:+(t==null?void 0:t.first_install),amount_nocharges:+V.amount,type:"Direct_Admission",paidBy:`${h==null?void 0:h.id}`,paidTo:`${(X=h.searchProfile)==null?void 0:X.id}`,moduleId:`${t==null?void 0:t.appId}`,ad_status_id:null,payment_installment:null,ad_install:null,month:null,payment_remain_1:null,payment_card_type:null,payment_book_id:null,name:u.username,isApk:"web",payment_card_id:null}).then(E=>{var L,ee;window.onScriptLoad((ee=(L=E==null?void 0:E.response)==null?void 0:L.body)==null?void 0:ee.txnToken,E==null?void 0:E.order,E==null?void 0:E.amount)}).catch(E=>{console.info(E)}):me!=null&&me.Key&&(V!=null&&V.amount)&&Re({amount:V==null?void 0:V.amount}).then(E=>{var L,ee,de,ue;(L=E.data)!=null&&L.success?zr({key:me==null?void 0:me.Key,oid:(ee=E.data)==null?void 0:ee.order.id,amount_nocharge:(t==null?void 0:t.first_install)*100,amount:(de=E.data)==null?void 0:de.order.amount,type:"Direct_Admission",pay_by:`${h==null?void 0:h.id}`,pay_to:`${(ue=h.searchProfile)==null?void 0:ue.id}`,mid:`${t==null?void 0:t.appId}`,razor_key:te==null?void 0:te.key,razor_author:te==null?void 0:te.bool,status:null,installment_type:null,is_install:null,h_month:null,student_data:P}):console.log("data error")}).catch(E=>{console.log(E)})}return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:f.goback_container,id:"scrollView",children:s.jsxs("div",{className:f.goback_container_text,onClick:Xe,children:[s.jsx("img",{src:"/images/arr-left-white.svg",alt:"go back icon"}),s.jsx("h6",{className:f.goback_container_text_go,children:l("go_back")})]})}),s.jsxs("div",{className:f.student_from_container,children:[s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("h6",{className:f.student_from_fill,children:l("form_fill_student")}),H&&s.jsx("h6",{className:f.student_from_fill_edit,onClick:()=>k(m=>!m),children:l("edit_")})]}),s.jsx(i,{customStyle:{width:"100%"}}),(t==null?void 0:t.whichFormShow)==="DEPARTMENT"?s.jsx(xr,{preview:H,setPreview:k,location:t,onApplyForm:ae}):s.jsx(gr,{preview:H,setPreview:k,location:t,onApplyForm:ae})]}),G&&s.jsx(Kr,{onClose:()=>A(!1),allContent:{type:"ADMISSION_DIRECT_APPLY",amount:t==null?void 0:t.first_install},checkoutAdmissionDirectHandler:Y}),I&&s.jsx(Os,{})]})}export{Yt as default};
