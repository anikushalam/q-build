import{R as y,_ as E,r as u,u as A,j as t,e as H,kX as D,Q as T,k as w,S as I,a1 as M}from"./index-0ca76035.js";import{y as P,z as v,D as O,E as q,F as U}from"./institute-staff-student-api-7114d611.js";import{C as F}from"./CustomSuspense-25f8db15.js";import{aE as V}from"./department-api-e4b13f05.js";import{B as z}from"./BorderBottom-1dc6f53e.js";import{U as X}from"./UniversalTab-73e7f63a.js";const G="_complaints_c5ndx_1",J="_complaintList_c5ndx_7",K="_complaintDetail_c5ndx_13",S={complaints:G,complaintList:J,complaintDetail:K},W="_complaintList_hv44v_1",Y="_listHead_hv44v_11",Z="_tabs_hv44v_15",k={complaintList:W,listHead:Y,tabs:Z};const Q="_item_1vljc_1",ss="_leaves_1vljc_4",ts="_itemHead_1vljc_9",is="_left_1vljc_15",cs="_text_1vljc_27",es="_right_1vljc_50",ns="_btn_1vljc_56",as="_activeBtn_1vljc_68",os="_reason_1vljc_83",rs="_divider_1vljc_94",ms="_viewAll_1vljc_100",p={item:Q,leaves:ss,itemHead:ts,left:is,text:cs,right:es,btn:ns,activeBtn:as,reason:os,divider:rs,viewAll:ms},ds=y.lazy(()=>E(()=>import("./LeavesModal-63784062.js"),["assets/LeavesModal-63784062.js","assets/index-0ca76035.js","assets/index-4d24e8f6.css","assets/SearchModalBackdrop-c4f123e6.js","assets/SearchHeader.module-b69c8942.js","assets/SearchHeader-d07f850c.css","assets/Overlay-c8100e0a.js","assets/Overlay.module-9133d1bb.js","assets/Overlay-6f7772cd.css","assets/LeavesModal-2f73ccd0.css"])),ls=({leave:s,onStaffLeaveListRefetch:m,viewBy:n})=>{var h,b,$,i,d,o;const[e]=P(),[a]=V(),[l,c]=u.useState(!1),[N,g]=u.useState(!1),{t:_}=A(),L=r=>{var x,f;c(R=>!R),n==="COFF"&&((x=s==null?void 0:s.staff)!=null&&x._id)?a({lid:s==null?void 0:s._id,cConfig:{sid:(f=s==null?void 0:s.staff)==null?void 0:f._id}}).then(()=>{m(),c(R=>!R)}):e({id:s==null?void 0:s._id,leaveAction:{status:r}}).then(()=>{m(),c(R=>!R)})};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:p.item,children:[t.jsxs("div",{className:p.itemHead,children:[t.jsxs("div",{className:p.left,children:[t.jsx("img",{src:((h=s==null?void 0:s.staff)==null?void 0:h.photoId)!=="1"?`${H}/${(b=s==null?void 0:s.staff)==null?void 0:b.staffProfilePhoto}`:"/images/demo_users/user5.svg",alt:""}),t.jsxs("div",{className:p.text,children:[t.jsx("h6",{children:`${($=s==null?void 0:s.staff)==null?void 0:$.staffFirstName} ${(i=s==null?void 0:s.staff)!=null&&i.staffMiddleName?(d=s==null?void 0:s.staff)==null?void 0:d.staffMiddleName:""} ${(o=s==null?void 0:s.staff)==null?void 0:o.staffLastName}`}),(s==null?void 0:s.date.length)===1?t.jsx("p",{children:s==null?void 0:s.date[0]}):t.jsxs("p",{children:[s==null?void 0:s.date[0]," ",!N&&t.jsxs("span",{className:p.viewAll,onClick:()=>g(!0),children:["..",_("view_all_")]})]}),N&&t.jsx(F,{children:t.jsx(ds,{open:N,hideModal:r=>g(r),dates:s==null?void 0:s.date})})]})]}),t.jsxs("div",{className:p.right,children:[(s==null?void 0:s.attach)&&t.jsx("a",{href:`${D}/${s==null?void 0:s.attach}`,target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:t.jsx("img",{src:"/images/members/receipt-icon.svg",alt:"receipt icon",style:{height:"1.5rem"}})}),(s==null?void 0:s.status)==="Request"?t.jsxs(t.Fragment,{children:[n==="COFF"?null:t.jsx("div",{className:p.activeBtn,onClick:()=>{L("Rejected")},children:_("reject")}),t.jsx("div",{className:`${p.activeBtn}`,onClick:()=>{L("Accepted")},children:_("approve")})]}):t.jsx("div",{className:p.btn,style:(s==null?void 0:s.status)==="Rejected"?{color:"red"}:{color:"#14ab50"},children:s==null?void 0:s.status})]})]}),t.jsxs("div",{className:p.reason,style:{marginBottom:"0.3rem"},children:[" ",_("leave_type")," "," : ",s==null?void 0:s.leave_type]}),t.jsxs("div",{className:p.reason,children:[" ",_("reason")," "," : ",s==null?void 0:s.reason]})]}),t.jsx("div",{className:p.divider}),l&&t.jsx(T,{})]})};function _s(){var l;const s=w(c=>c.idChange.id),[m,n]=u.useState(!0),{staffLeaveList:e,staffLeaveListRefetch:a}=v({data:{id:s,page:1,limit:10},skip:!s});return u.useEffect(()=>{s&&(n(!0),a())},[s,a]),u.useEffect(()=>{e!=null&&e.allLeave&&n(!1)},[e==null?void 0:e.allLeave]),t.jsxs("div",{className:p.leaves,children:[(l=e==null?void 0:e.allLeave)==null?void 0:l.map((c,N)=>t.jsx(ls,{leave:c,onStaffLeaveListRefetch:a},N)),m&&t.jsx(I,{})]})}const fs="_item_stu1j_1",js="_leaves_stu1j_4",hs="_itemHead_stu1j_9",ps="_left_stu1j_15",xs="_text_stu1j_27",us="_right_stu1j_50",Ns="_btn_stu1j_56",gs="_activeBtn_stu1j_68",bs="_reason_stu1j_83",$s="_divider_stu1j_94",Ls="_replacebtn_stu1j_100",Rs="_replacedbtn_stu1j_117",j={item:fs,leaves:js,itemHead:hs,left:ps,text:xs,right:us,btn:Ns,activeBtn:gs,reason:bs,divider:$s,replacebtn:Ls,replacedbtn:Rs};function Ss({img:s,photoId:m,name:n,from:e,replacedBy:a,reason:l,index:c,replaced:N,setStaffListView:g,replacedStaff:_,setReplaceStaffId:L,setClickedIndex:h,clickedIndex:b,status:$,pid:i,aid:d,transId:o,MarkApprove:r,MarkReject:x}){const{t:f}=A();return t.jsxs("div",{className:j.item,children:[t.jsxs("div",{className:j.itemHead,children:[t.jsxs("div",{className:j.left,children:[t.jsx("img",{src:m!=="1"?`${H}/${s}`:"/images/demo_users/user5.svg",alt:""}),t.jsxs("div",{className:j.text,children:[t.jsx("h6",{children:n}),t.jsx("p",{children:e})]})]}),$==="Requested"?t.jsxs("div",{className:j.right,children:[(!_||b!==c)&&t.jsx("div",{className:`${j.btn}`,children:f("reject")}),(!_||b!==c)&&t.jsx("div",{className:`${j.btn}`,children:f("approve")}),_&&b===c&&t.jsx("div",{onClick:()=>{x("Rejected",o)},className:`${j.activeBtn}`,children:f("reject")}),_&&b===c&&t.jsx("div",{onClick:()=>{r("Approved",i,d,o)},className:`${j.activeBtn}`,children:f("approve")})]}):""]}),t.jsx("div",{className:j.reason,children:l}),$==="Requested"&&t.jsx("div",{onClick:()=>{g(!0),L(i),h(c)},className:j.replacebtn,children:f("replacement")}),$!=="Requested"&&t.jsxs("div",{className:j.replacedbtn,children:[f("replacement")," ",$]})]})}function As({staffListView:s,setStaffListView:m,replacedStaff:n,setReplaceStaffId:e,transferData:a,fetch:l}){const[c,N]=u.useState(),[g]=O(),[_]=q(),[L,h]=u.useState(!1),b=(i,d,o,r)=>{i!==""&&d!==""&&o!==""&&r!==""&&(h(x=>!x),g({tid:r&&r,status:i&&i,previousStaff:d&&d,assignedStaff:o&&o}).then(()=>{l(),m(!1),h(x=>!x)}).catch(x=>{h(f=>!f)}))},$=(i,d)=>{i!==""&&d!==""&&(h(o=>!o),_({tid:d&&d,status:i&&i}).then(o=>{l(),m(!1),h(r=>!r)}).catch(o=>{h(r=>!r)}))};return t.jsxs("div",{className:j.leaves,children:[a==null?void 0:a.map((i,d)=>{var o,r,x,f,R,C,B;return t.jsxs(t.Fragment,{children:[t.jsx(Ss,{index:d,img:(o=i==null?void 0:i.staff)==null?void 0:o.staffProfilePhoto,photoId:(r=i==null?void 0:i.staff)==null?void 0:r.photoId,from:M(i==null?void 0:i.createdAt).format("LL"),replaced:i.replaced,replacedBy:i.replacedBy,name:`${(x=i==null?void 0:i.staff)==null?void 0:x.staffFirstName} ${(f=i==null?void 0:i.staff)!=null&&f.staffMiddleName?(R=i==null?void 0:i.staff)==null?void 0:R.staffMiddleName:""} ${(C=i==null?void 0:i.staff)==null?void 0:C.staffLastName}`,reason:i==null?void 0:i.transferReason,setStaffListView:m,replacedStaff:n,setReplaceStaffId:e,clickedIndex:c,setClickedIndex:N,status:i==null?void 0:i.transferStatus,pid:(B=i==null?void 0:i.staff)==null?void 0:B._id,aid:n==null?void 0:n._id,transId:i==null?void 0:i._id,MarkApprove:b,MarkReject:$},d),t.jsx("div",{className:j.divider})]})}),L&&t.jsx(T,{})]})}function Cs({staffListView:s,setStaffListView:m,replacedStaff:n,setReplaceStaffId:e}){const a=w(h=>h.idChange.id),{t:l}=A(),{transferList:c,transferListRefetch:N}=U({id:a,skip:!a});u.useEffect(()=>{a&&N()},[a]);const[g,_]=u.useState(0),L=[{name:l("leaves"),id:0},{name:l("transfer"),id:1}];return t.jsx("div",{className:k.complaintList,children:t.jsxs("div",{className:k.listHead,children:[t.jsx(X,{tabList:L,activeIndexTab:g,setActiveIndexTab:_,customStyleTab:{width:"100%"}}),t.jsx(z,{customStyle:{width:"100%"}}),g===0&&t.jsx(_s,{}),g===1&&t.jsx(As,{staffListView:s,setStaffListView:m,replacedStaff:n,setReplaceStaffId:e,transferData:c&&(c==null?void 0:c.transfers),fetch:N})]})})}const Bs=y.lazy(()=>E(()=>import("./AllStaffList-d567e462.js"),["assets/AllStaffList-d567e462.js","assets/index-0ca76035.js","assets/index-4d24e8f6.css","assets/search-api-b192a53f.js","assets/AllStaffList-69d5806d.css"]));function Fs(){const[s,m]=u.useState(!1),[n,e]=u.useState(),[a,l]=u.useState("");return t.jsxs("div",{className:S.complaints,children:[t.jsx("div",{className:S.complaintList,children:t.jsx(Cs,{staffListView:s,setStaffListView:m,replacedStaff:n,setReplaceStaffId:l})}),t.jsx("div",{className:S.complaintDetail,children:s&&t.jsx(F,{children:t.jsx(Bs,{staffListView:s,setStaffListView:m,setReplacedStaff:e,replaceStaffId:a,replacedStaff:n})})})]})}export{Fs as default};
