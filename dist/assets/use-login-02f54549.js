import{g as v,c as x,aY as E,h as n,A as a,aZ as R,a_ as $}from"./index-731451a5.js";import{v as U}from"./verifyUserNameSpaces-1eb95efa.js";const Y=()=>{const i=v(),o=x(),[N]=E(),q=async t=>{var r,l,c,u,g,d,_,m,A,S,f,h,I,p,y,L,k,C,D,Q;if(U(t.insUserName))return{msg:"Special Character not allowed...",notify:!0};try{const e=await N(t);if(e.data.login)localStorage.clear("token"),localStorage.clear("user"),localStorage.clear("loggedinAs"),localStorage.clear("_did"),localStorage.clear("_cid"),localStorage.clear("_searchId"),localStorage.clear("_searchAs"),localStorage.clear("_usr"),localStorage.clear("_ad_access"),localStorage.clear("_fn_access"),localStorage.clear("_usr_r"),(r=e==null?void 0:e.data)!=null&&r.institute?(i(n.loginQuery({login:!0,token:e.data.token,id:(l=e.data.institute)==null?void 0:l._id,status:!0,loggedinAs:"institute",username:(c=e.data.institute)==null?void 0:c.name,loginRole:((u=e.data)==null?void 0:u.main_role)==="SOCIAL_MEDIA_HANDLER"?"_usr_rs":""})),i(a.addInstituteId({id:e.data.institute?(g=e.data.institute)==null?void 0:g._id:"",loggedinAs:"institute"})),i(R.financeQuery({fid:(_=(d=e==null?void 0:e.data)==null?void 0:d.institute)!=null&&_.financeDepart[0]?(A=(m=e==null?void 0:e.data)==null?void 0:m.institute)==null?void 0:A.financeDepart[0]:""})),i($.admissionQuery({aid:(f=(S=e==null?void 0:e.data)==null?void 0:S.institute)!=null&&f.admissionDepart[0]?(I=(h=e==null?void 0:e.data)==null?void 0:h.institute)==null?void 0:I.admissionDepart[0]:""})),o(`/q/${e.data.institute.name}/feed`,{state:{loginRole:((p=e.data)==null?void 0:p.main_role)==="SOCIAL_MEDIA_HANDLER"?"_usr_rs":""}})):(y=e==null?void 0:e.data)!=null&&y.user?(i(n.loginQuery({login:!0,token:e.data.token,id:e.data.user._id,status:!0,loggedinAs:"user",username:(L=e.data.user)==null?void 0:L.username})),i(a.addInstituteId({id:e.data.user?(k=e.data.user)==null?void 0:k._id:"",loggedinAs:"user"})),o(`/q/${(C=e==null?void 0:e.data)==null?void 0:C.user.username}/feed`)):(D=e==null?void 0:e.data)!=null&&D.admin&&(i(n.loginQuery({login:!0,token:e.data.token,id:e.data.admin?(Q=e.data.admin)==null?void 0:Q._id:"",status:!0,loggedinAs:"admin"})),o(`/q/${e.data.admin.adminUserName}/superadmin`));else return{msg:"Invalid Credentials",notify:!0}}catch{return{msg:"Time out of request...",notify:!0}}},s=()=>{localStorage.clear("token"),localStorage.clear("user"),localStorage.clear("loggedinAs"),localStorage.clear("_did"),localStorage.clear("_cid"),localStorage.clear("_searchId"),localStorage.clear("_searchAs"),localStorage.clear("_usr"),localStorage.clear("_ad_access"),localStorage.clear("_fn_access")};return{authenticateLogin:q,existingAccountLogin:t=>{s(),i(n.loginQuery({login:!0,token:t==null?void 0:t.token,id:t==null?void 0:t._id,status:!0,loggedinAs:"user",username:t==null?void 0:t.username})),i(a.addInstituteId({id:t==null?void 0:t._id,loggedinAs:"user"})),o(`/q/${t==null?void 0:t.username}/feed`)},existingLandingAccountLogin:t=>{s(),i(n.loginQuery({login:!0,token:t==null?void 0:t.token,id:t==null?void 0:t._id,status:!0,loggedinAs:"user",username:t==null?void 0:t.username})),i(a.addInstituteId({id:t==null?void 0:t._id,loggedinAs:"user"}))}}};export{Y as u};
