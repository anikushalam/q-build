import{u as p,j as e,lH as q,r as d,t as B,b as H,d as O,n as W}from"./index-0ca76035.js";import{n as Y,a4 as z,p as L,q as P,M as E,E as C,U as g,a as S,B as F,r as w,L as U,a5 as K,f as Q,C as V,Q as f,y as G,z as I,v as J,a6 as X,s as k,a7 as Z,l as M,H as D,k as A}from"./FinanceConfig-24ef7fd2.js";import{T as ee,a as se}from"./TileCard-17e6becb.js";import{t as ne}from"./transaction_constant-ad8d613b.js";import{l as ae}from"./localTime-4e51d139.js";const te="_applicable_to_btn_1tn1k_1",oe="_unused_container_1tn1k_19",ce="_unused_container_text_1tn1k_33",re="_unused_container_text_inner_1tn1k_38",ie="_modal_container_1tn1k_61",_e="_modal_container_header_1tn1k_70",le="_modal_container_outer_header_1tn1k_82",me="_student_container_1tn1k_89",de="_conainter_main_1tn1k_107",he="_student_container_name_1tn1k_112",xe="_corpus_card_1tn1k_131",je="_recieve_from_1tn1k_156",i={applicable_to_btn:te,unused_container:oe,unused_container_text:ce,unused_container_text_inner:re,modal_container:ie,modal_container_header:_e,modal_container_outer_header:le,student_container:me,conainter_main:de,student_container_name:he,corpus_card:xe,recieve_from:je},$=({student:s,onSelect:c})=>{var r;const{t:a}=p(),t=()=>{c(s)};return e.jsxs("section",{className:i.student_container,title:"Refund deposit",onClick:t,children:[e.jsx("img",{src:s!=null&&s.studentProfilePhoto?`${q}/${s==null?void 0:s.studentProfilePhoto}`:`${Y}/feed-user-avatar.svg`,alt:"student avatar"}),e.jsxs("div",{className:i.conainter_main,children:[e.jsxs("div",{className:i.student_container_name,children:[e.jsx("h6",{children:`${s==null?void 0:s.studentFirstName} ${s!=null&&s.studentMiddleName?s==null?void 0:s.studentMiddleName:""} ${s==null?void 0:s.studentLastName}`}),e.jsxs("h6",{className:i.student_container_gr,children:[a("rs")," ",(s==null?void 0:s.deposit_pending_amount)??0]})]}),e.jsxs("div",{className:i.student_container_name,children:[e.jsxs("h6",{children:[a("gr_number"),(s==null?void 0:s.studentGRNO)??""," ",", ",((r=s==null?void 0:s.department)==null?void 0:r.dName)??""]}),e.jsx("p",{className:i.student_container_gr,children:a("pending_deposit")})]})]})]})},pe=({fmid:s,onClose:c,onSelectRefund:a})=>{const{t}=p(),[r,n]=d.useState(""),[j,x]=d.useState(1),[u,v]=d.useState(!0),[_,y]=B({skip:r}),{financeMasterDepositAll:l,financeMasterDepositAllLoading:b}=z({data:{fmid:s,page:j,limit:10,search:r},skip:!s});d.useEffect(()=>{y&&u&&x(o=>o+1)},[y,u]),d.useEffect(()=>{l!=null&&l.length&&L(l==null?void 0:l.length,v)},[l==null?void 0:l.length]);const m=d.useCallback(P(o=>n(o),500),[]),N=o=>{m(o.target.value)},h=o=>{a(o)};return e.jsx(E,{onClose:c,children:e.jsxs("div",{className:C.modal_container,style:{marginBottom:"1rem"},children:[e.jsx(g,{children:e.jsxs("div",{className:C.modal_container_outer_header,children:[e.jsx("div",{className:C.modal_container_header,children:e.jsx("h6",{children:t("deposit_student_list")})}),e.jsx("img",{src:`${S}/close.svg`,alt:"close icon",onClick:c})]})}),e.jsx(F,{}),e.jsxs(g,{customStyle:{paddingTop:"0"},children:[e.jsxs("div",{className:C.assign_search_container,children:[e.jsx("input",{type:"text",placeholder:t("search"),className:C.assign_search_input,onChange:N}),e.jsx("img",{src:`${w}/navbar-search.svg`,alt:"search icon"})]}),b&&e.jsx(U,{}),l==null?void 0:l.map((o,R)=>(l==null?void 0:l.length)===R+1?e.jsx("div",{ref:_,children:e.jsx($,{student:o,onSelect:h})},o==null?void 0:o._id):e.jsx($,{student:o,onSelect:h},o==null?void 0:o._id))]})]})})},ue=({onClose:s,fmid:c,refundForm:a,onCloseParent:t})=>{var N;const{t:r}=p(),[n,j]=d.useState({amount:"",mode:"",fee_payment_mode:"By Bank",fee_payment_amount:"",transaction_date:"",fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:""}),[x,u]=d.useState(!1),[v,_]=d.useState(""),[y]=K(),l=h=>{j(o=>({...o,amount:+h.target.value,fee_payment_amount:+h.target.value}))},b=h=>{j(o=>({...o,mode:h==="By Bank"?"Online":"Offline",fee_payment_mode:h}))},m=()=>{if(c){let h=G(n,["amount","mode","transaction_date","fee_bank_name","fee_bank_holder","fee_utr_reference"]);I(h)?(u(o=>!o),y({fmid:c,sid:a==null?void 0:a._id,refundDeposit:n}).then(()=>{t(),u(o=>!o)}).catch({})):_(h)}};return e.jsx(e.Fragment,{children:e.jsx(E,{onClose:s,children:e.jsxs("div",{className:i.modal_container,children:[e.jsx(g,{children:e.jsxs("div",{className:i.modal_container_header,children:[e.jsx("img",{src:`${S}/back-arrow.svg`,onClick:s,title:"Go Back",style:{cursor:"pointer"}}),e.jsx("h6",{children:r("refund_deposit")})]})}),e.jsx(F,{}),e.jsxs(g,{customStyle:{paddingTop:"0"},children:[e.jsxs("div",{className:i.unused_container_text_inner,style:{marginTop:"0.6rem"},children:[e.jsx("h6",{children:r("pending_deposit")}),e.jsxs("h6",{children:[r("rs")," ",(a==null?void 0:a.deposit_pending_amount)??0]})]}),e.jsx(ee,{label:"payment_type_mode",customTileContainer:{marginBottom:"1rem"},children:(N=ne)==null?void 0:N.map(h=>e.jsx(se,{tile:h,onTile:b,activeTile:n.fee_payment_mode},h==null?void 0:h.key))}),e.jsx(Q,{label:r("amount"),name:"fee_payment_amount",type:"tel",value:n==null?void 0:n.fee_payment_amount,onChange:l,placeholder:r("please_enter_amount_paid"),errorShow:v.fee_payment_amount}),e.jsx(V,{label:"confirm",onAction:m})]}),x&&e.jsx(f,{})]})})})},ge=({onClose:s,fmid:c})=>{const[a,t]=d.useState(""),r=j=>{t(j)},n=()=>{t("")};return a?e.jsx(ue,{onClose:n,onCloseParent:s,refundForm:a,fmid:c}):e.jsx(pe,{fmid:c,onClose:s,onSelectRefund:r})},ve=({fmid:s,paidStudentCount:c,depositAmount:a})=>{const{t}=p(),[r,n]=d.useState(!1),j=()=>{n(x=>!x)};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:i.applicable_to_btn,onClick:j,style:{width:"50%",marginTop:"2rem",marginBottom:"1rem",cursor:"pointer"},children:[e.jsxs("div",{children:[t("refund_deposit")," "]}),e.jsx("img",{src:`${S}/forward.svg`,alt:"next step"})]}),e.jsxs("section",{className:i.unused_container,children:[e.jsx("img",{src:`${S}/rupee.svg`,alt:"rupee symobl"}),e.jsxs("div",{className:i.unused_container_text,children:[e.jsxs("div",{className:i.unused_container_text_inner,children:[e.jsx("h6",{children:t("total_deposit")}),e.jsxs("h6",{children:[t("rs")," ",a??0]})]}),e.jsx("div",{className:i.unused_container_text_inner,children:e.jsxs("p",{children:[t("of")," ",c??0," ",t("students")]})})]})]}),r&&e.jsx(ge,{onClose:j,fmid:s})]})},T=({refund:s})=>{var a,t,r;const{t:c}=p();return e.jsxs("div",{className:i.corpus_card,children:[e.jsxs("h6",{style:{textAlign:"center"},children:[c("invoice_number")," "," : "," ",(s==null?void 0:s.invoice_count)??""]}),e.jsx("p",{className:i.recieve_from,children:c("paid_to")}),e.jsxs("div",{className:i.unused_container_text_inner,children:[e.jsx("h6",{children:`${((a=s==null?void 0:s.student)==null?void 0:a.studentFirstName)??""} ${((t=s==null?void 0:s.student)==null?void 0:t.studentMiddleName)??""} ${((r=s==null?void 0:s.student)==null?void 0:r.studentLastName)??""}`}),e.jsxs("h6",{children:[c("rs")," ",(s==null?void 0:s.fee_payment_amount)??0]})]}),e.jsxs("div",{className:i.unused_container_text_inner,children:[e.jsxs("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:[J(s==null?void 0:s.created_at).format("DD MMM YYYY"),", ",ae(s==null?void 0:s.created_at,"LT")]}),e.jsx("p",{style:{color:"rgba(18, 18, 18, 0.8)"},children:(s==null?void 0:s.fee_payment_mode)==="Online"?"Bank":"Cash"})]})]})},ye=({fid:s})=>{const{t:c}=p(),[a,t]=d.useState(""),[r,n]=d.useState(1),[j,x]=d.useState(!0),[u,v]=B({skip:a}),{financeAllDepositRefund:_,financeAllDepositRefundLoading:y}=X({data:{fid:s,page:r,limit:10,search:a},skip:!s});d.useEffect(()=>{v&&j&&n(m=>m+1)},[v,j]),d.useEffect(()=>{_!=null&&_.length&&L(_==null?void 0:_.length,x)},[_==null?void 0:_.length]);const l=d.useCallback(P(m=>t(m),500),[]),b=m=>{l(m.target.value)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:k.fm_header_container,style:{marginTop:"0.5rem"},children:[e.jsx("h6",{children:c("refund_history")}),e.jsx("div",{className:k.fm_search,style:{marginBottom:"0.5rem"},children:e.jsx("section",{className:k.fm_search_container,children:e.jsxs("div",{className:k.fm_search_container_inner,children:[e.jsx("img",{className:k.fm_search_icon,alt:"search icon",src:`${w}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:c("search"),onChange:b})]})})})]}),y&&e.jsx(U,{}),_==null?void 0:_.map((m,N)=>(_==null?void 0:_.length)===N+1?e.jsx("div",{ref:u,children:e.jsx(T,{refund:m})},m==null?void 0:m._id):e.jsx(T,{refund:m},m==null?void 0:m._id))]})},Ne=({refundAmount:s,refundStudentCount:c,fid:a})=>{const{t}=p();return e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:i.unused_container,children:[e.jsx("img",{src:`${S}/rupee.svg`,alt:"rupee symobl"}),e.jsxs("div",{className:i.unused_container_text,children:[e.jsxs("div",{className:i.unused_container_text_inner,children:[e.jsx("h6",{children:t("total_refunded")}),e.jsxs("h6",{children:[t("rs")," ",s??0]})]}),e.jsx("div",{className:i.unused_container_text_inner,children:e.jsxs("p",{children:[t("of")," ",c??0," ",t("students")]})})]})]}),e.jsx(ye,{fid:a})]})},ke=[{label:"collection",id:"collection",urlKey:""},{label:"refunded",id:"refund",urlKey:"&n=refund"}],Te=({fid:s})=>{const{t:c}=p(),[a]=H(),t=O(),r=W(),{financeMasterDeposit:n,financeMasterDepositLoading:j}=Z({fid:s,skip:!s});return e.jsxs(M,{children:[e.jsx(g,{children:e.jsxs("div",{className:k.fm_header_container,children:[e.jsx("h6",{children:c("deposit")}),e.jsx("img",{src:`${S}/filter.svg`,alt:"filter icon"})]})}),e.jsx(F,{}),e.jsxs(g,{customStyle:{paddingTop:"0"},children:[e.jsx(D,{children:ke.map(x=>e.jsx(A,{tab:x,isLink:!0,isActive:x.id==="collection"&&!a.get("n")?!0:a.get("n")===x.id,parentState:t.state,url:`/q/${r.username}/member/staff/finance?type=deposit${x.urlKey}`},x==null?void 0:x.id))}),e.jsx(F,{customStyleBorder:{marginTop:"0"}})]}),e.jsx(g,{customStyle:{paddingTop:"0"},children:a.get("n")==="refund"?e.jsx(Ne,{fid:s,refundAmount:n==null?void 0:n.refund_amount,refundStudentCount:n==null?void 0:n.refund_student_count}):e.jsx(ve,{fmid:n==null?void 0:n._id,depositAmount:n==null?void 0:n.deposit_amount,paidStudentCount:n==null?void 0:n.paid_student_count})})]})};export{Te as default};
