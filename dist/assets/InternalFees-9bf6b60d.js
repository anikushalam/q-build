import{j as e,u as B,r as a,t as Q}from"./index-0ca76035.js";import{E as j,a as w,B as A,aa as M,p as z,q as O,M as G,U as y,r as H,L as J,ab as X,f as q,C as Y,Q as Z,y as L,z as I,ac as ee,l as se,s as D,a3 as ne}from"./FinanceConfig-24ef7fd2.js";import{A as K}from"./AddButton-53d4607a.js";import{S as te}from"./SelectDepartment-a1ffc283.js";import{s as P}from"./Income.module-200dd9e8.js";import"./TileCard-17e6becb.js";import"./statistics_constant-b063291e.js";const V=({cls:t,onSelect:d,selectedId:c})=>{const f=()=>{d(t)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:c!=null&&c.includes(t==null?void 0:t._id)?`${j.assign_show_list_each} ${j.assign_show_list_each_active}`:j.assign_show_list_each,onClick:f,children:[e.jsx("img",{src:`${w}/class.svg`,alt:"class icon",style:{borderRadius:"0"}}),e.jsx("div",{className:j.assign_each_paragraph,children:e.jsx("h6",{children:(t==null?void 0:t.className)??""})})]}),e.jsx(A,{customStyleBorder:{margin:"0"}})]})},ae=({onClose:t,did:d,bid:c,onSave:f,clsListId:l,setClsListId:g})=>{const{t:p}=B(),[N,F]=a.useState(""),[C,v]=a.useState(1),[m,r]=a.useState(!0),[$,E]=Q({skip:N}),[S,x]=a.useState(l??[]),[o,b]=a.useState([]),{departmentBatchAllClassMaster:i,departmentBatchAllClassMasterLoading:T}=M({data:{did:d,bid:c,page:C,limit:10,search:N},skip:d?!d:!c});a.useEffect(()=>{l!=null&&l.length&&x(l)},[l==null?void 0:l.length]),a.useEffect(()=>{E&&m&&v(s=>s+1)},[E,m]),a.useEffect(()=>{i!=null&&i.length&&z(i==null?void 0:i.length,r)},[i==null?void 0:i.length]);const k=a.useCallback(O(s=>F(s),500),[]),R=s=>{k(s.target.value)},h=s=>{S!=null&&S.includes(s==null?void 0:s._id)?(x(n=>n==null?void 0:n.filter(u=>u!==(s==null?void 0:s._id))),g(n=>n==null?void 0:n.filter(u=>u!==(s==null?void 0:s._id))),b(n=>n==null?void 0:n.filter(u=>(u==null?void 0:u._id)!==(s==null?void 0:s._id)))):(x(n=>[...n,s==null?void 0:s._id]),g(n=>[...n,s==null?void 0:s._id]),b(n=>[...n,s]))},_=()=>{let s=[];for(let n of o)for(let u of n==null?void 0:n.classDivision)s.push(u==null?void 0:u._id);f(s)};return e.jsx(G,{onClose:t,children:e.jsxs("div",{className:j.modal_container,children:[e.jsx(y,{children:e.jsxs("div",{className:j.modal_container_outer_header,children:[e.jsx("div",{className:j.modal_container_header,children:e.jsx("h6",{children:p("select_standard")})}),e.jsxs("div",{className:j.modal_container_header_btn,children:[e.jsx(K,{label:"select",onAction:_}),e.jsx("img",{src:`${w}/close.svg`,alt:"close icon",onClick:t})]})]})}),e.jsx(A,{}),e.jsxs(y,{customStyle:{paddingTop:"0",paddingBottom:"1rem"},children:[e.jsxs("div",{className:j.assign_search_container,style:{marginBottom:"0.8rem"},children:[e.jsx("input",{type:"text",placeholder:p("search"),className:j.assign_search_input,onChange:R}),e.jsx("img",{src:`${H}/navbar-search.svg`,alt:"search icon"})]}),T&&e.jsx(J,{}),i==null?void 0:i.map((s,n)=>(i==null?void 0:i.length)===n+1?e.jsx("div",{ref:$,children:e.jsx(V,{cls:s,selectedId:S,onSelect:h})},s==null?void 0:s._id):e.jsx(V,{cls:s,selectedId:S,onSelect:h},s==null?void 0:s._id))]})]})})},oe=({fid:t,onClose:d})=>{const{t:c}=B(),[f,l]=a.useState("DEPARTMENT"),[g,p]=a.useState({feeName:"",feeAmount:"",feeDate:""}),[N,F]=a.useState(""),[C,v]=a.useState(!1),[m,r]=a.useState(""),[$]=X(),[E,S]=a.useState([]),[x,o]=a.useState([]),b=h=>{h.target.name==="feeAmount"?p(_=>({..._,feeAmount:+h.target.value})):p(_=>({..._,[h.target.name]:h.target.value}))},i=()=>{if(t&&(x==null?void 0:x.length)>0){let _=new Date().toISOString(),s=`${_==null?void 0:_.substring(0,4)}-${_==null?void 0:_.substring(5,7)}-${_==null?void 0:_.substring(8,10)}`;v(n=>!n),$({fid:t,inernalBody:{did:m==null?void 0:m._id,ClassId:x,feeName:g.feeName,feeAmount:g.feeAmount,feeDate:s}}).then(()=>{v(n=>!n),d()}).catch(()=>{v(n=>!n)})}},T=()=>{let h=L(g,["feeDate"]);I(h)?i():F(h)},k=h=>{r(h),l("CLASSES")},R=h=>{o(h),l("")};return e.jsx(e.Fragment,{children:f?f==="DEPARTMENT"?e.jsx(te,{onClose:d,fid:t,onSelect:k}):e.jsx(ae,{onClose:()=>l("DEPARTMENT"),did:m==null?void 0:m._id,bid:m==null?void 0:m.departmentSelectBatch,onSave:R,clsListId:E,setClsListId:S}):e.jsx(G,{onClose:d,children:e.jsxs("div",{className:P.modal_container,children:[e.jsx(y,{children:e.jsxs("div",{className:P.modal_container_outer_header,children:[e.jsx("div",{className:P.modal_container_header,children:e.jsx("h6",{children:c("create_new_fees")})}),e.jsx("img",{src:`${w}/close.svg`,alt:"close icon",onClick:()=>l("CLASSES")})]})}),e.jsx(A,{}),e.jsxs(y,{customStyle:{paddingTop:"0"},children:[e.jsx(q,{label:c("fees_name"),placeholder:c("fees_name_placeholder"),name:"feeName",value:g.feeName,type:"text",onChange:b,errorShow:N.feeName}),e.jsx(q,{label:c("amount"),placeholder:c("amount_placeholder"),name:"feeAmount",value:g.feeAmount,type:"text",onChange:b,errorShow:N.feeAmount}),e.jsx(Y,{label:"save",onAction:T})]}),C&&e.jsx(Z,{})]})})})},re="_exam_card_container_lx6x4_1",ie="_exam_inner_text_lx6x4_22",ce="_fees_image_lx6x4_43",U={exam_card_container:re,exam_inner_text:ie,fees_image:ce},W=({fees:t})=>e.jsxs("div",{className:U.exam_card_container,children:[e.jsx("img",{src:`${w}/fees-card.svg`,alt:"fees icon",className:U.fees_image}),e.jsxs("div",{className:U.exam_inner_text,children:[e.jsxs("h6",{children:["Rs. ",(t==null?void 0:t.feeAmount)??0,"/-"]}),e.jsxs("p",{children:[(t==null?void 0:t.feeName)??""," "]})]})]}),ge=({fid:t})=>{const{t:d}=B(),[c,f]=a.useState(""),[l,g]=a.useState(1),[p,N]=a.useState(!0),[F,C]=a.useState(!1),[v,m]=Q({skip:c}),{financeAllInternalFee:r,financeAllInternalFeeLoading:$}=ee({data:{fid:t,page:l,limit:10,search:c},skip:!t});a.useEffect(()=>{m&&p&&g(o=>o+1)},[m,p]),a.useEffect(()=>{r!=null&&r.length&&z(r==null?void 0:r.length,N)},[r==null?void 0:r.length]);const E=a.useCallback(O(o=>f(o),500),[]),S=o=>{E(o.target.value)},x=()=>{C(o=>!o)};return e.jsxs(e.Fragment,{children:[e.jsxs(se,{children:[e.jsx(y,{children:e.jsxs("div",{className:D.fm_header_container,children:[e.jsx("h6",{children:d("internal_fees")}),e.jsx("div",{className:D.fm_search,children:e.jsx("section",{className:D.fm_search_container,children:e.jsxs("div",{className:D.fm_search_container_inner,children:[e.jsx("img",{className:D.fm_search_icon,alt:"search icon",src:`${H}/navbar-search.svg`}),e.jsx("input",{type:"text",placeholder:d("search"),onChange:S})]})})})]})}),e.jsx(A,{}),e.jsxs(y,{customStyle:{paddingTop:"0"},children:[e.jsx(ne,{children:e.jsx(K,{label:"create_new_fees",onAction:x})}),$&&e.jsx(J,{}),r==null?void 0:r.map((o,b)=>(r==null?void 0:r.length)===b+1?e.jsx("div",{ref:v,children:e.jsx(W,{fees:o})},o==null?void 0:o._id):e.jsx(W,{fees:o},o==null?void 0:o._id))]})]}),F&&e.jsx(oe,{onClose:x,fid:t})]})};export{ge as default};
