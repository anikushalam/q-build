import{u as D,r as i,k as H,q as $,j as e,e as O}from"./index-0ca76035.js";import{s as c}from"./NewAnnouncement.module-4f17791a.js";/* empty css                         */import{q as T}from"./search-api-b192a53f.js";import{L as z}from"./LoaderButton-56f541f9.js";import{P as B,a as V}from"./PostFooterIcon-79c1540d.js";import"./Avatar-e65c49d9.js";import"./Avatar.module-fb7ee634.js";import"./FormToggle-18d319d7.js";import"./UniversalForm.module-19614663.js";import"./Switch-4bb87998.js";import"./SwitchBase-e3c2ff35.js";function se({setPostType:g,onPostTypeChange:o}){var R,I,A;const{t:l}=D(),[a,w]=i.useState(),[x,L]=i.useState([]),[h,U]=i.useState([]),[y,C]=i.useState(!1),[j,v]=i.useState(!1),[E,S]=i.useState(!1),u=i.useRef(""),f=i.useRef(""),p=i.useRef(""),[P]=T(),n=H(t=>t.idChange),{oneInstituteDashboard:r,oneInstituteDashboardRefetch:N}=$({id:n==null?void 0:n.id,skip:!(n!=null&&n.id)});i.useEffect(()=>{n!=null&&n.id&&N()},[n==null?void 0:n.id,N]),i.useEffect(()=>{if(a){const t=[],s=[];for(let d in a)for(let F in a[d])F==="type"&&(a[d][F].includes("image/")?t.push(URL.createObjectURL(a[d])):s.push({name:a[d].name}));L(t),U(s)}},[a]);const k=()=>{if(u.current.value!==""&&p.current.value!==""){v(!0),S(!1);const t=new FormData;t.append("insAnnTitle",u.current.value),t.append("insAnnDescription",f.current.value),t.append("insAnnVisibility",p.current.value);for(let s in a)a[s].size&&t.append("file",a[s]);P({id:n==null?void 0:n.id,announcement:t}).then(()=>{o("post"),u.current.value="",f.current.value="",p.current.value="",v(!1)}).catch({})}else S(!0)},q=t=>{w(t.target.files)},_=()=>{o("newPost"),g("text")},b=()=>{o("newPost"),g("image")},m=document.querySelector("textarea");return m==null||m.addEventListener("keyup",t=>{m.style.height="auto";let s=t.target.scrollHeight;m.style.height=`${s}px`}),e.jsx(e.Fragment,{children:e.jsxs(B,{postTitle:l("create_announcement"),onClose:()=>o("post"),dynamicImage:((R=r==null?void 0:r.institute)==null?void 0:R.photoId)!=="1"?`${O}/${(I=r==null?void 0:r.institute)==null?void 0:I.insProfilePhoto}`:"/images/ins_default_profile.svg",name:(A=r==null?void 0:r.institute)==null?void 0:A.insName,privateImage:y,setPrivateImage:C,postStatusRef:p,announcement:!0,children:[e.jsx("div",{className:c.postTitle,children:e.jsx("input",{className:c.input,type:"text",ref:u,required:!0,placeholder:l("title_announce")})}),e.jsx("div",{className:c.postDesc,children:e.jsx("textarea",{className:c.postTextarea,rows:"3",type:"text",required:!0,ref:f,name:"CreateInsPost",placeholder:l("description")})}),e.jsxs("div",{className:c.listContainer,children:[x.length>0&&e.jsx("div",{className:c.documentList,children:x.map((t,s)=>e.jsx("img",{src:t,alt:""},s))}),h.length>0&&e.jsx("div",{className:c.pdfList,children:h.map((t,s)=>e.jsxs("div",{className:c.pdfPreview,children:[e.jsx("img",{src:"/images/pdf-icon.png",alt:""},s),e.jsx("p",{children:t.name})]}))})]}),E&&e.jsx("div",{style:{color:"red"},children:l("please_add")}),e.jsxs("button",{className:c.btn,disabled:j,onClick:k,children:[e.jsx("p",{children:l("post")}),j&&e.jsx("div",{children:e.jsx(z,{})})]}),e.jsx(V,{onEditIocn:_,onPostTypeChange:o,activeIcon:4,addFileToggle:!0,onAddFile:q,acceptFormate:"image/gif, image/jpeg, image/png,  application/pdf, application/msword",children:e.jsx("div",{children:e.jsx("img",{src:"/images/img-post-icon.svg",onClick:b,alt:"file upload icon",title:"Create Image Post"})})})]})})}export{se as default};
