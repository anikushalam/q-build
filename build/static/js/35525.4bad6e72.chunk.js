"use strict";(self.webpackChunkmithkal_qviple=self.webpackChunkmithkal_qviple||[]).push([[35525],{35525:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var l=n(63687),i=n(56959),o=n(16871),a=n(43504),d=n(21348),s=n(90904),r=n(98967),c=n(63162),u=n(93638),v=n(72791),m=n(55336),_=n(6758),h=n(39230),f=n(23441),p=n(91427),x=n(98684),j=n(2651),y=n(1669),g=n(76697),b=n(97892),Z=n.n(b),S=n(82824),I=n(1095),C=n(56655),N=n(80184);const k=e=>{var t,n,l,i,d,s,r,c,u,m,_,f,p,j,y,b,k,O,F,w,R,A,T,L,q,P,D,M,Y,E,G,J,H,U,$,K,z;let{history:B,onRefetch:V,ofid:W}=e;const{t:Q}=(0,h.$G)(),X=(0,o.UO)(),ee=(0,o.TH)(),[te,ne]=(0,v.useState)("");return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:g.Z.sidebarheader,style:{gap:"1%"},title:"View Receipt",children:[(0,N.jsxs)("div",{className:g.Z.history_image_container,style:{width:"50%"},children:[null!==B&&void 0!==B&&null!==(t=B.payment_student)&&void 0!==t&&t.studentProfilePhoto?(0,N.jsx)(a.rU,{to:"/q/".concat(X.username,"/student/profile"),state:{...ee.state,sid:null===B||void 0===B||null===(n=B.payment_student)||void 0===n?void 0:n._id},children:(0,N.jsx)("img",{src:"".concat(I.yI,"/").concat(null===B||void 0===B||null===(l=B.payment_student)||void 0===l?void 0:l.studentProfilePhoto),alt:"qr code",style:{width:"60px",height:"60px",borderRadius:"12px"}})}):(0,N.jsx)("img",{src:"".concat(x.p3,"/feed-user-avatar.svg"),alt:"qr code",style:{width:"60px",height:"60px",borderRadius:"12px"}}),null!==B&&void 0!==B&&B.payment_student_detail?(0,N.jsxs)("div",{className:g.Z.text,children:[(0,N.jsx)("p",{className:g.Z.rcv,children:Q("recived_from")}),(0,N.jsx)("h6",{children:null!==(i=null===B||void 0===B||null===(d=B.fee_receipt)||void 0===d?void 0:d.student_name)&&void 0!==i?i:""}),(0,N.jsxs)("p",{className:g.Z.rcv,children:[Q("batch")," ",": ",null!==(s=null===B||void 0===B||null===(r=B.payment_student_detail)||void 0===r?void 0:r.batch)&&void 0!==s?s:"",","," ",Q("student_class"),": ",null===B||void 0===B||null===(c=B.payment_student_detail)||void 0===c?void 0:c.classes,", ",Q("roll_number")," ",": ",null!==(u=null===B||void 0===B||null===(m=B.payment_student_detail)||void 0===m?void 0:m.roll_no)&&void 0!==u?u:""]})]}):(0,N.jsxs)("div",{className:g.Z.text,children:[(0,N.jsx)("p",{className:g.Z.rcv,children:Q("recived_from")}),(0,N.jsx)("h6",{children:null!==B&&void 0!==B&&B.payment_student?"".concat(null!==(_=null===B||void 0===B||null===(f=B.payment_student)||void 0===f?void 0:f.studentFirstName)&&void 0!==_?_:""," ").concat(null!==(p=null===B||void 0===B||null===(j=B.payment_student)||void 0===j?void 0:j.studentMiddleName)&&void 0!==p?p:""," ").concat(null!==(y=null===B||void 0===B||null===(b=B.payment_student)||void 0===b?void 0:b.studentLastName)&&void 0!==y?y:""):null!==(k=null===B||void 0===B||null===(O=B.payment_by_end_user_id)||void 0===O?void 0:O.userLegalName)&&void 0!==k?k:null===B||void 0===B?void 0:B.payment_by_end_user_id_name}),(0,N.jsxs)("p",{className:g.Z.rcv,children:[Q("gr_number")," ",null!==(F=null===B||void 0===B||null===(w=B.payment_student)||void 0===w?void 0:w.studentGRNO)&&void 0!==F?F:""]}),(0,N.jsx)("p",{className:g.Z.rcv,children:null!==(R=null===B||void 0===B||null===(A=B.payment_student)||void 0===A||null===(T=A.fee_structure)||void 0===T?void 0:T.unique_structure_name)&&void 0!==R?R:""})]})]}),(0,N.jsxs)("div",{className:g.Z.text,style:{width:"27%"},children:[(0,N.jsx)("p",{className:g.Z.rcv,style:{width:"100%"},children:Q("transaction_id")}),(0,N.jsx)("h6",{style:{width:"100%",wordWrap:"break-word"},children:null!==B&&void 0!==B&&B.razorpay_payment_id?null===B||void 0===B?void 0:B.razorpay_payment_id:null!==B&&void 0!==B&&null!==(L=B.fee_receipt)&&void 0!==L&&L.fee_utr_reference?null===B||void 0===B||null===(q=B.fee_receipt)||void 0===q?void 0:q.fee_utr_reference:"N/A"}),(0,N.jsxs)("p",{className:g.Z.rcv,style:{width:"100%"},children:[Z()(null===B||void 0===B?void 0:B.created_at).format("DD MMM YYYY"),", ",(0,S.J)(null===B||void 0===B?void 0:B.created_at,"LT")]})]}),(0,N.jsxs)("div",{className:g.Z.text,style:{width:"20%"},children:[(0,N.jsxs)("p",{className:g.Z.rcv,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Q("invoice_no")," ",null!==(P=null!==(D=null===B||void 0===B||null===(M=B.fee_receipt)||void 0===M?void 0:M.invoice_count)&&void 0!==D?D:null===B||void 0===B?void 0:B.payment_invoice_number)&&void 0!==P?P:"N/A",null!==B&&void 0!==B&&null!==(Y=B.fee_receipt)&&void 0!==Y&&Y.receipt_file?(0,N.jsx)("a",{href:"".concat(I.q2,"/").concat(null===B||void 0===B||null===(E=B.fee_receipt)||void 0===E?void 0:E.receipt_file),target:"_blank",rel:"noopener noreferrer",children:(0,N.jsx)("img",{src:"".concat(x.J7,"/receipt.svg"),alt:"receipt icon",title:"Download Fees Receipt"})}):null]}),(0,N.jsxs)("h6",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Q("rs_only")," ",null===B||void 0===B?void 0:B.payment_amount,(0,N.jsx)("img",{src:"".concat(x.J7,"/menu.svg"),alt:"receipt icon",title:"Download Fees Receipt",onClick:e=>{e.stopPropagation(),ne(1)}})]}),(0,N.jsx)("p",{className:g.Z.rcv,style:{width:"100%"},children:"offline"===(null===(G=B.payment_mode)||void 0===G?void 0:G.toLowerCase())?null!==B&&void 0!==B&&null!==(J=B.fee_receipt)&&void 0!==J&&J.fee_payment_mode?"".concat(null===B||void 0===B||null===(H=B.fee_receipt)||void 0===H?void 0:H.fee_payment_mode):"Offline - No Receipt":"online"===(null===(U=B.payment_mode)||void 0===U?void 0:U.toLowerCase())?null!==B&&void 0!==B&&null!==($=B.fee_receipt)&&void 0!==$&&$.fee_payment_mode?"".concat(null===B||void 0===B||null===(K=B.fee_receipt)||void 0===K?void 0:K.fee_payment_mode):"Online - No Receipt":null===B||void 0===B?void 0:B.payment_mode})]})]}),1===te?(0,N.jsx)(C.Z,{onClose:()=>ne(""),frid:null===B||void 0===B||null===(z=B.fee_receipt)||void 0===z?void 0:z._id,onRefetch:V,ofid:W}):null]})},O=e=>{var t,n,l,o;let{instituteId:a,ofid:r}=e;const{t:c}=(0,h.$G)(),[u,g]=(0,v.useState)(""),[b,Z]=(0,v.useState)(""),[S,I]=(0,v.useState)(1),[C,O]=(0,v.useState)(!0),[F,w]=(0,f.YD)({skip:u}),{financeOtherOneFeesTransaction:R,financeOtherOneFeesTransactionLoading:A,financeOtherOneFeesTransactionRefetch:T}=(0,_.ok)({data:{uid:a,page:S,limit:10,search:u,filter:"",ofid:r},skip:a?!r:!a});(0,v.useEffect)((()=>{w&&C&&I((e=>e+1))}),[w,C]),(0,v.useEffect)((()=>{var e;if(null!==R&&void 0!==R&&null!==(e=R.list)&&void 0!==e&&e.length){var t;let e=(0,p.f)(null===R||void 0===R||null===(t=R.list)||void 0===t?void 0:t.length);O((()=>e))}}),[null===R||void 0===R||null===(t=R.list)||void 0===t?void 0:t.length]);const L=()=>{I((e=>1)),T()};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(d.default,{children:(0,N.jsx)("div",{className:i.Z.fm_search_full,children:(0,N.jsx)("section",{className:i.Z.fm_search_full_container,children:(0,N.jsxs)("div",{className:i.Z.fm_search_full_container_inner,children:[(0,N.jsx)("img",{className:i.Z.fm_search_full_icon,alt:"search icon",src:"".concat(x.dB,"/navbar-search.svg")}),(0,N.jsx)("input",{type:"text",placeholder:c("search"),onChange:e=>{var t;!A&&(null===R||void 0===R||null===(t=R.list)||void 0===t?void 0:t.length)>=0&&Z(e.target.value)},onKeyUp:e=>{"Enter"===e.key&&(I((()=>1)),g(b))},value:b})]})})})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[null===R||void 0===R||null===(n=R.list)||void 0===n?void 0:n.map(((e,t)=>{var n;return(null===R||void 0===R||null===(n=R.list)||void 0===n?void 0:n.length)===t+1?(0,N.jsx)("div",{ref:F,children:(0,N.jsx)(k,{history:e,onRefetch:L,ofid:r})},null===e||void 0===e?void 0:e._id):(0,N.jsx)(k,{history:e,onRefetch:L,ofid:r},null===e||void 0===e?void 0:e._id)})),A?u?(0,N.jsx)(m.default,{}):(0,N.jsx)(y.Z,{}):u?0===(null===R||void 0===R||null===(l=R.list)||void 0===l?void 0:l.length)&&(0,N.jsx)(j.Z,{title:"No receipts found related this search.",customStyleContainer:{marginTop:"1.5rem"}}):0===(null===R||void 0===R||null===(o=R.list)||void 0===o?void 0:o.length)&&(0,N.jsx)(j.Z,{title:"No receipts added.",customStyleContainer:{marginTop:"1.5rem"}})]})]})};var F=n(27976),w=n(13182),R=n(43172),A=n(73711),T=n(85794),L=n(9228),q=n(38857),P=n(16925),D=n(61055),M=n(60924),Y=n(43997),E=n(50518),G=n(99183),J=n(60307),H=n(71439),U=n(64499);const $=e=>{var t;let{onClose:n,financeId:l,onRefetch:i,otherFeesId:a,student:r,instituteId:c,isNonExisting:f,collectStaffId:p,cardId:j,cardAmount:y}=e;const{t:g}=(0,h.$G)(),[b,S]=(0,v.useState)(!1),I=(0,o.UO)(),[C,k]=(0,v.useState)({amount:"",mode:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:Z()().format("DD/MM/YYYY"),fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:""}),[O,F]=(0,v.useState)(""),[w,R]=(0,v.useState)({open:!1,msg:"",variant:"error"}),[A,L]=(0,v.useState)({amount:0,type:"Other",isTransaction:!1}),{studentInstituteCharges:$}=(0,J.xY)({data:{id:c},skip:!c}),[K]=(0,_.iJ)();(0,v.useEffect)((()=>{y&&(k((e=>({...e,amount:+y,fee_payment_amount:+y}))),L({amount:+y,type:"Other",isTransaction:!1}))}),[r]);const z=e=>{k((t=>({...t,[e.target.name]:e.target.value})))};return(0,N.jsxs)(N.Fragment,{children:[A.isTransaction?(0,N.jsx)(H.Z,{onClose:n,allContent:{...A,platform_charges:null===$||void 0===$||null===(t=$.platform_charges)||void 0===t?void 0:t.percentage},checkoutAdmissionHandler:()=>{var e,t,n,l,i,o,d,s,u,v,m;let _=2.1*+(null===A||void 0===A?void 0:A.amount)/100,h=_+18*+_/100;const f=parseInt(null===A||void 0===A?void 0:A.amount);var p=Math.ceil(f+ +h.toFixed(2));(0,U.oU)({amount:null!==(e=+(null===C||void 0===C?void 0:C.amount))&&void 0!==e?e:10,amount_nocharges:null!==(t=+p)&&void 0!==t?t:0,type:"Other",paidBy:null===r||void 0===r?void 0:r._id,paidTo:c,moduleId:a,ad_status_id:null,payment_installment:null,ad_install:null,month:null,payment_remain_1:null,payment_card_type:null,payment_book_id:null,name:I.username,isApk:"web",payment_card_id:null,payment_remain_fees:null,charge:{num_platform_percent:null!==(n=null===$||void 0===$||null===(l=$.platform_charges)||void 0===l?void 0:l.percentage)&&void 0!==n?n:0,num_platform_max:null!==(i=null===$||void 0===$||null===(o=$.platform_charges)||void 0===o?void 0:o.maximum)&&void 0!==i?i:0,num_trans_pecent:null!==(d=null===$||void 0===$||null===(s=$.transaction_charges)||void 0===s?void 0:s.percentage)&&void 0!==d?d:0,num_trans_max:null!==(u=null===$||void 0===$||null===(v=$.transaction_charges)||void 0===v?void 0:v.maximum)&&void 0!==u?u:0,num_app_max:null!==(m=null===$||void 0===$?void 0:$.application_charges)&&void 0!==m?m:0},nsid:null}).then((e=>{var t,n;window.onScriptLoad(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.body)||void 0===n?void 0:n.txnToken,null===e||void 0===e?void 0:e.order,null===e||void 0===e?void 0:e.amount)})).catch((e=>{console.info(e)}))},isOptimzed:!0}):(0,N.jsx)(q.Z,{onClose:n,children:(0,N.jsxs)("div",{className:P.Z.modal_container,children:[(0,N.jsx)(d.default,{children:(0,N.jsxs)("div",{className:P.Z.modal_container_outer_header,children:[(0,N.jsx)("div",{className:P.Z.modal_container_header,children:(0,N.jsx)("h6",{children:g("collect_fees")})}),(0,N.jsx)("img",{src:"".concat(x.J7,"/close.svg"),alt:"close icon",onClick:n})]})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[(0,N.jsxs)("div",{className:P.Z.admission_fees_row,children:[(0,N.jsxs)("h6",{children:[g("applicable_amount")," :"]}),(0,N.jsxs)("h6",{children:[g("rs_only")," ",null!==y&&void 0!==y?y:0]})]}),(0,N.jsx)(D.Z,{label:g("amount"),placeholder:g("amoute_details_collect"),name:"amount",value:C.amount,type:"tel",onChange:e=>{k((t=>({...t,amount:+e.target.value,fee_payment_amount:+e.target.value}))),L((t=>({...t,amount:+e.target.value})))},errorShow:O.amount,msg:O.rest_issue}),(0,N.jsx)(E.Z,{paymentHeading:g("payment_type_mode"),selectLabel:g("mode_placeholder"),onClick:e=>{k((t=>({...t,mode:"Online",fee_payment_mode:e})))},errorShow:O.fee_payment_mode,defalutValue:C.fee_payment_mode,selectedValue:g("please_select_payment_mode"),isAuthority:f?"admissionCollectMode":"admissionCollectModePg",customLabelStyle:{marginTop:"0"}}),"Payment Gateway"===C.fee_payment_mode?(0,N.jsx)(u.Z,{label:"collect",onAction:()=>{let e=(0,G.l)({amount:A.amount});(0,G.x)(e)?null!==$&&void 0!==$&&$.institute?l&&a&&null!==r&&void 0!==r&&r._id&&!f&&L((e=>({...e,isTransaction:!0}))):R({open:!0,msg:"Online Payment Not Activated",variant:"error"}):F(e)}}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(M.Z,{label:g("select_date_of_transaction"),placeholder:g("please_select_date"),name:"transaction_date",value:C.transaction_date,onChange:e=>{k((t=>({...t,transaction_date:(0,Y.jh)(e)})))},errorShow:O.transaction_date}),"Cash"===C.fee_payment_mode?null:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(D.Z,{label:g("bank_name_collect"),placeholder:g("please_enter_bank_name"),name:"fee_bank_name",value:C.fee_bank_name,type:"text",onChange:z}),(0,N.jsx)(D.Z,{label:g("banke_holder_name"),placeholder:g("please_enter_name_of_bank_holder"),name:"fee_bank_holder",value:C.fee_bank_holder,type:"text",onChange:z}),(0,N.jsx)(D.Z,{label:g("cheque_dd_neft"),placeholder:g("please_enter_utr_ref_number"),name:"fee_utr_reference",value:C.fee_utr_reference,type:"text",onChange:z})]}),(0,N.jsx)(u.Z,{label:"collect",onAction:()=>{let e=(0,G.l)(C,["mode","fee_payment_amount","fee_bank_name","fee_bank_holder","fee_utr_reference"]);var t,o,d,s,c,u,v;(0,G.x)(e)&&null!==r&&void 0!==r&&r._id&&a?(S((e=>!e)),K({fid:l,bodyParameter:{ofid:a,sid:null===r||void 0===r?void 0:r._id,amount:null!==(t=null===C||void 0===C?void 0:C.amount)&&void 0!==t?t:0,mode:"Cash"===(null===C||void 0===C?void 0:C.fee_payment_mode)?"Offline":null!==(o=null===C||void 0===C?void 0:C.mode)&&void 0!==o?o:"",fee_payment_mode:"Cash"===(null===C||void 0===C?void 0:C.fee_payment_mode)?"By Cash":null===C||void 0===C?void 0:C.fee_payment_mode,fee_payment_amount:null!==(d=null===C||void 0===C?void 0:C.fee_payment_amount)&&void 0!==d?d:0,transaction_date:null!==(s=(0,Y._1)(C.transaction_date))&&void 0!==s?s:"",fee_bank_name:null!==(c=null===C||void 0===C?void 0:C.fee_bank_name)&&void 0!==c?c:"",fee_bank_holder:null!==(u=null===C||void 0===C?void 0:C.fee_bank_holder)&&void 0!==u?u:"",fee_utr_reference:null!==(v=null===C||void 0===C?void 0:C.fee_utr_reference)&&void 0!==v?v:"",staff_id:null!==p&&void 0!==p?p:"",cid:null!==j&&void 0!==j?j:""}}).then((()=>{i(),S((e=>!e)),n()})).catch({})):F(e)}})]})]})]})}),b&&(0,N.jsx)(m.default,{}),(0,N.jsx)(T.Z,{eventState:w,eventStateHandler:R})]})};var K=n(89064);const z=e=>{let{ofid:t,onClose:n,menuData:l,onRefetch:i,feeReceiptId:o,isFee:a}=e;const{t:r}=(0,h.$G)(),[c,m]=(0,v.useState)(!1),[f,p]=(0,v.useState)({open:!1,msg:"",variant:"error"}),[j,y]=(0,v.useState)(""),[g,b]=(0,v.useState)({query:""}),[Z,S]=(0,v.useState)(!1),[I]=(0,_.M0)(),[C]=(0,_.dM)();return(0,N.jsxs)(N.Fragment,{children:[Z?(0,N.jsx)(q.Z,{onClose:()=>S(!1),children:(0,N.jsxs)("div",{className:P.Z.modal_container,children:[(0,N.jsx)(d.default,{children:(0,N.jsxs)("div",{className:P.Z.modal_container_outer_header,children:[(0,N.jsx)("div",{className:P.Z.modal_container_header,children:(0,N.jsx)("h6",{children:r("are_your_sure_to_delete_fee_receipt")})}),(0,N.jsx)("img",{src:"".concat(x.J7,"/close.svg"),alt:"close icon",onClick:()=>S(!1)})]})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[(0,N.jsx)(D.Z,{label:r("type_confirm_to_continue"),placeholder:r("type_confirm_to_continue"),name:"query",value:g.query,type:"text",onChange:e=>{b((t=>({...t,[e.target.name]:e.target.value})))},errorShow:j.query}),(0,N.jsx)(u.Z,{label:"confirm",onAction:()=>{let e=(0,G.l)(g);(0,G.x)(e)?"Confirm"===g.query&&o&&t&&(S(!1),m((e=>!e)),C({fid:o,ofid:t}).then((e=>{i(),m((e=>!e)),n()})).catch({})):y(e)}})]})]})}):(0,N.jsx)(K.Z,{onClose:n,disabled:c,children:a?(0,N.jsx)("h6",{onClick:()=>S(!0),children:r("delete")}):(0,N.jsx)("h6",{onClick:()=>{null!==l&&void 0!==l&&l._id&&t&&(m((e=>!e)),I({ofid:t,bodyParameter:{students:[null===l||void 0===l?void 0:l._id]}}).then((e=>{p({open:!0,msg:"Time out of request...",variant:"error"}),i(),m((e=>!e)),n()})).catch({}))},children:r("remove")})}),(0,N.jsx)(T.Z,{eventState:f,eventStateHandler:p})]})},B=e=>{var t,n,l,i,o,a,d,s;let{student:r,financeId:c,onRefetch:m,otherFeesId:_,instituteId:f,ofid:p,isCashierAccess:j,collectStaffId:y,cardId:g,cardAmount:b}=e;const{t:Z}=(0,h.$G)(),[S,C]=(0,v.useState)(""),[k,O]=(0,v.useState)({open:!1,msg:"",variant:"error"}),F=()=>{C("")};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:L.Z.iadcc_card_hover,children:[(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner,children:[(0,N.jsx)("img",{src:null!==r&&void 0!==r&&r.studentProfilePhoto?"".concat(I.yI,"/").concat(r.studentProfilePhoto):"".concat(x.p3,"/feed-user-avatar.svg"),loading:"lazy",alt:"avatar",style:{width:"2.5rem",height:"2.5rem"}}),(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner_inner,children:[(0,N.jsx)("h6",{children:"".concat(null!==(t=null===r||void 0===r?void 0:r.studentFirstName)&&void 0!==t?t:""," ").concat(null!==(n=null===r||void 0===r?void 0:r.studentMiddleName)&&void 0!==n?n:""," ").concat(null!==(l=null===r||void 0===r?void 0:r.studentLastName)&&void 0!==l?l:"")}),(0,N.jsxs)("p",{children:[Z("gr_number")," ",": ",null!==(i=null===r||void 0===r?void 0:r.studentGRNO)&&void 0!==i?i:""]})]})]}),"Paid"===(null===r||void 0===r||null===(o=r.other_fees_obj)||void 0===o?void 0:o.status)?(0,N.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner_inner,children:[(0,N.jsxs)("h6",{children:["Rs. ",null!==b&&void 0!==b?b:0]}),(0,N.jsx)("p",{children:Z("amount")})]}),(0,N.jsx)("div",{className:L.Z.sf_card_contatiner_inner,children:null!==r&&void 0!==r&&null!==(a=r.other_fees_obj)&&void 0!==a&&a.receipt_file?(0,N.jsx)("a",{href:"".concat(I.q2,"/").concat(null===r||void 0===r||null===(d=r.other_fees_obj)||void 0===d?void 0:d.receipt_file),target:"_blank",rel:"noopener noreferrer",children:(0,N.jsx)("img",{src:"".concat(x.J7,"/receipt.svg"),alt:"receipt icon",style:{height:"1.5rem"}})}):null}),(0,N.jsx)("img",{src:"".concat(x.J7,"/menu.svg"),alt:"menu icon",onClick:()=>C(3)})]}):(0,N.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner_inner,children:[(0,N.jsxs)("h6",{children:["Rs. ",null!==b&&void 0!==b?b:0]}),(0,N.jsx)("p",{children:Z("amount")})]}),(0,N.jsx)(u.Z,{label:"collect_fees",onAction:()=>{"ALLOW"===j?C(1):O({msg:"You are not Cashier Manager",open:!0,variant:"error"})},customStyle:{margin:"0",padding:"0.4rem 1rem"}}),(0,N.jsx)("img",{src:"".concat(x.J7,"/menu.svg"),alt:"menu icon",onClick:e=>{C(2)}})]})]}),1===S?(0,N.jsx)($,{financeId:c,onClose:F,onRefetch:m,student:r,otherFeesId:_,instituteId:f,collectStaffId:y,cardId:g,cardAmount:b}):2===S?(0,N.jsx)(z,{onClose:F,onRefetch:m,menuData:r,ofid:p}):3===S?(0,N.jsx)(z,{onClose:F,onRefetch:m,menuData:r,ofid:p,feeReceiptId:null===r||void 0===r||null===(s=r.other_fees_obj)||void 0===s?void 0:s.fee_receipt,isFee:!0}):null,(0,N.jsx)(T.Z,{eventState:k,eventStateHandler:O})]})},V=e=>{var t,n,l,o;let{ofid:a,instituteId:r,financeId:c,isCashierAccess:u,collectStaffId:g}=e;const{t:b}=(0,h.$G)(),[Z,S]=(0,v.useState)(""),[I,C]=(0,v.useState)(""),[k,O]=(0,v.useState)(1),[F,w]=(0,v.useState)(!0),[R,A]=(0,f.YD)({skip:Z}),{financeOneOtherFeesStudentList:T,financeOneOtherFeesStudentListLoading:L,financeOneOtherFeesStudentListRefetch:q}=(0,_.Jo)({data:{ofid:a,page:k,limit:10,search:Z,type:""},skip:!a});(0,v.useEffect)((()=>{A&&F&&O((e=>e+1))}),[A,F]),(0,v.useEffect)((()=>{var e;if(null!==T&&void 0!==T&&null!==(e=T.list)&&void 0!==e&&e.length){var t;let e=(0,p.f)(null===T||void 0===T||null===(t=T.list)||void 0===t?void 0:t.length);w((()=>e))}}),[null===T||void 0===T||null===(t=T.list)||void 0===t?void 0:t.length]);const P=(0,v.useCallback)((()=>{O((()=>1)),q()}),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(d.default,{children:(0,N.jsx)("div",{className:i.Z.fm_search_full,children:(0,N.jsx)("section",{className:i.Z.fm_search_full_container,children:(0,N.jsxs)("div",{className:i.Z.fm_search_full_container_inner,children:[(0,N.jsx)("img",{className:i.Z.fm_search_full_icon,alt:"search icon",src:"".concat(x.dB,"/navbar-search.svg")}),(0,N.jsx)("input",{type:"text",placeholder:b("search"),onChange:e=>{var t;!L&&(null===T||void 0===T||null===(t=T.list)||void 0===t?void 0:t.length)>=0&&C(e.target.value)},onKeyUp:e=>{"Enter"===e.key&&(O((()=>1)),S(I))},value:I})]})})})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[null===T||void 0===T||null===(n=T.list)||void 0===n?void 0:n.map(((e,t)=>{var n,l,i;return(null===T||void 0===T||null===(n=T.list)||void 0===n?void 0:n.length)===t+1?(0,N.jsx)("div",{ref:R,children:(0,N.jsx)(B,{student:null===e||void 0===e?void 0:e.student,financeId:c,instituteId:r,otherFeesId:a,onRefetch:P,ofid:a,isCashierAccess:u,collectStaffId:g,cardId:null===e||void 0===e?void 0:e._id,cardAmount:null!==(l=null===e||void 0===e?void 0:e.price)&&void 0!==l?l:0})},"".concat(null===e||void 0===e?void 0:e._id).concat(t)):(0,N.jsx)(B,{student:null===e||void 0===e?void 0:e.student,financeId:c,instituteId:r,otherFeesId:a,onRefetch:P,ofid:a,isCashierAccess:u,collectStaffId:g,cardId:null===e||void 0===e?void 0:e._id,cardAmount:null!==(i=null===e||void 0===e?void 0:e.price)&&void 0!==i?i:0},"".concat(null===e||void 0===e?void 0:e._id).concat(t))})),L?Z?(0,N.jsx)(m.default,{}):(0,N.jsx)(y.Z,{}):Z?0===(null===T||void 0===T||null===(l=T.list)||void 0===l?void 0:l.length)&&(0,N.jsx)(j.Z,{title:"No receipts found related this search.",customStyleContainer:{marginTop:"1.5rem"}}):0===(null===T||void 0===T||null===(o=T.list)||void 0===o?void 0:o.length)&&(0,N.jsx)(j.Z,{title:"No receipts added.",customStyleContainer:{marginTop:"1.5rem"}})]})]})},W=e=>{var t,n,f,p,j,y,g,b,Z,S,I,C,k,L,q,P,D,M,Y,E;let{fid:G,instituteId:J,cashAuthority:H}=e;const{t:U}=(0,h.$G)(),$=(0,o.TH)(),K=(0,o.UO)(),z=(0,o.s0)(),[B]=(0,a.lr)(),[W,X]=(0,v.useState)(!1),[ee,te]=(0,v.useState)(""),[ne,le]=(0,v.useState)(null),[ie,oe]=(0,v.useState)([]),[ae,de]=(0,v.useState)({open:!1,msg:"",variant:"error"}),[se]=(0,_.P_)(),[re]=(0,_.UG)(),[ce]=(0,_.YC)(),[ue]=(0,_.zY)(),{financeOneOtherFeesStudentList:ve,financeOneOtherFeesStudentListRefetch:me}=(0,_.Jo)({data:{ofid:null===(t=$.state)||void 0===t?void 0:t.feesId,page:1,limit:10,search:"",type:""},skip:!(null!==(n=$.state)&&void 0!==n&&n.feesId)}),{financeOtherOneFeesTransaction:_e,financeOtherOneFeesTransactionRefetch:he}=(0,_.ok)({data:{uid:J,page:1,limit:10,search:"",filter:"",ofid:null===(f=$.state)||void 0===f?void 0:f.feesId},skip:J?!(null!==(p=$.state)&&void 0!==p&&p.feesId):!J}),fe=()=>{te("")},pe=(0,v.useCallback)((()=>{var e;let t="";t="Institute"===(null===(e=$.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(K.username,"/institute/member/finance?type=other-fees"):"/q/".concat(K.username,"/member/staff/finance?type=other-fees"),z(t,{state:$.state})}),[z,$.state,K.username]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(l.default,{children:[(0,N.jsx)(d.default,{children:(0,N.jsxs)("div",{className:i.Z.fm_header_container,children:[(0,N.jsxs)("div",{className:i.Z.fm_header_start_container,style:{gap:"0.2rem"},children:[(0,N.jsx)("img",{alt:"search icon",src:"".concat(x.Fk,"/back.svg"),style:{height:"2rem",width:"2rem"},onClick:pe}),(0,N.jsxs)("h6",{children:[null!==(j=null===(y=$.state)||void 0===y?void 0:y.feesName)&&void 0!==j?j:""," ","(",(0,N.jsx)("span",{style:{color:"#00f"},children:null===(g=$.state)||void 0===g||null===(b=g.otherData)||void 0===b?void 0:b.paid}),"/",null===(Z=$.state)||void 0===Z||null===(S=Z.otherData)||void 0===S?void 0:S.rmaining,")"]})]}),(0,N.jsxs)("div",{className:i.Z.fm_header_start_container,children:[(0,N.jsx)(u.Z,{label:"add_single_student",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{var e;null!==H&&void 0!==H&&H.includes(null===$||void 0===$||null===(e=$.state)||void 0===e?void 0:e.sid)?te(4):de({msg:"You are not Cashier Manager",open:!0,variant:"error"})}}),(0,N.jsx)(u.Z,{label:"add_student",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{te(3)}}),(0,N.jsx)(u.Z,{label:"add_non_existing_student",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{var e;null!==H&&void 0!==H&&H.includes(null===$||void 0===$||null===(e=$.state)||void 0===e?void 0:e.sid)?te(1):de({msg:"You are not Cashier Manager",open:!0,variant:"error"})}}),(0,N.jsx)(u.Z,{label:"export",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{var e,t;null!==(e=$.state)&&void 0!==e&&e.feesId&&(X((e=>!e)),se({ofid:null===(t=$.state)||void 0===t?void 0:t.feesId}).then((()=>{var e;let t="Institute"===(null===(e=$.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(K.username,"/institute/member/finance?type=export"):"/q/".concat(K.username,"/member/staff/finance?type=export");z(t,{state:$.state})})).catch({}))}})]})]})}),(0,N.jsx)(s.Z,{}),(0,N.jsx)(r.Z,{children:Q.map((e=>{var t,n;return(0,N.jsx)(c.Z,{tab:e,isLink:!0,isActive:null===(t=e.groupIs)||void 0===t?void 0:t.includes(B.get("n")),parentState:$.state,url:"Institute"===(null===(n=$.state)||void 0===n?void 0:n.urlOffSet)?"/q/".concat(K.username,"/institute/member/finance?type=other-fees-detail").concat(e.urlKey):"/q/".concat(K.username,"/member/staff/finance?type=other-fees-detail").concat(e.urlKey)},null===e||void 0===e?void 0:e.id)}))}),(0,N.jsx)(s.Z,{customStyleBorder:{marginTop:"0"}}),"receipt"===B.get("n")?(0,N.jsx)(V,{ofid:null===(I=$.state)||void 0===I?void 0:I.feesId,instituteId:J,financeId:G,isCashierAccess:null!==H&&void 0!==H&&H.includes(null===$||void 0===$||null===(C=$.state)||void 0===C?void 0:C.sid)?"ALLOW":"DENY",collectStaffId:null===$||void 0===$||null===(k=$.state)||void 0===k?void 0:k.sid}):(0,N.jsx)(O,{ofid:null===(L=$.state)||void 0===L?void 0:L.feesId,instituteId:J})]}),W&&(0,N.jsx)(m.default,{}),1===ee?(0,N.jsx)(F.Z,{onClose:fe,singleStudent:ne,onNext:e=>{le(e),te(2)}}):2===ee?(0,N.jsx)(w.Z,{onClose:()=>te(1),onParentClose:()=>{},instituteId:J,onGrabCollectFees:e=>{var t,n,l,i;G&&null!==ne&&void 0!==ne&&ne.student_name&&null!==(t=$.state)&&void 0!==t&&t.feesId&&(X((e=>!e)),re({fid:G,bodyParameter:{...ne,ofid:null===(n=$.state)||void 0===n?void 0:n.feesId,...e,staff_id:null!==(l=null===$||void 0===$||null===(i=$.state)||void 0===i?void 0:i.sid)&&void 0!==l?l:""}}).then((()=>{le(null),X((e=>!e)),fe()})).catch({}))},singleStudent:ne,isOtherFees:"OTHER_FEES",isNonExisting:!0,applicant:{head:null===(q=$.state)||void 0===q||null===(P=q.otherData)||void 0===P?void 0:P.payable_amount}}):3===ee?(0,N.jsx)(R.Z,{title:U("select_student"),onClose:fe,instituteId:J,isMultiSelect:!0,onMultiSelect:e=>{null!==ie&&void 0!==ie&&ie.includes(null===e||void 0===e?void 0:e._id)?oe((t=>null===t||void 0===t?void 0:t.filter((t=>t!==(null===e||void 0===e?void 0:e._id))))):oe((t=>[...t,null===e||void 0===e?void 0:e._id]))},onDone:()=>{var e,t;G&&(null===ie||void 0===ie?void 0:ie.length)>0&&null!==(e=$.state)&&void 0!==e&&e.feesId&&(X((e=>!e)),ce({fid:G,bodyParameter:{students:ie,ofid:null===(t=$.state)||void 0===t?void 0:t.feesId}}).then((()=>{me(),X((e=>!e)),fe(),oe([]),le(null)})).catch({}))},selectList:ie,buttonTitle:"add",isSearchOnly:!0}):4===ee?(0,N.jsx)(R.Z,{title:U("select_student"),onClose:fe,instituteId:J,onSelectStudent:e=>{le(e),te(5)},selectedId:null===ne||void 0===ne?void 0:ne._id,isSearchOnly:!0}):5===ee?(0,N.jsx)(w.Z,{onClose:fe,onParentClose:()=>{},instituteId:J,onGrabCollectFees:e=>{var t,n,l,i;G&&null!==ne&&void 0!==ne&&ne._id&&null!==(t=$.state)&&void 0!==t&&t.feesId&&(X((e=>!e)),ue({fid:G,bodyParameter:{students:[null===ne||void 0===ne?void 0:ne._id],ofid:null===(n=$.state)||void 0===n?void 0:n.feesId,...e,staff_id:null!==(l=null===$||void 0===$||null===(i=$.state)||void 0===i?void 0:i.sid)&&void 0!==l?l:""}}).then((e=>{te(6),X((e=>!e))})).catch({}))},singleStudent:ne,isOtherFees:"OTHER_FEES",applicant:{head:null===(D=$.state)||void 0===D||null===(M=D.otherData)||void 0===M?void 0:M.payable_amount},ofid:null===(Y=$.state)||void 0===Y?void 0:Y.feesId,financeId:G}):6===ee?(0,N.jsx)(A.Z,{applicant:ne,onClose:()=>{le(null),fe()},ofid:null===(E=$.state)||void 0===E?void 0:E.feesId}):null,(0,N.jsx)(T.Z,{eventState:ae,eventStateHandler:de})]})},Q=[{label:"transaction",id:"transaction",urlKey:"",groupIs:["",null]},{label:"receipt",id:"receipt",urlKey:"&n=receipt",groupIs:["receipt"]}]}}]);
//# sourceMappingURL=35525.4bad6e72.chunk.js.map