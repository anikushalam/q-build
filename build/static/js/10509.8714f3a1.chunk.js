(self.webpackChunkmithkal_qviple=self.webpackChunkmithkal_qviple||[]).push([[10509],{10509:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>E});var i=n(63687),l=n(39230),s=n(56959),d=n(90904),o=n(21348),a=n(98684),r=n(72791),c=n(43504),u=n(16871),v=n(98967),_=n(63162),f=n(23441),m=n(91427),h=n(43317),p=n(55336),x=n(1669),j=n(2651),y=n(3773),g=n(1095),N=n(80184);const Z=e=>{var t,n,i,s,d,o,r,c,v,_,f,m,h;let{history:p}=e;const{t:x}=(0,l.$G)(),j=(0,u.UO)(),Z=(0,u.s0)();return(0,N.jsxs)("div",{className:y.Z.pending_fees_card,onClick:()=>{var e;Z("/q/".concat(j.username,"/member/student/admission/profile"),{state:{sid:null===p||void 0===p||null===(e=p.student)||void 0===e?void 0:e._id,viewAs:"ADMISSION_ADMIN",collectAccess:"ADMISSION_ADMIN"}})},title:"Refund student fees",children:[(0,N.jsxs)("div",{className:y.Z.pending_fees_card_container,children:[(0,N.jsx)("img",{alt:"Student Avatar",src:null!==p&&void 0!==p&&null!==(t=p.student)&&void 0!==t&&t.studentProfilePhoto?"".concat(g.yI,"/").concat(null===p||void 0===p||null===(n=p.student)||void 0===n?void 0:n.studentProfilePhoto):"".concat(a.p3,"/feed-user-avatar.svg"),loading:"lazy"}),(0,N.jsxs)("div",{className:y.Z.pending_fees_card_inner,children:[(0,N.jsx)("h6",{children:"".concat(null===p||void 0===p||null===(i=p.student)||void 0===i?void 0:i.studentFirstName," ").concat(null!==p&&void 0!==p&&null!==(s=p.student)&&void 0!==s&&s.studentMiddleName?null===p||void 0===p||null===(d=p.student)||void 0===d?void 0:d.studentMiddleName:""," ").concat(null===p||void 0===p||null===(o=p.student)||void 0===o?void 0:o.studentLastName)}),(0,N.jsxs)("p",{children:[x("gr_number")," : ",null!==(r=null===p||void 0===p||null===(c=p.student)||void 0===c?void 0:c.studentGRNO)&&void 0!==r?r:"",null!==p&&void 0!==p&&null!==(v=p.student)&&void 0!==v&&null!==(_=v.department)&&void 0!==_&&_.dName?", ".concat(null===p||void 0===p||null===(f=p.student)||void 0===f||null===(m=f.department)||void 0===m?void 0:m.dName):""]})]})]}),(0,N.jsxs)("div",{className:y.Z.pending_fees_card_inner,children:[(0,N.jsxs)("h6",{children:[x("rs_only")," ",null!==(h=null===p||void 0===p?void 0:p.refund)&&void 0!==h?h:0]}),(0,N.jsx)("p",{children:x("excess_fees")})]})]})},M=e=>{var t,n,i;let{aid:d,totalRefund:o}=e;const{t:c}=(0,l.$G)(),[u,v]=(0,r.useState)(""),[_,y]=(0,r.useState)(""),[g,M]=(0,r.useState)(1),[S,L]=(0,r.useState)(!0),[Y,w]=(0,f.YD)({skip:u}),{admissionExcessFeeNotRefundedList:b,admissionExcessFeeNotRefundedListLoading:R}=(0,h.ye)({data:{aid:d,page:g,limit:10,search:u},skip:!d});(0,r.useEffect)((()=>{w&&S&&M((e=>e+1))}),[w,S]),(0,r.useEffect)((()=>{var e;if(null!==b&&void 0!==b&&null!==(e=b.list)&&void 0!==e&&e.length){var t;let e=(0,m.f)(null===b||void 0===b||null===(t=b.list)||void 0===t?void 0:t.length);L((()=>e))}}),[null===b||void 0===b?void 0:b.list]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:s.Z.fm_header_container,children:[(0,N.jsxs)("h6",{children:[c("total_refund_amount")," "," : "," ",c("rs_only")," ",null!==o&&void 0!==o?o:0]}),(0,N.jsx)("div",{className:s.Z.fm_search,children:(0,N.jsx)("section",{className:s.Z.fm_search_container,children:(0,N.jsxs)("div",{className:s.Z.fm_search_container_inner,children:[(0,N.jsx)("img",{className:s.Z.fm_search_icon,alt:"search icon",src:"".concat(a.dB,"/navbar-search.svg")}),(0,N.jsx)("input",{type:"text",placeholder:c("search"),onChange:e=>{var t;!R&&(null===b||void 0===b||null===(t=b.list)||void 0===t?void 0:t.length)>=0&&y(e.target.value)},onKeyUp:e=>{"Enter"===e.key&&(M((()=>1)),v(_))},value:_})]})})})]}),null===b||void 0===b||null===(t=b.list)||void 0===t?void 0:t.map(((e,t)=>{var n;return(null===b||void 0===b||null===(n=b.list)||void 0===n?void 0:n.length)===t+1?(0,N.jsx)("div",{ref:Y,children:(0,N.jsx)(Z,{history:e})},null===e||void 0===e?void 0:e._id):(0,N.jsx)(Z,{history:e},null===e||void 0===e?void 0:e._id)})),R?u?(0,N.jsx)(p.default,{}):(0,N.jsx)(x.Z,{}):u?0===(null===b||void 0===b||null===(n=b.list)||void 0===n?void 0:n.length)&&(0,N.jsx)(j.Z,{title:"No students found related this search."}):0===(null===b||void 0===b||null===(i=b.list)||void 0===i?void 0:i.length)&&(0,N.jsx)(j.Z,{title:"No students."})]})};var S=n(76697),L=n(97892),Y=n.n(L),w=n(82824),b=n(6758),R=n(37782);const D=e=>{let{history:t}=e;const[i,l]=(0,r.useState)(""),[s,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(""),{financeReceipt:u,financeReceiptRefetch:v}=(0,b.Nw)({rid:i,skip:!i});(0,r.useEffect)((()=>{i&&v()}),[i,v]),(0,r.useEffect)((()=>{null!==u&&void 0!==u&&u.receipt&&null!==u&&void 0!==u&&u.all_remain&&c(u)}),[u]),(0,r.useEffect)((()=>{if(o){const e=new Worker(new URL(n.p+n.u(5563),n.b)),{institute:t,studentInfo:i,paymentReceiptInfo:l}=(0,R.Hs)(null===o||void 0===o?void 0:o.all_remain,null===o||void 0===o?void 0:o.receipt);e.postMessage({institute:t,studentInfo:i,paymentReceiptInfo:l,printReceiptType:"Refunded"===(null===l||void 0===l?void 0:l.transactonRefund)?"ADMISSION_REFUND":"ADMISSION"}),e.onmessage=t=>{t&&(window.open(t.data,"_blank"),d((e=>!e)),c(""),e.terminate())}}}),[o]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("img",{src:"".concat(a.J7,"/receipt.svg"),alt:"receipt icon",title:"Download Fees Receipt",onClick:()=>{var e,n,s;null!==t&&void 0!==t&&null!==(e=t.fee_receipt)&&void 0!==e&&e._id&&(d((e=>!e)),l(null===t||void 0===t||null===(n=t.fee_receipt)||void 0===n?void 0:n._id),i===(null===t||void 0===t||null===(s=t.fee_receipt)||void 0===s?void 0:s._id)&&c(u))}}),s&&(0,N.jsx)(p.default,{})]})},I=e=>{var t,n,i,s,d,o,a,r,c,u,v,_,f,m,h,p,x,j,y,Z,M,L,b,R,I,k;let{history:E}=e;const{t:T}=(0,l.$G)();return(0,N.jsxs)("div",{className:S.Z.sidebarheader,style:{gap:"1%"},title:"Income"===(null===E||void 0===E?void 0:E.payment_module_type)?"":"View Receipt",children:[(0,N.jsxs)("div",{className:S.Z.history_image_container,style:{width:"50%"},children:[null!==E&&void 0!==E&&null!==(t=E.student)&&void 0!==t&&t.studentProfilePhoto?(0,N.jsx)("img",{src:"".concat(g.yI,"/").concat(null===E||void 0===E||null===(n=E.student)||void 0===n?void 0:n.studentProfilePhoto),alt:"qr code",style:{width:"60px",height:"60px",borderRadius:"12px"}}):null,(0,N.jsxs)("div",{className:S.Z.text,children:[(0,N.jsx)("p",{className:S.Z.rcv,children:T("paid_to")}),(0,N.jsx)("h6",{children:null!==E&&void 0!==E&&E.student?"".concat(null!==(i=null===E||void 0===E||null===(s=E.student)||void 0===s?void 0:s.studentFirstName)&&void 0!==i?i:""," ").concat(null!==(d=null===E||void 0===E||null===(o=E.student)||void 0===o?void 0:o.studentMiddleName)&&void 0!==d?d:""," ").concat(null!==(a=null===E||void 0===E||null===(r=E.student)||void 0===r?void 0:r.studentLastName)&&void 0!==a?a:""):""}),(0,N.jsxs)("p",{className:S.Z.rcv,children:[T("gr_number")," ",null!==(c=null===E||void 0===E||null===(u=E.student)||void 0===u?void 0:u.studentGRNO)&&void 0!==c?c:""]}),(0,N.jsx)("p",{className:S.Z.rcv,children:null!==(v=null===E||void 0===E||null===(_=E.student)||void 0===_||null===(f=_.fee_structure)||void 0===f?void 0:f.unique_structure_name)&&void 0!==v?v:""})]})]}),(0,N.jsxs)("div",{className:S.Z.text,style:{width:"27%"},children:[(0,N.jsx)("p",{className:S.Z.rcv,style:{width:"100%"},children:T("transaction_id")}),(0,N.jsx)("h6",{style:{width:"100%",wordWrap:"break-word"},children:null!==E&&void 0!==E&&null!==(m=E.fee_receipt)&&void 0!==m&&m.fee_utr_reference?null===E||void 0===E||null===(h=E.fee_receipt)||void 0===h?void 0:h.fee_utr_reference:"N/A"}),(0,N.jsxs)("p",{className:S.Z.rcv,style:{width:"100%"},children:[Y()(null===E||void 0===E||null===(p=E.fee_receipt)||void 0===p?void 0:p.created_at).format("DD MMM YYYY"),", ",(0,w.J)(null===E||void 0===E||null===(x=E.fee_receipt)||void 0===x?void 0:x.created_at,"LT")]})]}),(0,N.jsxs)("div",{className:S.Z.text,style:{width:"20%"},children:[(0,N.jsxs)("p",{className:S.Z.rcv,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[T("invoice_no")," ",null!==(j=null===E||void 0===E||null===(y=E.fee_receipt)||void 0===y?void 0:y.invoice_count)&&void 0!==j?j:"N/A",(0,N.jsx)(D,{history:E})]}),(0,N.jsxs)("h6",{style:{width:"100%"},children:[T("rs_only")," ",null===E||void 0===E||null===(Z=E.fee_receipt)||void 0===Z?void 0:Z.fee_payment_amount]}),(0,N.jsx)("p",{className:S.Z.rcv,style:{width:"100%"},children:"offline"===(null===E||void 0===E||null===(M=E.payment_mode)||void 0===M?void 0:M.toLowerCase())?null!==E&&void 0!==E&&null!==(L=E.fee_receipt)&&void 0!==L&&L.fee_payment_mode?"".concat(null===E||void 0===E||null===(b=E.fee_receipt)||void 0===b?void 0:b.fee_payment_mode):"Offline - No Receipt":"online"===(null===E||void 0===E||null===(R=E.payment_mode)||void 0===R?void 0:R.toLowerCase())?null!==E&&void 0!==E&&null!==(I=E.fee_receipt)&&void 0!==I&&I.fee_payment_mode?"".concat(null===E||void 0===E||null===(k=E.fee_receipt)||void 0===k?void 0:k.fee_payment_mode):"Online - No Receipt":null===E||void 0===E?void 0:E.payment_mode})]})]})},k=e=>{var t,n,i;let{aid:d,totalRefunded:o}=e;const{t:c}=(0,l.$G)(),[u,v]=(0,r.useState)(""),[_,y]=(0,r.useState)(""),[g,Z]=(0,r.useState)(1),[M,S]=(0,r.useState)(!0),[L,Y]=(0,f.YD)({skip:u}),{admissionExcessFeeRefundedList:w,admissionExcessFeeRefundedListLoading:b}=(0,h.oL)({data:{aid:d,page:g,limit:10,search:u},skip:!d});(0,r.useEffect)((()=>{Y&&M&&Z((e=>e+1))}),[Y,M]),(0,r.useEffect)((()=>{var e;if(null!==w&&void 0!==w&&null!==(e=w.list)&&void 0!==e&&e.length){var t;let e=(0,m.f)(null===w||void 0===w||null===(t=w.list)||void 0===t?void 0:t.length);S((()=>e))}}),[null===w||void 0===w?void 0:w.list]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:s.Z.fm_header_container,children:[(0,N.jsxs)("h6",{children:[c("total_refund")," "," : "," ",c("rs_only")," ",null!==o&&void 0!==o?o:0]}),(0,N.jsx)("div",{className:s.Z.fm_search,children:(0,N.jsx)("section",{className:s.Z.fm_search_container,children:(0,N.jsxs)("div",{className:s.Z.fm_search_container_inner,children:[(0,N.jsx)("img",{className:s.Z.fm_search_icon,alt:"search icon",src:"".concat(a.dB,"/navbar-search.svg")}),(0,N.jsx)("input",{type:"text",placeholder:c("search"),onChange:e=>{var t;!b&&(null===w||void 0===w||null===(t=w.list)||void 0===t?void 0:t.length)>=0&&y(e.target.value)},onKeyUp:e=>{"Enter"===e.key&&(Z((()=>1)),v(_))},value:_})]})})})]}),null===w||void 0===w||null===(t=w.list)||void 0===t?void 0:t.map(((e,t)=>{var n;return(null===w||void 0===w||null===(n=w.list)||void 0===n?void 0:n.length)===t+1?(0,N.jsx)("div",{ref:L,children:(0,N.jsx)(I,{history:e})},null===e||void 0===e?void 0:e._id):(0,N.jsx)(I,{history:e},null===e||void 0===e?void 0:e._id)})),b?u?(0,N.jsx)(p.default,{}):(0,N.jsx)(x.Z,{}):u?0===(null===w||void 0===w||null===(n=w.list)||void 0===n?void 0:n.length)&&(0,N.jsx)(j.Z,{title:"No students found related this search."}):0===(null===w||void 0===w||null===(i=w.list)||void 0===i?void 0:i.length)&&(0,N.jsx)(j.Z,{title:"No students."})]})},E=e=>{let{totalRefund:t,aid:n,totalRefunded:f}=e;const{t:m}=(0,l.$G)(),[x]=(0,c.lr)(),j=(0,u.TH)(),y=(0,u.UO)(),g=(0,u.s0)(),[Z,S]=(0,r.useState)(!1),[L]=(0,h.o5)(),[Y]=(0,h.Lg)();return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(i.default,{children:[(0,N.jsx)(o.default,{children:(0,N.jsxs)("div",{className:s.Z.fm_header_container,children:[(0,N.jsx)("h6",{children:m("excess_fees_refund")}),(0,N.jsx)("div",{className:s.Z.fm_both_filter,children:(0,N.jsx)("div",{onClick:()=>{n&&(S((e=>!e)),"refunded"===x.get("n")?Y({aid:n}).then((()=>{var e;S((e=>!e));let t="Institute"===(null===(e=j.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(y.username,"/institute/member/finance?type=export"):"/q/".concat(y.username,"/member/staff/finance?type=export");g(t,{state:j.state})})).catch({}):L({aid:n}).then((()=>{var e;S((e=>!e));let t="Institute"===(null===(e=j.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(y.username,"/institute/member/finance?type=export"):"/q/".concat(y.username,"/member/staff/finance?type=export");g(t,{state:j.state})})).catch({}))},className:s.Z.fm_both_filter_with_name,children:(0,N.jsx)("img",{src:"".concat(a.J7,"/export.svg"),alt:"filter icon",style:{width:"2rem",height:"2rem"},title:"Export In Excel"})})})]})}),(0,N.jsx)(d.Z,{}),(0,N.jsxs)(o.default,{customStyle:{paddingTop:"0"},children:[(0,N.jsx)(v.Z,{children:T.map((e=>{var t;return(0,N.jsx)(_.Z,{tab:e,isLink:!0,isActive:"excess_fee"===e.id&&!x.get("n")||x.get("n")===e.id,parentState:j.state,url:"Institute"===(null===(t=j.state)||void 0===t?void 0:t.urlOffSet)?"/q/".concat(y.username,"/institute/member/finance?type=excess").concat(e.urlKey):"/q/".concat(y.username,"/member/staff/finance?type=excess").concat(e.urlKey)},null===e||void 0===e?void 0:e.id)}))}),(0,N.jsx)(d.Z,{customStyleBorder:{marginTop:"0"}})]}),(0,N.jsx)(o.default,{customStyle:{paddingTop:"0"},children:"refunded"===x.get("n")?(0,N.jsx)(k,{aid:n,totalRefunded:f}):(0,N.jsx)(M,{aid:n,totalRefund:t})})]}),Z&&(0,N.jsx)(p.default,{})]})},T=[{label:"excess_fee",id:"excess_fee",urlKey:""},{label:"refunded",id:"refunded",urlKey:"&n=refunded"}]},82824:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,Z:()=>a});var i=n(99893),l=n.n(i),s=n(97892),d=n.n(s);const o=(e,t)=>(d().extend(l()),d()(e).format(t)),a=(e,t,n)=>{var i;return d()()[e]("".concat(null===(i=d()(n))||void 0===i?void 0:i.format("YYYY-MM-DD")),t)}},99893:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(t,n,i){var l=n.prototype,s=l.format;i.en.formats=e,l.format=function(t){void 0===t&&(t="YYYY-MM-DDTHH:mm:ssZ");var n=this.$locale().formats,i=function(t,n){return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,i,l){var s=l&&l.toUpperCase();return i||n[l]||e[l]||n[s].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))}(t,void 0===n?{}:n);return s.call(this,i)}}}()},3773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={pending_fees_card:"PendingFees_pending_fees_card__-fyKu",pending_fees_card_container:"PendingFees_pending_fees_card_container__HBWkK",pending_fees_card_inner:"PendingFees_pending_fees_card_inner__Zi+6O",statistics_balance:"PendingFees_statistics_balance__px4LZ"}},76697:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={settle_card:"TransactionHistory_settle_card__WjSwI",settle_card_container:"TransactionHistory_settle_card_container__EIw4W",settle_card_text:"TransactionHistory_settle_card_text__3j20S",settle_paragraph:"TransactionHistory_settle_paragraph__x3Ovt",sidebarheader:"TransactionHistory_sidebarheader__oEDm9",history_image_container:"TransactionHistory_history_image_container__ZBhq9",text:"TransactionHistory_text__yimnr",rcv:"TransactionHistory_rcv__kuGgZ"}}}]);
//# sourceMappingURL=10509.8714f3a1.chunk.js.map