"use strict";(self.webpackChunkmithkal_qviple=self.webpackChunkmithkal_qviple||[]).push([[18344],{18344:(e,l,s)=>{s.d(l,{Z:()=>$});var t=s(72791),i=s(39230),o=s(98684),n=s(48293),a=s(21348);const c="ExcelImport_mc__7QTcg",r="ExcelImport_mc_outer_header__M6u69",d="ExcelImport_mc_header__YQP2Z",m="ExcelImport_mc_step__z7AVn",u="ExcelImport_mcs_inner__fa27Q",_="ExcelImport_mcs_progress__7k+ck",v="ExcelImport_mcs_circle__jA7Om",p="ExcelImport_mcs_line__HaPNQ",h="ExcelImport_mcuy_file__lntGX",x="ExcelImport_mcuyf_note__z6PuF",f="ExcelImport_mcf_card__0hIVi",j="ExcelImport_mcf_container__G6TWw",g="ExcelImport_mcf_card_paragraph__rXmdN",y="ExcelImport_mcfc_sample__76p69",S="ExcelImport_mcf_drag_area__qGi6B",N="ExcelImport_mc_excel_container__aSE+1",b="ExcelImport_mc_heading__XsMPY",I="ExcelImport_mc_content__Pkj6a",k="ExcelImport_mcc_inner__WM9qB",E="ExcelImport_mcfd_card__0eaIe";var C=s(80184);const Z=e=>{let{onClose:l,step:s,children:t}=e;const{t:h}=(0,i.$G)();return(0,C.jsx)(n.Z,{onClose:l,customOverlayStyle:{width:"80%"},children:(0,C.jsxs)("div",{className:c,children:[(0,C.jsxs)(a.Z,{children:[(0,C.jsxs)("div",{className:r,children:[(0,C.jsx)("div",{className:d}),(0,C.jsx)("img",{src:"".concat(o.J7,"/close.svg"),alt:"close icon",onClick:l})]}),(0,C.jsxs)("div",{className:m,children:[(0,C.jsxs)("div",{className:u,children:[(0,C.jsx)("h6",{children:h("upload_file")}),(0,C.jsxs)("div",{className:_,children:[(0,C.jsx)("div",{className:v,style:{"--mcs-circle-bg":1===s?"#459ffc":"#bbdcfe"}}),(0,C.jsx)("div",{className:p,style:{"--mcs-circle-bg":1===s?"#459ffc":"#bbdcfe"}})]})]}),(0,C.jsxs)("div",{className:u,children:[(0,C.jsx)("h6",{children:h("review_mapping")}),(0,C.jsxs)("div",{className:_,children:[(0,C.jsx)("div",{className:v,style:{"--mcs-circle-bg":1===s?"#459ffc":"#bbdcfe"}}),(0,C.jsx)("div",{className:p,style:{"--mcs-circle-bg":2===s?"#459ffc":"#bbdcfe"}})]})]}),(0,C.jsxs)("div",{className:u,children:[(0,C.jsx)("h6",{children:h("finalize_import")}),(0,C.jsxs)("div",{className:_,children:[(0,C.jsx)("div",{className:v,style:{"--mcs-circle-bg":2===s?"#459ffc":"#bbdcfe"}}),(0,C.jsx)("div",{className:p,style:{"--mcs-circle-bg":"#459ffc",width:"0"}})]})]})]})]}),t]})})};var w=s(44226),F=s(93638);const q=e=>{let{setFile:l,setStep:s}=e;const{t:n}=(0,i.$G)(),[a,c]=(0,t.useState)(!1),r=(0,t.useRef)(null),d=e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?c(!0):"dragleave"===e.type&&c(!1)},m=function(e){e.preventDefault(),e.target.files&&e.target.files[0]&&(l(e.target.files[0]),s(1))};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("h2",{className:h,children:n("upload_your_file")}),(0,C.jsx)("div",{className:f,children:(0,C.jsxs)("form",{onDragEnter:d,onSubmit:e=>e.preventDefault(),onPaste:e=>{e.clipboardData.files.length&&(l(e.clipboardData.files[0]),s(1))},className:j,children:[(0,C.jsx)(w.Z,{onExcelFileUpload:m,assestUrl:"".concat(o.J7,"/xsxl.svg")}),(0,C.jsx)(F.Z,{label:n("upload_file"),onAction:()=>{r.current.click()},customStyle:{margin:"0",marginTop:"0.5rem",padding:"0.2rem 0.8rem",fontWeight:"400",fontSize:"13px"}}),(0,C.jsx)("input",{ref:r,type:"file",id:"excel_grab_file",multiple:!1,onChange:m,style:{display:"none"}}),(0,C.jsx)("label",{id:"label-file-upload",htmlFor:"excel_grab_file",className:a?"drag-active":"",style:{height:"auto"},children:(0,C.jsx)("p",{className:g,style:{marginTop:"1rem"},children:"or drag and drop it here"})}),(0,C.jsx)("div",{className:g,children:"or paste a file"}),a&&(0,C.jsx)("div",{onDragEnter:d,onDragLeave:d,onDragOver:d,onDrop:e=>{e.preventDefault(),e.stopPropagation(),c(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&(l(e.dataTransfer.files[0]),s(1))},className:S}),(0,C.jsx)("div",{className:y,children:n("download_a_sample")})]})})]})},R=(0,t.memo)(q);var L=s(34045),A=s(52245);const D=e=>{let{selectLabel:l,onClick:s,selectedValue:n,options:a,customStyleContainer:c,customLabelStyle:r,customListStyle:d,errorShow:m,defalutValue:u,isDenied:_,customStyleArea:v}=e;const{t:p}=(0,i.$G)(),[h,x]=(0,t.useState)(!1),[f,j]=(0,t.useState)(""),[g,y]=(0,t.useState)(null!==a&&void 0!==a?a:[]);(0,t.useEffect)((()=>{null!==a&&void 0!==a&&a.length&&y(a)}),[null===a||void 0===a?void 0:a.length]);const S=()=>{_||x((e=>!e))};(0,t.useEffect)((()=>{u&&j(u)}),[u]);return(0,C.jsxs)("div",{className:A.Z.form_input_container,style:c,children:[(0,C.jsxs)("p",{className:A.Z.join_form_select_paragraph,style:r,children:[l,m&&(0,C.jsxs)("span",{style:{color:"red",marginLeft:"15px"},children:["* ",p("form_require_label")]})]}),(0,C.jsxs)("section",{className:A.Z.join_form_select_custom,onClick:S,style:v,children:[f?(0,C.jsx)("p",{className:A.Z.join_form_select_custom_paragraph,children:null!==f&&void 0!==f?f:""}):(0,C.jsx)("p",{className:A.Z.join_form_select_custom_paragraph,children:n}),h?(0,C.jsx)("img",{className:A.Z.join_form_select_custom_rotate_icon,src:"".concat(o.J7,"/down.svg"),alt:"categor icon"}):(0,C.jsx)("img",{className:A.Z.join_form_select_custom_icon,src:"".concat(o.J7,"/down.svg"),alt:"categor icon"})]}),h&&(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)("section",{className:A.Z.jfscl_option_list,style:d,children:[(0,C.jsxs)("div",{className:A.Z.jfsclol_search_container,children:[(0,C.jsx)("input",{type:"text",placeholder:p("search"),className:A.Z.jfsclolsc_input,onChange:e=>{if(e.target.value){let l=P(a,e.target.value);y(l)}else y(a)}}),(0,C.jsx)("img",{src:"".concat(o.dB,"/navbar-search.svg"),alt:"search icon"})]}),null===g||void 0===g?void 0:g.map(((e,l)=>{var t;return(0,C.jsxs)("p",{onClick:()=>{return s(l=e),S(),void(null!==l&&void 0!==l&&l.name?j(null===l||void 0===l?void 0:l.name):j(l));var l},className:A.Z.join_form_select_custom_paragraph_option,children:[null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:e,null!==e&&void 0!==e&&e.isRequired?(0,C.jsxs)("span",{style:{color:"red"},children:[" ","*"]}):null]},l)})),0===(null===g||void 0===g?void 0:g.length)?(0,C.jsx)("p",{className:A.Z.join_form_select_custom_paragraph_option,children:p("no_results_found")}):""]})})]})},P=(e,l)=>null===e||void 0===e?void 0:e.filter((e=>{var s,t;return null!==e&&void 0!==e&&null!==(s=e.name)&&void 0!==s&&null!==(t=s.toLowerCase())&&void 0!==t&&t.includes(null===l||void 0===l?void 0:l.toLowerCase())?e:null}));var K=s(23984);const V=e=>{let{grabFile:l,setStep:s,setKeyCount:n,onImportFileInSystem:c,keyCount:r,requiredFormat:d,whichImportAccess:m,setRootList:u}=e;const{t:_}=(0,i.$G)(),[v,p]=(0,t.useState)(null!==l&&void 0!==l?l:""),[x,f]=(0,t.useState)([]),[j,g]=(0,t.useState)({}),[y,S]=(0,t.useState)({}),[E,Z]=(0,t.useState)([]),[w,q]=(0,t.useState)(null!==l&&void 0!==l?l:"");(0,t.useEffect)((()=>{null!==d&&void 0!==d&&d.length&&Z(d)}),[null===d||void 0===d?void 0:d.length]),(0,t.useEffect)((()=>{l&&R(l)}),[l]);const R=async e=>{var l;const s=e,t=await s.arrayBuffer(),i=(0,L.ij)(t),o=i.Sheets[null===(l=i.SheetNames)||void 0===l?void 0:l[0]],n=L.P6.sheet_to_json(o,{raw:!1}),a=[];for(let c=0;c<(null===n||void 0===n?void 0:n.length);c++){for(let e in n[c]){let l=n[c][e];0===c&&a.push({title:e,firstValue:l,isMapped:!1,mappedKey:"",isRequired:!1,db_key:""})}break}p(n),f(a)};return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(a.Z,{customStyle:{width:"100%"},children:[(0,C.jsx)("h2",{className:h,children:_("review_the_mapping_of_your_fields")}),(0,C.jsxs)("div",{className:N,children:[(0,C.jsxs)("div",{className:b,children:[(0,C.jsx)("h6",{style:{flex:"0.4 0.4 8.2%"},children:_("import")}),(0,C.jsx)("h6",{style:{flex:"2 2 52%",textAlign:"left"},children:_("xslx_column")}),(0,C.jsx)("h6",{style:{flex:"1 1 5%"},children:_("mapped")}),(0,C.jsx)("h6",{style:{flex:"1 1 24%",marginRight:"1rem"},children:_("suite_field")})]}),null===x||void 0===x?void 0:x.map((e=>{var l,s;return(0,C.jsxs)("section",{className:I,children:[(0,C.jsx)("h6",{style:{flex:"0.4 0.4 8%",opacity:y[null===e||void 0===e?void 0:e.title]?"1":"0.5"},children:(0,C.jsx)("img",{src:y[null===e||void 0===e?void 0:e.title]?"".concat(o.U_,"/check.svg"):"".concat(o.U_,"/uncheck.svg"),alt:"icon",style:{height:"1.3rem",borderRadius:"0",cursor:"pointer"},onClick:()=>{return l=null===e||void 0===e?void 0:e.title,void(j[l]&&!j[l].isRequired&&S((e=>({...e,[l]:!e[l]}))));var l}})}),(0,C.jsxs)("div",{style:{flex:"2 2 50%",opacity:y[null===e||void 0===e?void 0:e.title]?"1":"0.5"},className:k,children:[(0,C.jsx)("h6",{children:null===e||void 0===e?void 0:e.title}),(0,C.jsxs)("p",{children:[null===e||void 0===e||null===(l=e.firstValue)||void 0===l?void 0:l.substring(0,70),(null===e||void 0===e||null===(s=e.firstValue)||void 0===s?void 0:s.length)>70?"...":""]})]}),(0,C.jsx)("h6",{style:{flex:"1 1 5%",opacity:y[null===e||void 0===e?void 0:e.title]?"1":"0.5"},children:(0,C.jsx)("img",{src:null!==e&&void 0!==e&&e.mappedKey?"".concat(o.Fk,"/complete.svg"):"".concat(o.Fk,"/radio-grey.svg"),alt:"icon",style:{height:"1.3rem",borderRadius:"0"}})}),(0,C.jsx)(D,{selectedValue:_("select_a_field"),customStyleContainer:{flex:"1 1 25%",paddingInline:"1rem"},customStyleArea:null!==e&&void 0!==e&&e.isRequired?{border:"0.5px solid red"}:{},options:E,onClick:l=>((e,l)=>{let s=[...x],t={};for(let c=0;c<(null===s||void 0===s?void 0:s.length);c++){var i,o;(null===(i=s[c])||void 0===i?void 0:i.title)===e?(s[c].mappedKey=null===l||void 0===l?void 0:l.name,s[c].isMapped=!0,s[c].isRequired=null===l||void 0===l?void 0:l.isRequired,s[c].db_key=l[null===l||void 0===l?void 0:l.name],t[e]={name:null===l||void 0===l?void 0:l.name,[null===l||void 0===l?void 0:l.name]:l[null===l||void 0===l?void 0:l.name],isRequired:null===l||void 0===l?void 0:l.isRequired}):s[c].mappedKey&&(t[null===(o=s[c])||void 0===o?void 0:o.title]={name:s[c].mappedKey,[s[c].mappedKey]:s[c].db_key,isRequired:s[c].isRequired})}f(s),g(t),S((l=>({...l,[e]:!0})));const n=[];for(let c of d){let e=!1;for(let l in t){var a;if((null===(a=t[l])||void 0===a?void 0:a.name)===(null===c||void 0===c?void 0:c.name)){e=!0;break}}e||n.push(c)}Z((()=>n))})(null===e||void 0===e?void 0:e.title,l),defalutValue:null===e||void 0===e?void 0:e.mappedKey,customListStyle:{opacity:"1"}})]},"key".concat(null===e||void 0===e?void 0:e.title))}))]}),(0,C.jsx)(K.Z,{customStyle:{justifyContent:"center"},children:(0,C.jsx)(F.Z,{label:_("next"),onAction:()=>{const e=[...v],l=[];let t=0;for(let s=0;s<(null===e||void 0===e?void 0:e.length);s++){let c=0,r=0,d={};for(let l in e[s]){var i;let t=e[s][l];var o,a;if(null!==(i=j[l])&&void 0!==i&&i.name)d["key".concat(c)]={value:t,fomat_key:null===(o=j[l])||void 0===o?void 0:o.name,excel_key:l,db_key:j[l][null===(a=j[l])||void 0===a?void 0:a.name]},++r,++c}0===s&&(n(r),t=r),l.push(d)}q(l),"SCHOLARSHIP"===m?(u(l),s(3)):c(l,t)},customStyle:{width:"fit-content",paddingInline:"2rem"}})})]})})},G=(0,t.memo)(V);var T=s(61055),B=s(99183);const M=e=>{let{keyCount:l,rootList:s,onImportFileInSystem:o,file:n}=e;const{t:a}=(0,i.$G)(),[c,r]=(0,t.useState)({excel_sheet_name:""});(0,t.useEffect)((()=>{null!==n&&void 0!==n&&n.name&&r((e=>({...e,excel_sheet_name:null===n||void 0===n?void 0:n.name})))}),[null===n||void 0===n?void 0:n.name]);const[d,m]=(0,t.useState)("");return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("h2",{className:h,style:{marginBottom:"1rem"},children:a("your_file_is_ready_to_be_imported")}),(0,C.jsx)("h6",{className:x,style:{marginBottom:"4rem"},children:a("take_a_quick_look_at_these_settings_to_make_sure_nothing_is_missed_out")}),(0,C.jsxs)("div",{className:E,children:[(0,C.jsx)(T.Z,{label:a("file_name"),placeholder:a("file_name_placeholder"),name:"excel_sheet_name",value:c.excel_sheet_name,type:"text",onChange:e=>{r((l=>({...l,[e.target.name]:e.target.value})))},errorShow:d.excel_sheet_name}),(0,C.jsx)(K.Z,{customStyle:{justifyContent:"center"},children:(0,C.jsx)(F.Z,{label:a("import"),onAction:()=>{let e=(0,B.l)(c,[]);(0,B.x)(e)?o(s,l,c):m(e)},customStyle:{width:"fit-content",paddingInline:"2rem"}})})]})]})},$=e=>{let{onClose:l,onImportFileInSystem:s,requiredFormat:i,whichImportAccess:o}=e;const[n,a]=(0,t.useState)(0),[c,r]=(0,t.useState)(""),[d,m]=(0,t.useState)(0),[u,_]=(0,t.useState)([]);return(0,C.jsx)(Z,{onClose:l,step:n,children:0===n?(0,C.jsx)(R,{setFile:r,file:c,setStep:a}):1===n?(0,C.jsx)(G,{grabFile:c,setStep:a,setKeyCount:m,onImportFileInSystem:s,keyCount:d,requiredFormat:i,whichImportAccess:o,setRootList:_}):3===n?(0,C.jsx)(M,{keyCount:d,rootList:u,onImportFileInSystem:s,file:c}):null})}},23984:(e,l,s)=>{s.d(l,{Z:()=>o});var t=s(80476),i=s(80184);const o=e=>{let{customStyle:l,children:s}=e;return(0,i.jsx)("div",{className:t.Z.btn_wrapper,style:l,children:s})}}}]);
//# sourceMappingURL=18344.c3bbb5b3.chunk.js.map