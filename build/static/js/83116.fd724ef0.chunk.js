"use strict";(self.webpackChunkmithkal_qviple=self.webpackChunkmithkal_qviple||[]).push([[83116],{83116:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var l=n(63687),i=n(56959),o=n(16871),a=n(43504),d=n(21348),s=n(90904),r=n(98967),c=n(63162),u=n(93638),v=n(72791),m=n(55336),_=n(6758),h=n(39230),f=n(23441),p=n(91427),x=n(98684),y=n(2651),j=n(1669),g=n(76697),Z=n(97892),b=n.n(Z),S=n(82824),C=n(1095),I=n(56655),N=n(80184);const k=e=>{var t,n,l,i,d,s,r,c,u,m,_,f,p,y,j,Z,k,O,w,F,R,T,A,L,P,q,D,M,Y,E,G,J,H,U,$,B,K;let{history:z,onRefetch:V,ofid:W}=e;const{t:Q}=(0,h.$G)(),X=(0,o.UO)(),ee=(0,o.TH)(),[te,ne]=(0,v.useState)("");return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:g.Z.sidebarheader,style:{gap:"1%"},title:"View Receipt",children:[(0,N.jsxs)("div",{className:g.Z.history_image_container,style:{width:"50%"},children:[null!==z&&void 0!==z&&null!==(t=z.payment_student)&&void 0!==t&&t.studentProfilePhoto?(0,N.jsx)(a.rU,{to:"/q/".concat(X.username,"/student/profile"),state:{...ee.state,sid:null===z||void 0===z||null===(n=z.payment_student)||void 0===n?void 0:n._id},children:(0,N.jsx)("img",{src:"".concat(C.yI,"/").concat(null===z||void 0===z||null===(l=z.payment_student)||void 0===l?void 0:l.studentProfilePhoto),alt:"qr code",style:{width:"60px",height:"60px",borderRadius:"12px"}})}):(0,N.jsx)("img",{src:"".concat(x.p3,"/feed-user-avatar.svg"),alt:"qr code",style:{width:"60px",height:"60px",borderRadius:"12px"}}),null!==z&&void 0!==z&&z.payment_student_detail?(0,N.jsxs)("div",{className:g.Z.text,children:[(0,N.jsx)("p",{className:g.Z.rcv,children:Q("recived_from")}),(0,N.jsx)("h6",{children:null!==(i=null===z||void 0===z||null===(d=z.fee_receipt)||void 0===d?void 0:d.student_name)&&void 0!==i?i:""}),(0,N.jsxs)("p",{className:g.Z.rcv,children:[Q("batch")," ",": ",null!==(s=null===z||void 0===z||null===(r=z.payment_student_detail)||void 0===r?void 0:r.batch)&&void 0!==s?s:"",","," ",Q("student_class"),": ",null===z||void 0===z||null===(c=z.payment_student_detail)||void 0===c?void 0:c.classes,", ",Q("roll_number")," ",": ",null!==(u=null===z||void 0===z||null===(m=z.payment_student_detail)||void 0===m?void 0:m.roll_no)&&void 0!==u?u:""]})]}):(0,N.jsxs)("div",{className:g.Z.text,children:[(0,N.jsx)("p",{className:g.Z.rcv,children:Q("recived_from")}),(0,N.jsx)("h6",{children:null!==z&&void 0!==z&&z.payment_student?"".concat(null!==(_=null===z||void 0===z||null===(f=z.payment_student)||void 0===f?void 0:f.studentFirstName)&&void 0!==_?_:""," ").concat(null!==(p=null===z||void 0===z||null===(y=z.payment_student)||void 0===y?void 0:y.studentMiddleName)&&void 0!==p?p:""," ").concat(null!==(j=null===z||void 0===z||null===(Z=z.payment_student)||void 0===Z?void 0:Z.studentLastName)&&void 0!==j?j:""):null!==(k=null===z||void 0===z||null===(O=z.payment_by_end_user_id)||void 0===O?void 0:O.userLegalName)&&void 0!==k?k:null===z||void 0===z?void 0:z.payment_by_end_user_id_name}),(0,N.jsxs)("p",{className:g.Z.rcv,children:[Q("gr_number")," ",null!==(w=null===z||void 0===z||null===(F=z.payment_student)||void 0===F?void 0:F.studentGRNO)&&void 0!==w?w:""]}),(0,N.jsx)("p",{className:g.Z.rcv,children:null!==(R=null===z||void 0===z||null===(T=z.payment_student)||void 0===T||null===(A=T.fee_structure)||void 0===A?void 0:A.unique_structure_name)&&void 0!==R?R:""})]})]}),(0,N.jsxs)("div",{className:g.Z.text,style:{width:"27%"},children:[(0,N.jsx)("p",{className:g.Z.rcv,style:{width:"100%"},children:Q("transaction_id")}),(0,N.jsx)("h6",{style:{width:"100%",wordWrap:"break-word"},children:null!==z&&void 0!==z&&z.razorpay_payment_id?null===z||void 0===z?void 0:z.razorpay_payment_id:null!==z&&void 0!==z&&null!==(L=z.fee_receipt)&&void 0!==L&&L.fee_utr_reference?null===z||void 0===z||null===(P=z.fee_receipt)||void 0===P?void 0:P.fee_utr_reference:"N/A"}),(0,N.jsxs)("p",{className:g.Z.rcv,style:{width:"100%"},children:[b()(null===z||void 0===z?void 0:z.created_at).format("DD MMM YYYY"),", ",(0,S.J)(null===z||void 0===z?void 0:z.created_at,"LT")]})]}),(0,N.jsxs)("div",{className:g.Z.text,style:{width:"20%"},children:[(0,N.jsxs)("p",{className:g.Z.rcv,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Q("invoice_no")," ",null!==(q=null!==(D=null===z||void 0===z||null===(M=z.fee_receipt)||void 0===M?void 0:M.invoice_count)&&void 0!==D?D:null===z||void 0===z?void 0:z.payment_invoice_number)&&void 0!==q?q:"N/A",null!==z&&void 0!==z&&null!==(Y=z.fee_receipt)&&void 0!==Y&&Y.receipt_file?(0,N.jsx)("a",{href:"".concat(C.q2,"/").concat(null===z||void 0===z||null===(E=z.fee_receipt)||void 0===E?void 0:E.receipt_file),target:"_blank",rel:"noopener noreferrer",children:(0,N.jsx)("img",{src:"".concat(x.J7,"/receipt.svg"),alt:"receipt icon",title:"Download Fees Receipt"})}):null]}),(0,N.jsxs)("h6",{style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[Q("rs_only")," ",null===z||void 0===z?void 0:z.payment_amount,(0,N.jsx)("img",{src:"".concat(x.J7,"/menu.svg"),alt:"receipt icon",title:"Download Fees Receipt",onClick:e=>{e.stopPropagation(),ne(1)}})]}),(0,N.jsx)("p",{className:g.Z.rcv,style:{width:"100%"},children:"offline"===(null===(G=z.payment_mode)||void 0===G?void 0:G.toLowerCase())?null!==z&&void 0!==z&&null!==(J=z.fee_receipt)&&void 0!==J&&J.fee_payment_mode?"".concat(null===z||void 0===z||null===(H=z.fee_receipt)||void 0===H?void 0:H.fee_payment_mode):"Offline - No Receipt":"online"===(null===(U=z.payment_mode)||void 0===U?void 0:U.toLowerCase())?null!==z&&void 0!==z&&null!==($=z.fee_receipt)&&void 0!==$&&$.fee_payment_mode?"".concat(null===z||void 0===z||null===(B=z.fee_receipt)||void 0===B?void 0:B.fee_payment_mode):"Online - No Receipt":null===z||void 0===z?void 0:z.payment_mode})]})]}),1===te?(0,N.jsx)(I.Z,{onClose:()=>ne(""),frid:null===z||void 0===z||null===(K=z.fee_receipt)||void 0===K?void 0:K._id,onRefetch:V,ofid:W}):null]})},O=e=>{var t,n,l,o;let{instituteId:a,ofid:r}=e;const{t:c}=(0,h.$G)(),[u,g]=(0,v.useState)(""),[Z,b]=(0,v.useState)(""),[S,C]=(0,v.useState)(1),[I,O]=(0,v.useState)(!0),[w,F]=(0,f.YD)({skip:u}),{financeOtherOneFeesTransaction:R,financeOtherOneFeesTransactionLoading:T,financeOtherOneFeesTransactionRefetch:A}=(0,_.ok)({data:{uid:a,page:S,limit:10,search:u,filter:"",ofid:r},skip:a?!r:!a});(0,v.useEffect)((()=>{F&&I&&C((e=>e+1))}),[F,I]),(0,v.useEffect)((()=>{var e;if(null!==R&&void 0!==R&&null!==(e=R.list)&&void 0!==e&&e.length){var t;let e=(0,p.f)(null===R||void 0===R||null===(t=R.list)||void 0===t?void 0:t.length);O((()=>e))}}),[null===R||void 0===R||null===(t=R.list)||void 0===t?void 0:t.length]);const L=()=>{C((e=>1)),A()};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(d.default,{children:(0,N.jsx)("div",{className:i.Z.fm_search_full,children:(0,N.jsx)("section",{className:i.Z.fm_search_full_container,children:(0,N.jsxs)("div",{className:i.Z.fm_search_full_container_inner,children:[(0,N.jsx)("img",{className:i.Z.fm_search_full_icon,alt:"search icon",src:"".concat(x.dB,"/navbar-search.svg")}),(0,N.jsx)("input",{type:"text",placeholder:c("search"),onChange:e=>{var t;!T&&(null===R||void 0===R||null===(t=R.list)||void 0===t?void 0:t.length)>=0&&b(e.target.value)},onKeyUp:e=>{"Enter"===e.key&&(C((()=>1)),g(Z))},value:Z})]})})})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[null===R||void 0===R||null===(n=R.list)||void 0===n?void 0:n.map(((e,t)=>{var n;return(null===R||void 0===R||null===(n=R.list)||void 0===n?void 0:n.length)===t+1?(0,N.jsx)("div",{ref:w,children:(0,N.jsx)(k,{history:e,onRefetch:L,ofid:r})},null===e||void 0===e?void 0:e._id):(0,N.jsx)(k,{history:e,onRefetch:L,ofid:r},null===e||void 0===e?void 0:e._id)})),T?u?(0,N.jsx)(m.default,{}):(0,N.jsx)(j.Z,{}):u?0===(null===R||void 0===R||null===(l=R.list)||void 0===l?void 0:l.length)&&(0,N.jsx)(y.Z,{title:"No receipts found related this search.",customStyleContainer:{marginTop:"1.5rem"}}):0===(null===R||void 0===R||null===(o=R.list)||void 0===o?void 0:o.length)&&(0,N.jsx)(y.Z,{title:"No receipts added.",customStyleContainer:{marginTop:"1.5rem"}})]})]})};var w=n(27976),F=n(13182),R=n(43172),T=n(73711),A=n(85794),L=n(9228),P=n(38857),q=n(16925),D=n(61055),M=n(60924),Y=n(43997),E=n(50518),G=n(99183),J=n(60307),H=n(71439),U=n(64499);const $=e=>{var t;let{onClose:n,financeId:l,onRefetch:i,otherFeesId:a,student:r,instituteId:c,isNonExisting:f,collectStaffId:p,cardId:y,cardAmount:j}=e;const{t:g}=(0,h.$G)(),[Z,S]=(0,v.useState)(!1),C=(0,o.UO)(),[I,k]=(0,v.useState)({amount:"",mode:"",fee_payment_mode:"",fee_payment_amount:"",transaction_date:b()().format("DD/MM/YYYY"),fee_bank_name:"",fee_bank_holder:"",fee_utr_reference:""}),[O,w]=(0,v.useState)(""),[F,R]=(0,v.useState)({open:!1,msg:"",variant:"error"}),[T,L]=(0,v.useState)({amount:0,type:"Other",isTransaction:!1}),{studentInstituteCharges:$}=(0,J.xY)({data:{id:c},skip:!c}),[B]=(0,_.iJ)();(0,v.useEffect)((()=>{j&&(k((e=>({...e,amount:+j,fee_payment_amount:+j}))),L({amount:+j,type:"Other",isTransaction:!1}))}),[r]);const K=e=>{k((t=>({...t,[e.target.name]:e.target.value})))};return(0,N.jsxs)(N.Fragment,{children:[T.isTransaction?(0,N.jsx)(H.Z,{onClose:n,allContent:{...T,platform_charges:null===$||void 0===$||null===(t=$.platform_charges)||void 0===t?void 0:t.percentage},checkoutAdmissionHandler:()=>{var e,t,n,l,i,o,d,s,u,v,m;let _=2.1*+(null===T||void 0===T?void 0:T.amount)/100,h=_+18*+_/100;const f=parseInt(null===T||void 0===T?void 0:T.amount);var p=Math.ceil(f+ +h.toFixed(2));(0,U.oU)({amount:null!==(e=+(null===I||void 0===I?void 0:I.amount))&&void 0!==e?e:10,amount_nocharges:null!==(t=+p)&&void 0!==t?t:0,type:"Other",paidBy:null===r||void 0===r?void 0:r._id,paidTo:c,moduleId:a,ad_status_id:null,payment_installment:null,ad_install:null,month:null,payment_remain_1:null,payment_card_type:null,payment_book_id:null,name:C.username,isApk:"web",payment_card_id:null,payment_remain_fees:null,charge:{num_platform_percent:null!==(n=null===$||void 0===$||null===(l=$.platform_charges)||void 0===l?void 0:l.percentage)&&void 0!==n?n:0,num_platform_max:null!==(i=null===$||void 0===$||null===(o=$.platform_charges)||void 0===o?void 0:o.maximum)&&void 0!==i?i:0,num_trans_pecent:null!==(d=null===$||void 0===$||null===(s=$.transaction_charges)||void 0===s?void 0:s.percentage)&&void 0!==d?d:0,num_trans_max:null!==(u=null===$||void 0===$||null===(v=$.transaction_charges)||void 0===v?void 0:v.maximum)&&void 0!==u?u:0,num_app_max:null!==(m=null===$||void 0===$?void 0:$.application_charges)&&void 0!==m?m:0},nsid:null}).then((e=>{var t,n;window.onScriptLoad(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(n=t.body)||void 0===n?void 0:n.txnToken,null===e||void 0===e?void 0:e.order,null===e||void 0===e?void 0:e.amount)})).catch((e=>{console.info(e)}))},isOptimzed:!0}):(0,N.jsx)(P.Z,{onClose:n,children:(0,N.jsxs)("div",{className:q.Z.modal_container,children:[(0,N.jsx)(d.default,{children:(0,N.jsxs)("div",{className:q.Z.modal_container_outer_header,children:[(0,N.jsx)("div",{className:q.Z.modal_container_header,children:(0,N.jsx)("h6",{children:g("collect_fees")})}),(0,N.jsx)("img",{src:"".concat(x.J7,"/close.svg"),alt:"close icon",onClick:n})]})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[(0,N.jsxs)("div",{className:q.Z.admission_fees_row,children:[(0,N.jsxs)("h6",{children:[g("applicable_amount")," :"]}),(0,N.jsxs)("h6",{children:[g("rs_only")," ",null!==j&&void 0!==j?j:0]})]}),(0,N.jsx)(D.Z,{label:g("amount"),placeholder:g("amoute_details_collect"),name:"amount",value:I.amount,type:"tel",onChange:e=>{k((t=>({...t,amount:+e.target.value,fee_payment_amount:+e.target.value}))),L((t=>({...t,amount:+e.target.value})))},errorShow:O.amount,msg:O.rest_issue}),(0,N.jsx)(E.Z,{paymentHeading:g("payment_type_mode"),selectLabel:g("mode_placeholder"),onClick:e=>{k((t=>({...t,mode:"Online",fee_payment_mode:e})))},errorShow:O.fee_payment_mode,defalutValue:I.fee_payment_mode,selectedValue:g("please_select_payment_mode"),isAuthority:f?"admissionCollectMode":"admissionCollectModePg",customLabelStyle:{marginTop:"0"}}),"Payment Gateway"===I.fee_payment_mode?(0,N.jsx)(u.Z,{label:"collect",onAction:()=>{let e=(0,G.l)({amount:T.amount});(0,G.x)(e)?null!==$&&void 0!==$&&$.institute?l&&a&&null!==r&&void 0!==r&&r._id&&!f&&L((e=>({...e,isTransaction:!0}))):R({open:!0,msg:"Online Payment Not Activated",variant:"error"}):w(e)}}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(M.Z,{label:g("select_date_of_transaction"),placeholder:g("please_select_date"),name:"transaction_date",value:I.transaction_date,onChange:e=>{k((t=>({...t,transaction_date:(0,Y.jh)(e)})))},errorShow:O.transaction_date}),"Cash"===I.fee_payment_mode?null:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(D.Z,{label:g("bank_name_collect"),placeholder:g("please_enter_bank_name"),name:"fee_bank_name",value:I.fee_bank_name,type:"text",onChange:K}),(0,N.jsx)(D.Z,{label:g("banke_holder_name"),placeholder:g("please_enter_name_of_bank_holder"),name:"fee_bank_holder",value:I.fee_bank_holder,type:"text",onChange:K}),(0,N.jsx)(D.Z,{label:g("cheque_dd_neft"),placeholder:g("please_enter_utr_ref_number"),name:"fee_utr_reference",value:I.fee_utr_reference,type:"text",onChange:K})]}),(0,N.jsx)(u.Z,{label:"collect",onAction:()=>{let e=(0,G.l)(I,["mode","fee_payment_amount","fee_bank_name","fee_bank_holder","fee_utr_reference"]);var t,o,d,s,c,u,v;(0,G.x)(e)&&null!==r&&void 0!==r&&r._id&&a?(S((e=>!e)),B({fid:l,bodyParameter:{ofid:a,sid:null===r||void 0===r?void 0:r._id,amount:null!==(t=null===I||void 0===I?void 0:I.amount)&&void 0!==t?t:0,mode:"Cash"===(null===I||void 0===I?void 0:I.fee_payment_mode)?"Offline":null!==(o=null===I||void 0===I?void 0:I.mode)&&void 0!==o?o:"",fee_payment_mode:"Cash"===(null===I||void 0===I?void 0:I.fee_payment_mode)?"By Cash":null===I||void 0===I?void 0:I.fee_payment_mode,fee_payment_amount:null!==(d=null===I||void 0===I?void 0:I.fee_payment_amount)&&void 0!==d?d:0,transaction_date:null!==(s=(0,Y._1)(I.transaction_date))&&void 0!==s?s:"",fee_bank_name:null!==(c=null===I||void 0===I?void 0:I.fee_bank_name)&&void 0!==c?c:"",fee_bank_holder:null!==(u=null===I||void 0===I?void 0:I.fee_bank_holder)&&void 0!==u?u:"",fee_utr_reference:null!==(v=null===I||void 0===I?void 0:I.fee_utr_reference)&&void 0!==v?v:"",staff_id:null!==p&&void 0!==p?p:"",cid:null!==y&&void 0!==y?y:""}}).then((()=>{i(),S((e=>!e)),n()})).catch({})):w(e)}})]})]})]})}),Z&&(0,N.jsx)(m.default,{}),(0,N.jsx)(A.Z,{eventState:F,eventStateHandler:R})]})};var B=n(89064);const K=e=>{let{ofid:t,onClose:n,menuData:l,onRefetch:i,feeReceiptId:o,isFee:a}=e;const{t:r}=(0,h.$G)(),[c,m]=(0,v.useState)(!1),[f,p]=(0,v.useState)({open:!1,msg:"",variant:"error"}),[y,j]=(0,v.useState)(""),[g,Z]=(0,v.useState)({query:""}),[b,S]=(0,v.useState)(!1),[C]=(0,_.M0)(),[I]=(0,_.dM)();return(0,N.jsxs)(N.Fragment,{children:[b?(0,N.jsx)(P.Z,{onClose:()=>S(!1),children:(0,N.jsxs)("div",{className:q.Z.modal_container,children:[(0,N.jsx)(d.default,{children:(0,N.jsxs)("div",{className:q.Z.modal_container_outer_header,children:[(0,N.jsx)("div",{className:q.Z.modal_container_header,children:(0,N.jsx)("h6",{children:r("are_your_sure_to_delete_fee_receipt")})}),(0,N.jsx)("img",{src:"".concat(x.J7,"/close.svg"),alt:"close icon",onClick:()=>S(!1)})]})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[(0,N.jsx)(D.Z,{label:r("type_confirm_to_continue"),placeholder:r("type_confirm_to_continue"),name:"query",value:g.query,type:"text",onChange:e=>{Z((t=>({...t,[e.target.name]:e.target.value})))},errorShow:y.query}),(0,N.jsx)(u.Z,{label:"confirm",onAction:()=>{let e=(0,G.l)(g);(0,G.x)(e)?"Confirm"===g.query&&o&&t&&(S(!1),m((e=>!e)),I({fid:o,ofid:t}).then((e=>{i(),m((e=>!e)),n()})).catch({})):j(e)}})]})]})}):(0,N.jsx)(B.Z,{onClose:n,disabled:c,children:a?(0,N.jsx)("h6",{onClick:()=>S(!0),children:r("delete")}):(0,N.jsx)("h6",{onClick:()=>{null!==l&&void 0!==l&&l._id&&t&&(m((e=>!e)),C({ofid:t,bodyParameter:{students:[null===l||void 0===l?void 0:l._id]}}).then((e=>{p({open:!0,msg:"Time out of request...",variant:"error"}),i(),m((e=>!e)),n()})).catch({}))},children:r("remove")})}),(0,N.jsx)(A.Z,{eventState:f,eventStateHandler:p})]})},z=e=>{var t,n,l,i,o,a,d,s;let{student:r,financeId:c,onRefetch:m,otherFeesId:_,instituteId:f,ofid:p,isCashierAccess:y,collectStaffId:j,cardId:g,cardAmount:Z}=e;const{t:b}=(0,h.$G)(),[S,I]=(0,v.useState)(""),[k,O]=(0,v.useState)({open:!1,msg:"",variant:"error"}),w=()=>{I("")};return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{className:L.Z.iadcc_card_hover,children:[(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner,children:[(0,N.jsx)("img",{src:null!==r&&void 0!==r&&r.studentProfilePhoto?"".concat(C.yI,"/").concat(r.studentProfilePhoto):"".concat(x.p3,"/feed-user-avatar.svg"),loading:"lazy",alt:"avatar",style:{width:"2.5rem",height:"2.5rem"}}),(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner_inner,children:[(0,N.jsx)("h6",{children:"".concat(null!==(t=null===r||void 0===r?void 0:r.studentFirstName)&&void 0!==t?t:""," ").concat(null!==(n=null===r||void 0===r?void 0:r.studentMiddleName)&&void 0!==n?n:""," ").concat(null!==(l=null===r||void 0===r?void 0:r.studentLastName)&&void 0!==l?l:"")}),(0,N.jsxs)("p",{children:[b("gr_number")," ",": ",null!==(i=null===r||void 0===r?void 0:r.studentGRNO)&&void 0!==i?i:""]})]})]}),"Paid"===(null===r||void 0===r||null===(o=r.other_fees_obj)||void 0===o?void 0:o.status)?(0,N.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner_inner,children:[(0,N.jsxs)("h6",{children:["Rs. ",null!==Z&&void 0!==Z?Z:0]}),(0,N.jsx)("p",{children:b("amount")})]}),(0,N.jsx)("div",{className:L.Z.sf_card_contatiner_inner,children:null!==r&&void 0!==r&&null!==(a=r.other_fees_obj)&&void 0!==a&&a.receipt_file?(0,N.jsx)("a",{href:"".concat(C.q2,"/").concat(null===r||void 0===r||null===(d=r.other_fees_obj)||void 0===d?void 0:d.receipt_file),target:"_blank",rel:"noopener noreferrer",children:(0,N.jsx)("img",{src:"".concat(x.J7,"/receipt.svg"),alt:"receipt icon",style:{height:"1.5rem"}})}):null}),(0,N.jsx)("img",{src:"".concat(x.J7,"/menu.svg"),alt:"menu icon",onClick:()=>I(3)})]}):(0,N.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem"},children:[(0,N.jsxs)("div",{className:L.Z.sf_card_contatiner_inner,children:[(0,N.jsxs)("h6",{children:["Rs. ",null!==Z&&void 0!==Z?Z:0]}),(0,N.jsx)("p",{children:b("amount")})]}),(0,N.jsx)(u.Z,{label:"collect_fees",onAction:()=>{"ALLOW"===y?I(1):O({msg:"You are not Cashier Manager",open:!0,variant:"error"})},customStyle:{margin:"0",padding:"0.4rem 1rem"}}),(0,N.jsx)("img",{src:"".concat(x.J7,"/menu.svg"),alt:"menu icon",onClick:e=>{I(2)}})]})]}),1===S?(0,N.jsx)($,{financeId:c,onClose:w,onRefetch:m,student:r,otherFeesId:_,instituteId:f,collectStaffId:j,cardId:g,cardAmount:Z}):2===S?(0,N.jsx)(K,{onClose:w,onRefetch:m,menuData:r,ofid:p}):3===S?(0,N.jsx)(K,{onClose:w,onRefetch:m,menuData:r,ofid:p,feeReceiptId:null===r||void 0===r||null===(s=r.other_fees_obj)||void 0===s?void 0:s.fee_receipt,isFee:!0}):null,(0,N.jsx)(A.Z,{eventState:k,eventStateHandler:O})]})},V=e=>{var t,n,l,o;let{ofid:a,instituteId:r,financeId:c,isCashierAccess:u,collectStaffId:g}=e;const{t:Z}=(0,h.$G)(),[b,S]=(0,v.useState)(""),[C,I]=(0,v.useState)(""),[k,O]=(0,v.useState)(1),[w,F]=(0,v.useState)(!0),[R,T]=(0,f.YD)({skip:b}),{financeOneOtherFeesStudentList:A,financeOneOtherFeesStudentListLoading:L,financeOneOtherFeesStudentListRefetch:P}=(0,_.Jo)({data:{ofid:a,page:k,limit:10,search:b,type:""},skip:!a});(0,v.useEffect)((()=>{T&&w&&O((e=>e+1))}),[T,w]),(0,v.useEffect)((()=>{var e;if(null!==A&&void 0!==A&&null!==(e=A.list)&&void 0!==e&&e.length){var t;let e=(0,p.f)(null===A||void 0===A||null===(t=A.list)||void 0===t?void 0:t.length);F((()=>e))}}),[null===A||void 0===A||null===(t=A.list)||void 0===t?void 0:t.length]);const q=(0,v.useCallback)((()=>{O((()=>1)),P()}),[]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(d.default,{children:(0,N.jsx)("div",{className:i.Z.fm_search_full,children:(0,N.jsx)("section",{className:i.Z.fm_search_full_container,children:(0,N.jsxs)("div",{className:i.Z.fm_search_full_container_inner,children:[(0,N.jsx)("img",{className:i.Z.fm_search_full_icon,alt:"search icon",src:"".concat(x.dB,"/navbar-search.svg")}),(0,N.jsx)("input",{type:"text",placeholder:Z("search"),onChange:e=>{var t;!L&&(null===A||void 0===A||null===(t=A.list)||void 0===t?void 0:t.length)>=0&&I(e.target.value)},onKeyUp:e=>{"Enter"===e.key&&(O((()=>1)),S(C))},value:C})]})})})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[null===A||void 0===A||null===(n=A.list)||void 0===n?void 0:n.map(((e,t)=>{var n,l,i;return(null===A||void 0===A||null===(n=A.list)||void 0===n?void 0:n.length)===t+1?(0,N.jsx)("div",{ref:R,children:(0,N.jsx)(z,{student:null===e||void 0===e?void 0:e.student,financeId:c,instituteId:r,otherFeesId:a,onRefetch:q,ofid:a,isCashierAccess:u,collectStaffId:g,cardId:null===e||void 0===e?void 0:e._id,cardAmount:null!==(l=null===e||void 0===e?void 0:e.price)&&void 0!==l?l:0})},"".concat(null===e||void 0===e?void 0:e._id).concat(t)):(0,N.jsx)(z,{student:null===e||void 0===e?void 0:e.student,financeId:c,instituteId:r,otherFeesId:a,onRefetch:q,ofid:a,isCashierAccess:u,collectStaffId:g,cardId:null===e||void 0===e?void 0:e._id,cardAmount:null!==(i=null===e||void 0===e?void 0:e.price)&&void 0!==i?i:0},"".concat(null===e||void 0===e?void 0:e._id).concat(t))})),L?b?(0,N.jsx)(m.default,{}):(0,N.jsx)(j.Z,{}):b?0===(null===A||void 0===A||null===(l=A.list)||void 0===l?void 0:l.length)&&(0,N.jsx)(y.Z,{title:"No receipts found related this search.",customStyleContainer:{marginTop:"1.5rem"}}):0===(null===A||void 0===A||null===(o=A.list)||void 0===o?void 0:o.length)&&(0,N.jsx)(y.Z,{title:"No receipts added.",customStyleContainer:{marginTop:"1.5rem"}})]})]})};var W=n(19056);const Q=e=>{let{onClose:t,ofid:n}=e;const{t:l}=(0,h.$G)(),i=(0,o.TH)(),a=(0,o.UO)(),r=(0,o.s0)(),[c,f]=(0,v.useState)({from:"",to:"",payment_type:""}),[p,y]=(0,v.useState)(!1),[j,g]=(0,v.useState)(""),[Z]=(0,_.DM)(),b=(e,t)=>{f((n=>({...n,[t]:(0,Y.O_)(e)})))};return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(P.Z,{onClose:t,children:(0,N.jsxs)("div",{className:q.Z.modal_container,children:[(0,N.jsx)(d.default,{children:(0,N.jsxs)("div",{className:q.Z.modal_container_outer_header,children:[(0,N.jsx)("div",{className:q.Z.modal_container_header,children:(0,N.jsx)("h6",{children:l("export")})}),(0,N.jsx)("img",{src:"".concat(x.J7,"/close.svg"),alt:"close icon",onClick:t})]})}),(0,N.jsx)(s.Z,{}),(0,N.jsxs)(d.default,{customStyle:{paddingTop:"0"},children:[(0,N.jsx)(M.Z,{label:l("from"),placeholder:l("please_select_from_date"),name:"from",value:c.from?(0,Y.jh)(c.from):"",onChange:e=>b(e,"from"),errorShow:j.from}),(0,N.jsx)(M.Z,{label:l("to_only"),placeholder:l("please_select_to_date"),name:"to",value:c.to?(0,Y.jh)(c.to):"",onChange:e=>b(e,"to"),errorShow:j.to}),(0,N.jsx)(W.Z,{selectLabel:l("payment_type"),selectedValue:l("please_select_payment_type"),options:["Payment Gateway / Online","By Cash","Total"],onClick:e=>{f((t=>({...t,payment_type:e})))},defalutValue:c.payment_type,errorShow:j.payment_type}),(0,N.jsx)(u.Z,{label:"export",onAction:()=>{let e=(0,G.l)(c,[]);(0,G.x)(e)&&n?(y((e=>!e)),Z({ofid:n,bodyParameter:{from:c.from,to:c.to,payment_type:c.payment_type}}).then((()=>{var e;y((e=>!e));let t="Institute"===(null===(e=i.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(a.username,"/institute/member/finance?type=export"):"/q/".concat(a.username,"/member/staff/finance?type=export");r(t,{state:i.state})})).catch({})):g(e)}})]}),p&&(0,N.jsx)(m.default,{})]})})})},X=e=>{var t,n,f,p,y,j,g,Z,b,S,C,I,k,L,P,q,D,M,Y,E,G;let{fid:J,instituteId:H,cashAuthority:U}=e;const{t:$}=(0,h.$G)(),B=(0,o.TH)(),K=(0,o.UO)(),z=(0,o.s0)(),[W]=(0,a.lr)(),[X,te]=(0,v.useState)(!1),[ne,le]=(0,v.useState)(""),[ie,oe]=(0,v.useState)(null),[ae,de]=(0,v.useState)([]),[se,re]=(0,v.useState)({open:!1,msg:"",variant:"error"}),[ce]=(0,_.UG)(),[ue]=(0,_.YC)(),[ve]=(0,_.zY)(),{financeOneOtherFeesStudentList:me,financeOneOtherFeesStudentListRefetch:_e}=(0,_.Jo)({data:{ofid:null===(t=B.state)||void 0===t?void 0:t.feesId,page:1,limit:10,search:"",type:""},skip:!(null!==(n=B.state)&&void 0!==n&&n.feesId)}),{financeOtherOneFeesTransaction:he,financeOtherOneFeesTransactionRefetch:fe}=(0,_.ok)({data:{uid:H,page:1,limit:10,search:"",filter:"",ofid:null===(f=B.state)||void 0===f?void 0:f.feesId},skip:H?!(null!==(p=B.state)&&void 0!==p&&p.feesId):!H}),pe=()=>{le("")},xe=(0,v.useCallback)((()=>{var e;let t="";t="Institute"===(null===(e=B.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(K.username,"/institute/member/finance?type=other-fees"):"/q/".concat(K.username,"/member/staff/finance?type=other-fees"),z(t,{state:B.state})}),[z,B.state,K.username]);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)(l.default,{children:[(0,N.jsx)(d.default,{children:(0,N.jsxs)("div",{className:i.Z.fm_header_container,children:[(0,N.jsxs)("div",{className:i.Z.fm_header_start_container,style:{gap:"0.2rem"},children:[(0,N.jsx)("img",{alt:"search icon",src:"".concat(x.Fk,"/back.svg"),style:{height:"2rem",width:"2rem"},onClick:xe}),(0,N.jsxs)("h6",{children:[null!==(y=null===(j=B.state)||void 0===j?void 0:j.feesName)&&void 0!==y?y:""," ","(",(0,N.jsx)("span",{style:{color:"#00f"},children:null===(g=B.state)||void 0===g||null===(Z=g.otherData)||void 0===Z?void 0:Z.paid}),"/",null===(b=B.state)||void 0===b||null===(S=b.otherData)||void 0===S?void 0:S.rmaining,")"]})]}),(0,N.jsxs)("div",{className:i.Z.fm_header_start_container,children:[(0,N.jsx)(u.Z,{label:"add_single_student",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{var e;null!==U&&void 0!==U&&U.includes(null===B||void 0===B||null===(e=B.state)||void 0===e?void 0:e.sid)?le(4):re({msg:"You are not Cashier Manager",open:!0,variant:"error"})}}),(0,N.jsx)(u.Z,{label:"add_student",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{le(3)}}),(0,N.jsx)(u.Z,{label:"add_non_existing_student",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{var e;null!==U&&void 0!==U&&U.includes(null===B||void 0===B||null===(e=B.state)||void 0===e?void 0:e.sid)?le(1):re({msg:"You are not Cashier Manager",open:!0,variant:"error"})}}),(0,N.jsx)(u.Z,{label:"export",customStyle:{margin:"0",padding:"0.4rem 0.5rem",width:"fit-content"},onAction:()=>{le(7)}})]})]})}),(0,N.jsx)(s.Z,{}),(0,N.jsx)(r.Z,{children:ee.map((e=>{var t,n;return(0,N.jsx)(c.Z,{tab:e,isLink:!0,isActive:null===(t=e.groupIs)||void 0===t?void 0:t.includes(W.get("n")),parentState:B.state,url:"Institute"===(null===(n=B.state)||void 0===n?void 0:n.urlOffSet)?"/q/".concat(K.username,"/institute/member/finance?type=other-fees-detail").concat(e.urlKey):"/q/".concat(K.username,"/member/staff/finance?type=other-fees-detail").concat(e.urlKey)},null===e||void 0===e?void 0:e.id)}))}),(0,N.jsx)(s.Z,{customStyleBorder:{marginTop:"0"}}),"receipt"===W.get("n")?(0,N.jsx)(V,{ofid:null===(C=B.state)||void 0===C?void 0:C.feesId,instituteId:H,financeId:J,isCashierAccess:null!==U&&void 0!==U&&U.includes(null===B||void 0===B||null===(I=B.state)||void 0===I?void 0:I.sid)?"ALLOW":"DENY",collectStaffId:null===B||void 0===B||null===(k=B.state)||void 0===k?void 0:k.sid}):(0,N.jsx)(O,{ofid:null===(L=B.state)||void 0===L?void 0:L.feesId,instituteId:H})]}),X&&(0,N.jsx)(m.default,{}),1===ne?(0,N.jsx)(w.Z,{onClose:pe,singleStudent:ie,onNext:e=>{oe(e),le(2)}}):2===ne?(0,N.jsx)(F.Z,{onClose:()=>le(1),onParentClose:()=>{},instituteId:H,onGrabCollectFees:e=>{var t,n,l,i;J&&null!==ie&&void 0!==ie&&ie.student_name&&null!==(t=B.state)&&void 0!==t&&t.feesId&&(te((e=>!e)),ce({fid:J,bodyParameter:{...ie,ofid:null===(n=B.state)||void 0===n?void 0:n.feesId,...e,staff_id:null!==(l=null===B||void 0===B||null===(i=B.state)||void 0===i?void 0:i.sid)&&void 0!==l?l:""}}).then((()=>{oe(null),te((e=>!e)),pe()})).catch({}))},singleStudent:ie,isOtherFees:"OTHER_FEES",isNonExisting:!0,applicant:{head:null===(P=B.state)||void 0===P||null===(q=P.otherData)||void 0===q?void 0:q.payable_amount}}):3===ne?(0,N.jsx)(R.Z,{title:$("select_student"),onClose:pe,instituteId:H,isMultiSelect:!0,onMultiSelect:e=>{null!==ae&&void 0!==ae&&ae.includes(null===e||void 0===e?void 0:e._id)?de((t=>null===t||void 0===t?void 0:t.filter((t=>t!==(null===e||void 0===e?void 0:e._id))))):de((t=>[...t,null===e||void 0===e?void 0:e._id]))},onDone:()=>{var e,t;J&&(null===ae||void 0===ae?void 0:ae.length)>0&&null!==(e=B.state)&&void 0!==e&&e.feesId&&(te((e=>!e)),ue({fid:J,bodyParameter:{students:ae,ofid:null===(t=B.state)||void 0===t?void 0:t.feesId}}).then((()=>{_e(),te((e=>!e)),pe(),de([]),oe(null)})).catch({}))},selectList:ae,buttonTitle:"add",isSearchOnly:!0}):4===ne?(0,N.jsx)(R.Z,{title:$("select_student"),onClose:pe,instituteId:H,onSelectStudent:e=>{oe(e),le(5)},selectedId:null===ie||void 0===ie?void 0:ie._id,isSearchOnly:!0}):5===ne?(0,N.jsx)(F.Z,{onClose:pe,onParentClose:()=>{},instituteId:H,onGrabCollectFees:e=>{var t,n,l,i;J&&null!==ie&&void 0!==ie&&ie._id&&null!==(t=B.state)&&void 0!==t&&t.feesId&&(te((e=>!e)),ve({fid:J,bodyParameter:{students:[null===ie||void 0===ie?void 0:ie._id],ofid:null===(n=B.state)||void 0===n?void 0:n.feesId,...e,staff_id:null!==(l=null===B||void 0===B||null===(i=B.state)||void 0===i?void 0:i.sid)&&void 0!==l?l:""}}).then((e=>{le(6),te((e=>!e))})).catch({}))},singleStudent:ie,isOtherFees:"OTHER_FEES",applicant:{head:null===(D=B.state)||void 0===D||null===(M=D.otherData)||void 0===M?void 0:M.payable_amount},ofid:null===(Y=B.state)||void 0===Y?void 0:Y.feesId,financeId:J}):6===ne?(0,N.jsx)(T.Z,{applicant:ie,onClose:()=>{oe(null),pe()},ofid:null===(E=B.state)||void 0===E?void 0:E.feesId}):7===ne?(0,N.jsx)(Q,{onClose:pe,ofid:null===(G=B.state)||void 0===G?void 0:G.feesId}):null,(0,N.jsx)(A.Z,{eventState:se,eventStateHandler:re})]})},ee=[{label:"transaction",id:"transaction",urlKey:"",groupIs:["",null]},{label:"receipt",id:"receipt",urlKey:"&n=receipt",groupIs:["receipt"]}]}}]);
//# sourceMappingURL=83116.fd724ef0.chunk.js.map