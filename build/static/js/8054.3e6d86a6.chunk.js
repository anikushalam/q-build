"use strict";(self.webpackChunkmithkal_qviple=self.webpackChunkmithkal_qviple||[]).push([[8054],{68054:function(e,l,i){i.d(l,{Z:function(){return $}});var n=i(29439),t=i(72791),s=i(39230),a=i(98684),o=i(48293),r=i(21348),c="ExcelImport_mc__7QTcg",d="ExcelImport_mc_outer_header__M6u69",u="ExcelImport_mc_header__YQP2Z",m="ExcelImport_mc_step__z7AVn",v="ExcelImport_mcs_inner__fa27Q",_="ExcelImport_mcs_progress__7k+ck",p="ExcelImport_mcs_circle__jA7Om",f="ExcelImport_mcs_line__HaPNQ",h="ExcelImport_mcuy_file__lntGX",x="ExcelImport_mcf_card__0hIVi",g="ExcelImport_mcf_container__G6TWw",j="ExcelImport_mcf_card_paragraph__rXmdN",y="ExcelImport_mcfc_sample__76p69",Z="ExcelImport_mcf_drag_area__qGi6B",b="ExcelImport_mc_excel_container__aSE+1",N="ExcelImport_mc_heading__XsMPY",S="ExcelImport_mc_content__Pkj6a",k="ExcelImport_mcc_inner__WM9qB",E=i(80184),C=function(e){var l=e.onClose,i=e.step,n=e.children,t=(0,s.$G)().t;return(0,E.jsx)(o.Z,{onClose:l,customOverlayStyle:{width:"80%"},children:(0,E.jsxs)("div",{className:c,children:[(0,E.jsxs)(r.Z,{children:[(0,E.jsxs)("div",{className:d,children:[(0,E.jsx)("div",{className:u}),(0,E.jsx)("img",{src:"".concat(a.J7,"/close.svg"),alt:"close icon",onClick:l})]}),(0,E.jsxs)("div",{className:m,children:[(0,E.jsxs)("div",{className:v,children:[(0,E.jsx)("h6",{children:t("upload_file")}),(0,E.jsxs)("div",{className:_,children:[(0,E.jsx)("div",{className:p,style:{"--mcs-circle-bg":1===i?"#459ffc":"#bbdcfe"}}),(0,E.jsx)("div",{className:f,style:{"--mcs-circle-bg":1===i?"#459ffc":"#bbdcfe"}})]})]}),(0,E.jsxs)("div",{className:v,children:[(0,E.jsx)("h6",{children:t("review_mapping")}),(0,E.jsxs)("div",{className:_,children:[(0,E.jsx)("div",{className:p,style:{"--mcs-circle-bg":1===i?"#459ffc":"#bbdcfe"}}),(0,E.jsx)("div",{className:f,style:{"--mcs-circle-bg":2===i?"#459ffc":"#bbdcfe"}})]})]}),(0,E.jsxs)("div",{className:v,children:[(0,E.jsx)("h6",{children:t("finalize_import")}),(0,E.jsxs)("div",{className:_,children:[(0,E.jsx)("div",{className:p,style:{"--mcs-circle-bg":2===i?"#459ffc":"#bbdcfe"}}),(0,E.jsx)("div",{className:f,style:{"--mcs-circle-bg":"#459ffc",width:"0"}})]})]})]})]}),n]})})},I=i(44226),w=i(93638),q=function(e){var l=e.setFile,i=e.setStep,o=(0,s.$G)().t,r=(0,t.useState)(!1),c=(0,n.Z)(r,2),d=c[0],u=c[1],m=(0,t.useRef)(null),v=function(e){e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?u(!0):"dragleave"===e.type&&u(!1)},_=function(e){e.preventDefault(),e.target.files&&e.target.files[0]&&(l(e.target.files[0]),i(1))};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)("h2",{className:h,children:o("upload_your_file")}),(0,E.jsx)("div",{className:x,children:(0,E.jsxs)("form",{onDragEnter:v,onSubmit:function(e){return e.preventDefault()},onPaste:function(e){e.clipboardData.files.length&&(l(e.clipboardData.files[0]),i(1))},className:g,children:[(0,E.jsx)(I.Z,{onExcelFileUpload:_,assestUrl:"".concat(a.J7,"/xsxl.svg")}),(0,E.jsx)(w.Z,{label:o("upload_file"),onAction:function(){m.current.click()},customStyle:{margin:"0",marginTop:"0.5rem",padding:"0.2rem 0.8rem",fontWeight:"400",fontSize:"13px"}}),(0,E.jsx)("input",{ref:m,type:"file",id:"excel_grab_file",multiple:!1,onChange:_,style:{display:"none"}}),(0,E.jsx)("label",{id:"label-file-upload",htmlFor:"excel_grab_file",className:d?"drag-active":"",style:{height:"auto"},children:(0,E.jsx)("p",{className:j,style:{marginTop:"1rem"},children:"or drag and drop it here"})}),(0,E.jsx)("div",{className:j,children:"or paste a file"}),d&&(0,E.jsx)("div",{onDragEnter:v,onDragLeave:v,onDragOver:v,onDrop:function(e){e.preventDefault(),e.stopPropagation(),u(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&(l(e.dataTransfer.files[0]),i(1))},className:Z}),(0,E.jsx)("div",{className:y,children:o("download_a_sample")})]})})]})},R=(0,t.memo)(q),F=i(4942),D=i(1413),T=i(93433),L=i(74165),P=i(15861),V=i(34045),G=i(52245),A=function(e){var l=e.selectLabel,i=e.onClick,o=e.selectedValue,r=e.options,c=e.customStyleContainer,d=e.customLabelStyle,u=e.customListStyle,m=e.errorShow,v=e.defalutValue,_=e.isDenied,p=e.customStyleArea,f=(0,s.$G)().t,h=(0,t.useState)(!1),x=(0,n.Z)(h,2),g=x[0],j=x[1],y=(0,t.useState)(""),Z=(0,n.Z)(y,2),b=Z[0],N=Z[1],S=(0,t.useState)(null!==r&&void 0!==r?r:[]),k=(0,n.Z)(S,2),C=k[0],I=k[1];(0,t.useEffect)((function(){null!==r&&void 0!==r&&r.length&&I(r)}),[null===r||void 0===r?void 0:r.length]);var w=function(){_||j((function(e){return!e}))};(0,t.useEffect)((function(){v&&N(v)}),[v]);var q=function(e){i(e),w(),null!==e&&void 0!==e&&e.name?N(null===e||void 0===e?void 0:e.name):N(e)};return(0,E.jsxs)("div",{className:G.Z.form_input_container,style:c,children:[(0,E.jsxs)("p",{className:G.Z.join_form_select_paragraph,style:d,children:[l,m&&(0,E.jsxs)("span",{style:{color:"red",marginLeft:"15px"},children:["* ",f("form_require_label")]})]}),(0,E.jsxs)("section",{className:G.Z.join_form_select_custom,onClick:w,style:p,children:[b?(0,E.jsx)("p",{className:G.Z.join_form_select_custom_paragraph,children:null!==b&&void 0!==b?b:""}):(0,E.jsx)("p",{className:G.Z.join_form_select_custom_paragraph,children:o}),g?(0,E.jsx)("img",{className:G.Z.join_form_select_custom_rotate_icon,src:"".concat(a.J7,"/down.svg"),alt:"categor icon"}):(0,E.jsx)("img",{className:G.Z.join_form_select_custom_icon,src:"".concat(a.J7,"/down.svg"),alt:"categor icon"})]}),g&&(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("section",{className:G.Z.jfscl_option_list,style:u,children:[(0,E.jsxs)("div",{className:G.Z.jfsclol_search_container,children:[(0,E.jsx)("input",{type:"text",placeholder:f("search"),className:G.Z.jfsclolsc_input,onChange:function(e){if(e.target.value){var l=K(r,e.target.value);I(l)}else I(r)}}),(0,E.jsx)("img",{src:"".concat(a.dB,"/navbar-search.svg"),alt:"search icon"})]}),null===C||void 0===C?void 0:C.map((function(e,l){var i;return(0,E.jsxs)("p",{onClick:function(){return q(e)},className:G.Z.join_form_select_custom_paragraph_option,children:[null!==(i=null===e||void 0===e?void 0:e.name)&&void 0!==i?i:e,null!==e&&void 0!==e&&e.isRequired?(0,E.jsxs)("span",{style:{color:"red"},children:[" ","*"]}):null]},l)})),0===(null===C||void 0===C?void 0:C.length)?(0,E.jsx)("p",{className:G.Z.join_form_select_custom_paragraph_option,children:f("no_results_found")}):""]})})]})},K=function(e,l){return null===e||void 0===e?void 0:e.filter((function(e){var i,n;return null!==e&&void 0!==e&&null!==(i=e.name)&&void 0!==i&&null!==(n=i.toLowerCase())&&void 0!==n&&n.includes(null===l||void 0===l?void 0:l.toLowerCase())?e:null}))},M=i(23984),O=[{name:"Topic",Topic:"chapter_name",isRequired:!0},{name:"SubTopic",SubTopic:"topic_name",isRequired:!0},{name:"CourseOutcome",CourseOutcome:"course_outcome",isRequired:!1},{name:"LearningOutcome",LearningOutcome:"learning_outcome",isRequired:!1},{name:"Hours",Hours:"hours",isRequired:!1},{name:"Minutes",Minutes:"minutes",isRequired:!1},{name:"PlanningDate",PlanningDate:"planning_date",isRequired:!1},{name:"ExecutionDate",ExecutionDate:"execution_date",isRequired:!1}],U=function(e){var l=e.grabFile,i=(e.setStep,e.setKeyCount),o=e.onImportFileInSystem,c=(e.keyCount,(0,s.$G)().t),d=(0,t.useState)(null!==l&&void 0!==l?l:""),u=(0,n.Z)(d,2),m=u[0],v=u[1],_=(0,t.useState)([]),p=(0,n.Z)(_,2),f=p[0],x=p[1],g=(0,t.useState)({}),j=(0,n.Z)(g,2),y=j[0],Z=j[1],C=(0,t.useState)({}),I=(0,n.Z)(C,2),q=I[0],R=I[1],G=(0,t.useState)(O),K=(0,n.Z)(G,2),U=K[0],J=K[1],$=(0,t.useState)(null!==l&&void 0!==l?l:""),B=(0,n.Z)($,2),Q=B[0],z=B[1];(0,t.useEffect)((function(){l&&H(l)}),[l]);var H=function(){var e=(0,P.Z)((0,L.Z)().mark((function e(l){var i,n,t,s,a,o,r,c,d,u;return(0,L.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l,e.next=3,n.arrayBuffer();case 3:t=e.sent,s=(0,V.ij)(t),a=s.Sheets[null===(i=s.SheetNames)||void 0===i?void 0:i[0]],o=V.P6.sheet_to_json(a,{raw:!1}),r=[],c=0;case 9:if(!(c<(null===o||void 0===o?void 0:o.length))){e.next=15;break}for(d in o[c])u=o[c][d],0===c&&r.push({title:d,firstValue:u,isMapped:!1,mappedKey:"",isRequired:!1});return e.abrupt("break",15);case 12:c++,e.next=9;break;case 15:v(o),x(r);case 17:case"end":return e.stop()}}),e)})));return function(l){return e.apply(this,arguments)}}();return console.info("deSelectColumn",Q),(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)(r.Z,{children:[(0,E.jsx)("h2",{className:h,children:c("review_the_mapping_of_your_fields")}),(0,E.jsxs)("div",{className:b,children:[(0,E.jsxs)("div",{className:N,children:[(0,E.jsx)("h6",{style:{"--mc-width":"4rem"},children:c("import")}),(0,E.jsx)("h6",{style:{"--mc-width":"25rem",textAlign:"left"},children:c("xslx_column")}),(0,E.jsx)("h6",{style:{"--mc-width":"5rem"},children:c("mapped")}),(0,E.jsx)("h6",{style:{"--mc-width":"15rem",marginRight:"1rem"},children:c("suite_field")})]}),null===f||void 0===f?void 0:f.map((function(e){var l,i;return(0,E.jsxs)("section",{className:S,children:[(0,E.jsx)("h6",{style:{"--mc-width":"4rem",opacity:q[null===e||void 0===e?void 0:e.title]?"1":"0.5"},children:(0,E.jsx)("img",{src:q[null===e||void 0===e?void 0:e.title]?"".concat(a.U_,"/check.svg"):"".concat(a.U_,"/uncheck.svg"),alt:"icon",style:{height:"1.3rem",borderRadius:"0",cursor:"pointer"},onClick:function(){return l=null===e||void 0===e?void 0:e.title,void(y[l]&&!y[l].isRequired&&R((function(e){return(0,D.Z)((0,D.Z)({},e),{},(0,F.Z)({},l,!e[l]))})));var l}})}),(0,E.jsxs)("div",{style:{"--mc-width":"25rem",opacity:q[null===e||void 0===e?void 0:e.title]?"1":"0.5"},className:k,children:[(0,E.jsx)("h6",{children:null===e||void 0===e?void 0:e.title}),(0,E.jsxs)("p",{children:[null===e||void 0===e||null===(l=e.firstValue)||void 0===l?void 0:l.substring(0,70),(null===e||void 0===e||null===(i=e.firstValue)||void 0===i?void 0:i.length)>70?"...":""]})]}),(0,E.jsx)("h6",{style:{"--mc-width":"5rem",opacity:q[null===e||void 0===e?void 0:e.title]?"1":"0.5"},children:(0,E.jsx)("img",{src:null!==e&&void 0!==e&&e.mappedKey?"".concat(a.Fk,"/complete.svg"):"".concat(a.Fk,"/radio-grey.svg"),alt:"icon",style:{height:"1.3rem",borderRadius:"0"}})}),(0,E.jsx)(A,{selectedValue:c("select_a_field"),customStyleContainer:{width:"15rem",marginRight:"1rem"},customStyleArea:null!==e&&void 0!==e&&e.isRequired?{border:"0.5px solid red"}:{},options:U,onClick:function(l){return function(e,l){for(var i,n=(0,T.Z)(f),t=0;t<(null===n||void 0===n?void 0:n.length);t++){var s;if((null===(s=n[t])||void 0===s?void 0:s.title)===e){n[t].mappedKey=null===l||void 0===l?void 0:l.name,n[t].isMapped=!0,n[t].isRequired=null===l||void 0===l?void 0:l.isRequired;break}}x(n),Z((function(i){var n;return(0,D.Z)((0,D.Z)({},i),{},(0,F.Z)({},e,(n={name:null===l||void 0===l?void 0:l.name},(0,F.Z)(n,null===l||void 0===l?void 0:l.name,l[null===l||void 0===l?void 0:l.name]),(0,F.Z)(n,"isRequired",null===l||void 0===l?void 0:l.isRequired),n)))})),R((function(l){return(0,D.Z)((0,D.Z)({},l),{},(0,F.Z)({},e,!0))}));for(var a=(0,D.Z)((0,D.Z)({},y),{},(0,F.Z)({},e,(i={name:null===l||void 0===l?void 0:l.name},(0,F.Z)(i,null===l||void 0===l?void 0:l.name,l[null===l||void 0===l?void 0:l.name]),(0,F.Z)(i,"isRequired",null===l||void 0===l?void 0:l.isRequired),i))),o=[],r=0,c=O;r<c.length;r++){var d=c[r],u=!1;for(var m in a){var v;if((null===(v=a[m])||void 0===v?void 0:v.name)===(null===d||void 0===d?void 0:d.name)){u=!0;break}}u||o.push(d)}J((function(e){return o}))}(null===e||void 0===e?void 0:e.title,l)},defalutValue:null===e||void 0===e?void 0:e.mappedKey,customListStyle:{opacity:"1"}})]},"key".concat(null===e||void 0===e?void 0:e.title))}))]}),(0,E.jsx)(M.Z,{customStyle:{justifyContent:"center"},children:(0,E.jsx)(w.Z,{label:c("next"),onAction:function(){for(var e=(0,T.Z)(m),l=[],n=0,t=0;t<(null===e||void 0===e?void 0:e.length);t++){var s=0,a=0,r={};for(var c in e[t]){var d,u,v,_=e[t][c];if(null!==(d=y[c])&&void 0!==d&&d.name)r["key".concat(s)]={value:_,fomat_key:null===(u=y[c])||void 0===u?void 0:u.name,excel_key:c,db_key:y[c][null===(v=y[c])||void 0===v?void 0:v.name]},++a;++s}0===t&&(i(a),n=a),l.push(r)}z(l),o(l,n)},customStyle:{width:"fit-content",paddingInline:"2rem"}})})]})})},J=(0,t.memo)(U),$=function(e){var l=e.onClose,i=e.onImportFileInSystem,s=(0,t.useState)(0),a=(0,n.Z)(s,2),o=a[0],r=a[1],c=(0,t.useState)(""),d=(0,n.Z)(c,2),u=d[0],m=d[1],v=(0,t.useState)(0),_=(0,n.Z)(v,2),p=_[0],f=_[1];return(0,E.jsx)(C,{onClose:l,step:o,children:0===o?(0,E.jsx)(R,{setFile:m,file:u,setStep:r}):1===o?(0,E.jsx)(J,{grabFile:u,setStep:r,setKeyCount:f,onImportFileInSystem:i,keyCount:p}):null})}},44226:function(e,l,i){var n=i(39230),t=i(98684),s=i(80476),a=i(80184);l.Z=function(e){var l=e.onExcelFileUpload,i=e.acceptType,o=e.label,r=e.dynamicKey,c=e.title,d=e.assestUrl,u=(0,n.$G)().t;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("label",{className:s.Z.upload_excel_file,htmlFor:null!==r&&void 0!==r?r:"uploadExcel",children:[(0,a.jsx)("img",{src:d||"".concat(t.J7,"/upload-xslx.svg"),alt:"add student icon",title:null!==c&&void 0!==c?c:"Upload excel file"}),o&&(0,a.jsx)("h6",{children:u(o)})]}),(0,a.jsx)("input",{type:"file",id:null!==r&&void 0!==r?r:"uploadExcel",accept:i,onChange:l,style:{display:"none"}})]})}}}]);
//# sourceMappingURL=8054.3e6d86a6.chunk.js.map