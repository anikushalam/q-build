(self.webpackChunkmithkal_qviple=self.webpackChunkmithkal_qviple||[]).push([[10509],{10509:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>A});var i=n(63687),s=n(39230),l=n(56959),d=n(90904),o=n(21348),a=n(98684),r=n(72791),c=n(43504),u=n(16871),v=n(98967),_=n(63162),f=n(23441),m=n(57588),h=n(91427),p=n(43317),x=n(55336),j=n(1669),g=n(2651),y=n(3773),N=n(1095),Z=n(80184);const M=e=>{var t,n,i,l,d,o,r,c,v,_,f,m,h;let{history:p}=e;const{t:x}=(0,s.$G)(),j=(0,u.UO)(),g=(0,u.s0)();return(0,Z.jsxs)("div",{className:y.Z.pending_fees_card,onClick:()=>{var e;g("/q/".concat(j.username,"/member/student/admission/profile"),{state:{sid:null===p||void 0===p||null===(e=p.student)||void 0===e?void 0:e._id,viewAs:"ADMISSION_ADMIN",collectAccess:"ADMISSION_ADMIN"}})},title:"Refund student fees",children:[(0,Z.jsxs)("div",{className:y.Z.pending_fees_card_container,children:[(0,Z.jsx)("img",{alt:"Student Avatar",src:null!==p&&void 0!==p&&null!==(t=p.student)&&void 0!==t&&t.studentProfilePhoto?"".concat(N.yI,"/").concat(null===p||void 0===p||null===(n=p.student)||void 0===n?void 0:n.studentProfilePhoto):"".concat(a.p3,"/feed-user-avatar.svg"),loading:"lazy"}),(0,Z.jsxs)("div",{className:y.Z.pending_fees_card_inner,children:[(0,Z.jsx)("h6",{children:"".concat(null===p||void 0===p||null===(i=p.student)||void 0===i?void 0:i.studentFirstName," ").concat(null!==p&&void 0!==p&&null!==(l=p.student)&&void 0!==l&&l.studentMiddleName?null===p||void 0===p||null===(d=p.student)||void 0===d?void 0:d.studentMiddleName:""," ").concat(null===p||void 0===p||null===(o=p.student)||void 0===o?void 0:o.studentLastName)}),(0,Z.jsxs)("p",{children:[x("gr_number")," : ",null!==(r=null===p||void 0===p||null===(c=p.student)||void 0===c?void 0:c.studentGRNO)&&void 0!==r?r:"",null!==p&&void 0!==p&&null!==(v=p.student)&&void 0!==v&&null!==(_=v.department)&&void 0!==_&&_.dName?", ".concat(null===p||void 0===p||null===(f=p.student)||void 0===f||null===(m=f.department)||void 0===m?void 0:m.dName):""]})]})]}),(0,Z.jsxs)("div",{className:y.Z.pending_fees_card_inner,children:[(0,Z.jsxs)("h6",{children:[x("rs_only")," ",null!==(h=null===p||void 0===p?void 0:p.refund)&&void 0!==h?h:0]}),(0,Z.jsx)("p",{children:x("excess_fees")})]})]})},b=e=>{var t,n,i;let{aid:d,totalRefund:o}=e;const{t:c}=(0,s.$G)(),[u,v]=(0,r.useState)(""),[_,y]=(0,r.useState)(1),[N,b]=(0,r.useState)(!0),[L,S]=(0,f.YD)({skip:u}),{admissionExcessFeeNotRefundedList:Y,admissionExcessFeeNotRefundedListLoading:w}=(0,p.ye)({data:{aid:d,page:_,limit:10,search:u},skip:!d});(0,r.useEffect)((()=>{S&&N&&y((e=>e+1))}),[S,N]),(0,r.useEffect)((()=>{var e;if(null!==Y&&void 0!==Y&&null!==(e=Y.list)&&void 0!==e&&e.length){var t;let e=(0,h.f)(null===Y||void 0===Y||null===(t=Y.list)||void 0===t?void 0:t.length);b((()=>e))}}),[null===Y||void 0===Y?void 0:Y.list]);const R=(0,r.useCallback)((0,m.J)((e=>{y((()=>1)),v(e)}),1500),[]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:l.Z.fm_header_container,children:[(0,Z.jsxs)("h6",{children:[c("total_refund_amount")," "," : "," ",c("rs_only")," ",null!==o&&void 0!==o?o:0]}),(0,Z.jsx)("div",{className:l.Z.fm_search,children:(0,Z.jsx)("section",{className:l.Z.fm_search_container,children:(0,Z.jsxs)("div",{className:l.Z.fm_search_container_inner,children:[(0,Z.jsx)("img",{className:l.Z.fm_search_icon,alt:"search icon",src:"".concat(a.dB,"/navbar-search.svg")}),(0,Z.jsx)("input",{type:"text",placeholder:c("search"),onChange:e=>{e.target.value?R(e.target.value):(y((()=>1)),v(""))}})]})})})]}),null===Y||void 0===Y||null===(t=Y.list)||void 0===t?void 0:t.map(((e,t)=>{var n;return(null===Y||void 0===Y||null===(n=Y.list)||void 0===n?void 0:n.length)===t+1?(0,Z.jsx)("div",{ref:L,children:(0,Z.jsx)(M,{history:e})},null===e||void 0===e?void 0:e._id):(0,Z.jsx)(M,{history:e},null===e||void 0===e?void 0:e._id)})),w?u?(0,Z.jsx)(x.Z,{}):(0,Z.jsx)(j.Z,{}):u?0===(null===Y||void 0===Y||null===(n=Y.list)||void 0===n?void 0:n.length)&&(0,Z.jsx)(g.Z,{title:"No students found related this search."}):0===(null===Y||void 0===Y||null===(i=Y.list)||void 0===i?void 0:i.length)&&(0,Z.jsx)(g.Z,{title:"No students."})]})};var L=n(76697),S=n(97892),Y=n.n(S),w=n(82824),R=n(6758),D=n(37782);const I=e=>{let{history:t}=e;const[i,s]=(0,r.useState)(""),[l,d]=(0,r.useState)(!1),[o,c]=(0,r.useState)(""),{financeReceipt:u,financeReceiptRefetch:v}=(0,R.Nw)({rid:i,skip:!i});(0,r.useEffect)((()=>{i&&v()}),[i,v]),(0,r.useEffect)((()=>{null!==u&&void 0!==u&&u.receipt&&null!==u&&void 0!==u&&u.all_remain&&c(u)}),[u]),(0,r.useEffect)((()=>{if(o){const e=new Worker(new URL(n.p+n.u(4942),n.b)),{institute:t,studentInfo:i,paymentReceiptInfo:s}=(0,D.Hs)(null===o||void 0===o?void 0:o.all_remain,null===o||void 0===o?void 0:o.receipt);e.postMessage({institute:t,studentInfo:i,paymentReceiptInfo:s,printReceiptType:"Refunded"===(null===s||void 0===s?void 0:s.transactonRefund)?"ADMISSION_REFUND":"ADMISSION"}),e.onmessage=t=>{t&&(window.open(t.data,"_blank"),d((e=>!e)),c(""),e.terminate())}}}),[o]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("img",{src:"".concat(a.J7,"/receipt.svg"),alt:"receipt icon",title:"Download Fees Receipt",onClick:()=>{var e,n,l;null!==t&&void 0!==t&&null!==(e=t.fee_receipt)&&void 0!==e&&e._id&&(d((e=>!e)),s(null===t||void 0===t||null===(n=t.fee_receipt)||void 0===n?void 0:n._id),i===(null===t||void 0===t||null===(l=t.fee_receipt)||void 0===l?void 0:l._id)&&c(u))}}),l&&(0,Z.jsx)(x.Z,{})]})},k=e=>{var t,n,i,l,d,o,a,r,c,u,v,_,f,m,h,p,x,j,g,y,M,b,S,R,D,k;let{history:T}=e;const{t:A}=(0,s.$G)();return(0,Z.jsxs)("div",{className:L.Z.sidebarheader,style:{gap:"1%"},title:"Income"===(null===T||void 0===T?void 0:T.payment_module_type)?"":"View Receipt",children:[(0,Z.jsxs)("div",{className:L.Z.history_image_container,style:{width:"50%"},children:[null!==T&&void 0!==T&&null!==(t=T.student)&&void 0!==t&&t.studentProfilePhoto?(0,Z.jsx)("img",{src:"".concat(N.yI,"/").concat(null===T||void 0===T||null===(n=T.student)||void 0===n?void 0:n.studentProfilePhoto),alt:"qr code",style:{width:"60px",height:"60px",borderRadius:"12px"}}):null,(0,Z.jsxs)("div",{className:L.Z.text,children:[(0,Z.jsx)("p",{className:L.Z.rcv,children:A("paid_to")}),(0,Z.jsx)("h6",{children:null!==T&&void 0!==T&&T.student?"".concat(null!==(i=null===T||void 0===T||null===(l=T.student)||void 0===l?void 0:l.studentFirstName)&&void 0!==i?i:""," ").concat(null!==(d=null===T||void 0===T||null===(o=T.student)||void 0===o?void 0:o.studentMiddleName)&&void 0!==d?d:""," ").concat(null!==(a=null===T||void 0===T||null===(r=T.student)||void 0===r?void 0:r.studentLastName)&&void 0!==a?a:""):""}),(0,Z.jsxs)("p",{className:L.Z.rcv,children:[A("gr_number")," ",null!==(c=null===T||void 0===T||null===(u=T.student)||void 0===u?void 0:u.studentGRNO)&&void 0!==c?c:""]}),(0,Z.jsx)("p",{className:L.Z.rcv,children:null!==(v=null===T||void 0===T||null===(_=T.student)||void 0===_||null===(f=_.fee_structure)||void 0===f?void 0:f.unique_structure_name)&&void 0!==v?v:""})]})]}),(0,Z.jsxs)("div",{className:L.Z.text,style:{width:"27%"},children:[(0,Z.jsx)("p",{className:L.Z.rcv,style:{width:"100%"},children:A("transaction_id")}),(0,Z.jsx)("h6",{style:{width:"100%",wordWrap:"break-word"},children:null!==T&&void 0!==T&&null!==(m=T.fee_receipt)&&void 0!==m&&m.fee_utr_reference?null===T||void 0===T||null===(h=T.fee_receipt)||void 0===h?void 0:h.fee_utr_reference:"N/A"}),(0,Z.jsxs)("p",{className:L.Z.rcv,style:{width:"100%"},children:[Y()(null===T||void 0===T||null===(p=T.fee_receipt)||void 0===p?void 0:p.created_at).format("DD MMM YYYY"),", ",(0,w.J)(null===T||void 0===T||null===(x=T.fee_receipt)||void 0===x?void 0:x.created_at,"LT")]})]}),(0,Z.jsxs)("div",{className:L.Z.text,style:{width:"20%"},children:[(0,Z.jsxs)("p",{className:L.Z.rcv,style:{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[A("invoice_no")," ",null!==(j=null===T||void 0===T||null===(g=T.fee_receipt)||void 0===g?void 0:g.invoice_count)&&void 0!==j?j:"N/A",(0,Z.jsx)(I,{history:T})]}),(0,Z.jsxs)("h6",{style:{width:"100%"},children:[A("rs_only")," ",null===T||void 0===T||null===(y=T.fee_receipt)||void 0===y?void 0:y.fee_payment_amount]}),(0,Z.jsx)("p",{className:L.Z.rcv,style:{width:"100%"},children:"offline"===(null===T||void 0===T||null===(M=T.payment_mode)||void 0===M?void 0:M.toLowerCase())?null!==T&&void 0!==T&&null!==(b=T.fee_receipt)&&void 0!==b&&b.fee_payment_mode?"".concat(null===T||void 0===T||null===(S=T.fee_receipt)||void 0===S?void 0:S.fee_payment_mode):"Offline - No Receipt":"online"===(null===T||void 0===T||null===(R=T.payment_mode)||void 0===R?void 0:R.toLowerCase())?null!==T&&void 0!==T&&null!==(D=T.fee_receipt)&&void 0!==D&&D.fee_payment_mode?"".concat(null===T||void 0===T||null===(k=T.fee_receipt)||void 0===k?void 0:k.fee_payment_mode):"Online - No Receipt":null===T||void 0===T?void 0:T.payment_mode})]})]})},T=e=>{var t,n,i;let{aid:d,totalRefunded:o}=e;const{t:c}=(0,s.$G)(),[u,v]=(0,r.useState)(""),[_,y]=(0,r.useState)(1),[N,M]=(0,r.useState)(!0),[b,L]=(0,f.YD)({skip:u}),{admissionExcessFeeRefundedList:S,admissionExcessFeeRefundedListLoading:Y}=(0,p.oL)({data:{aid:d,page:_,limit:10,search:u},skip:!d});(0,r.useEffect)((()=>{L&&N&&y((e=>e+1))}),[L,N]),(0,r.useEffect)((()=>{var e;if(null!==S&&void 0!==S&&null!==(e=S.list)&&void 0!==e&&e.length){var t;let e=(0,h.f)(null===S||void 0===S||null===(t=S.list)||void 0===t?void 0:t.length);M((()=>e))}}),[null===S||void 0===S?void 0:S.list]);const w=(0,r.useCallback)((0,m.J)((e=>{y((()=>1)),v(e)}),1500),[]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("div",{className:l.Z.fm_header_container,children:[(0,Z.jsxs)("h6",{children:[c("total_refund")," "," : "," ",c("rs_only")," ",null!==o&&void 0!==o?o:0]}),(0,Z.jsx)("div",{className:l.Z.fm_search,children:(0,Z.jsx)("section",{className:l.Z.fm_search_container,children:(0,Z.jsxs)("div",{className:l.Z.fm_search_container_inner,children:[(0,Z.jsx)("img",{className:l.Z.fm_search_icon,alt:"search icon",src:"".concat(a.dB,"/navbar-search.svg")}),(0,Z.jsx)("input",{type:"text",placeholder:c("search"),onChange:e=>{e.target.value?w(e.target.value):(y((()=>1)),v(""))}})]})})})]}),null===S||void 0===S||null===(t=S.list)||void 0===t?void 0:t.map(((e,t)=>{var n;return(null===S||void 0===S||null===(n=S.list)||void 0===n?void 0:n.length)===t+1?(0,Z.jsx)("div",{ref:b,children:(0,Z.jsx)(k,{history:e})},null===e||void 0===e?void 0:e._id):(0,Z.jsx)(k,{history:e},null===e||void 0===e?void 0:e._id)})),Y?u?(0,Z.jsx)(x.Z,{}):(0,Z.jsx)(j.Z,{}):u?0===(null===S||void 0===S||null===(n=S.list)||void 0===n?void 0:n.length)&&(0,Z.jsx)(g.Z,{title:"No students found related this search."}):0===(null===S||void 0===S||null===(i=S.list)||void 0===i?void 0:i.length)&&(0,Z.jsx)(g.Z,{title:"No students."})]})},A=e=>{let{totalRefund:t,aid:n,totalRefunded:f}=e;const{t:m}=(0,s.$G)(),[h]=(0,c.lr)(),j=(0,u.TH)(),g=(0,u.UO)(),y=(0,u.s0)(),[N,M]=(0,r.useState)(!1),[L]=(0,p.o5)(),[S]=(0,p.Lg)();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(i.Z,{children:[(0,Z.jsx)(o.Z,{children:(0,Z.jsxs)("div",{className:l.Z.fm_header_container,children:[(0,Z.jsx)("h6",{children:m("excess_fees_refund")}),(0,Z.jsx)("div",{className:l.Z.fm_both_filter,children:(0,Z.jsx)("div",{onClick:()=>{n&&(M((e=>!e)),"refunded"===h.get("n")?S({aid:n}).then((()=>{var e;M((e=>!e));let t="Institute"===(null===(e=j.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(g.username,"/institute/member/finance?type=export"):"/q/".concat(g.username,"/member/staff/finance?type=export");y(t,{state:j.state})})).catch({}):L({aid:n}).then((()=>{var e;M((e=>!e));let t="Institute"===(null===(e=j.state)||void 0===e?void 0:e.urlOffSet)?"/q/".concat(g.username,"/institute/member/finance?type=export"):"/q/".concat(g.username,"/member/staff/finance?type=export");y(t,{state:j.state})})).catch({}))},className:l.Z.fm_both_filter_with_name,children:(0,Z.jsx)("img",{src:"".concat(a.J7,"/export.svg"),alt:"filter icon",style:{width:"2rem",height:"2rem"},title:"Export In Excel"})})})]})}),(0,Z.jsx)(d.Z,{}),(0,Z.jsxs)(o.Z,{customStyle:{paddingTop:"0"},children:[(0,Z.jsx)(v.Z,{children:E.map((e=>{var t;return(0,Z.jsx)(_.Z,{tab:e,isLink:!0,isActive:"excess_fee"===e.id&&!h.get("n")||h.get("n")===e.id,parentState:j.state,url:"Institute"===(null===(t=j.state)||void 0===t?void 0:t.urlOffSet)?"/q/".concat(g.username,"/institute/member/finance?type=excess").concat(e.urlKey):"/q/".concat(g.username,"/member/staff/finance?type=excess").concat(e.urlKey)},null===e||void 0===e?void 0:e.id)}))}),(0,Z.jsx)(d.Z,{customStyleBorder:{marginTop:"0"}})]}),(0,Z.jsx)(o.Z,{customStyle:{paddingTop:"0"},children:"refunded"===h.get("n")?(0,Z.jsx)(T,{aid:n,totalRefunded:f}):(0,Z.jsx)(b,{aid:n,totalRefund:t})})]}),N&&(0,Z.jsx)(x.Z,{})]})},E=[{label:"excess_fee",id:"excess_fee",urlKey:""},{label:"refunded",id:"refunded",urlKey:"&n=refunded"}]},82824:(e,t,n)=>{"use strict";n.d(t,{J:()=>o,Z:()=>a});var i=n(99893),s=n.n(i),l=n(97892),d=n.n(l);const o=(e,t)=>(d().extend(s()),d()(e).format(t)),a=(e,t,n)=>{var i;return d()()[e]("".concat(null===(i=d()(n))||void 0===i?void 0:i.format("YYYY-MM-DD")),t)}},99893:function(e){e.exports=function(){"use strict";var e={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(t,n,i){var s=n.prototype,l=s.format;i.en.formats=e,s.format=function(t){void 0===t&&(t="YYYY-MM-DDTHH:mm:ssZ");var n=this.$locale().formats,i=function(t,n){return t.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(t,i,s){var l=s&&s.toUpperCase();return i||n[s]||e[s]||n[l].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))}))}(t,void 0===n?{}:n);return l.call(this,i)}}}()},3773:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={pending_fees_card:"PendingFees_pending_fees_card__-fyKu",pending_fees_card_container:"PendingFees_pending_fees_card_container__HBWkK",pending_fees_card_inner:"PendingFees_pending_fees_card_inner__Zi+6O",statistics_balance:"PendingFees_statistics_balance__px4LZ"}},76697:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});const i={settle_card:"TransactionHistory_settle_card__WjSwI",settle_card_container:"TransactionHistory_settle_card_container__EIw4W",settle_card_text:"TransactionHistory_settle_card_text__3j20S",settle_paragraph:"TransactionHistory_settle_paragraph__x3Ovt",sidebarheader:"TransactionHistory_sidebarheader__oEDm9",history_image_container:"TransactionHistory_history_image_container__ZBhq9",text:"TransactionHistory_text__yimnr",rcv:"TransactionHistory_rcv__kuGgZ"}}}]);
//# sourceMappingURL=10509.5d8894fb.chunk.js.map